/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={984:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var i=function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.create,Object.create;var r,s,o=n(448),a=n(886),h=n(594),u=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),c=new o.LL("app","Firebase",u),l="@firebase/app",f="[DEFAULT]",d=((s={})[l]="fire-core",s["@firebase/analytics"]="fire-analytics",s["@firebase/auth"]="fire-auth",s["@firebase/database"]="fire-rtdb",s["@firebase/functions"]="fire-fn",s["@firebase/installations"]="fire-iid",s["@firebase/messaging"]="fire-fcm",s["@firebase/performance"]="fire-perf",s["@firebase/remote-config"]="fire-rc",s["@firebase/storage"]="fire-gcs",s["@firebase/firestore"]="fire-fst",s["fire-js"]="fire-js",s["firebase-wrapper"]="fire-js-all",s),p=new h.Yd("@firebase/app"),v=function(){function t(t,e,n){var i=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,o.p$)(t),this.container=new a.H0(e.name),this._addComponent(new a.wA("app",(function(){return i}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return i._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,i={__esModule:!0,initializeApp:function(n,r){void 0===r&&(r={}),"object"==typeof r&&null!==r||(r={name:r});var s=r;void 0===s.name&&(s.name=f);var a=s.name;if("string"!=typeof a||!a)throw c.create("bad-app-name",{appName:String(a)});if((0,o.r3)(e,a))throw c.create("duplicate-app",{appName:a});var h=new t(n,s,i);return e[a]=h,h},app:r,registerVersion:function(t,e,n){var i,r=null!==(i=d[t])&&void 0!==i?i:t;n&&(r+="-"+n);var o=r.match(/\s|\//),h=e.match(/\s|\//);if(o||h){var u=['Unable to register library "'+r+'" with version "'+e+'":'];return o&&u.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),o&&h&&u.push("and"),h&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(u.join(" "))}s(new a.wA(r+"-version",(function(){return{library:r,version:e}}),"VERSION"))},setLogLevel:h.Ub,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw c.create("invalid-log-argument");(0,h.Am)(t,e)},apps:null,SDK_VERSION:"8.3.1",INTERNAL:{registerComponent:s,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function r(t){if(t=t||f,!(0,o.r3)(e,t))throw c.create("no-app",{appName:t});return e[t]}function s(s){var a=s.name;if(n.has(a))return p.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===s.type?i[a]:null;if(n.set(a,s),"PUBLIC"===s.type){var h=function(t){if(void 0===t&&(t=r()),"function"!=typeof t[a])throw c.create("invalid-app-argument",{appName:a});return t[a]()};void 0!==s.serviceProps&&(0,o.ZB)(h,s.serviceProps),i[a]=h,t.prototype[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,a).apply(this,s.multipleInstances?t:[])}}for(var u=0,l=Object.keys(e);u<l.length;u++){var f=l[u];e[f]._addComponent(s)}return"PUBLIC"===s.type?i[a]:null}return i.default=i,Object.defineProperty(i,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),r.App=t,i}(v);return e.INTERNAL=i(i({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,o.ZB)(e,t)},createSubscribe:o.ne,ErrorFactory:o.LL,deepExtend:o.ZB}),e}(),m=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,o.jU)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var x=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,o.UG)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),x.apply(void 0,t)};var b=g;!function(t,e){t.INTERNAL.registerComponent(new a.wA("platform-logger",(function(t){return new m(t)}),"PRIVATE")),t.registerVersion(l,"0.6.17",void 0),t.registerVersion("fire-js","")}(b);const w=b},886:(t,e,n)=>{"use strict";n.d(e,{wA:()=>a,H0:()=>c,zt:()=>u});var i=function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function r(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function s(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}Object.create,Object.create;var o=n(448),a=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),h="[DEFAULT]",u=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=h);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new o.BH;this.instancesDeferred.set(e,n);try{var i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=i({identifier:h,optional:!1},t),n=e.identifier,r=e.optional,s=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService({instanceIdentifier:s});if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:h})}catch(t){}try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var o=r(s.value,2),a=o[0],u=o[1],c=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService({instanceIdentifier:c});u.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=h),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],r(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),r(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=h),this.instances.has(t)},t.prototype.initialize=function(t){void 0===t&&(t={});var e=t.instanceIdentifier,n=void 0===e?h:e,i=t.options,r=void 0===i?{}:i,s=this.normalizeInstanceIdentifier(n);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");return this.getOrInitializeService({instanceIdentifier:s,options:r})},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,i=t.options,r=void 0===i?{}:i,s=this.instances.get(n);return!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===h?void 0:e),options:r}),this.instances.set(n,s)),s||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:h:t},t}(),c=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new u(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},790:(t,e,n)=>{"use strict";var i=n(984),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function u(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}Object.create,Object.create;var c=n(448),l=n(594),f=n(886);t=n.hmd(t);var d,p=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,c.Pz)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,c.cI)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),v=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,c.r3)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),g=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new p(e)}}catch(t){}return new v},m=g("localStorage"),y=g("sessionStorage"),x=new l.Yd("@firebase/database"),b=(d=1,function(){return d++}),w=function(t){var e=(0,c.dS)(t),n=new c.gQ;n.update(e);var i=n.digest();return c.US.encodeByteArray(i)},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",i=0;i<t.length;i++){var r=t[i];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?n+=_.apply(null,r):n+="object"==typeof r?(0,c.Pz)(r):r,n+=" "}return n},T=null,E=!0,S=function(t,e){(0,c.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(x.logLevel=l.in.VERBOSE,T=x.log.bind(x),e&&y.set("logging_enabled",!0)):"function"==typeof t?T=t:(T=null,y.remove("logging_enabled"))},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===E&&(E=!1,null===T&&!0===y.get("logging_enabled")&&S(!0)),T){var n=_.apply(null,t);T(n)}},A=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];C.apply(void 0,u([t],h(e)))}},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+_.apply(void 0,u([],h(t)));x.error(n)},P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+_.apply(void 0,u([],h(t)));throw x.error(n),new Error(n)},R=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+_.apply(void 0,u([],h(t)));x.warn(n)},O=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},k="[MIN_NAME]",M="[MAX_NAME]",D=function(t,e){if(t===e)return 0;if(t===k||e===M)return-1;if(e===k||t===M)return 1;var n=z(t),i=z(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1},L=function(t,e){return t===e?0:t<e?-1:1},N=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,c.Pz)(e))},F=function(t){if("object"!=typeof t||null===t)return(0,c.Pz)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var i="{",r=0;r<e.length;r++)0!==r&&(i+=","),i+=(0,c.Pz)(e[r]),i+=":",i+=F(t[e[r]]);return i+"}"},B=function(t,e){var n=t.length;if(n<=e)return[t];for(var i=[],r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function U(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var V=function(t){(0,c.hu)(!O(t),"Invalid JSON number");var e,n,i,r,s;0===t?(n=0,i=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(r=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,i=Math.round(t*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,i=Math.round(t/Math.pow(2,-1074))));var o=[];for(s=52;s;s-=1)o.push(i%2?1:0),i=Math.floor(i/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(e?1:0),o.reverse();var a=o.join(""),h="";for(s=0;s<64;s+=8){var u=parseInt(a.substr(s,8),2).toString(16);1===u.length&&(u="0"+u),h+=u}return h.toLowerCase()},Y=new RegExp("^-?(0*)\\d{1,10}$"),z=function(t){if(Y.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},X=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw R("Exception was thrown by user callback.",e),t}),Math.floor(0))}},G=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},j=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function W(){return new j("")}function H(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function q(t){return t.pieces_.length-t.pieceNum_}function K(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new j(t.pieces_,e)}function Q(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Z(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function J(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function $(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new j(e,0)}function tt(t,e){for(var n=[],i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof j)for(i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{var r=e.split("/");for(i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new j(n,0)}function et(t){return t.pieceNum_>=t.pieces_.length}function nt(t,e){var n=H(t),i=H(e);if(null===n)return e;if(n===i)return nt(K(t),K(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function it(t,e){for(var n=J(t,0),i=J(e,0),r=0;r<n.length&&r<i.length;r++){var s=D(n[r],i[r]);if(0!==s)return s}return n.length===i.length?0:n.length<i.length?-1:1}function rt(t,e){if(q(t)!==q(e))return!1;for(var n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function st(t,e){var n=t.pieceNum_,i=e.pieceNum_;if(q(t)>q(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var ot=function(t,e){this.errorPrefix_=e,this.parts_=J(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,c.ug)(this.parts_[n]);at(this)};function at(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ht(t))}function ht(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var ut=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ct="websocket",lt="long_polling",ft=function(){function t(t,e,n,i,r,s,o){void 0===r&&(r=!1),void 0===s&&(s=""),void 0===o&&(o=!1),this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=m.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&m.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function dt(t,e,n){var i;if((0,c.hu)("string"==typeof e,"typeof type must == string"),(0,c.hu)("object"==typeof n,"typeof params must == object"),e===ct)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==lt)throw new Error("Unknown connection type: "+e);i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var r=[];return U(n,(function(t,e){r.push(t+"="+e)})),i+r.join("&")}var pt,vt,gt,mt,yt,xt,bt,wt=function(t,e){var n=_t(t),i=n.namespace;"firebase.com"===n.domain&&P(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||P("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&R("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ft(n.host,n.secure,i,e,r,"",i!==n.subdomain),path:new j(n.pathString)}},_t=function(t){var e="",n="",i="",r="",s="",o=!0,h="https",u=443;if("string"==typeof t){var c=t.indexOf("//");c>=0&&(h=t.substring(0,c-1),t=t.substring(c+2));var l=t.indexOf("/");-1===l&&(l=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(l,f)),l<f&&(r=function(t){for(var e="",n=t.split("/"),i=0;i<n.length;i++)if(n[i].length>0){var r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(t){}e+="/"+r}return e}(t.substring(l,f)));var d=function(t){var e,n,i={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var r=a(t.split("&")),s=r.next();!s.done;s=r.next()){var o=s.value;if(0!==o.length){var h=o.split("=");2===h.length?i[decodeURIComponent(h[0])]=decodeURIComponent(h[1]):R("Invalid query segment '"+o+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}(t.substring(Math.min(t.length,f)));(c=e.indexOf(":"))>=0?(o="https"===h||"wss"===h,u=parseInt(e.substring(c+1),10)):c=e.length;var p=e.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");i=e.substring(0,v).toLowerCase(),n=e.substring(v+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:u,domain:n,subdomain:i,secure:o,scheme:h,pathString:r,namespace:s}},Tt=/[\[\].#$\/\u0000-\u001F\u007F]/,Et=/[\[\].#$\u0000-\u001F\u007F]/,St=10485760,Ct=function(t){return"string"==typeof t&&0!==t.length&&!Tt.test(t)},At=function(t){return"string"==typeof t&&0!==t.length&&!Et.test(t)},It=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!O(t)||t&&"object"==typeof t&&(0,c.r3)(t,".sv")},Pt=function(t,e,n,i,r){r&&void 0===n||Rt((0,c.gK)(t,e,r),n,i)},Rt=function(t,e,n){var i=n instanceof j?new ot(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+ht(i));if("function"==typeof e)throw new Error(t+"contains a function "+ht(i)+" with contents = "+e.toString());if(O(e))throw new Error(t+"contains "+e.toString()+" "+ht(i));if("string"==typeof e&&e.length>St/3&&(0,c.ug)(e)>St)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+ht(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var r=!1,s=!1;if(U(e,(function(e,n){if(".value"===e)r=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!Ct(e)))throw new Error(t+" contains an invalid key ("+e+") "+ht(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var o,a;a=e,(o=i).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(a),o.byteLength_+=(0,c.ug)(a),at(o),Rt(t,n,i),function(t){var e=t.parts_.pop();t.byteLength_-=(0,c.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)})),r&&s)throw new Error(t+' contains ".value" child '+ht(i)+" in addition to actual children.")}},Ot=function(t,e,n,i,r){if(!r||void 0!==n){var s=(0,c.gK)(t,e,r);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(s+" must be an object containing the children to replace.");var o=[];U(n,(function(t,e){var n=new j(t);if(Rt(s,e,tt(i,n)),".priority"===Q(n)&&!It(e))throw new Error(s+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(n)})),function(t,e){var n,i;for(n=0;n<e.length;n++)for(var r=J(i=e[n]),s=0;s<r.length;s++)if(".priority"===r[s]&&s===r.length-1);else if(!Ct(r[s]))throw new Error(t+"contains an invalid key ("+r[s]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(it);var o=null;for(n=0;n<e.length;n++){if(i=e[n],null!==o&&st(o,i))throw new Error(t+"contains a path "+o.toString()+" that is ancestor of another path "+i.toString());o=i}}(s,o)}},kt=function(t,e,n,i){if(!i||void 0!==n){if(O(n))throw new Error((0,c.gK)(t,e,i)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!It(n))throw new Error((0,c.gK)(t,e,i)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Mt=function(t,e,n,i){if(!i||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,c.gK)(t,e,i)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Dt=function(t,e,n,i){if(!(i&&void 0===n||Ct(n)))throw new Error((0,c.gK)(t,e,i)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Lt=function(t,e,n,i){if(!(i&&void 0===n||At(n)))throw new Error((0,c.gK)(t,e,i)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Nt=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lt(t,e,n,i)},Ft=function(t,e){if(".info"===H(e))throw new Error(t+" failed = Can't modify data under /.info/")},Bt=function(t,e,n){var i=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Ct(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==i.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),At(t)}(i))throw new Error((0,c.gK)(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Ut=function(t,e,n,i){if((!i||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,c.gK)(t,e,i)+"must be a boolean.")},Vt=function(t){return"number"==typeof t?"number:"+V(t):"string:"+t},Yt=function(t){if(t.isLeafNode()){var e=t.val();(0,c.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,c.r3)(e,".sv"),"Priority must be a string or number.")}else(0,c.hu)(t===pt||t.isEmpty(),"priority of unexpected type.");(0,c.hu)(t===pt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},zt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,c.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Yt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return vt},set:function(t){vt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return et(e)?this:".priority"===H(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var i=H(e);return null===i?n:n.isEmpty()&&".priority"!==i?this:((0,c.hu)(".priority"!==i||1===q(e),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(K(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Vt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?V(this.value_):this.value_,this.lazyHash_=w(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,c.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,i=typeof this.value_,r=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(i);return(0,c.hu)(r>=0,"Unknown leaf type: "+n),(0,c.hu)(s>=0,"Unknown leaf type: "+i),r===s?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Xt=function(){function t(t,e,n,i,r){void 0===r&&(r=null),this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];for(var s=1;!t.isEmpty();)if(t=t,s=e?n(t.key,e):1,i&&(s*=-1),s<0)t=this.isReverse_?t.left:t.right;else{if(0===s){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Gt=function(){function t(e,n,i,r,s){this.key=e,this.value=n,this.color=null!=i?i:t.RED,this.left=null!=r?r:Wt.EMPTY_NODE,this.right=null!=s?s:Wt.EMPTY_NODE}return t.prototype.copy=function(e,n,i,r,s){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=s?s:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Wt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,i;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Wt.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),jt=function(){function t(){}return t.prototype.copy=function(t,e,n,i,r){return this},t.prototype.insert=function(t,e,n){return new Gt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Wt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Gt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,i=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Xt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Xt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Xt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Xt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new jt,t}(),Ht=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),qt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ht(k,t),i=new Ht(k,e);return 0!==this.compare(n,i)},t.prototype.minPost=function(){return Ht.MIN},t}(),Kt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),i=e.node.getPriority(),r=n.compareTo(i);return 0===r?D(t.name,e.name):r},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ht.MIN},e.prototype.maxPost=function(){return new Ht(M,new zt("[PRIORITY-POST]",mt))},e.prototype.makePost=function(t,e){var n=gt(t);return new Ht(e,new zt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(qt)),Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return yt},set:function(t){yt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return D(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,c.g5)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ht.MIN},e.prototype.maxPost=function(){return new Ht(M,yt)},e.prototype.makePost=function(t,e){return(0,c.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ht(t,yt)},e.prototype.toString=function(){return".key"},e}(qt),Zt=new Qt,Jt=Math.log(2),$t=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Jt,10)),this.current_=this.count-1;var n,i=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&i}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),te=function(t,e,n,i){t.sort(e);var r=function(e,i){var s,o,a=i-e;if(0===a)return null;if(1===a)return s=t[e],o=n?n(s):s,new Gt(o,s.node,Gt.BLACK,null,null);var h=parseInt(a/2,10)+e,u=r(e,h),c=r(h+1,i);return s=t[h],o=n?n(s):s,new Gt(o,s.node,Gt.BLACK,u,c)},s=function(e){for(var i=null,s=null,o=t.length,a=function(e,i){var s=o-e,a=o;o-=e;var u=r(s+1,a),c=t[s],l=n?n(c):c;h(new Gt(l,c.node,i,null,u))},h=function(t){i?(i.left=t,i=t):(s=t,i=t)},u=0;u<e.count;++u){var c=e.nextBitIsOne(),l=Math.pow(2,e.count-(u+1));c?a(l,Gt.BLACK):(a(l,Gt.BLACK),a(l,Gt.RED))}return s}(new $t(t.length));return new Wt(i||e,s)},ee={},ne=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,c.hu)(ee&&Kt,"ChildrenNode.ts has not been loaded"),xt=xt||new t({".priority":ee},{".priority":Kt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,c.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Wt?e:null},t.prototype.hasIndex=function(t){return(0,c.r3)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,c.hu)(e!==Zt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var i,r=[],s=!1,a=n.getIterator(Ht.Wrap),h=a.getNext();h;)s=s||e.isDefinedOn(h.node),r.push(h),h=a.getNext();i=s?te(r,e.getCompare()):ee;var u=e.toString(),l=o({},this.indexSet_);l[u]=e;var f=o({},this.indexes_);return f[u]=i,new t(f,l)},t.prototype.addToIndexes=function(e,n){var i=this;return new t((0,c.UI)(this.indexes_,(function(t,r){var s=(0,c.DV)(i.indexSet_,r);if((0,c.hu)(s,"Missing index implementation for "+r),t===ee){if(s.isDefinedOn(e.node)){for(var o=[],a=n.getIterator(Ht.Wrap),h=a.getNext();h;)h.name!==e.name&&o.push(h),h=a.getNext();return o.push(e),te(o,s.getCompare())}return ee}var u=n.get(e.name),l=t;return u&&(l=l.remove(new Ht(e.name,u))),l.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,c.UI)(this.indexes_,(function(t){if(t===ee)return t;var i=n.get(e.name);return i?t.remove(new Ht(e.name,i)):t})),this.indexSet_)},t}();function ie(t,e){return D(t.name,e.name)}function re(t,e){return D(t,e)}var se,oe=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Yt(this.priorityNode_),this.children_.isEmpty()&&(0,c.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return bt||(bt=new t(new Wt(re),null,ne.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||bt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?bt:e},t.prototype.getChild=function(t){var e=H(t);return null===e?this:this.getImmediateChild(e).getChild(K(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,c.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var i=new Ht(e,n),r=void 0,s=void 0;n.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(i,this.children_));var o=r.isEmpty()?bt:this.priorityNode_;return new t(r,o,s)},t.prototype.updateChild=function(t,e){var n=H(t);if(null===n)return e;(0,c.hu)(".priority"!==H(t)||1===q(t),".priority must be the last token in a path");var i=this.getImmediateChild(n).updateChild(K(t),e);return this.updateImmediateChild(n,i)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},i=0,r=0,s=!0;if(this.forEachChild(Kt,(function(o,a){n[o]=a.val(e),i++,s&&t.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1})),!e&&s&&r<2*i){var o=[];for(var a in n)o[a]=n[a];return o}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Vt(this.getPriority().val())+":"),this.forEachChild(Kt,(function(e,n){var i=n.hash();""!==i&&(t+=":"+e+":"+i)})),this.lazyHash_=""===t?"":w(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var i=this.resolveIndex_(n);if(i){var r=i.getPredecessorKey(new Ht(t,e));return r?r.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ht(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ht(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var i=this.children_.getIteratorFrom(t.name,Ht.Wrap),r=i.peek();null!=r&&e.compare(r,t)<0;)i.getNext(),r=i.peek();return i},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var i=this.children_.getReverseIteratorFrom(t.name,Ht.Wrap),r=i.peek();null!=r&&e.compare(r,t)>0;)i.getNext(),r=i.peek();return i},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ae?-1:0},t.prototype.withIndex=function(e){if(e===Zt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Zt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Kt),i=e.getIterator(Kt),r=n.getNext(),s=i.getNext();r&&s;){if(r.name!==s.name||!r.node.equals(s.node))return!1;r=n.getNext(),s=i.getNext()}return null===r&&null===s}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Zt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ae=new(function(t){function e(){return t.call(this,new Wt(re),oe.EMPTY_NODE,ne.Default)||this}return s(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return oe.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(oe));function he(t,e){if(void 0===e&&(e=null),null===t)return oe.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,c.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new zt(t,he(e));if(t instanceof Array){var n=oe.EMPTY_NODE;return U(t,(function(e,i){if((0,c.r3)(t,e)&&"."!==e.substring(0,1)){var r=he(i);!r.isLeafNode()&&r.isEmpty()||(n=n.updateImmediateChild(e,r))}})),n.updatePriority(he(e))}var i=[],r=!1;if(U(t,(function(t,e){if("."!==t.substring(0,1)){var n=he(e);n.isEmpty()||(r=r||!n.getPriority().isEmpty(),i.push(new Ht(t,n)))}})),0===i.length)return oe.EMPTY_NODE;var s=te(i,ie,(function(t){return t.name}),re);if(r){var o=te(i,Kt.getCompare());return new oe(s,he(e),new ne({".priority":o},{".priority":Kt}))}return new oe(s,he(e),ne.Default)}function ue(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}Object.defineProperties(Ht,{MIN:{value:new Ht(k,oe.EMPTY_NODE)},MAX:{value:new Ht(M,ae)}}),Qt.__EMPTY_NODE=oe.EMPTY_NODE,zt.__childrenNodeConstructor=oe,pt=ae,mt=ae,function(t){gt=t}(he),function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(se||(se={}));var ce,le=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=se.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(et(this.path)){if(null!=this.affectedTree.value)return(0,c.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new j(e));return new t(W(),n,this.revert)}return(0,c.hu)(H(this.path)===e,"operationForChild called for unrelated child."),new t(K(this.path),this.affectedTree,this.revert)},t}(),fe=function(){function t(t,e){void 0===e&&(ce||(ce=new Wt(L)),e=ce),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return U(e,(function(t,e){n=n.set(new j(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:W(),value:this.value};if(et(t))return null;var n=H(t),i=this.children.get(n);if(null!==i){var r=i.findRootMostMatchingPathAndValue(K(t),e);return null!=r?{path:tt(new j(n),r.path),value:r.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(et(e))return this;var n=H(e),i=this.children.get(n);return null!==i?i.subtree(K(e)):new t(null)},t.prototype.set=function(e,n){if(et(e))return new t(n,this.children);var i=H(e),r=(this.children.get(i)||new t(null)).set(K(e),n),s=this.children.insert(i,r);return new t(this.value,s)},t.prototype.remove=function(e){if(et(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=H(e),i=this.children.get(n);if(i){var r=i.remove(K(e)),s=void 0;return s=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),null===this.value&&s.isEmpty()?new t(null):new t(this.value,s)}return this},t.prototype.get=function(t){if(et(t))return this.value;var e=H(t),n=this.children.get(e);return n?n.get(K(t)):null},t.prototype.setTree=function(e,n){if(et(e))return n;var i,r=H(e),s=(this.children.get(r)||new t(null)).setTree(K(e),n);return i=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new t(this.value,i)},t.prototype.fold=function(t){return this.fold_(W(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(i,r){n[i]=r.fold_(tt(t,i),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,W(),e)},t.prototype.findOnPath_=function(t,e,n){var i=!!this.value&&n(e,this.value);if(i)return i;if(et(t))return null;var r=H(t),s=this.children.get(r);return s?s.findOnPath_(K(t),tt(e,r),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,W(),e)},t.prototype.foreachOnPath_=function(e,n,i){if(et(e))return this;this.value&&i(n,this.value);var r=H(e),s=this.children.get(r);return s?s.foreachOnPath_(K(e),tt(n,r),i):new t(null)},t.prototype.foreach=function(t){this.foreach_(W(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,i){i.foreach_(tt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),de=function(){function t(t,e){this.source=t,this.path=e,this.type=se.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return et(this.path)?new t(this.source,W()):new t(this.source,K(this.path))},t}(),pe=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=se.OVERWRITE}return t.prototype.operationForChild=function(e){return et(this.path)?new t(this.source,W(),this.snap.getImmediateChild(e)):new t(this.source,K(this.path),this.snap)},t}(),ve=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=se.MERGE}return t.prototype.operationForChild=function(e){if(et(this.path)){var n=this.children.subtree(new j(e));return n.isEmpty()?null:n.value?new pe(this.source,W(),n.value):new t(this.source,W(),n)}return(0,c.hu)(H(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,K(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),ge=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(et(t))return this.isFullyInitialized()&&!this.filtered_;var e=H(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}();function me(t,e){return{eventCache:t,serverCache:e}}function ye(t,e,n,i){return me(new ge(e,n,i),t.serverCache)}function xe(t,e,n,i){return me(t.eventCache,new ge(e,n,i))}function be(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function we(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}function _e(t){return{type:"value",snapshotNode:t}}function Te(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ee(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Se(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var Ce=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,i,r,s){(0,c.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=t.getImmediateChild(e);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(Ee(e,o)):(0,c.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(Te(e,n)):s.trackChildChange(Se(e,n,o))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Kt,(function(t,i){e.hasChild(t)||n.trackChildChange(Ee(t,i))})),e.isLeafNode()||e.forEachChild(Kt,(function(e,i){if(t.hasChild(e)){var r=t.getImmediateChild(e);r.equals(i)||n.trackChildChange(Se(e,i,r))}else n.trackChildChange(Te(e,i))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?oe.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ae=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,c.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,c.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");var i=this.changeMap.get(n);if(i){var r=i.type;if("child_added"===e&&"child_removed"===r)this.changeMap.set(n,Se(n,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===r)this.changeMap.set(n,Ee(n,i.oldSnap));else if("child_changed"===e&&"child_added"===r)this.changeMap.set(n,Te(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==r)throw(0,c.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(n,Se(n,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Ie=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new fe(null))},t}();function Pe(t,e,n){if(et(e))return new Ie(new fe(n));var i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){var r=i.path,s=i.value,o=nt(r,e);return s=s.updateChild(o,n),new Ie(t.writeTree_.set(r,s))}var a=new fe(n),h=t.writeTree_.setTree(e,a);return new Ie(h)}function Re(t,e,n){var i=t;return U(n,(function(t,n){i=Pe(i,tt(e,t),n)})),i}function Oe(t,e){if(et(e))return Ie.empty();var n=t.writeTree_.setTree(e,new fe(null));return new Ie(n)}function ke(t,e){return null!=Me(t,e)}function Me(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(nt(n.path,e)):null}function De(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Kt,(function(t,n){e.push(new Ht(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ht(t,n.value))})),e}function Le(t,e){if(et(e))return t;var n=Me(t,e);return new Ie(null!=n?new fe(n):t.writeTree_.subtree(e))}function Ne(t){return t.writeTree_.isEmpty()}function Fe(t,e){return Be(W(),t.writeTree_,e)}function Be(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var i=null;return e.children.inorderTraversal((function(e,r){".priority"===e?((0,c.hu)(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=Be(tt(t,e),r,n)})),n.getChild(t).isEmpty()||null===i||(n=n.updateChild(tt(t,".priority"),i)),n}function Ue(t,e){return Qe(e,t)}function Ve(t,e){if(t.snap)return st(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&st(tt(t.path,n),e))return!0;return!1}function Ye(t){return t.visible}function ze(t,e,n){for(var i=Ie.empty(),r=0;r<t.length;++r){var s=t[r];if(e(s)){var o=s.path,a=void 0;if(s.snap)st(n,o)?i=Pe(i,a=nt(n,o),s.snap):st(o,n)&&(a=nt(o,n),i=Pe(i,W(),s.snap.getChild(a)));else{if(!s.children)throw(0,c.g5)("WriteRecord should have .snap or .children");if(st(n,o))i=Re(i,a=nt(n,o),s.children);else if(st(o,n))if(et(a=nt(o,n)))i=Re(i,W(),s.children);else{var h=(0,c.DV)(s.children,H(a));if(h){var u=h.getChild(K(a));i=Pe(i,W(),u)}}}}}return i}function Xe(t,e,n,i,r){if(i||r){var s=Le(t.visibleWrites,e);return!r&&Ne(s)?n:r||null!=n||ke(s,W())?Fe(ze(t.allWrites,(function(t){return(t.visible||r)&&(!i||!~i.indexOf(t.writeId))&&(st(t.path,e)||st(e,t.path))}),e),n||oe.EMPTY_NODE):null}var o=Me(t.visibleWrites,e);if(null!=o)return o;var a=Le(t.visibleWrites,e);return Ne(a)?n:null!=n||ke(a,W())?Fe(a,n||oe.EMPTY_NODE):null}function Ge(t,e,n,i){return Xe(t.writeTree,t.treePath,e,n,i)}function je(t,e){return function(t,e,n){var i=oe.EMPTY_NODE,r=Me(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Kt,(function(t,e){i=i.updateImmediateChild(t,e)})),i;if(n){var s=Le(t.visibleWrites,e);return n.forEachChild(Kt,(function(t,e){var n=Fe(Le(s,new j(t)),e);i=i.updateImmediateChild(t,n)})),De(s).forEach((function(t){i=i.updateImmediateChild(t.name,t.node)})),i}return De(Le(t.visibleWrites,e)).forEach((function(t){i=i.updateImmediateChild(t.name,t.node)})),i}(t.writeTree,t.treePath,e)}function We(t,e,n,i){return function(t,e,n,i,r){(0,c.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");var s=tt(e,n);if(ke(t.visibleWrites,s))return null;var o=Le(t.visibleWrites,s);return Ne(o)?r.getChild(n):Fe(o,r.getChild(n))}(t.writeTree,t.treePath,e,n,i)}function He(t,e){return function(t,e){return Me(t.visibleWrites,e)}(t.writeTree,tt(t.treePath,e))}function qe(t,e,n){return function(t,e,n,i){var r=tt(e,n),s=Me(t.visibleWrites,r);return null!=s?s:i.isCompleteForChild(n)?Fe(Le(t.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Ke(t,e){return Qe(tt(t.treePath,e),t.writeTree)}function Qe(t,e){return{treePath:t,writeTree:e}}var Ze=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Je=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new ge(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return qe(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:we(this.viewCache_),r=function(t,e,n,i,r,s){return function(t,e,n,i,r,s,o){var a,h=Le(t.visibleWrites,e),u=Me(h,W());if(null!=u)a=u;else{if(null==n)return[];a=Fe(h,n)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),f=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),d=f.getNext();d&&c.length<r;)0!==l(d,i)&&c.push(d),d=f.getNext();return c}(t.writeTree,t.treePath,e,n,i,r,s)}(this.writes_,i,e,1,n,t);return 0===r.length?null:r[0]},t}();function $e(t,e,n,i,r,s){var o=e.eventCache;if(null!=He(i,n))return e;var a=void 0,h=void 0;if(et(n))if((0,c.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var u=we(e),l=je(i,u instanceof oe?u:oe.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{var f=Ge(i,we(e));a=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{var d=H(n);if(".priority"===d){(0,c.hu)(1===q(n),"Can't have a priority with additional path components");var p=o.getNode(),v=We(i,n,p,h=e.serverCache.getNode());a=null!=v?t.filter.updatePriority(p,v):o.getNode()}else{var g=K(n),m=void 0;if(o.isCompleteForChild(d)){h=e.serverCache.getNode();var y=We(i,n,o.getNode(),h);m=null!=y?o.getNode().getImmediateChild(d).updateChild(g,y):o.getNode().getImmediateChild(d)}else m=qe(i,d,e.serverCache);a=null!=m?t.filter.updateChild(o.getNode(),d,m,g,r,s):o.getNode()}}return ye(e,a,o.isFullyInitialized()||et(n),t.filter.filtersNodes())}function tn(t,e,n,i,r,s,o,a){var h,u=e.serverCache,c=o?t.filter:t.filter.getIndexedFilter();if(et(n))h=c.updateFullNode(u.getNode(),i,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(n,i);h=c.updateFullNode(u.getNode(),l,null)}else{var f=H(n);if(!u.isCompleteForPath(n)&&q(n)>1)return e;var d=K(n),p=u.getNode().getImmediateChild(f).updateChild(d,i);h=".priority"===f?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),f,p,d,Ze,null)}var v=xe(e,h,u.isFullyInitialized()||et(n),c.filtersNodes());return $e(t,v,n,r,new Je(r,v,s),a)}function en(t,e,n,i,r,s,o){var a,h,u=e.eventCache,c=new Je(r,e,s);if(et(n))h=t.filter.updateFullNode(e.eventCache.getNode(),i,o),a=ye(e,h,!0,t.filter.filtersNodes());else{var l=H(n);if(".priority"===l)h=t.filter.updatePriority(e.eventCache.getNode(),i),a=ye(e,h,u.isFullyInitialized(),u.isFiltered());else{var f=K(n),d=u.getNode().getImmediateChild(l),p=void 0;if(et(f))p=i;else{var v=c.getCompleteChild(l);p=null!=v?".priority"===Q(f)&&v.getChild($(f)).isEmpty()?v:v.updateChild(f,i):oe.EMPTY_NODE}a=d.equals(p)?e:ye(e,t.filter.updateChild(u.getNode(),l,p,f,c,o),u.isFullyInitialized(),t.filter.filtersNodes())}}return a}function nn(t,e){return t.eventCache.isCompleteForChild(e)}function rn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function sn(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var h,u=e;h=et(n)?i:new fe(null).setTree(n,i);var c=e.serverCache.getNode();return h.children.inorderTraversal((function(n,i){if(c.hasChild(n)){var h=rn(0,e.serverCache.getNode().getImmediateChild(n),i);u=tn(t,u,new j(n),h,r,s,o,a)}})),h.children.inorderTraversal((function(n,i){var h=!e.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!c.hasChild(n)&&!h){var l=rn(0,e.serverCache.getNode().getImmediateChild(n),i);u=tn(t,u,new j(n),l,r,s,o,a)}})),u}var on=function(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()};function an(t,e,n,i,r,s){var o=i.filter((function(t){return t.type===n}));o.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,c.g5)("Should only compare child_ events.");var i=new Ht(e.childName,e.snapshotNode),r=new Ht(n.childName,n.snapshotNode);return t.index_.compare(i,r)}(t,e,n)})),o.forEach((function(n){var i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,s);r.forEach((function(r){r.respondsTo(n.type)&&e.push(r.createEvent(i,t.query_))}))}))}var hn,un,cn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ln=(hn=0,un=[],function(t){var e,n=t===hn;hn=t;var i=new Array(8);for(e=7;e>=0;e--)i[e]=cn.charAt(t%64),t=Math.floor(t/64);(0,c.hu)(0===t,"Cannot push at time == 0");var r=i.join("");if(n){for(e=11;e>=0&&63===un[e];e--)un[e]=0;un[e]++}else for(e=0;e<12;e++)un[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)r+=cn.charAt(un[e]);return(0,c.hu)(20===r.length,"nextPushId: Length should be 20."),r}),fn=function(t){if("2147483647"===t)return"-";var e=z(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),i=0;i<n.length;i++)n[i]=t.charAt(i);if(n.length<786)return n.push("-"),n.join("");for(var r=n.length-1;r>=0&&"z"===n[r];)r--;if(-1===r)return M;var s=n[r],o=cn.charAt(cn.indexOf(s)+1);return n[r]=o,n.slice(0,r+1).join("")},dn=function(t){if("-2147483648"===t)return k;var e=z(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),i=0;i<n.length;i++)n[i]=t.charAt(i);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=cn.charAt(cn.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))},pn=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?D(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ht.MIN},e.prototype.maxPost=function(){return Ht.MAX},e.prototype.makePost=function(t,e){var n=he(t);return new Ht(e,n)},e.prototype.toString=function(){return".value"},e}(qt)),vn=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,c.hu)(!et(e)&&".priority"!==H(e),"Can't create PathIndex with empty path or .priority key"),n}return s(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),i=this.extractChild(e.node),r=n.compareTo(i);return 0===r?D(t.name,e.name):r},e.prototype.makePost=function(t,e){var n=he(t),i=oe.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ht(e,i)},e.prototype.maxPost=function(){var t=oe.EMPTY_NODE.updateChild(this.indexPath_,ae);return new Ht(M,t)},e.prototype.toString=function(){return J(this.indexPath_,0).join("/")},e}(qt),gn=function(){function t(e){this.indexedFilter_=new Ce(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,i,r,s){return this.matches(new Ht(e,n))||(n=oe.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,r,s)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=oe.EMPTY_NODE);var i=e.withIndex(this.index_);i=i.updatePriority(oe.EMPTY_NODE);var r=this;return e.forEachChild(Kt,(function(t,e){r.matches(new Ht(t,e))||(i=i.updateImmediateChild(t,oe.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),mn=function(){function t(t){this.rangedFilter_=new gn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,i,r,s){return this.rangedFilter_.matches(new Ht(e,n))||(n=oe.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,r,s):this.fullLimitUpdateChild_(t,e,n,r,s)},t.prototype.updateFullNode=function(t,e,n){var i;if(e.isLeafNode()||e.isEmpty())i=oe.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){i=oe.EMPTY_NODE.withIndex(this.index_);var r=void 0;r=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var s=0;r.hasNext()&&s<this.limit_;){var o=r.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;i=i.updateImmediateChild(o.name,o.node),s++}}else{i=(i=e.withIndex(this.index_)).updatePriority(oe.EMPTY_NODE);var a=void 0,h=void 0,u=void 0;if(r=void 0,this.reverse_){r=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),h=this.rangedFilter_.getStartPost();var c=this.index_.getCompare();u=function(t,e){return c(e,t)}}else r=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),h=this.rangedFilter_.getEndPost(),u=this.index_.getCompare();s=0;for(var l=!1;r.hasNext();)o=r.getNext(),!l&&u(a,o)<=0&&(l=!0),l&&s<this.limit_&&u(o,h)<=0?s++:i=i.updateImmediateChild(o.name,oe.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,i,r){var s;if(this.reverse_){var o=this.index_.getCompare();s=function(t,e){return o(e,t)}}else s=this.index_.getCompare();var a=t;(0,c.hu)(a.numChildren()===this.limit_,"");var h=new Ht(e,n),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(h);if(a.hasChild(e)){for(var f=a.getImmediateChild(e),d=i.getChildAfterChild(this.index_,u,this.reverse_);null!=d&&(d.name===e||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:s(d,h);if(l&&!n.isEmpty()&&p>=0)return null!=r&&r.trackChildChange(Se(e,n,f)),a.updateImmediateChild(e,n);null!=r&&r.trackChildChange(Ee(e,f));var v=a.updateImmediateChild(e,oe.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=r&&r.trackChildChange(Te(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:l&&s(u,h)>=0?(null!=r&&(r.trackChildChange(Ee(u.name,u.node)),r.trackChildChange(Te(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(u.name,oe.EMPTY_NODE)):t},t}(),yn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Kt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,c.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,c.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,c.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,c.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:M},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,c.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Kt},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function xn(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function bn(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function wn(t,e,n){var i=t.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function _n(t,e,n){var i;return t.index_===Zt?("string"==typeof e&&(e=fn(e)),i=wn(t,e,n)):i=wn(t,e,null==n?M:fn(n)),i.startAfterSet_=!0,i}function Tn(t,e,n){var i=t.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function En(t,e,n){var i;return t.index_===Zt?("string"==typeof e&&(e=dn(e)),i=Tn(t,e,n)):i=Tn(t,e,null==n?k:dn(n)),i.endBeforeSet_=!0,i}function Sn(t,e){var n=t.copy();return n.index_=e,n}function Cn(t){var e,n={};return t.isDefault()||(t.index_===Kt?e="$priority":t.index_===pn?e="$value":t.index_===Zt?e="$key":((0,c.hu)(t.index_ instanceof vn,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,c.Pz)(e),t.startSet_&&(n.startAt=(0,c.Pz)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,c.Pz)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,c.Pz)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,c.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}var An,In=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,i=this.query_.getQueryParams(),r=new Ce(i.getIndex()),s=(n=i).loadsAllData()?new Ce(n.getIndex()):n.hasLimit()?new mn(n):new gn(n);this.processor_=function(t){return{filter:t}}(s);var o=e.serverCache,a=e.eventCache,h=r.updateFullNode(oe.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(oe.EMPTY_NODE,a.getNode(),null),c=new ge(h,o.isFullyInitialized(),r.filtersNodes()),l=new ge(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=me(l,c),this.eventGenerator_=new on(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Pn(t,e){var n=we(t.viewCache_);return n&&(t.query.getQueryParams().loadsAllData()||!et(e)&&!n.getImmediateChild(H(e)).isEmpty())?n.getChild(e):null}function Rn(t){return 0===t.eventRegistrations_.length}function On(t,e,n){var i=[];if(n){(0,c.hu)(null==e,"A cancel should cancel all event registrations.");var r=t.query.path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,r);e&&i.push(e)}))}if(e){for(var s=[],o=0;o<t.eventRegistrations_.length;++o){var a=t.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(o+1));break}}else s.push(a)}t.eventRegistrations_=s}else t.eventRegistrations_=[];return i}function kn(t,e,n,i){e.type===se.MERGE&&null!==e.source.queryId&&((0,c.hu)(we(t.viewCache_),"We should always have a full cache before handling merges"),(0,c.hu)(be(t.viewCache_),"Missing event cache, even though we have a server cache"));var r,s,o=t.viewCache_,a=function(t,e,n,i,r){var s,o,a=new Ae;if(n.type===se.OVERWRITE){var h=n;h.source.fromUser?s=en(t,e,h.path,h.snap,i,r,a):((0,c.hu)(h.source.fromServer,"Unknown source."),o=h.source.tagged||e.serverCache.isFiltered()&&!et(h.path),s=tn(t,e,h.path,h.snap,i,r,o,a))}else if(n.type===se.MERGE){var u=n;u.source.fromUser?s=function(t,e,n,i,r,s,o){var a=e;return i.foreach((function(i,h){var u=tt(n,i);nn(e,H(u))&&(a=en(t,a,u,h,r,s,o))})),i.foreach((function(i,h){var u=tt(n,i);nn(e,H(u))||(a=en(t,a,u,h,r,s,o))})),a}(t,e,u.path,u.children,i,r,a):((0,c.hu)(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),s=sn(t,e,u.path,u.children,i,r,o,a))}else if(n.type===se.ACK_USER_WRITE){var l=n;s=l.revert?function(t,e,n,i,r,s){var o;if(null!=He(i,n))return e;var a=new Je(i,e,r),h=e.eventCache.getNode(),u=void 0;if(et(n)||".priority"===H(n)){var l=void 0;if(e.serverCache.isFullyInitialized())l=Ge(i,we(e));else{var f=e.serverCache.getNode();(0,c.hu)(f instanceof oe,"serverChildren would be complete if leaf node"),l=je(i,f)}l=l,u=t.filter.updateFullNode(h,l,s)}else{var d=H(n),p=qe(i,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=h.getImmediateChild(d)),(u=null!=p?t.filter.updateChild(h,d,p,K(n),a,s):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(h,d,oe.EMPTY_NODE,K(n),a,s):h).isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ge(i,we(e))).isLeafNode()&&(u=t.filter.updateFullNode(u,o,s))}return o=e.serverCache.isFullyInitialized()||null!=He(i,W()),ye(e,u,o,t.filter.filtersNodes())}(t,e,l.path,i,r,a):function(t,e,n,i,r,s,o){if(null!=He(r,n))return e;var a=e.serverCache.isFiltered(),h=e.serverCache;if(null!=i.value){if(et(n)&&h.isFullyInitialized()||h.isCompleteForPath(n))return tn(t,e,n,h.getNode().getChild(n),r,s,a,o);if(et(n)){var u=new fe(null);return h.getNode().forEachChild(Zt,(function(t,e){u=u.set(new j(t),e)})),sn(t,e,n,u,r,s,a,o)}return e}var c=new fe(null);return i.foreach((function(t,e){var i=tt(n,t);h.isCompleteForPath(i)&&(c=c.set(t,h.getNode().getChild(i)))})),sn(t,e,n,c,r,s,a,o)}(t,e,l.path,l.affectedTree,i,r,a)}else{if(n.type!==se.LISTEN_COMPLETE)throw(0,c.g5)("Unknown operation type: "+n.type);s=function(t,e,n,i,r){var s=e.serverCache;return $e(t,xe(e,s.getNode(),s.isFullyInitialized()||et(n),s.isFiltered()),n,i,Ze,r)}(t,e,n.path,i,a)}var f=a.getChanges();return function(t,e,n){var i=e.eventCache;if(i.isFullyInitialized()){var r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=be(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(_e(be(e)))}}(e,s,f),{viewCache:s,changes:f}}(t.processor_,o,e,n,i);return r=t.processor_,s=a.viewCache,(0,c.hu)(s.eventCache.getNode().isIndexed(r.filter.getIndex()),"Event snap not indexed"),(0,c.hu)(s.serverCache.getNode().isIndexed(r.filter.getIndex()),"Server snap not indexed"),(0,c.hu)(a.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=a.viewCache,Mn(t,a.changes,a.viewCache.eventCache.getNode(),null)}function Mn(t,e,n,i){var r=i?[i]:t.eventRegistrations_;return function(t,e,n,i){var r=[],s=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&s.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),an(t,r,"child_removed",e,i,n),an(t,r,"child_added",e,i,n),an(t,r,"child_moved",s,i,n),an(t,r,"child_changed",e,i,n),an(t,r,"value",e,i,n),r}(t.eventGenerator_,e,n,r)}var Dn=function(){this.views=new Map};function Ln(t,e,n,i){var r,s,o=e.source.queryId;if(null!==o){var h=t.views.get(o);return(0,c.hu)(null!=h,"SyncTree gave us an op for an invalid query."),kn(h,e,n,i)}var u=[];try{for(var l=a(t.views.values()),f=l.next();!f.done;f=l.next())h=f.value,u=u.concat(kn(h,e,n,i))}catch(t){r={error:t}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(r)throw r.error}}return u}function Nn(t,e,n,i,r){var s=e.queryIdentifier(),o=t.views.get(s);if(!o){var a=Ge(n,r?i:null),h=!1;a?h=!0:i instanceof oe?(a=je(n,i),h=!1):(a=oe.EMPTY_NODE,h=!1);var u=me(new ge(a,h,!1),new ge(i,r,!1));return new In(e,u)}return o}function Fn(t){var e,n,i=[];try{for(var r=a(t.views.values()),s=r.next();!s.done;s=r.next()){var o=s.value;o.query.getQueryParams().loadsAllData()||i.push(o)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Bn(t,e){var n,i,r=null;try{for(var s=a(t.views.values()),o=s.next();!o.done;o=s.next()){var h=o.value;r=r||Pn(h,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return r}function Un(t,e){if(e.getQueryParams().loadsAllData())return zn(t);var n=e.queryIdentifier();return t.views.get(n)}function Vn(t,e){return null!=Un(t,e)}function Yn(t){return null!=zn(t)}function zn(t){var e,n;try{for(var i=a(t.views.values()),r=i.next();!r.done;r=i.next()){var s=r.value;if(s.query.getQueryParams().loadsAllData())return s}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null}var Xn=1,Gn=function(t){this.listenProvider_=t,this.syncPointTree_=new fe(null),this.pendingWriteTree_={visibleWrites:Ie.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function jn(t,e,n,i,r){return function(t,e,n,i,r){(0,c.hu)(i>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Pe(t.visibleWrites,e,n)),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i,r),r?Zn(t,new pe({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Wn(t,e,n){void 0===n&&(n=!1);var i=function(t,e){for(var n=0;n<t.allWrites.length;n++){var i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,c.hu)(n>=0,"removeWrite called with nonexistent writeId.");var i=t.allWrites[n];t.allWrites.splice(n,1);for(var r=i.visible,s=!1,o=t.allWrites.length-1;r&&o>=0;){var a=t.allWrites[o];a.visible&&(o>=n&&Ve(a,i.path)?r=!1:st(i.path,a.path)&&(s=!0)),o--}return!!r&&(s?(function(t){t.visibleWrites=ze(t.allWrites,Ye,W()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(i.snap?t.visibleWrites=Oe(t.visibleWrites,i.path):U(i.children,(function(e){t.visibleWrites=Oe(t.visibleWrites,tt(i.path,e))})),!0))}(t.pendingWriteTree_,e)){var r=new fe(null);return null!=i.snap?r=r.set(W(),!0):U(i.children,(function(t){r=r.set(new j(t),!0)})),Zn(t,new le(i.path,r,n))}return[]}function Hn(t,e,n){return Zn(t,new pe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function qn(t,e,n,i){var r=e.path,s=t.syncPointTree_.get(r),o=[];if(s&&("default"===e.queryIdentifier()||Vn(s,e))){var u=function(t,e,n,i){var r,s,o=e.queryIdentifier(),u=[],l=[],f=Yn(t);if("default"===o)try{for(var d=a(t.views.entries()),p=d.next();!p.done;p=d.next()){var v=h(p.value,2),g=v[0],m=v[1];l=l.concat(On(m,n,i)),Rn(m)&&(t.views.delete(g),m.query.getQueryParams().loadsAllData()||u.push(m.query))}}catch(t){r={error:t}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(r)throw r.error}}else(m=t.views.get(o))&&(l=l.concat(On(m,n,i)),Rn(m)&&(t.views.delete(o),m.query.getQueryParams().loadsAllData()||u.push(m.query)));return f&&!Yn(t)&&u.push(new((0,c.hu)(An,"Reference.ts has not been loaded"),An)(e.repo,e.path)),{removed:u,events:l}}(s,e,n,i);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(r));var l=u.removed;o=u.events;var f=-1!==l.findIndex((function(t){return t.getQueryParams().loadsAllData()})),d=t.syncPointTree_.findOnPath(r,(function(t,e){return Yn(e)}));if(f&&!d){var p=t.syncPointTree_.subtree(r);if(!p.isEmpty())for(var v=function(t){return t.fold((function(t,e,n){if(e&&Yn(e))return[zn(e)];var i=[];return e&&(i=Fn(e)),U(n,(function(t,e){i=i.concat(e)})),i}))}(p),g=0;g<v.length;++g){var m=v[g],y=m.query,x=ti(t,m);t.listenProvider_.startListening(oi(y),ei(t,y),x.hashFn,x.onComplete)}}!d&&l.length>0&&!i&&(f?t.listenProvider_.stopListening(oi(e),null):l.forEach((function(e){var n=t.queryToTagMap.get(ni(e));t.listenProvider_.stopListening(oi(e),n)}))),function(t,e){for(var n=0;n<e.length;++n){var i=e[n];if(!i.getQueryParams().loadsAllData()){var r=ni(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}(t,l)}return o}function Kn(t,e,n){var i=e.path,r=null,s=!1;t.syncPointTree_.foreachOnPath(i,(function(t,e){var n=nt(t,i);r=r||Bn(e,n),s=s||Yn(e)}));var o,a=t.syncPointTree_.get(i);a?(s=s||Yn(a),r=r||Bn(a,W())):(a=new Dn,t.syncPointTree_=t.syncPointTree_.set(i,a)),null!=r?o=!0:(o=!1,r=oe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((function(t,e){var n=Bn(e,W());n&&(r=r.updateImmediateChild(t,n))})));var h=Vn(a,e);if(!h&&!e.getQueryParams().loadsAllData()){var u=ni(e);(0,c.hu)(!t.queryToTagMap.has(u),"View does not exist, but we have a tag");var l=Xn++;t.queryToTagMap.set(u,l),t.tagToQueryMap.set(l,u)}var f=function(t,e,n,i,r,s){var o=Nn(t,e,i,r,s);return t.views.has(e.queryIdentifier())||t.views.set(e.queryIdentifier(),o),function(t,e){t.eventRegistrations_.push(e)}(o,n),function(t,e){var n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Kt,(function(t,e){i.push(Te(t,e))})),n.isFullyInitialized()&&i.push(_e(n.getNode())),Mn(t,i,n.getNode(),e)}(o,n)}(a,e,n,Ue(t.pendingWriteTree_,i),r,o);if(!h&&!s){var d=Un(a,e);f=f.concat(function(t,e,n){var i=e.path,r=ei(t,e),s=ti(t,n),o=t.listenProvider_.startListening(oi(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)(0,c.hu)(!Yn(a.value),"If we're adding a query, it shouldn't be shadowed");else for(var h=a.fold((function(t,e,n){if(!et(t)&&e&&Yn(e))return[zn(e).query];var i=[];return e&&(i=i.concat(Fn(e).map((function(t){return t.query})))),U(n,(function(t,e){i=i.concat(e)})),i})),u=0;u<h.length;++u){var l=h[u];t.listenProvider_.stopListening(oi(l),ei(t,l))}return o}(t,e,d))}return f}function Qn(t,e,n){var i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(function(t,n){var i=Bn(n,nt(t,e));if(i)return i}));return Xe(i,e,r,n,!0)}function Zn(t,e){return Jn(e,t.syncPointTree_,null,Ue(t.pendingWriteTree_,W()))}function Jn(t,e,n,i){if(et(t.path))return $n(t,e,n,i);var r=e.get(W());null==n&&null!=r&&(n=Bn(r,W()));var s=[],o=H(t.path),a=t.operationForChild(o),h=e.children.get(o);if(h&&a){var u=n?n.getImmediateChild(o):null,c=Ke(i,o);s=s.concat(Jn(a,h,u,c))}return r&&(s=s.concat(Ln(r,t,i,n))),s}function $n(t,e,n,i){var r=e.get(W());null==n&&null!=r&&(n=Bn(r,W()));var s=[];return e.children.inorderTraversal((function(e,r){var o=n?n.getImmediateChild(e):null,a=Ke(i,e),h=t.operationForChild(e);h&&(s=s.concat($n(h,r,o,a)))})),r&&(s=s.concat(Ln(r,t,i,n))),s}function ti(t,e){var n=e.query,i=ei(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||oe.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return i?function(t,e,n){var i=ii(t,n);if(i){var r=ri(i),s=r.path,o=r.queryId,a=nt(s,e);return si(t,s,new de(ue(o),a))}return[]}(t,n.path,i):function(t,e){return Zn(t,new de({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n.path);var r=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var i=new Error(t+" at "+e.path.toString()+": "+n);return i.code=t.toUpperCase(),i}(e,n);return qn(t,n,null,r)}}}function ei(t,e){var n=ni(e);return t.queryToTagMap.get(n)}function ni(t){return t.path.toString()+"$"+t.queryIdentifier()}function ii(t,e){return t.tagToQueryMap.get(e)}function ri(t){var e=t.indexOf("$");return(0,c.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new j(t.substr(0,e))}}function si(t,e,n){var i=t.syncPointTree_.get(e);return(0,c.hu)(i,"Missing sync point for query tag that we're tracking"),Ln(i,n,Ue(t.pendingWriteTree_,e),null)}function oi(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t}var ai=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),hi=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=tt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return Qn(this.syncTree_,this.path_)},t}(),ui=function(t,e,n){return t&&"object"==typeof t?((0,c.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?ci(t[".sv"],e,n):"object"==typeof t[".sv"]?li(t[".sv"],e):void(0,c.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},ci=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,c.hu)(!1,"Unexpected server value: "+t)}},li=function(t,e,n){t.hasOwnProperty("increment")||(0,c.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var i=t.increment;"number"!=typeof i&&(0,c.hu)(!1,"Unexpected increment value: "+i);var r=e.node();if((0,c.hu)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;var s=r.getValue();return"number"!=typeof s?i:s+i},fi=function(t,e,n,i){return pi(e,new hi(n,t),i)},di=function(t,e,n){return pi(t,new ai(e),n)};function pi(t,e,n){var i,r=t.getPriority().val(),s=ui(r,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var o=t,a=ui(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new zt(a,he(s)):t}var h=t;return i=h,s!==h.getPriority().val()&&(i=i.updatePriority(new zt(s))),h.forEachChild(Kt,(function(t,r){var s=pi(r,e.getImmediateChild(t),n);s!==r&&(i=i.updateImmediateChild(t,s))})),i}function vi(){return{value:null,children:new Map}}function gi(t,e,n){if(et(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var i=H(e);t.children.has(i)||t.children.set(i,vi()),gi(t.children.get(i),e=K(e),n)}}function mi(t,e){if(et(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Kt,(function(e,n){gi(t,new j(e),n)})),mi(t,e)}if(t.children.size>0){var i=H(e);return e=K(e),t.children.has(i)&&mi(t.children.get(i),e)&&t.children.delete(i),0===t.children.size}return!0}function yi(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,i){yi(i,new j(e.toString()+"/"+t),n)}))}var xi=function(){function t(){this.rootNode_=oe.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),bi=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,c.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,c.p$)(this.counters_)},t}(),wi={},_i={};function Ti(t){var e=t.toString();return wi[e]||(wi[e]=new bi),wi[e]}var Ei=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=o({},t);return this.last_&&U(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Si=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ei(t);var n=1e4+2e4*Math.random();G(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},i=!1;U(e,(function(e,r){r>0&&(0,c.r3)(t.statsToReport_,e)&&(n[e]=r,i=!0)})),i&&this.server_.reportStats(n),G(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ci=function(){this.eventLists_=[],this.recursionDepth_=0};function Ai(t,e){for(var n=null,i=0;i<e.length;i++){var r=e[i],s=r.getPath();null===n||rt(s,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Ii(t,e,n){Ai(t,n),Ri(t,(function(t){return rt(t,e)}))}function Pi(t,e,n){Ai(t,n),Ri(t,(function(t){return st(t,e)||st(e,t)}))}function Ri(t,e){t.recursionDepth_++;for(var n=!0,i=0;i<t.eventLists_.length;i++){var r=t.eventLists_[i];r&&(e(r.path)?(Oi(t.eventLists_[i]),t.eventLists_[i]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Oi(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var i=n.getEventRunner();T&&C("event: "+n.toString()),X(i)}}}var ki=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,c.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var i=u([],h(this.listeners_[t])),r=0;r<i.length;r++)i[r].callback.apply(i[r].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var i=this.getInitialEvent(t);i&&e.apply(n,i)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var i=this.listeners_[t]||[],r=0;r<i.length;r++)if(i[r].callback===e&&(!n||n===i[r].context))return void i.splice(r,1)},t.prototype.validateEventType_=function(t){(0,c.hu)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Mi=function(t){function e(){var e,n,i=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),i.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==i.visible_&&(i.visible_=t,i.trigger("visible",t))}),!1),i}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,c.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ki),Di=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,c.uI)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,c.hu)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ki),Li=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var i=function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=function(e){t[e]&&X((function(){n.onMessage_(t[e])}))},i=0;i<t.length;++i)e(i);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++},r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==i(););},t}(),Ni="start",Fi="close",Bi=function(){function t(t,e,n,i,r){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=i,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=A(t),this.stats_=Ti(e),this.urlFn=function(t){return dt(e,lt,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Li(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,c.Yr)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Ui((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=h(t,5),r=i[0],s=i[1],o=i[2];if(i[3],i[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===Ni)n.id=s,n.password=o;else{if(r!==Fi)throw new Error("Unrecognized command received: "+r);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=h(t,2),r=i[0],s=i[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,s)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.hostname&&ut.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,c.Yr)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,c.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,c.h$)(e),i=B(n,1840),r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,c.Yr)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,c.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Ui=function(){function t(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,c.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=b(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(s='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(t){C("frame writing exception"),t.stack&&C(t.stack),C(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||C("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var r=this.pendingSegs.shift();n=n+"&seg"+i+"="+r.seg+"&ts"+i+"="+r.ts+"&d"+i+"="+r.d,i++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var i=function(){n.outstandingRequests.delete(e),n.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(r),i()}))},t.prototype.addTag=function(t,e){var n=this;(0,c.Yr)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=function(){C("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(t){}}),Math.floor(1))},t}(),Vi="";function Yi(t){Vi=t}var zi=null;"undefined"!=typeof MozWebSocket?zi=MozWebSocket:"undefined"!=typeof WebSocket&&(zi=WebSocket);var Xi=function(){function t(e,n,i,r,s){this.connId=e,this.applicationId=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=A(this.connId),this.stats_=Ti(n),this.connURL=t.connectionURL_(n,r,s),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var i={v:"5"};return!(0,c.Yr)()&&"undefined"!=typeof location&&location.hostname&&ut.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),dt(t,ct,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,m.set("previous_websocket_failure",!0);try{if((0,c.Yr)()){var i=this.nodeAdmin?"AdminNode":"Node",r={headers:{"User-Agent":"Firebase/5/"+Vi+"/"+process.platform+"/"+i,"X-Firebase-GMPID":this.applicationId||""}},s=process.env,o=0===this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;o&&(r.proxy={origin:o}),this.mySock=new zi(this.connURL,[],r)}else r={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new zi(this.connURL,[],r)}catch(t){this.log_("Error instantiating WebSocket.");var a=t.message||t.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==zi&&!t.forceDisallow_},t.previouslyFailed=function(){return m.isInMemoryStorage||!0===m.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){m.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,c.cI)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,c.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,c.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=B(e,16384);n.length>1&&this.sendString_(String(n.length));for(var i=0;i<n.length;i++)this.sendString_(n[i])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Gi=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Bi,Xi]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,i,r=Xi&&Xi.isAvailable(),s=r&&!Xi.previouslyFailed();if(e.webSocketOnly&&(r||R("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Xi];else{var o=this.transports_=[];try{for(var h=a(t.ALL_TRANSPORTS),u=h.next();!u.done;u=h.next()){var c=u.value;c&&c.isAvailable()&&o.push(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),ji=function(){function t(t,e,n,i,r,s,o,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=i,this.onReady_=r,this.onDisconnect_=s,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=A("c:"+this.id+":"),this.transportManager_=new Gi(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,i)}),Math.floor(0));var r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=G((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(r)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=N("t",t),n=N("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=N("t",t),n=N("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=N("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?I("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):I("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&R("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),G((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):G((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(m.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Wi=function(){function t(){}return t.prototype.put=function(t,e,n,i){},t.prototype.merge=function(t,e,n,i){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),Hi=1e3,qi=function(t){function e(n,i,r,s,o,a,h){var u=t.call(this)||this;if(u.repoInfo_=n,u.applicationId_=i,u.onDataUpdate_=r,u.onConnectStatus_=s,u.onServerInfoUpdate_=o,u.authTokenProvider_=a,u.authOverride_=h,u.id=e.nextPersistentConnectionId_++,u.log_=A("p:"+u.id+":"),u.interruptReasons_={},u.listens=new Map,u.outstandingPuts_=[],u.outstandingGets_=[],u.outstandingPutCount_=0,u.outstandingGetCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=Hi,u.maxReconnectDelay_=3e5,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,h&&!(0,c.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),Mi.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&Di.getInstance().on("online",u.onOnline_,u),u}return s(e,t),e.prototype.sendRequest=function(t,e,n){var i=++this.requestNumber_,r={r:i,a:t,b:e};this.log_((0,c.Pz)(r)),(0,c.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)},e.prototype.get=function(t){var e=this,n=new c.BH,i={p:t.path.toString(),q:t.queryObject()},r={action:"g",request:i,onComplete:function(t){var r=t.d;"ok"===t.s?(e.onDataUpdate_(i.p,r,!1,null),n.resolve(r)):n.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;var s=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[s];void 0!==t&&r===t&&(delete e.outstandingGets_[s],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(s),n.promise},e.prototype.listen=function(t,e,n,i){var r=t.queryIdentifier(),s=t.path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),(0,c.hu)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),(0,c.hu)(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");var o={onComplete:i,hashFn:e,query:t,tag:n};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(i){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(i)}))},e.prototype.sendListen_=function(t){var n=this,i=t.query,r=i.path.toString(),s=i.queryIdentifier();this.log_("Listen on "+r+" for "+s);var o={p:r};t.tag&&(o.q=i.queryObject(),o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,(function(o){var a=o.d,h=o.s;e.warnOnListenWarnings_(a,i),(n.listens.get(r)&&n.listens.get(r).get(s))===t&&(n.log_("listen response",o),"ok"!==h&&n.removeListen_(r,s),t.onComplete&&t.onComplete(h,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,c.r3)(t,"w")){var n=(0,c.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var i='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',r=e.path.toString();R("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+i+" at "+r+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,c.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,c.w9)(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(n,i,(function(n){var i=n.s,r=n.d||"error";t.authToken_===e&&("ok"===i?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(i,r))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),i=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+i),(0,c.hu)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);var r={p:t};i&&(r.q=n,r.t=i),this.sendRequest("n",r)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,i){var r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,(function(t){i&&setTimeout((function(){i(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,i){this.putInternal("p",t,e,n,i)},e.prototype.merge=function(t,e,n,i){this.putInternal("m",t,e,n,i)},e.prototype.putInternal=function(t,e,n,i,r){var s={p:e,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:t,request:s,onComplete:i}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,(function(i){e.log_(n+" response",i),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),r&&r(i.s,i.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,c.Pz)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):I("Unrecognized action received from server: "+(0,c.Pz)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,c.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Hi,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Hi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Hi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,h=!1,u=null,l=function(){u?u.close():(h=!0,r())};this.realtime_={close:l,sendRequest:function(t){(0,c.hu)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(t){h?C("getToken() completed but was canceled"):(C("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,u=new ji(s,o.repoInfo_,o.applicationId_,n,i,r,(function(t){R(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")}),a))})).then(null,(function(e){o.log_("Failed to get token: "+e),h||(t.repoInfo_.nodeAdmin&&R(e),l())}))}},e.prototype.interrupt=function(t){C("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){C("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,c.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Hi,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return F(t)})).join("$"):"default";var i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,i=new j(t).toString();if(this.listens.has(i)){var r=this.listens.get(i);n=r.get(e),r.delete(e),0===r.size&&this.listens.delete(i)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){C("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,i;this.tryAuth();try{for(var r=a(this.listens.values()),s=r.next();!s.done;s=r.next()){var o=s.value;try{for(var h=(n=void 0,a(o.values())),u=h.next();!u.done;u=h.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,c.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+Vi.replace(/\./g,"-")]=1,(0,c.uI)()?t["framework.cordova"]=1:(0,c.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Di.getInstance().currentlyOnline();return(0,c.xb)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Wi),Ki=function(t){function e(e,n,i){var r=t.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=n,r.authTokenProvider_=i,r.log_=A("p:rest:"),r.listens_={},r}return s(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,c.hu)(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,i,r){var s=this,o=t.path.toString();this.log_("Listen called for "+o+" "+t.queryIdentifier());var a=e.getListenId_(t,i),h={};this.listens_[a]=h;var u=Cn(t.getQueryParams());this.restRequest_(o+".json",u,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&s.onDataUpdate_(o,n,!1,i),(0,c.DV)(s.listens_,a)===h&&r(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var i=e.getListenId_(t,n);delete this.listens_[i]},e.prototype.get=function(t){var e=this,n=Cn(t.getQueryParams()),i=t.path.toString(),r=new c.BH;return this.restRequest_(i+".json",n,(function(t,n){var s=n;404===t&&(s=null,t=null),null===t?(e.onDataUpdate_(i,s,!1,null),r.resolve(s)):r.reject(new Error(s))})),r.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var i=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(r){var s=r&&r.accessToken;s&&(e.auth=s);var o=(i.repoInfo_.secure?"https://":"http://")+i.repoInfo_.host+t+"?ns="+i.repoInfo_.namespace+(0,c.xO)(e);i.log_("Sending REST request for "+o);var a=new XMLHttpRequest;a.onreadystatechange=function(){if(n&&4===a.readyState){i.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);var t=null;if(a.status>=200&&a.status<300){try{t=(0,c.cI)(a.responseText)}catch(t){R("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&R("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()}))},e}(Wi),Qi=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return(0,c.Dv)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return(0,c.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return(0,c.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return(0,c.Dv)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){(0,c.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Lt("DataSnapshot.child",1,e,!1);var n=new j(e),i=this.ref_.child(n);return new t(this.node_.getChild(n),i,Kt)},t.prototype.hasChild=function(t){(0,c.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Lt("DataSnapshot.hasChild",1,t,!1);var e=new j(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return(0,c.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if((0,c.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,c.Wj)("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var i=this.node_;return!!i.forEachChild(this.index_,(function(i,r){return e(new t(r,n.ref_.child(i),Kt))}))},t.prototype.hasChildren=function(){return(0,c.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,c.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return(0,c.Dv)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Zi=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function Ji(t,e){for(var n=e instanceof j?e:new j(e),i=t,r=H(n);null!==r;){var s=(0,c.DV)(i.node.children,r)||{children:{},childCount:0};i=new Zi(r,i,s),r=H(n=K(n))}return i}function $i(t){return t.node.value}function tr(t,e){t.node.value=e,sr(t)}function er(t){return t.node.childCount>0}function nr(t,e){U(t.node.children,(function(n,i){e(new Zi(n,t,i))}))}function ir(t,e,n,i){n&&!i&&e(t),nr(t,(function(t){ir(t,e,!0,i)})),n&&i&&e(t)}function rr(t){return new j(null===t.parent?t.name:rr(t.parent)+"/"+t.name)}function sr(t){null!==t.parent&&function(t,e,n){var i=function(t){return void 0===$i(t)&&!er(t)}(n),r=(0,c.r3)(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,sr(t)):i||r||(t.node.children[e]=n.node,t.node.childCount++,sr(t))}(t.parent,t.name,t)}var or="repo_interrupt",ar=function(){function t(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ci,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vi(),this.transactionQueueTree_=new Zi,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function hr(t){var e=t.infoData_.getNode(new j(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function ur(t){return(e=(e={timestamp:hr(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function cr(t,e,n,i,r){t.dataUpdateCount++;var s=new j(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var o=[];if(r)if(i){var a=(0,c.UI)(n,(function(t){return he(t)}));o=function(t,e,n,i){var r=ii(t,i);if(r){var s=ri(r),o=s.path,a=s.queryId,h=nt(o,e),u=fe.fromObject(n);return si(t,o,new ve(ue(a),h,u))}return[]}(t.serverSyncTree_,s,a,r)}else{var h=he(n);o=function(t,e,n,i){var r=ii(t,i);if(null!=r){var s=ri(r),o=s.path,a=s.queryId,h=nt(o,e);return si(t,o,new pe(ue(a),h,n))}return[]}(t.serverSyncTree_,s,h,r)}else if(i){var u=(0,c.UI)(n,(function(t){return he(t)}));o=function(t,e,n){var i=fe.fromObject(n);return Zn(t,new ve({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,s,u)}else{var l=he(n);o=Hn(t.serverSyncTree_,s,l)}var f=s;o.length>0&&(f=Rr(t,s)),Pi(t.eventQueue_,f,o)}function lr(t,e){fr(t,"connected",e),!1===e&&function(t){Er(t,"onDisconnectEvents");var e=ur(t),n=vi();yi(t.onDisconnect_,W(),(function(i,r){var s=fi(i,r,t.serverSyncTree_,e);gi(n,i,s)}));var i=[];yi(n,W(),(function(e,n){i=i.concat(Hn(t.serverSyncTree_,e,n));var r=Lr(t,e);Rr(t,r)})),t.onDisconnect_=vi(),Pi(t.eventQueue_,W(),i)}(t)}function fr(t,e,n){var i=new j("/.info/"+e),r=he(n);t.infoData_.updateSnapshot(i,r);var s=Hn(t.infoSyncTree_,i,r);Pi(t.eventQueue_,i,s)}function dr(t){return t.nextWriteId_++}function pr(t,e,n,i,r){Er(t,"set",{path:e.toString(),value:n,priority:i});var s=ur(t),o=he(n,i),a=Qn(t.serverSyncTree_,e),h=di(o,a,s),u=dr(t),c=jn(t.serverSyncTree_,e,h,u,!0);Ai(t.eventQueue_,c),t.server_.put(e.toString(),o.val(!0),(function(n,i){var s="ok"===n;s||R("set at "+e+" failed: "+n);var o=Wn(t.serverSyncTree_,u,!s);Pi(t.eventQueue_,e,o),Sr(0,r,n,i)}));var l=Lr(t,e);Rr(t,l),Pi(t.eventQueue_,l,[])}function vr(t,e,n,i){Er(t,"update",{path:e.toString(),value:n});var r=!0,s=ur(t),o={};if(U(n,(function(n,i){r=!1,o[n]=fi(tt(e,n),he(i),t.serverSyncTree_,s)})),r)C("update() called with empty data.  Don't do anything."),Sr(0,i,"ok",void 0);else{var a=dr(t),h=function(t,e,n,i){!function(t,e,n,i){(0,c.hu)(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Re(t.visibleWrites,e,n),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i);var r=fe.fromObject(n);return Zn(t,new ve({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,e,o,a);Ai(t.eventQueue_,h),t.server_.merge(e.toString(),n,(function(n,r){var s="ok"===n;s||R("update at "+e+" failed: "+n);var o=Wn(t.serverSyncTree_,a,!s),h=o.length>0?Rr(t,e):e;Pi(t.eventQueue_,h,o),Sr(0,i,n,r)})),U(n,(function(n){var i=Lr(t,tt(e,n));Rr(t,i)})),Pi(t.eventQueue_,e,[])}}function gr(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(i,r){"ok"===i&&mi(t.onDisconnect_,e),Sr(0,n,i,r)}))}function mr(t,e,n,i){var r=he(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(function(n,s){"ok"===n&&gi(t.onDisconnect_,e,r),Sr(0,i,n,s)}))}function yr(t,e,n,i,r){var s=he(n,i);t.server_.onDisconnectPut(e.toString(),s.val(!0),(function(n,i){"ok"===n&&gi(t.onDisconnect_,e,s),Sr(0,r,n,i)}))}function xr(t,e,n,i){if((0,c.xb)(n))return C("onDisconnect().update() called with empty data.  Don't do anything."),void Sr(0,i,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(r,s){"ok"===r&&U(n,(function(n,i){var r=he(i);gi(t.onDisconnect_,tt(e,n),r)})),Sr(0,i,r,s)}))}function br(t,e,n){var i;i=".info"===H(e.path)?Kn(t.infoSyncTree_,e,n):Kn(t.serverSyncTree_,e,n),Ii(t.eventQueue_,e.path,i)}function wr(t,e,n){var i;i=".info"===H(e.path)?qn(t.infoSyncTree_,e,n):qn(t.serverSyncTree_,e,n),Ii(t.eventQueue_,e.path,i)}function _r(t){t.persistentConnection_&&t.persistentConnection_.interrupt(or)}function Tr(t){t.persistentConnection_&&t.persistentConnection_.resume(or)}function Er(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i="";t.persistentConnection_&&(i=t.persistentConnection_.id+":"),C.apply(void 0,u([i],h(e)))}function Sr(t,e,n,i){e&&X((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),r=t;i&&(r+=": "+i);var s=new Error(r);s.code=t,e(s)}}))}function Cr(t){return t.__database||(t.__database=new Zr(t))}function Ar(t,e,n,i,r){Er(t,"transaction on "+e);var s=function(){},o=new jr(t,e);o.on("value",s);var a={path:e,update:n,onComplete:i,status:null,order:b(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",s)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Ir(t,e,void 0);a.currentInputSnapshot=h;var u=a.update(h.val());if(void 0===u){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new Qi(a.currentInputSnapshot,new jr(t,a.path),Kt);a.onComplete(null,!1,l)}}else{Rt("transaction failed: Data returned ",u,a.path),a.status=0;var f=Ji(t.transactionQueueTree_,e),d=$i(f)||[];d.push(a),tr(f,d);var p=void 0;"object"==typeof u&&null!==u&&(0,c.r3)(u,".priority")?(p=(0,c.DV)(u,".priority"),(0,c.hu)(It(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(Qn(t.serverSyncTree_,e)||oe.EMPTY_NODE).getPriority().val();var v=ur(t),g=he(u,p),m=di(g,h,v);a.currentOutputSnapshotRaw=g,a.currentOutputSnapshotResolved=m,a.currentWriteId=dr(t);var y=jn(t.serverSyncTree_,e,m,a.currentWriteId,a.applyLocally);Pi(t.eventQueue_,e,y),Pr(t,t.transactionQueueTree_)}}function Ir(t,e,n){return Qn(t.serverSyncTree_,e,n)||oe.EMPTY_NODE}function Pr(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||Dr(t,e),$i(e)){var n=kr(t,e);(0,c.hu)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var i=n.map((function(t){return t.currentWriteId})),r=Ir(t,e,i),s=r,o=r.hash(),a=0;a<n.length;a++){var h=n[a];(0,c.hu)(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;var u=nt(e,h.path);s=s.updateChild(u,h.currentOutputSnapshotRaw)}var l=s.val(!0),f=e;t.server_.put(f.toString(),l,(function(i){Er(t,"transaction put response",{path:f.toString(),status:i});var r=[];if("ok"===i){for(var s=[],o=0;o<n.length;o++){if(n[o].status=2,r=r.concat(Wn(t.serverSyncTree_,n[o].currentWriteId)),n[o].onComplete){var a=n[o].currentOutputSnapshotResolved,h=new jr(t,n[o].path),u=new Qi(a,h,Kt);s.push(n[o].onComplete.bind(null,null,!0,u))}n[o].unwatcher()}for(Dr(t,Ji(t.transactionQueueTree_,e)),Pr(t,t.transactionQueueTree_),Pi(t.eventQueue_,e,r),o=0;o<s.length;o++)X(s[o])}else{if("datastale"===i)for(o=0;o<n.length;o++)3===n[o].status?n[o].status=4:n[o].status=0;else for(R("transaction at "+f.toString()+" failed: "+i),o=0;o<n.length;o++)n[o].status=4,n[o].abortReason=i;Rr(t,e)}}),o)}(t,rr(e),n)}else er(e)&&nr(e,(function(e){Pr(t,e)}))}function Rr(t,e){var n=Or(t,e),i=rr(n);return function(t,e,n){if(0!==e.length){for(var i=[],r=[],s=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),o=0;o<e.length;o++){var a=e[o],h=nt(n,a.path),u=!1,l=void 0;if((0,c.hu)(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)u=!0,l=a.abortReason,r=r.concat(Wn(t.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status)if(a.retryCount>=25)u=!0,l="maxretry",r=r.concat(Wn(t.serverSyncTree_,a.currentWriteId,!0));else{var f=Ir(t,a.path,s);a.currentInputSnapshot=f;var d=e[o].update(f.val());if(void 0!==d){Rt("transaction failed: Data returned ",d,a.path);var p=he(d);"object"==typeof d&&null!=d&&(0,c.r3)(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=a.currentWriteId,g=ur(t),m=di(p,f,g);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=m,a.currentWriteId=dr(t),s.splice(s.indexOf(v),1),r=(r=r.concat(jn(t.serverSyncTree_,a.path,m,a.currentWriteId,a.applyLocally))).concat(Wn(t.serverSyncTree_,v,!0))}else u=!0,l="nodata",r=r.concat(Wn(t.serverSyncTree_,a.currentWriteId,!0))}if(Pi(t.eventQueue_,n,r),r=[],u&&(e[o].status=2,w=e[o].unwatcher,setTimeout(w,Math.floor(0)),e[o].onComplete))if("nodata"===l){var y=new jr(t,e[o].path),x=e[o].currentInputSnapshot,b=new Qi(x,y,Kt);i.push(e[o].onComplete.bind(null,null,!1,b))}else i.push(e[o].onComplete.bind(null,new Error(l),!1,null))}var w;for(Dr(t,t.transactionQueueTree_),o=0;o<i.length;o++)X(i[o]);Pr(t,t.transactionQueueTree_)}}(t,kr(t,n),i),i}function Or(t,e){var n,i=t.transactionQueueTree_;for(n=H(e);null!==n&&void 0===$i(i);)i=Ji(i,n),n=H(e=K(e));return i}function kr(t,e){var n=[];return Mr(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function Mr(t,e,n){var i=$i(e);if(i)for(var r=0;r<i.length;r++)n.push(i[r]);nr(e,(function(e){Mr(t,e,n)}))}function Dr(t,e){var n=$i(e);if(n){for(var i=0,r=0;r<n.length;r++)2!==n[r].status&&(n[i]=n[r],i++);n.length=i,tr(e,n.length>0?n:void 0)}nr(e,(function(e){Dr(t,e)}))}function Lr(t,e){var n=rr(Or(t,e)),i=Ji(t.transactionQueueTree_,e);return function(t,e,n){for(var i=t.parent;null!==i;){if(e(i))return!0;i=i.parent}}(i,(function(e){Nr(t,e)})),Nr(t,i),ir(i,(function(e){Nr(t,e)})),n}function Nr(t,e){var n=$i(e);if(n){for(var i=[],r=[],s=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?((0,c.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):((0,c.hu)(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Wn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===s?tr(e,void 0):n.length=s+1,Pi(t.eventQueue_,rr(e),r),o=0;o<i.length;o++)X(i[o])}}var Fr,Br=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){(0,c.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,c.Wj)("OnDisconnect.cancel",1,t,!0);var e=new c.BH;return gr(this.repo_,this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){(0,c.Dv)("OnDisconnect.remove",0,1,arguments.length),Ft("OnDisconnect.remove",this.path_),(0,c.Wj)("OnDisconnect.remove",1,t,!0);var e=new c.BH;return mr(this.repo_,this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){(0,c.Dv)("OnDisconnect.set",1,2,arguments.length),Ft("OnDisconnect.set",this.path_),Pt("OnDisconnect.set",1,t,this.path_,!1),(0,c.Wj)("OnDisconnect.set",2,e,!0);var n=new c.BH;return mr(this.repo_,this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){(0,c.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),Ft("OnDisconnect.setWithPriority",this.path_),Pt("OnDisconnect.setWithPriority",1,t,this.path_,!1),kt("OnDisconnect.setWithPriority",2,e,!1),(0,c.Wj)("OnDisconnect.setWithPriority",3,n,!0);var i=new c.BH;return yr(this.repo_,this.path_,t,e,i.wrapCallback(n)),i.promise},t.prototype.update=function(t,e){if((0,c.Dv)("OnDisconnect.update",1,2,arguments.length),Ft("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,R("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ot("OnDisconnect.update",1,t,this.path_,!1),(0,c.Wj)("OnDisconnect.update",2,e,!0);var r=new c.BH;return xr(this.repo_,this.path_,t,r.wrapCallback(e)),r.promise},t}(),Ur=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,c.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Vr=function(){function t(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,c.Pz)(this.snapshot.exportVal())},t}(),Yr=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),zr=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Vr("value",this,new Qi(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){(0,c.hu)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var i=this.callback_;return function(){i.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Yr(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Xr=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,(0,c.r3)(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Yr(this,t,e):null},t.prototype.createEvent=function(t,e){(0,c.hu)(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),i=e.getQueryParams().getIndex();return new Vr(t.type,this,new Qi(t.snapshotNode,n,i),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){(0,c.hu)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var i=this.callbacks_[t.eventType];return function(){i.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var i=Object.keys(e.callbacks_),r=Object.keys(this.callbacks_),s=i.length;if(s===r.length){if(1===s){var o=i[0],a=r[0];return!(a!==o||e.callbacks_[o]&&this.callbacks_[a]&&e.callbacks_[o]!==this.callbacks_[a])}return r.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Gr=function(){function t(t,e,n,i){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=i}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return(0,c.hu)(Fr,"Reference.ts has not been loaded"),Fr},set:function(t){Fr=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Zt){var i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==k)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==M)throw new Error(i);if("string"!=typeof n)throw new Error(r)}}else if(t.getIndex()===Kt){if(null!=e&&!It(e)||null!=n&&!It(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,c.hu)(t.getIndex()instanceof vn||t.getIndex()===pn,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return(0,c.Dv)("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,i,r){(0,c.Dv)("Query.on",2,4,arguments.length),Mt("Query.on",1,e,!1),(0,c.Wj)("Query.on",2,n,!1);var s=t.getCancelAndContextArgs_("Query.on",i,r);if("value"===e)this.onValueEvent(n,s.cancel,s.context);else{var o={};o[e]=n,this.onChildEvent(o,s.cancel,s.context)}return n},t.prototype.onValueEvent=function(t,e,n){var i=new zr(t,e||null,n||null);br(this.repo,this,i)},t.prototype.onChildEvent=function(t,e,n){var i=new Xr(t,e,n);br(this.repo,this,i)},t.prototype.off=function(t,e,n){(0,c.Dv)("Query.off",0,3,arguments.length),Mt("Query.off",1,t,!0),(0,c.Wj)("Query.off",2,e,!0),(0,c.lb)("Query.off",3,n,!0);var i=null,r=null;if("value"===t){var s=e||null;i=new zr(s,null,n||null)}else t&&(e&&((r={})[t]=e),i=new Xr(r,null,n||null));wr(this.repo,this,i)},t.prototype.get=function(){return t=this.repo,e=this,null!=(n=function(t,e){var n=e.path,i=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var r=nt(t,n);i=i||Bn(e,r)}));var r=t.syncPointTree_.get(n);r?i=i||Bn(r,W()):(r=new Dn,t.syncPointTree_=t.syncPointTree_.set(n,r));var s=null!=i,o=s?new ge(i,!0,!1):null;return be(Nn(r,e,Ue(t.pendingWriteTree_,e.path),s?o.getNode():oe.EMPTY_NODE,s).viewCache_)}(t.serverSyncTree_,e))?Promise.resolve(new Qi(n,e.getRef(),e.getQueryParams().getIndex())):t.server_.get(e).then((function(n){var i=he(n),r=Hn(t.serverSyncTree_,e.path,i);return Ii(t.eventQueue_,e.path,r),Promise.resolve(new Qi(i,e.getRef(),e.getQueryParams().getIndex()))}),(function(n){return Er(t,"get for query "+(0,c.Pz)(e)+" failed: "+n),Promise.reject(new Error(n))}));var t,e,n},t.prototype.once=function(e,n,i,r){var s=this;(0,c.Dv)("Query.once",1,4,arguments.length),Mt("Query.once",1,e,!1),(0,c.Wj)("Query.once",2,n,!0);var o=t.getCancelAndContextArgs_("Query.once",i,r),a=!0,h=new c.BH;h.promise.catch((function(){}));var u=function(t){a&&(a=!1,s.off(e,u),n&&n.bind(o.context)(t),h.resolve(t))};return this.on(e,u,(function(t){s.off(e,u),o.cancel&&o.cancel.bind(o.context)(t),h.reject(t)})),h.promise},t.prototype.limitToFirst=function(e){if((0,c.Dv)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,xn(this.queryParams_,e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if((0,c.Dv)("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,bn(this.queryParams_,e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if((0,c.Dv)("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Lt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new j(e);if(et(n))throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var i=new vn(n),r=Sn(this.queryParams_,i);return t.validateQueryEndpoints_(r),new t(this.repo,this.path,r,!0)},t.prototype.orderByKey=function(){(0,c.Dv)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=Sn(this.queryParams_,Zt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){(0,c.Dv)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=Sn(this.queryParams_,Kt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){(0,c.Dv)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=Sn(this.queryParams_,pn);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),(0,c.Dv)("Query.startAt",0,2,arguments.length),Pt("Query.startAt",1,e,this.path,!0),Dt("Query.startAt",2,n,!0);var i=wn(this.queryParams_,e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.startAfter=function(e,n){void 0===e&&(e=null),(0,c.Dv)("Query.startAfter",0,2,arguments.length),Pt("Query.startAfter",1,e,this.path,!1),Dt("Query.startAfter",2,n,!0);var i=_n(this.queryParams_,e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasStart())throw new Error("Query.startAfter: Starting point was already set (by another call to startAt, startAfter or equalTo).");return new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),(0,c.Dv)("Query.endAt",0,2,arguments.length),Pt("Query.endAt",1,e,this.path,!0),Dt("Query.endAt",2,n,!0);var i=Tn(this.queryParams_,e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.endBefore=function(e,n){void 0===e&&(e=null),(0,c.Dv)("Query.endBefore",0,2,arguments.length),Pt("Query.endBefore",1,e,this.path,!1),Dt("Query.endBefore",2,n,!0);var i=En(this.queryParams_,e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasEnd())throw new Error("Query.endBefore: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if((0,c.Dv)("Query.equalTo",1,2,arguments.length),Pt("Query.equalTo",1,t,this.path,!1),Dt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return(0,c.Dv)("Query.toString",0,0,arguments.length),this.repo.toString()+Z(this.path)},t.prototype.toJSON=function(){return(0,c.Dv)("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return function(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Kt&&(e.i=t.index_.toString()),e}(this.queryParams_)},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=F(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if((0,c.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var i=this.repo===e.repo,r=rt(this.path,e.path),s=this.queryIdentifier()===e.queryIdentifier();return i&&r&&s},t.getCancelAndContextArgs_=function(t,e,n){var i={cancel:null,context:null};if(e&&n)i.cancel=e,(0,c.Wj)(t,3,i.cancel,!0),i.context=n,(0,c.lb)(t,4,i.context,!0);else if(e)if("object"==typeof e&&null!==e)i.context=e;else{if("function"!=typeof e)throw new Error((0,c.gK)(t,3,!0)+" must either be a cancel callback or a context object.");i.cancel=e}return i},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),jr=function(t){function e(e,n){if(!(e instanceof ar))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,new yn,!1)||this}return s(e,t),e.prototype.getKey=function(){return(0,c.Dv)("Reference.key",0,0,arguments.length),et(this.path)?null:Q(this.path)},e.prototype.child=function(t){return(0,c.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof j||(null===H(this.path)?Nt("Reference.child",1,t,!1):Lt("Reference.child",1,t,!1)),new e(this.repo,tt(this.path,t))},e.prototype.getParent=function(){(0,c.Dv)("Reference.parent",0,0,arguments.length);var t=$(this.path);return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){(0,c.Dv)("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return Cr(this.repo)},e.prototype.set=function(t,e){(0,c.Dv)("Reference.set",1,2,arguments.length),Ft("Reference.set",this.path),Pt("Reference.set",1,t,this.path,!1),(0,c.Wj)("Reference.set",2,e,!0);var n=new c.BH;return pr(this.repo,this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if((0,c.Dv)("Reference.update",1,2,arguments.length),Ft("Reference.update",this.path),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,R("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ot("Reference.update",1,t,this.path,!1),(0,c.Wj)("Reference.update",2,e,!0);var r=new c.BH;return vr(this.repo,this.path,t,r.wrapCallback(e)),r.promise},e.prototype.setWithPriority=function(t,e,n){if((0,c.Dv)("Reference.setWithPriority",2,3,arguments.length),Ft("Reference.setWithPriority",this.path),Pt("Reference.setWithPriority",1,t,this.path,!1),kt("Reference.setWithPriority",2,e,!1),(0,c.Wj)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var i=new c.BH;return pr(this.repo,this.path,t,e,i.wrapCallback(n)),i.promise},e.prototype.remove=function(t){return(0,c.Dv)("Reference.remove",0,1,arguments.length),Ft("Reference.remove",this.path),(0,c.Wj)("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if((0,c.Dv)("Reference.transaction",1,3,arguments.length),Ft("Reference.transaction",this.path),(0,c.Wj)("Reference.transaction",1,t,!1),(0,c.Wj)("Reference.transaction",2,e,!0),Ut("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var i=new c.BH;"function"==typeof e&&i.promise.catch((function(){}));var r=function(t,n,r){t?i.reject(t):i.resolve(new Ur(n,r)),"function"==typeof e&&e(t,n,r)};return Ar(this.repo,this.path,t,r,n),i.promise},e.prototype.setPriority=function(t,e){(0,c.Dv)("Reference.setPriority",1,2,arguments.length),Ft("Reference.setPriority",this.path),kt("Reference.setPriority",1,t,!1),(0,c.Wj)("Reference.setPriority",2,e,!0);var n=new c.BH;return pr(this.repo,tt(this.path,".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){(0,c.Dv)("Reference.push",0,2,arguments.length),Ft("Reference.push",this.path),Pt("Reference.push",1,t,this.path,!0),(0,c.Wj)("Reference.push",2,e,!0);var n,i=hr(this.repo),r=ln(i),s=this.child(r),o=this.child(r);return n=null!=t?s.set(t,e).then((function(){return o})):Promise.resolve(o),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),s},e.prototype.onDisconnect=function(){return Ft("Reference.onDisconnect",this.path),new Br(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Gr);Gr.__referenceConstructor=jr,function(t){(0,c.hu)(!An,"__referenceConstructor has already been defined"),An=t}(jr);var Wr=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(C("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',R(t)},t}(),Hr=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),qr={},Kr=!1;function Qr(t,e,n,i){var r=n||t.options.databaseURL;void 0===r&&(t.options.projectId||P("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),C("Using default host for project ",t.options.projectId),r=t.options.projectId+"-default-rtdb.firebaseio.com");var s,o=wt(r,i),a=o.repoInfo,h=void 0;"undefined"!=typeof process&&(h=process.env.FIREBASE_DATABASE_EMULATOR_HOST),h?(s=!0,r="http://"+h+"?ns="+a.namespace,a=(o=wt(r,i)).repoInfo):s=!o.repoInfo.secure;var u=i&&s?new Hr:new Wr(t,e);return Bt("Invalid Firebase Database URL",1,o),et(o.path)||P("Database URL must point to the root of a Firebase Database (not including a child path)."),Cr(function(t,e,n){var i=(0,c.DV)(qr,e.name);i||(i={},qr[e.name]=i);var r=(0,c.DV)(i,t.toURLString());return r&&P("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new ar(t,Kr,e,n),i[t.toURLString()]=r,r}(a,t,u))}var Zr=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return t=e,n=void 0,r=function(){return function(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(t){var e,n;return this.checkDeleted_("delete"),e=this.repo_,(n=(0,c.DV)(qr,e.app.name))&&(0,c.DV)(n,e.key)===e||P("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),_r(e),delete n[e.key],this.repoInternal_=null,this.rootInternal_=null,[2]}))},new((i=void 0)||(i=Promise))((function(e,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(t){t(n)}))).then(o,a)}h((r=r.apply(t,n||[])).next())}));var t,n,i,r}},t instanceof ar||P("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(function(t){if(t.stats_=Ti(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Ki(t.repoInfo_,(function(e,n,i,r){cr(t,e,n,i,r)}),t.authTokenProvider_),setTimeout((function(){return lr(t,!0)}),0);else{var e=t.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,c.Pz)(e)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new qi(t.repoInfo_,t.app.options.appId,(function(e,n,i,r){cr(t,e,n,i,r)}),(function(e){lr(t,e)}),(function(e){!function(t,e){U(e,(function(e,n){fr(t,e,n)}))}(t,e)}),t.authTokenProvider_,e),t.server_=t.persistentConnection_}var n,i;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.statsReporter_=(n=function(){return new Si(t.stats_,t.server_)},i=t.repoInfo_.toString(),_i[i]||(_i[i]=n()),_i[i]),t.infoData_=new xi,t.infoSyncTree_=new Gn({startListening:function(e,n,i,r){var s=[],o=t.infoData_.getNode(e.path);return o.isEmpty()||(s=Hn(t.infoSyncTree_,e.path,o),setTimeout((function(){r("ok")}),0)),s},stopListening:function(){}}),fr(t,"connected",!1),t.serverSyncTree_=new Gn({startListening:function(e,n,i,r){return t.server_.listen(e,i,n,(function(n,i){var s=r(n,i);Pi(t.eventQueue_,e.path,s)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this.repoInternal_),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new jr(this.repo_,W())),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?P("Cannot call useEmulator() after instance has already been initialized."):function(t,e,n){t.repoInfo_=new ft(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new Hr)}(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),(0,c.Dv)("database.ref",0,1,arguments.length),t instanceof jr?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),(0,c.Dv)(e,1,1,arguments.length);var n=wt(t,this.repo_.repoInfo_.nodeAdmin);Bt(e,1,n);var i=n.repoInfo;return this.repo_.repoInfo_.isCustomHost()||i.host===this.repo_.repoInfo_.host||P(e+": Host name does not match the current database: (found "+i.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&P("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){(0,c.Dv)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),_r(this.repo_)},t.prototype.goOnline=function(){(0,c.Dv)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),Tr(this.repo_)},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),Jr=Object.freeze({__proto__:null,forceLongPolling:function(){Xi.forceDisallow(),Bi.forceAllow()},forceWebSockets:function(){Bi.forceDisallow()},isWebSocketsAvailable:function(){return Xi.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ei(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var i=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);U(n,(function(t,e){for(var n=t,r=t.length;r<i+2;r++)n+=" ";console.log(n+e)}))}}(t.repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n;t.stats_.incrementCounter(e),n=e,t.statsReporter_.statsToReport_[n]=!0}(t.repo,e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t.repo,e)},initStandalone:function(t){var e=t.app,n=t.url,i=t.version,r=t.customAuthImpl,s=t.namespace,o=t.nodeAdmin,a=void 0!==o&&o;Yi(i);var h=new f.zt("auth-internal",new f.H0("database-standalone"));return h.setComponent(new f.wA("auth-internal",(function(){return r}),"PRIVATE")),{instance:Qr(e,h,n,a),namespace:s}}}),$r=qi;qi.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},qi.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var ts=ji,es=ft,ns=Object.freeze({__proto__:null,DataConnection:$r,RealTimeConnection:ts,hijackHash:function(t){var e=qi.prototype.put;return qi.prototype.put=function(n,i,r,s){void 0!==s&&(s=t()),e.call(this,n,i,r,s)},function(){qi.prototype.put=e}},ConnectionTarget:es,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){!function(t){Kr=t}(t)}}),is=Zr.ServerValue;!function(e){Yi(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new f.wA("database",(function(t,e){var n=e.instanceIdentifier;return Qr(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),n,void 0)}),"PUBLIC").setServiceProps({Reference:jr,Query:Gr,Database:Zr,DataSnapshot:Qi,enableLogging:S,INTERNAL:Jr,ServerValue:is,TEST_ACCESS:ns}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.9.6"),(0,c.Yr)()&&(t.exports=n)}(i.Z)},594:(t,e,n)=>{"use strict";function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i}var r;n.d(e,{in:()=>s,Yd:()=>l,Ub:()=>f,Am:()=>d});var s,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));var a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},h=s.INFO,u=((r={})[s.DEBUG]="log",r[s.VERBOSE]="log",r[s.INFO]="info",r[s.WARN]="warn",r[s.ERROR]="error",r),c=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var s=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,i(["["+s+"]  "+t.name+":"],n))}},l=function(){function t(t){this.name=t,this._logLevel=h,this._logHandler=c,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.DEBUG],t)),this._logHandler.apply(this,i([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.VERBOSE],t)),this._logHandler.apply(this,i([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.INFO],t)),this._logHandler.apply(this,i([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.WARN],t)),this._logHandler.apply(this,i([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.ERROR],t)),this._logHandler.apply(this,i([this,s.ERROR],t))},t}();function f(t){o.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var i=null;e&&e.level&&(i=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var a=r.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=i?i:e.logLevel)&&t({level:s[n].toLowerCase(),message:a,args:r,type:e.name})}},i=0,r=o;i<r.length;i++)n(r[i])}},448:(t,e,n)=>{"use strict";n.d(e,{BH:()=>f,LL:()=>A,ZR:()=>C,gQ:()=>V,zI:()=>S,hu:()=>r,g5:()=>s,US:()=>a,h$:()=>h,$s:()=>Q,r3:()=>L,ne:()=>Y,p$:()=>c,ZB:()=>l,gK:()=>j,z$:()=>d,GJ:()=>D,jU:()=>g,ru:()=>m,d:()=>x,xb:()=>F,w1:()=>b,hl:()=>T,uI:()=>p,UG:()=>v,Yr:()=>_,b$:()=>y,Mn:()=>w,w9:()=>M,cI:()=>R,UI:()=>B,xO:()=>U,DV:()=>N,ug:()=>K,dS:()=>q,Pz:()=>O,Dv:()=>G,Wj:()=>W,lb:()=>H,eu:()=>E});var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};Object.create,Object.create;var r=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},o=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[],r=0;r<t.length;r+=3){var s=t[r],o=r+1<t.length,a=o?t[r+1]:0,h=r+2<t.length,u=h?t[r+2]:0,c=s>>2,l=(3&s)<<4|a>>4,f=(15&a)<<2|u>>6,d=63&u;h||(d=64,o||(f=64)),i.push(n[c],n[l],n[f],n[d])}return i.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){var s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){var o=((7&r)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[],r=0;r<t.length;){var s=n[t.charAt(r++)],o=r<t.length?n[t.charAt(r)]:0,a=++r<t.length?n[t.charAt(r)]:64,h=++r<t.length?n[t.charAt(r)]:64;if(++r,null==s||null==o||null==a||null==h)throw Error();var u=s<<2|o>>4;if(i.push(u),64!==a){var c=o<<4&240|a>>2;if(i.push(c),64!==h){var l=a<<6&192|h;i.push(l)}}}return i},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){var e=o(t);return a.encodeByteArray(e,!0)},u=function(t){try{return a.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(t){return l(void 0,t)}function l(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=l(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,i){n?e.reject(n):e.resolve(i),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,i))}},t}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())}function v(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function g(){return"object"==typeof self&&self.self===self}function m(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function x(){return d().indexOf("Electron/")>=0}function b(){var t=d();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return d().indexOf("MSAppHost/")>=0}function _(){return!1}function T(){return"indexedDB"in self&&null!=indexedDB}function E(){return new Promise((function(t,e){try{var n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=window.indexedDB.open(i);r.onsuccess=function(){r.result.close(),n||window.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=function(){n=!1},r.onerror=function(){var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function S(){return!(!navigator||!navigator.cookieEnabled)}var C=function(t){function e(n,i,r){var s=t.call(this,i)||this;return s.code=n,s.customData=r,s.name="FirebaseError",Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,A.prototype.create),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),A=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=e[0]||{},r=this.service+"/"+t,s=this.errors[t],o=s?I(s,i):"Error",a=this.serviceName+": "+o+" ("+r+").",h=new C(r,a,i);return h},t}();function I(t,e){return t.replace(P,(function(t,n){var i=e[n];return null!=i?String(i):"<"+n+"?>"}))}var P=/\{\$([^}]+)}/g;function R(t){return JSON.parse(t)}function O(t){return JSON.stringify(t)}var k=function(t){var e={},n={},i={},r="";try{var s=t.split(".");e=R(u(s[0])||""),n=R(u(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:i,signature:r}},M=function(t){var e=k(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},D=function(t){var e=k(t).claims;return"object"==typeof e&&!0===e.admin};function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function F(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function B(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function U(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},i=0,r=Object.entries(t);i<r.length;i++){var s=r[i];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}var V=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(i=16;i<80;i++){var r=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=4294967295&(r<<1|r>>>31)}var s,o,a=this.chain_[0],h=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(i=0;i<80;i++)i<40?i<20?(s=c^h&(u^c),o=1518500249):(s=h^u^c,o=1859775393):i<60?(s=h&u|c&(h|u),o=2400959708):(s=h^u^c,o=3395469782),r=(a<<5|a>>>27)+s+l+o+n[i]&4294967295,l=c,c=u,u=4294967295&(h<<30|h>>>2),h=a,a=r;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+h&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=0,r=this.buf_,s=this.inbuf_;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++i,++s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++i,++s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var i=0;for(n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[i]=this.chain_[n]>>r&255,++i;return t},t}();function Y(t,e){var n=new z(t,e);return n.subscribe.bind(n)}var z=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var i,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,i=["next","error","complete"];n<i.length;n++){var r=i[n];if(r in t&&"function"==typeof t[r])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(i.next=X),void 0===i.error&&(i.error=X),void 0===i.complete&&(i.complete=X);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(t){}})),this.observers.push(i),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function X(){}var G=function(t,e,n,i){var r;if(i<e?r="at least "+e:i>n&&(r=0===n?"none":"no more than "+n),r)throw new Error(t+" failed: Was called with "+i+(1===i?" argument.":" arguments.")+" Expects "+r+".")};function j(t,e,n){var i="";switch(e){case 1:i=n?"first":"First";break;case 2:i=n?"second":"Second";break;case 3:i=n?"third":"Third";break;case 4:i=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(i+" argument ")}function W(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(j(t,e,i)+"must be a valid function.")}function H(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(j(t,e,i)+"must be a valid context object.")}var q=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var s=t.charCodeAt(i);if(s>=55296&&s<=56319){var o=s-55296;i++,r(i<t.length,"Surrogate pair missing trail surrogate."),s=65536+(o<<10)+(t.charCodeAt(i)-56320)}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},K=function(t){for(var e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};function Q(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}},10:t=>{function e(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(t){this.ms=t},e.prototype.setMax=function(t){this.max=t},e.prototype.setJitter=function(t){this.jitter=t}},704:(t,e)=>{!function(t){"use strict";e.encode=function(e){var n,i=new Uint8Array(e),r=i.length,s="";for(n=0;n<r;n+=3)s+=t[i[n]>>2],s+=t[(3&i[n])<<4|i[n+1]>>4],s+=t[(15&i[n+1])<<2|i[n+2]>>6],s+=t[63&i[n+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s},e.decode=function(e){var n,i,r,s,o,a=.75*e.length,h=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),l=new Uint8Array(c);for(n=0;n<h;n+=4)i=t.indexOf(e[n]),r=t.indexOf(e[n+1]),s=t.indexOf(e[n+2]),o=t.indexOf(e[n+3]),l[u++]=i<<2|r>>4,l[u++]=(15&r)<<4|s>>2,l[u++]=(3&s)<<6|63&o;return c}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},767:t=>{function e(t){if(t)return function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<i.length;r++)if((n=i[r])===e||n.fn===e){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},227:(t,e,n)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let i=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(i++,"%c"===t&&(r=i))})),e.splice(r,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(447)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},447:(t,e,n)=>{t.exports=function(t){function e(t){let n,r=null;function s(...t){if(!s.enabled)return;const i=s,r=Number(new Date),o=r-(n||r);i.diff=o,i.prev=n,i.curr=r,n=r,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,r)=>{if("%%"===n)return"%";a++;const s=e.formatters[r];if("function"==typeof s){const e=t[a];n=s.call(i,e),t.splice(a,1),a--}return n})),e.formatArgs.call(i,t),(i.log||e.log).apply(i,t)}return s.namespace=t,s.useColors=e.useColors(),s.color=e.selectColor(t),s.extend=i,s.destroy=e.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===r?e.enabled(t):r,set:t=>{r=t}}),"function"==typeof e.init&&e.init(s),s}function i(t,n){const i=e(this.namespace+(void 0===n?":":n)+t);return i.log=this.log,i}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(r),...e.skips.map(r).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.names=[],e.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),r=i.length;for(n=0;n<r;n++)i[n]&&("-"===(t=i[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,i;for(n=0,i=e.skips.length;n<i;n++)if(e.skips[n].test(t))return!1;for(n=0,i=e.names.length;n<i;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(824),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},549:t=>{t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},983:(t,e,n)=>{const i=n(192);t.exports=(t,e)=>new i(t,e),t.exports.Socket=i,t.exports.protocol=i.protocol,t.exports.Transport=n(496),t.exports.transports=n(352),t.exports.parser=n(743)},192:(t,e,n)=>{const i=n(352),r=n(767),s=n(227)("engine.io-client:socket"),o=n(743),a=n(187),h=n(830);class u extends r{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=a(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=a(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=h.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){s('creating transport "%s"',t);const e=function(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.opts.query);e.EIO=o.protocol,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return s("options: %j",n),new i[t](n)}open(){let t;if(this.opts.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){const t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return s("error while creating transport: %s",t),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){s("setting transport %s",t.name);const e=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))}probe(t){s('probing transport "%s"',t);let e=this.createTransport(t,{probe:1}),n=!1;const i=this;function r(){if(i.onlyBinaryUpgrades){const t=!this.supportsBinary&&i.transport.supportsBinary;n=n||t}n||(s('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(r){if(!n)if("pong"===r.type&&"probe"===r.data){if(s('probe transport "%s" pong',t),i.upgrading=!0,i.emit("upgrading",e),!e)return;u.priorWebsocketSuccess="websocket"===e.name,s('pausing current transport "%s"',i.transport.name),i.transport.pause((function(){n||"closed"!==i.readyState&&(s("changing transport and sending upgrade packet"),f(),i.setTransport(e),e.send([{type:"upgrade"}]),i.emit("upgrade",e),e=null,i.upgrading=!1,i.flush())}))}else{s('probe transport "%s" failed',t);const n=new Error("probe error");n.transport=e.name,i.emit("upgradeError",n)}})))}function o(){n||(n=!0,f(),e.close(),e=null)}function a(n){const r=new Error("probe error: "+n);r.transport=e.name,o(),s('probe transport "%s" failed because of error: %s',t,n),i.emit("upgradeError",r)}function h(){a("transport closed")}function c(){a("socket closed")}function l(t){e&&t.name!==e.name&&(s('"%s" works - aborting "%s"',t.name,e.name),o())}function f(){e.removeListener("open",r),e.removeListener("error",a),e.removeListener("close",h),i.removeListener("close",c),i.removeListener("upgrading",l)}u.priorWebsocketSuccess=!1,e.once("open",r),e.once("error",a),e.once("close",h),this.once("close",c),this.once("upgrading",l),e.open()}onOpen(){if(s("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){s("starting upgrade probes");let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else s('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:t,data:e,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const t=this;function e(){t.onClose("forced close"),s("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function i(){t.once("upgrade",n),t.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){this.upgrading?i():e()})):this.upgrading?i():e()),this}onError(t){s("socket error %j",t),u.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',t);const n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,e),n.writeBuffer=[],n.prevBufferLen=0}}filterUpgrades(t){const e=[];let n=0;const i=t.length;for(;n<i;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}u.priorWebsocketSuccess=!1,u.protocol=o.protocol,t.exports=u},496:(t,e,n)=>{const i=n(743),r=n(767);t.exports=class extends r{constructor(t){super(),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(t){const e=i.decodePacket(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){this.emit("packet",t)}onClose(){this.readyState="closed",this.emit("close")}}},352:(t,e,n)=>{const i=n(777),r=n(416),s=n(785),o=n(442);e.polling=function(t){let e,n=!1,o=!1;const a=!1!==t.jsonp;if("undefined"!=typeof location){const e="https:"===location.protocol;let i=location.port;i||(i=e?443:80),n=t.hostname!==location.hostname||i!==t.port,o=t.secure!==e}if(t.xdomain=n,t.xscheme=o,e=new i(t),"open"in e&&!t.forceJSONP)return new r(t);if(!a)throw new Error("JSONP disabled");return new s(t)},e.websocket=o},785:(t,e,n)=>{const i=n(15),r=n(549),s=/\n/g,o=/\\n/g;let a;t.exports=class extends i{constructor(t){super(t),this.query=this.query||{},a||(a=r.___eio=r.___eio||[]),this.index=a.length;const e=this;a.push((function(t){e.onData(t)})),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};const n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){const t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)}doWrite(t,e){const n=this;let i;if(!this.form){const t=document.createElement("form"),e=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;t.className="socketio",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.target=n,t.method="POST",t.setAttribute("accept-charset","utf-8"),e.name="d",t.appendChild(e),document.body.appendChild(t),this.form=t,this.area=e}function r(){a(),e()}function a(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{const t='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(t)}catch(t){i=document.createElement("iframe"),i.name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}this.form.action=this.uri(),a(),t=t.replace(o,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&r()}:this.iframe.onload=r}}},416:(t,e,n)=>{const i=n(777),r=n(15),s=n(767),{pick:o}=n(839),a=n(549),h=n(227)("engine.io-client:polling-xhr");function u(){}const c=null!=new i({xdomain:!1}).responseType;class l extends s{constructor(t,e){super(),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=o(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new i(t),n=this;try{h("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof e.status?e.status:0)}),0))},h("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}function f(){for(let t in l.requests)l.requests.hasOwnProperty(t)&&l.requests[t].abort()}l.requestsCount=0,l.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",f):"function"==typeof addEventListener&&addEventListener("onpagehide"in a?"pagehide":"unload",f,!1)),t.exports=class extends r{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=c&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new l(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t}),i=this;n.on("success",e),n.on("error",(function(t){i.onError("xhr post error",t)}))}doPoll(){h("xhr poll");const t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t}},t.exports.Request=l},15:(t,e,n)=>{const i=n(496),r=n(830),s=n(743),o=n(281),a=n(227)("engine.io-client:polling");t.exports=class extends i{get name(){return"polling"}doOpen(){this.poll()}pause(t){const e=this;function n(){a("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){let t=0;this.polling&&(a("we are currently polling - waiting to pause"),t++,this.once("pollComplete",(function(){a("pre-pause polling complete"),--t||n()}))),this.writable||(a("we are currently writing - waiting to pause"),t++,this.once("drain",(function(){a("pre-pause writing complete"),--t||n()})))}else n()}poll(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){const e=this;a("polling got data %s",t),s.decodePayload(t,this.socket.binaryType).forEach((function(t,n,i){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))}doClose(){const t=this;function e(){a("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(a("transport open - closing"),e()):(a("transport not open - deferring close"),this.once("open",e))}write(t){this.writable=!1,s.encodePayload(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=o()),this.supportsBinary||t.sid||(t.b64=1),t=r.encode(t),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}}},866:(t,e,n)=>{const i=n(549);t.exports={WebSocket:i.WebSocket||i.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},442:(t,e,n)=>{const i=n(496),r=n(743),s=n(830),o=n(281),{pick:a}=n(839),{WebSocket:h,usingBrowserWebSocket:u,defaultBinaryType:c}=n(866),l=n(227)("engine.io-client:websocket"),f="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class d extends i{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=f?{}:a(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=u&&!f?e?new h(t,e):new h(t):new h(t,e,n)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||c,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){const e=this;this.writable=!1;let n=t.length,i=0;const s=n;for(;i<s;i++)!function(t){r.encodePacket(t,e.supportsBinary,(function(i){const r={};!u&&(t.options&&(r.compress=t.options.compress),e.opts.perMessageDeflate)&&("string"==typeof i?Buffer.byteLength(i):i.length)<e.opts.perMessageDeflate.threshold&&(r.compress=!1);try{u?e.ws.send(i):e.ws.send(i,r)}catch(t){l("websocket closed before onclose event")}--n||(e.emit("flush"),setTimeout((function(){e.writable=!0,e.emit("drain")}),0))}))}(t[i])}onClose(){i.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";return this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=o()),this.supportsBinary||(t.b64=1),t=s.encode(t),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}check(){return!(!h||"__initialize"in h&&this.name===d.prototype.name)}}t.exports=d},839:t=>{t.exports.pick=(t,...e)=>e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})},777:(t,e,n)=>{const i=n(58),r=n(549);t.exports=function(t){const e=t.xdomain,n=t.xscheme,s=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||i))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(t){}if(!e)try{return new(r[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},712:t=>{const e=Object.create(null);e.open="0",e.close="1",e.ping="2",e.pong="3",e.message="4",e.upgrade="5",e.noop="6";const n=Object.create(null);Object.keys(e).forEach((t=>{n[e[t]]=t})),t.exports={PACKET_TYPES:e,PACKET_TYPES_REVERSE:n,ERROR_PACKET:{type:"error",data:"parser error"}}},965:(t,e,n)=>{const{PACKET_TYPES_REVERSE:i,ERROR_PACKET:r}=n(712);let s;"function"==typeof ArrayBuffer&&(s=n(704));const o=(t,e)=>{if(s){const n=s.decode(t);return a(n,e)}return{base64:!0,data:t}},a=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};t.exports=(t,e)=>{if("string"!=typeof t)return{type:"message",data:a(t,e)};const n=t.charAt(0);return"b"===n?{type:"message",data:o(t.substring(1),e)}:i[n]?t.length>1?{type:i[n],data:t.substring(1)}:{type:i[n]}:r}},929:(t,e,n)=>{const{PACKET_TYPES:i}=n(712),r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,o=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};t.exports=({type:t,data:e},n,a)=>{return r&&e instanceof Blob?n?a(e):o(e,a):s&&(e instanceof ArrayBuffer||(h=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(h):h&&h.buffer instanceof ArrayBuffer))?n?a(e instanceof ArrayBuffer?e:e.buffer):o(new Blob([e]),a):a(i[t]+(e||""));var h}},743:(t,e,n)=>{const i=n(929),r=n(965),s=String.fromCharCode(30);t.exports={protocol:4,encodePacket:i,encodePayload:(t,e)=>{const n=t.length,r=new Array(n);let o=0;t.forEach(((t,a)=>{i(t,!1,(t=>{r[a]=t,++o===n&&e(r.join(s))}))}))},decodePacket:r,decodePayload:(t,e)=>{const n=t.split(s),i=[];for(let t=0;t<n.length;t++){const s=r(n[t],e);if(i.push(s),"error"===s.type)break}return i}}},58:t=>{try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function i(t,e,i){var r,s=new Promise((function(s,o){n(r=t[e].apply(t,i)).then(s,o)}));return s.request=r,s}function r(t,e,n){var r=i(t,e,n);return r.then((function(t){if(t)return new c(t,r.request)}))}function s(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function o(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return this[e][i].apply(this[e],arguments)})}))}function h(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function u(t){this._index=t}function c(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}s(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),h(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(c,"_cursor",["direction","key","primaryKey","value"]),o(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(c.prototype[t]=function(){var e=this,i=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,i),n(e._request).then((function(t){if(t)return new c(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},s(l,"_store",["name","keyPath","indexNames","autoIncrement"]),o(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),h(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},s(f,"_tx",["objectStoreNames","mode"]),a(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},s(d,"_db",["name","version","objectStoreNames"]),a(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,u].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),i=n[n.length-1],r=this._store||this._index,s=r[t].apply(r,n.slice(0,-1));s.onsuccess=function(){i(s.result)}})}))})),[u,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,i=[];return new Promise((function(r){n.iterateCursor(t,(function(t){t?(i.push(t.value),void 0===e||i.length!=e?t.continue():r(i)):r(i)}))}))})})),t.openDb=function(t,e,n){var r=i(indexedDB,"open",[t,e]),s=r.request;return s&&(s.onupgradeneeded=function(t){n&&n(new d(s.result,t.oldVersion,s.transaction))}),r.then((function(t){return new p(t)}))},t.deleteDb=function(t){return i(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},824:t=>{var e=1e3,n=60*e,i=60*n,r=24*i;function s(t,e,n,i){var r=e>=1.5*n;return Math.round(t/n)+" "+i+(r?"s":"")}t.exports=function(t,o){o=o||{};var a,h,u=typeof t;if("string"===u&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*r;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===u&&isFinite(t))return o.long?(a=t,(h=Math.abs(a))>=r?s(a,h,r,"day"):h>=i?s(a,h,i,"hour"):h>=n?s(a,h,n,"minute"):h>=e?s(a,h,e,"second"):a+" ms"):function(t){var s=Math.abs(t);return s>=r?Math.round(t/r)+"d":s>=i?Math.round(t/i)+"h":s>=n?Math.round(t/n)+"m":s>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},830:(t,e)=>{e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),i=0,r=n.length;i<r;i++){var s=n[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},187:t=>{var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var i,r,s=t,o=t.indexOf("["),a=t.indexOf("]");-1!=o&&-1!=a&&(t=t.substring(0,o)+t.substring(o,a).replace(/:/g,";")+t.substring(a,t.length));for(var h,u,c=e.exec(t||""),l={},f=14;f--;)l[n[f]]=c[f]||"";return-1!=o&&-1!=a&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=(i=l.path,r=i.replace(/\/{2,9}/g,"/").split("/"),"/"!=i.substr(0,1)&&0!==i.length||r.splice(0,1),"/"==i.substr(i.length-1,1)&&r.splice(r.length-1,1),r),l.queryKey=(h=l.query,u={},h.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(u[e]=n)})),u),l}},260:function(t){var e;e=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1525)}([function(t,e){function n(t,e,n){var i=n?t[e]:Object.getOwnPropertyDescriptor(t,e);return!n&&i.value&&"object"==typeof i.value&&(i=i.value),!(!i||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(i))&&(void 0===i.enumerable&&(i.enumerable=!0),void 0===i.configurable&&(i.configurable=!0),i)}function i(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!!n&&(n.value&&"object"==typeof n.value&&(n=n.value),!1===n.configurable)}function r(t,e,r,s){for(var a in e)if(e.hasOwnProperty(a)){var h=n(e,a,r);if(!1!==h){if(i((s||t).prototype,a)){if(o.ignoreFinals)continue;throw new Error("cannot override final property '"+a+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,a,h)}else t.prototype[a]=e[a]}}function s(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)r(t,e[n].prototype||e[n])}}function o(t){var e,n;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var i=t.Extends;e=function(){i.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,n=t.Extends,delete t.Extends):e.prototype.constructor=e;var o=null;return t.Mixins&&(o=t.Mixins,delete t.Mixins),s(e,o),r(e,t,!0,n),e}o.extend=r,o.mixin=s,o.ignoreFinals=!1,t.exports=o},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e,n){var i=typeof t;return t&&"number"!==i&&"string"!==i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},function(t,e,n){var i=n(0),r=n(125),s=new i({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new s(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return r(this.x,t.x,e)&&r(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e*this.x-n*this.y,n*this.x+e*this.y)}});s.ZERO=new s,s.RIGHT=new s(1,0),s.LEFT=new s(-1,0),s.UP=new s(0,-1),s.DOWN=new s(0,1),s.ONE=new s(1,1),t.exports=s},function(t,e,n){var i=n(0),r=n(56),s=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=r.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=s},function(t,e,n){var i=n(0),r=n(24),s=n(20),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(s.DESTROY,this.destroy,this)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectFactory",o,"add"),t.exports=o},function(t,e){t.exports=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=n,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o])){s=n;break}s=r[i[o]],r=r[i[o]]}return s}return n}return n}},function(t,e){t.exports=function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}},function(t,e){var n={},i={install:function(t){for(var e in n)t[e]=n[e]},register:function(t,e){n[t]=e},destroy:function(){n={}}};t.exports=i},function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function s(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||t,s),h=r?r+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function u(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,i,s,o){var a=r?r+t:t;if(!this._events[a])return!1;var h,u,c=this._events[a],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,s),!0;case 6:return c.fn.call(c.context,e,n,i,s,o),!0}for(u=1,h=new Array(l-1);u<l;u++)h[u-1]=arguments[u];c.fn.apply(c.context,h)}else{var f,d=c.length;for(u=0;u<d;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),l){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,i);break;default:if(!h)for(f=1,h=new Array(l-1);f<l;f++)h[f-1]=arguments[f];c[u].fn.apply(c[u].context,h)}}return!0},u.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},u.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},u.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return h(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||i&&!o.once||n&&o.context!==n||h(this,s);else{for(var a=0,u=[],c=o.length;a<c;a++)(o[a].fn!==e||i&&!o[a].once||n&&o[a].context!==n)&&u.push(o[a]);u.length?this._events[s]=1===u.length?u[0]:u:h(this,s)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},function(t,e,n){var i=n(0),r=n(57),s=n(171),o=n(306),a=n(56),h=n(47),u=n(174),c=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return u(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=c},function(t,e,n){t.exports={Alpha:n(607),AlphaSingle:n(303),BlendMode:n(304),ComputedSize:n(608),Crop:n(609),Depth:n(305),Flip:n(610),GetBounds:n(611),Mask:n(309),Origin:n(632),PathFollower:n(633),Pipeline:n(167),ScrollFactor:n(312),Size:n(634),Texture:n(635),TextureCrop:n(636),Tint:n(637),ToJSON:n(176),Transform:n(313),TransformMatrix:n(25),Visible:n(314)}},function(t,e){function n(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}t.exports={getTintFromFloats:function(t,e,n,i){return((255&(255*i|0))<<24|(255&(255*t|0))<<16|(255&(255*e|0))<<8|255&(255*n|0))>>>0},getTintAppendFloatAlpha:function(t,e){return((255&(255*e|0))<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255&(255*e|0))<<24|(255&(0|t))<<16|(255&(t>>8|0))<<8|255&(t>>16|0))>>>0},getFloatsFromUintRGB:function(t){return[(255&(t>>16|0))/255,(255&(t>>8|0))/255,(255&(0|t))/255]},checkShaderMax:function(t,e){e&&-1!==e||(e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));for(var i=t.createShader(t.FRAGMENT_SHADER),r=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");;){var s=r.replace(/%forloop%/gi,n(e));if(t.shaderSource(i,s),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))break;e=e/2|0}return e},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var n="",i=0;i<e;i++)i>0&&(n+="\n\telse "),i<e-1&&(n+="if (outTexId < "+i+".5)"),n+="\n\t{",n+="\n\t\ttexture = texture2D(uMainSampler["+i+"], outTexCoord);",n+="\n\t}";return(t=t.replace(/%count%/gi,e.toString())).replace(/%forloop%/gi,n)}}},function(t,e,n){var i=n(193),r=n(6);t.exports=function(t,e,n){var s=r(t,e,null);if(null===s)return n;if(Array.isArray(s))return i.RND.pick(s);if("object"==typeof s){if(s.hasOwnProperty("randInt"))return i.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return i.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if("function"==typeof s)return s(e);return s}},function(t,e){var n={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};t.exports=n},function(t,e,n){var i=n(0),r=n(176),s=n(101),o=n(9),a=n(76),h=n(20),u=new i({Extends:o,initialize:function(t,e){o.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(a.ADDED_TO_SCENE,this.addedToScene,this),this.on(a.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return r(this)},willRender:function(t){return!(u.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?n.unshift(this.displayList.getIndex(t)):n.unshift(this.scene.sys.displayList.getIndex(t)),n},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(a.ADDED_TO_SCENE,this,this.scene),t.events.emit(h.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(a.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(h.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(){this.scene&&!this.ignoreDestroy&&(this.preDestroy&&this.preDestroy.call(this),this.emit(a.DESTROY,this),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});u.RENDER_MASK=15,t.exports=u},function(t,e,n){var i=n(0),r=n(24),s=n(20),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(s.DESTROY,this.destroy,this)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectCreator",o,"make"),t.exports=o},function(t,e,n){var i=n(7),r=function(){var t,e,n,s,o,a,h=arguments[0]||{},u=1,c=arguments.length,l=!1;for("boolean"==typeof h&&(l=h,h=arguments[1]||{},u=2),c===u&&(h=this,--u);u<c;u++)if(null!=(t=arguments[u]))for(e in t)n=h[e],h!==(s=t[e])&&(l&&s&&(i(s)||(o=Array.isArray(s)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&i(n)?n:{},h[e]=r(l,a,s)):void 0!==s&&(h[e]=s));return h};t.exports=r},function(t,e){t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},function(t,e,n){var i=n(25),r=new i,s=new i,o=new i,a={camera:r,sprite:s,calc:o};t.exports=function(t,e,n){var i=r,h=s,u=o;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=e.scrollX*t.scrollFactorX,h.f-=e.scrollY*t.scrollFactorY),i.multiply(h,u),a}},function(t,e,n){t.exports={ADDED_TO_SCENE:n(656),BOOT:n(657),CREATE:n(658),DESTROY:n(659),PAUSE:n(660),POST_UPDATE:n(661),PRE_RENDER:n(662),PRE_UPDATE:n(663),READY:n(664),REMOVED_FROM_SCENE:n(665),RENDER:n(666),RESUME:n(667),SHUTDOWN:n(668),SLEEP:n(669),START:n(670),TRANSITION_COMPLETE:n(671),TRANSITION_INIT:n(672),TRANSITION_OUT:n(673),TRANSITION_START:n(674),TRANSITION_WAKE:n(675),UPDATE:n(676),WAKE:n(677)}},function(t,e){t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19}},function(t,e,n){t.exports={BLUR:n(612),BOOT:n(613),CONTEXT_LOST:n(614),CONTEXT_RESTORED:n(615),DESTROY:n(616),FOCUS:n(617),HIDDEN:n(618),PAUSE:n(619),POST_RENDER:n(620),POST_STEP:n(621),PRE_RENDER:n(622),PRE_STEP:n(623),READY:n(624),RESUME:n(625),STEP:n(626),VISIBLE:n(627)}},function(t,e,n){var i=n(0),r=n(21),s=n(95),o=n(2),a=n(155),h=n(240),u=n(517),c=n(156),l=new i({initialize:function(t,e){this.loader=t,this.cache=o(e,"cache",!1),this.type=o(e,"type",!1),this.key=o(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.type||!this.key)throw new Error("Invalid Loader."+this.type+" key");var i=o(e,"url");void 0===i?i=t.path+n+"."+o(e,"extension",""):"string"!=typeof i||i.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)||(i=t.path+i),this.url=i,this.src="",this.xhrSettings=c(o(e,"responseType",void 0)),o(e,"xhrSettings",!1)&&(this.xhrSettings=h(this.xhrSettings,o(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?r.FILE_POPULATED:r.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=o(e,"config",{}),this.multiFile,this.linkFile},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){this.state===r.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=r.FILE_LOADING,this.src=a(this,this.loader.baseURL),0===this.src.indexOf("data:")?console.warn("Local data URIs are not supported: "+this.key):this.xhrLoader=u(this,this.loader.xhr))},onLoad:function(t,e){var n=t.responseURL&&0===t.responseURL.indexOf("file://")&&0===e.target.status,i=!(e.target&&200!==e.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(i=!1),this.state=r.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,i)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=r.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=r.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=r.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(t){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(s.FILE_COMPLETE,e,n,t),this.loader.emit(s.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});l.createObjectURL=function(t,e,n){if("function"==typeof URL)t.src=URL.createObjectURL(e);else{var i=new FileReader;i.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e)}},l.revokeObjectURL=function(t){"function"==typeof URL&&URL.revokeObjectURL(t.src)},t.exports=l},function(t,e){var n={},i={},r={register:function(t,e,i,r){void 0===r&&(r=!1),n[t]={plugin:e,mapping:i,custom:r}},registerCustom:function(t,e,n,r){i[t]={plugin:e,mapping:n,data:r}},hasCore:function(t){return n.hasOwnProperty(t)},hasCustom:function(t){return i.hasOwnProperty(t)},getCore:function(t){return n[t]},getCustom:function(t){return i[t]},getCustomClass:function(t){return i.hasOwnProperty(t)?i[t].plugin:null},remove:function(t){n.hasOwnProperty(t)&&delete n[t]},removeCustom:function(t){i.hasOwnProperty(t)&&delete i[t]},destroyCorePlugins:function(){for(var t in n)n.hasOwnProperty(t)&&delete n[t]},destroyCustomPlugins:function(){for(var t in i)i.hasOwnProperty(t)&&delete i[t]}};t.exports=r},function(t,e,n){var i=n(0),r=n(14),s=n(3),o=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),this.matrix=new Float32Array([t,e,n,i,r,s,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],s=t[3];return e||n?n>0?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||s?r.TAU-(s>0?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,r=i[0],s=i[1],o=i[2],a=i[3];return i[0]=r*n+o*e,i[1]=s*n+a*e,i[2]=r*-e+o*n,i[3]=s*-e+a*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,r=n[0],s=n[1],o=n[2],a=n[3],h=n[4],u=n[5],c=i[0],l=i[1],f=i[2],d=i[3],p=i[4],v=i[5],g=void 0===e?this:e;return g.a=c*r+l*o,g.b=c*s+l*a,g.c=f*r+d*o,g.d=f*s+d*a,g.e=p*r+v*o+h,g.f=p*s+v*a+u,g},multiplyWithOffset:function(t,e,n){var i=this.matrix,r=t.matrix,s=i[0],o=i[1],a=i[2],h=i[3],u=e*s+n*a+i[4],c=e*o+n*h+i[5],l=r[0],f=r[1],d=r[2],p=r[3],v=r[4],g=r[5];return i[0]=l*s+f*a,i[1]=l*o+f*h,i[2]=d*s+p*a,i[3]=d*o+p*h,i[4]=v*s+g*a+u,i[5]=v*o+g*h+c,this},transform:function(t,e,n,i,r,s){var o=this.matrix,a=o[0],h=o[1],u=o[2],c=o[3],l=o[4],f=o[5];return o[0]=t*a+e*u,o[1]=t*h+e*c,o[2]=n*a+i*u,o[3]=n*h+i*c,o[4]=r*a+s*u+l,o[5]=r*h+s*c+f,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,r=i[0],s=i[1],o=i[2],a=i[3],h=i[4],u=i[5];return n.x=t*r+e*o+h,n.y=t*s+e*a+u,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=e*r-n*i;return t[0]=r/a,t[1]=-n/a,t[2]=-i/a,t[3]=e/a,t[4]=(i*o-r*s)/a,t[5]=-(e*o-n*s)/a,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){var e=this.matrix;return t.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,r,s){var o=this.matrix;return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o[4]=r,o[5]=s,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(t.translateX=e[4],t.translateY=e[5],n||i){var a=Math.sqrt(n*n+i*i);t.rotation=i>0?Math.acos(n/a):-Math.acos(n/a),t.scaleX=a,t.scaleY=o/a}else if(r||s){var h=Math.sqrt(r*r+s*s);t.rotation=.5*Math.PI-(s>0?Math.acos(-r/h):-Math.acos(r/h)),t.scaleX=o/h,t.scaleY=h}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,n,i,r){var s=this.matrix,o=Math.sin(n),a=Math.cos(n);return s[4]=t,s[5]=e,s[0]=a*i,s[1]=o*i,s[2]=-o*r,s[3]=a*r,this},applyInverse:function(t,e,n){void 0===n&&(n=new s);var i=this.matrix,r=i[0],o=i[1],a=i[2],h=i[3],u=i[4],c=i[5],l=1/(r*h+a*-o);return n.x=h*l*t+-a*l*e+(c*a-u*h)*l,n.y=r*l*e+-o*l*t+(-c*r+u*o)*l,n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,n){var i=this.getX(t,e);return n&&(i=Math.round(i)),i},getYRound:function(t,e,n){var i=this.getY(t,e);return n&&(i=Math.round(i)),i},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}});t.exports=o},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=o.width),void 0===r&&(r=o.height),s||(s={});var a=i(s,"isNotEmpty",!1),h=i(s,"isColliding",!1),u=i(s,"hasInterestingFace",!1);t<0&&(n+=t,t=0),e<0&&(r+=e,e=0),t+n>o.width&&(n=Math.max(o.width-t,0)),e+r>o.height&&(r=Math.max(o.height-e,0));for(var c=[],l=e;l<e+r;l++)for(var f=t;f<t+n;f++){var d=o.data[l][f];if(null!==d){if(a&&-1===d.index)continue;if(h&&!d.collides)continue;if(u&&!d.hasInterestingFace)continue;c.push(d)}}return c}},function(t,e){t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,h=t.length;if(1===s)for(o=r;o<h;o++)t[o][e]=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]=n+a*i,a++;return t}},function(t,e,n){var i=n(35),r=n(13);t.exports=function(t,e,n){e.x=r(n,"x",0),e.y=r(n,"y",0),e.depth=r(n,"depth",0),e.flipX=r(n,"flipX",!1),e.flipY=r(n,"flipY",!1);var s=r(n,"scale",null);"number"==typeof s?e.setScale(s):null!==s&&(e.scaleX=r(s,"x",1),e.scaleY=r(s,"y",1));var o=r(n,"scrollFactor",null);"number"==typeof o?e.setScrollFactor(o):null!==o&&(e.scrollFactorX=r(o,"x",1),e.scrollFactorY=r(o,"y",1)),e.rotation=r(n,"rotation",0);var a=r(n,"angle",null);null!==a&&(e.angle=a),e.alpha=r(n,"alpha",1);var h=r(n,"origin",null);if("number"==typeof h)e.setOrigin(h);else if(null!==h){var u=r(h,"x",.5),c=r(h,"y",.5);e.setOrigin(u,c)}return e.blendMode=r(n,"blendMode",i.NORMAL),e.visible=r(n,"visible",!0),r(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},function(t,e){t.exports={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r,s){var o=r.alpha*n.alpha;if(o<=0)return!1;var a=i(n,r,s).calc;return e.globalCompositeOperation=t.blendModes[n.blendMode],e.globalAlpha=o,e.save(),a.setToContext(e),e.imageSmoothingEnabled=!(!t.antialias||n.frame&&n.frame.source.scaleMode),!0}},function(t,e,n){var i,r,s,o=n(33),a=n(192),h=[],u=!1;t.exports=(s=function(){var t=0;return h.forEach((function(e){e.parent&&t++})),t},{create2D:function(t,e,n){return i(t,e,n,o.CANVAS)},create:i=function(t,e,n,i,s){var c;void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=o.CANVAS),void 0===s&&(s=!1);var l=r(i);return null===l?(l={parent:t,canvas:document.createElement("canvas"),type:i},i===o.CANVAS&&h.push(l),c=l.canvas):(l.parent=t,c=l.canvas),s&&(l.parent=c),c.width=e,c.height=n,u&&i===o.CANVAS&&a.disable(c.getContext("2d")),c},createWebGL:function(t,e,n){return i(t,e,n,o.WEBGL)},disableSmoothing:function(){u=!0},enableSmoothing:function(){u=!1},first:r=function(t){if(void 0===t&&(t=o.CANVAS),t===o.WEBGL)return null;for(var e=0;e<h.length;e++){var n=h[e];if(!n.parent&&n.type===t)return n}return null},free:function(){return h.length-s()},pool:h,remove:function(t){var e=t instanceof HTMLCanvasElement;h.forEach((function(n){(e&&n.canvas===t||!e&&n.parent===t)&&(n.parent=null,n.canvas.width=1,n.canvas.height=1)}))},total:s})},function(t,e){var n={};t.exports=n,function(){n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n.extend=function(t,e){var i,r;"boolean"==typeof e?(i=2,r=e):(i=1,r=!0);for(var s=i;s<arguments.length;s++){var o=arguments[s];if(o)for(var a in o)r&&o[a]&&o[a].constructor===Object?t[a]&&t[a].constructor!==Object?t[a]=o[a]:(t[a]=t[a]||{},n.extend(t[a],r,o[a])):t[a]=o[a]}return t},n.clone=function(t,e){return n.extend({},e,t)},n.keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},n.values=function(t){var e=[];if(Object.keys){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(t[n[i]]);return e}for(var r in t)e.push(t[r]);return e},n.get=function(t,e,n,i){e=e.split(".").slice(n,i);for(var r=0;r<e.length;r+=1)t=t[e[r]];return t},n.set=function(t,e,i,r,s){var o=e.split(".").slice(r,s);return n.get(t,e,0,-1)[o[o.length-1]]=i,i},n.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(n.random()*(e+1)),r=t[e];t[e]=t[i],t[i]=r}return t},n.choose=function(t){return t[Math.floor(n.random()*t.length)]},n.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.isFunction=function(t){return"function"==typeof t},n.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},n.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},n.clamp=function(t,e,n){return t<e?e:t>n?n:t},n.sign=function(t){return t<0?-1:1},n.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-n._nowStartTime},n.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var t=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280};n.colorToNumber=function(t){return 3==(t=t.replace("#","")).length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.nextId=function(){return n._nextId++},n.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},n.map=function(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n},n.topologicalSort=function(t){var e=[],i=[],r=[];for(var s in t)i[s]||r[s]||n._topologicalSort(s,i,r,t,e);return e},n._topologicalSort=function(t,e,i,r,s){var o=r[t]||[];i[t]=!0;for(var a=0;a<o.length;a+=1){var h=o[a];i[h]||e[h]||n._topologicalSort(h,e,i,r,s)}i[t]=!1,e[t]=!0,s.push(t)},n.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var n=arguments[e];n._chained?t.push.apply(t,n._chained):t.push(n)}var i=function(){for(var e,n=new Array(arguments.length),i=0,r=arguments.length;i<r;i++)n[i]=arguments[i];for(i=0;i<t.length;i+=1){var s=t[i].apply(e,n);void 0!==s&&(e=s)}return e};return i._chained=t,i},n.chainPathBefore=function(t,e,i){return n.set(t,e,n.chain(i,n.get(t,e)))},n.chainPathAfter=function(t,e,i){return n.set(t,e,n.chain(n.get(t,e),i))}}()},function(t,e,n){var i={VERSION:"3.53.1",BlendModes:n(35),ScaleModes:n(168),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};t.exports=i},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(47),a=n(67),h=new i({Extends:s,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Transform,r.Visible],initialize:function(t,e,n){void 0===e&&(e="Shape"),s.call(this,t,e),this.geom=n,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new o,this.width=0,this.height=0,this.initPipeline(a.GRAPHICS_PIPELINE)},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,n){return void 0===n&&(n=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=n,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});t.exports=h},function(t,e){t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},function(t,e,n){var i=n(14);t.exports=function(t){return t*i.DEG_TO_RAD}},function(t,e,n){t.exports={DESTROY:n(743),FADE_IN_COMPLETE:n(744),FADE_IN_START:n(745),FADE_OUT_COMPLETE:n(746),FADE_OUT_START:n(747),FLASH_COMPLETE:n(748),FLASH_START:n(749),FOLLOW_UPDATE:n(750),PAN_COMPLETE:n(751),PAN_START:n(752),POST_RENDER:n(753),PRE_RENDER:n(754),ROTATE_COMPLETE:n(755),ROTATE_START:n(756),SHAKE_COMPLETE:n(757),SHAKE_START:n(758),ZOOM_COMPLETE:n(759),ZOOM_START:n(760)}},function(t,e,n){var i=n(0),r=n(103),s=n(328),o=n(188),a=n(329),h=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,n,i)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,n,i,r){return void 0===i&&(i=255),void 0===r&&(r=!0),this._locked=!0,this.red=t,this.green=e,this.blue=n,this.alpha=i,this._locked=!1,this.update(r)},setGLTo:function(t,e,n,i){return void 0===i&&(i=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=n,this.alphaGL=i,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,n){return o(t,e,n,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var e=this.r,n=this.g,i=this.b,o=this.a;return this._color=r(e,n,i),this._color32=s(e,n,i,o),this._rgba="rgba("+e+","+n+","+i+","+o/255+")",t&&a(e,n,i,this),this},updateHSV:function(){var t=this.r,e=this.g,n=this.b;return a(t,e,n,this),this},clone:function(){return new h(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t)),i=Math.floor(t+Math.random()*(e-t)),r=Math.floor(t+Math.random()*(e-t));return this.setTo(n,i,r)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t));return this.setTo(n,n,n)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,n=this.g,i=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),this.setTo(e,n,i)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,o(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,o(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,o(this._h,this._s,t,this)}}});t.exports=h},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new i(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z;return this.x=n*o-i*s,this.y=i*r-e*o,this.z=e*s-n*r,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=e*r[0]+n*r[3]+i*r[6],this.y=e*r[1]+n*r[4]+i*r[7],this.z=e*r[2]+n*r[5]+i*r[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=e*r[0]+n*r[4]+i*r[8]+r[12],o=e*r[1]+n*r[5]+i*r[9]+r[13],a=e*r[2]+n*r[6]+i*r[10]+r[14],h=e*r[3]+n*r[7]+i*r[11]+r[15];return this.x=s/h,this.y=o/h,this.z=a/h,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,h=a*e+s*i-o*n,u=a*n+o*e-r*i,c=a*i+r*n-s*e,l=-r*e-s*n-o*i;return this.x=h*a+l*-r+u*-o-c*-s,this.y=u*a+l*-s+c*-r-h*-o,this.z=c*a+l*-o+h*-s-u*-r,this},project:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=r[0],o=r[1],a=r[2],h=r[3],u=r[4],c=r[5],l=r[6],f=r[7],d=r[8],p=r[9],v=r[10],g=r[11],m=r[12],y=r[13],x=r[14],b=1/(e*h+n*f+i*g+r[15]);return this.x=(e*s+n*u+i*d+m)*b,this.y=(e*o+n*c+i*p+y)*b,this.z=(e*a+n*l+i*v+x)*b,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var n=t.x,i=t.y,r=t.z,s=t.w,o=this.x-n,a=s-this.y-1-i,h=this.z;return this.x=2*o/r-1,this.y=2*a/s-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},function(t,e){t.exports={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3}},function(t,e,n){var i={};t.exports=i;var r=n(63),s=n(84),o=n(165),a=n(32),h=n(85),u=n(271);!function(){i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i.create=function(e){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:null,position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},previousPositionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inverseMass:0,inertia:0,inverseInertia:0,_original:null,render:{visible:!0,opacity:1,sprite:{xOffset:0,yOffset:0},fillColor:null,fillOpacity:null,lineColor:null,lineOpacity:null,lineThickness:null},gameObject:null,scale:{x:1,y:1},centerOfMass:{x:0,y:0},centerOffset:{x:0,y:0},gravityScale:{x:1,y:1},ignoreGravity:!1,ignorePointer:!1,onCollideCallback:null,onCollideEndCallback:null,onCollideActiveCallback:null,onCollideWith:{}};!e.hasOwnProperty("position")&&e.hasOwnProperty("vertices")?e.position=r.centre(e.vertices):e.hasOwnProperty("vertices")||(n.vertices=r.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"));var i=a.extend(n,e);return t(i,e),i.setOnCollideWith=function(t,e){return e?this.onCollideWith[t.id]=e:delete this.onCollideWith[t.id],this},i},i.nextGroup=function(t){return t?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var t=function(t,e){e=e||{},i.set(t,{bounds:t.bounds||h.create(t.vertices),positionPrev:t.positionPrev||s.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t});var n=t.bounds;if(r.rotate(t.vertices,t.angle,t.position),u.rotate(t.axes,t.angle),h.update(n,t.vertices,t.velocity),i.set(t,{axes:e.axes||t.axes,area:e.area||t.area,mass:e.mass||t.mass,inertia:e.inertia||t.inertia}),1===t.parts.length){var o=t.centerOfMass,a=t.centerOffset,c=n.max.x-n.min.x,l=n.max.y-n.min.y;o.x=-(n.min.x-t.position.x)/c,o.y=-(n.min.y-t.position.y)/l,a.x=c*o.x,a.y=l*o.y}};i.set=function(t,e,n){var r;for(r in"string"==typeof e&&(r=e,(e={})[r]=n),e)if(Object.prototype.hasOwnProperty.call(e,r))switch(n=e[r],r){case"isStatic":i.setStatic(t,n);break;case"isSleeping":o.set(t,n);break;case"mass":i.setMass(t,n);break;case"density":i.setDensity(t,n);break;case"inertia":i.setInertia(t,n);break;case"vertices":i.setVertices(t,n);break;case"position":i.setPosition(t,n);break;case"angle":i.setAngle(t,n);break;case"velocity":i.setVelocity(t,n);break;case"angularVelocity":i.setAngularVelocity(t,n);break;case"parts":i.setParts(t,n);break;case"centre":i.setCentre(t,n);break;default:t[r]=n}},i.setStatic=function(t,e){for(var n=0;n<t.parts.length;n++){var i=t.parts[n];i.isStatic=e,e?(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia},i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null)}},i.setMass=function(t,e){var n=t.inertia/(t.mass/6);t.inertia=n*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},i.setDensity=function(t,e){i.setMass(t,e*t.area),t.density=e},i.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},i.setVertices=function(t,e){e[0].body===t?t.vertices=e:t.vertices=r.create(e,t),t.axes=u.fromVertices(t.vertices),t.area=r.area(t.vertices),i.setMass(t,t.density*t.area);var n=r.centre(t.vertices);r.translate(t.vertices,n,-1),i.setInertia(t,i._inertiaScale*r.inertia(t.vertices,t.mass)),r.translate(t.vertices,t.position),h.update(t.bounds,t.vertices,t.velocity)},i.setParts=function(t,e,n){var s;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,s=0;s<e.length;s++){var o=e[s];o!==t&&(o.parent=t,t.parts.push(o))}if(1!==t.parts.length){if(n=void 0===n||n){var a=[];for(s=0;s<e.length;s++)a=a.concat(e[s].vertices);r.clockwiseSort(a);var u=r.hull(a),c=r.centre(u);i.setVertices(t,u),r.translate(t.vertices,c)}var l=i._totalProperties(t),f=l.centre.x,d=l.centre.y,p=t.bounds,v=t.centerOfMass,g=t.centerOffset;h.update(p,t.vertices,t.velocity),v.x=-(p.min.x-f)/(p.max.x-p.min.x),v.y=-(p.min.y-d)/(p.max.y-p.min.y),g.x=f,g.y=d,t.area=l.area,t.parent=t,t.position.x=f,t.position.y=d,t.positionPrev.x=f,t.positionPrev.y=d,i.setMass(t,l.mass),i.setInertia(t,l.inertia),i.setPosition(t,l.centre)}},i.setCentre=function(t,e,n){n?(t.positionPrev.x+=e.x,t.positionPrev.y+=e.y,t.position.x+=e.x,t.position.y+=e.y):(t.positionPrev.x=e.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=e.y-(t.position.y-t.positionPrev.y),t.position.x=e.x,t.position.y=e.y)},i.setPosition=function(t,e){var n=s.sub(e,t.position);t.positionPrev.x+=n.x,t.positionPrev.y+=n.y;for(var i=0;i<t.parts.length;i++){var o=t.parts[i];o.position.x+=n.x,o.position.y+=n.y,r.translate(o.vertices,n),h.update(o.bounds,o.vertices,t.velocity)}},i.setAngle=function(t,e){var n=e-t.angle;t.anglePrev+=n;for(var i=0;i<t.parts.length;i++){var o=t.parts[i];o.angle+=n,r.rotate(o.vertices,n,t.position),u.rotate(o.axes,n),h.update(o.bounds,o.vertices,t.velocity),i>0&&s.rotateAbout(o.position,n,t.position,o.position)}},i.setVelocity=function(t,e){t.positionPrev.x=t.position.x-e.x,t.positionPrev.y=t.position.y-e.y,t.velocity.x=e.x,t.velocity.y=e.y,t.speed=s.magnitude(t.velocity)},i.setAngularVelocity=function(t,e){t.anglePrev=t.angle-e,t.angularVelocity=e,t.angularSpeed=Math.abs(t.angularVelocity)},i.translate=function(t,e){i.setPosition(t,s.add(t.position,e))},i.rotate=function(t,e,n){if(n){var r=Math.cos(e),s=Math.sin(e),o=t.position.x-n.x,a=t.position.y-n.y;i.setPosition(t,{x:n.x+(o*r-a*s),y:n.y+(o*s+a*r)}),i.setAngle(t,t.angle+e)}else i.setAngle(t,t.angle+e)},i.scale=function(t,e,n,s){var o=0,a=0;s=s||t.position;for(var c=0;c<t.parts.length;c++){var l=t.parts[c];l.scale.x=e,l.scale.y=n,r.scale(l.vertices,e,n,s),l.axes=u.fromVertices(l.vertices),l.area=r.area(l.vertices),i.setMass(l,t.density*l.area),r.translate(l.vertices,{x:-l.position.x,y:-l.position.y}),i.setInertia(l,i._inertiaScale*r.inertia(l.vertices,l.mass)),r.translate(l.vertices,{x:l.position.x,y:l.position.y}),c>0&&(o+=l.area,a+=l.inertia),l.position.x=s.x+(l.position.x-s.x)*e,l.position.y=s.y+(l.position.y-s.y)*n,h.update(l.bounds,l.vertices,t.velocity)}t.parts.length>1&&(t.area=o,t.isStatic||(i.setMass(t,t.density*o),i.setInertia(t,a))),t.circleRadius&&(e===n?t.circleRadius*=e:t.circleRadius=null)},i.update=function(t,e,n,i){var o=Math.pow(e*n*t.timeScale,2),a=1-t.frictionAir*n*t.timeScale,c=t.position.x-t.positionPrev.x,l=t.position.y-t.positionPrev.y;t.velocity.x=c*a*i+t.force.x/t.mass*o,t.velocity.y=l*a*i+t.force.y/t.mass*o,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*a*i+t.torque/t.inertia*o,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=s.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var f=0;f<t.parts.length;f++){var d=t.parts[f];r.translate(d.vertices,t.velocity),f>0&&(d.position.x+=t.velocity.x,d.position.y+=t.velocity.y),0!==t.angularVelocity&&(r.rotate(d.vertices,t.angularVelocity,t.position),u.rotate(d.axes,t.angularVelocity),f>0&&s.rotateAbout(d.position,t.angularVelocity,t.position,d.position)),h.update(d.bounds,d.vertices,t.velocity)}},i.applyForce=function(t,e,n){t.force.x+=n.x,t.force.y+=n.y;var i=e.x-t.position.x,r=e.y-t.position.y;t.torque+=i*n.y-r*n.x},i._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===t.parts.length?0:1;n<t.parts.length;n++){var i=t.parts[n],r=i.mass!==1/0?i.mass:1;e.mass+=r,e.area+=i.area,e.inertia+=i.inertia,e.centre=s.add(e.centre,s.mult(i.position,r))}return e.centre=s.div(e.centre,e.mass),e}}()},function(t,e){t.exports=function(t){return t.y+t.height-t.height*t.originY}},function(t,e){t.exports=function(t){return t.x-t.width*t.originX}},function(t,e){t.exports=function(t){return t.x+t.width-t.width*t.originX}},function(t,e){t.exports=function(t){return t.y-t.height*t.originY}},function(t,e){t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,h=t.length;if(1===s)for(o=r;o<h;o++)t[o][e]+=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]+=n+a*i,a++;return t}},function(t,e,n){var i=n(0),r=n(307),s=n(172),o=n(56),a=n(173),h=n(3),u=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return r(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},getPointA:function(t){return void 0===t&&(t=new h),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new h),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=u},function(t,e){t.exports=function(t,e,n,i){var r=n||e.fillColor,s=i||e.fillAlpha,o=(16711680&r)>>>16,a=(65280&r)>>>8,h=255&r;t.fillStyle="rgba("+o+","+a+","+h+","+s+")"}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){var r=[];i.forEach((function(t){t&&r.push(t)})),this.loader=t,this.type=e,this.key=n,this.multiKeyIndex=t.multiKeyIndex++,this.files=r,this.complete=!1,this.pending=r.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var s=0;s<r.length;s++)r[s].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&this.failed++}});t.exports=i},function(t,e){t.exports=function(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)}},function(t,e,n){t.exports={BOOT:n(921),DESTROY:n(922),DRAG_END:n(923),DRAG_ENTER:n(924),DRAG:n(925),DRAG_LEAVE:n(926),DRAG_OVER:n(927),DRAG_START:n(928),DROP:n(929),GAME_OUT:n(930),GAME_OVER:n(931),GAMEOBJECT_DOWN:n(932),GAMEOBJECT_DRAG_END:n(933),GAMEOBJECT_DRAG_ENTER:n(934),GAMEOBJECT_DRAG:n(935),GAMEOBJECT_DRAG_LEAVE:n(936),GAMEOBJECT_DRAG_OVER:n(937),GAMEOBJECT_DRAG_START:n(938),GAMEOBJECT_DROP:n(939),GAMEOBJECT_MOVE:n(940),GAMEOBJECT_OUT:n(941),GAMEOBJECT_OVER:n(942),GAMEOBJECT_POINTER_DOWN:n(943),GAMEOBJECT_POINTER_MOVE:n(944),GAMEOBJECT_POINTER_OUT:n(945),GAMEOBJECT_POINTER_OVER:n(946),GAMEOBJECT_POINTER_UP:n(947),GAMEOBJECT_POINTER_WHEEL:n(948),GAMEOBJECT_UP:n(949),GAMEOBJECT_WHEEL:n(950),MANAGER_BOOT:n(951),MANAGER_PROCESS:n(952),MANAGER_UPDATE:n(953),POINTER_DOWN:n(954),POINTER_DOWN_OUTSIDE:n(955),POINTER_MOVE:n(956),POINTER_OUT:n(957),POINTER_OVER:n(958),POINTER_UP:n(959),POINTER_UP_OUTSIDE:n(960),POINTER_WHEEL:n(961),POINTERLOCK_CHANGE:n(962),PRE_UPDATE:n(963),SHUTDOWN:n(964),START:n(965),UPDATE:n(966)}},function(t,e){t.exports=function(t,e){return t.y=e+t.height*t.originY,t}},function(t,e){t.exports=function(t,e){return t.x=e+t.width*t.originX,t}},function(t,e){t.exports=function(t,e){return t.x=e-t.width+t.width*t.originX,t}},function(t,e){t.exports=function(t,e){return t.y=e-t.height+t.height*t.originY,t}},function(t,e){t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},function(t,e){t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},function(t,e,n){var i=n(0),r=n(175),s=n(9),o=n(374),a=n(2),h=n(69),u=n(92),c=n(142),l=n(12),f=n(375),d=new i({Extends:s,initialize:function(t){s.call(this);var e=t.game,n=e.renderer,i=n.gl;this.name=a(t,"name","WebGLPipeline"),this.game=e,this.renderer=n,this.manager,this.gl=i,this.view=e.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.topology=a(t,"topology",i.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.currentUnit=0,this.forceZero=a(t,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=t,this.glReset=!1},boot:function(){var t,e=this.gl,n=this.config,i=this.renderer;this.isPostFX||(this.projectionMatrix=(new h).identity());var r=this.renderTargets,s=a(n,"renderTarget",!1);"boolean"==typeof s&&s&&(s=1);var l=i.width,f=i.height;if("number"==typeof s)for(t=0;t<s;t++)r.push(new c(i,l,f,1,0,!0));else if(Array.isArray(s))for(t=0;t<s.length;t++){var d=a(s[t],"scale",1),p=a(s[t],"minFilter",0),v=a(s[t],"autoClear",1);r.push(new c(i,l,f,d,p,v))}r.length&&(this.currentRenderTarget=r[0]),this.setShadersFromConfig(n);var g=this.shaders,m=0;for(t=0;t<g.length;t++)g[t].vertexSize>m&&(m=g[t].vertexSize);var y=a(n,"batchSize",i.config.batchSize);this.vertexCapacity=6*y;var x=new ArrayBuffer(this.vertexCapacity*m);this.vertexData=x,this.bytes=new Uint8Array(x),this.vertexViewF32=new Float32Array(x),this.vertexViewU32=new Uint32Array(x);var b=a(n,"vertices",null);for(b?(this.vertexViewF32.set(b),this.vertexBuffer=i.createVertexBuffer(x,e.STATIC_DRAW)):this.vertexBuffer=i.createVertexBuffer(x.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=g.length-1;t>=0;t--)g[t].rebind();this.hasBooted=!0,i.on(u.RESIZE,this.resize,this),i.on(u.PRE_RENDER,this.onPreRender,this),i.on(u.RENDER,this.onRender,this),i.on(u.POST_RENDER,this.onPostRender,this),this.emit(o.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e){var n=this.renderer;return t===this.currentShader&&n.currentProgram===this.currentShader.program||(this.flush(),n.resetTextures(),this.setVertexBuffer()&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t),this},getShaderByName:function(t){for(var e=this.shaders,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},setShadersFromConfig:function(t){var e,n=this.shaders,i=this.renderer;for(e=0;e<n.length;e++)n[e].destroy();var s="vertShader",o="fragShader",h="attributes",u=a(t,s,null),c=l.parseFragmentShaderMaxTextures(a(t,o,null),i.maxTextures),d=a(t,h,null),p=a(t,"shaders",[]),v=p.length;if(0===v)u&&c&&(this.shaders=[new f(this,"default",u,c,r(d))]);else{var g=[];for(e=0;e<v;e++){var m=p[e],y=a(m,"name","default"),x=a(m,s,u),b=l.parseFragmentShaderMaxTextures(a(m,o,c),i.maxTextures),w=a(m,h,d);x&&b&&g.push(new f(this,y,x,b,r(w)))}this.shaders=g}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},setGameObject:function(t,e){return void 0===e&&(e=t.frame),this.currentUnit=this.renderer.setTextureSource(e.source),this.currentUnit},shouldFlush:function(t){return void 0===t&&(t=0),this.vertexCount+t>this.vertexCapacity},resize:function(t,e){t===this.width&&e===this.height||this.flush(),this.width=t,this.height=e;for(var n=this.renderTargets,i=0;i<n.length;i++)n[i].resize(t,e);return this.setProjectionMatrix(t,e),this.emit(o.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var n=this.projectionMatrix;if(!n)return this;this.projectionWidth=t,this.projectionHeight=e,n.ortho(0,t,e,0,-1e3,1e3);for(var i=this.shaders,r="uProjectionMatrix",s=0;s<i.length;s++){var o=i[s];o.hasUniform(r)&&(o.resetUniform(r),o.setMatrix4fv(r,!1,n.val,o))}return this},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;this.projectionWidth===t&&this.projectionHeight===e||this.setProjectionMatrix(t,e)}},bind:function(t){if(void 0===t&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=this.setVertexBuffer();return t.bind(e),this.currentShader=t,this.emit(o.BIND,this,t),this.onActive(t),this},rebind:function(t){this.setVertexBuffer();for(var e=this.shaders,n=e.length-1;n>=0;n--){var i=e[n].rebind();t&&i!==t||(this.currentShader=i)}return this.emit(o.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},setVertexBuffer:function(){var t=this.gl,e=this.vertexBuffer;return t.getParameter(t.ARRAY_BUFFER_BINDING)!==e&&(t.bindBuffer(t.ARRAY_BUFFER,e),!0)},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(void 0===t&&(t=!1),this.vertexCount>0){this.emit(o.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,n=this.vertexCount,i=this.currentShader.vertexSize;this.active&&(this.setVertexBuffer(),n===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,n*i)),e.drawArrays(this.topology,0,n)),this.vertexCount=0,this.emit(o.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,n,i,r,s,o){var a=this.vertexViewF32,h=this.vertexViewU32,u=this.vertexCount*this.currentShader.vertexComponentCount-1;a[++u]=t,a[++u]=e,a[++u]=n,a[++u]=i,a[++u]=r,a[++u]=s,h[++u]=o,this.vertexCount++},batchQuad:function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x){void 0===x&&(x=this.currentUnit);var b=!1;return this.shouldFlush(6)&&(this.flush(),b=!0,x=this.setTexture2D(y)),this.batchVert(e,n,u,c,x,m,d),this.batchVert(i,r,u,f,x,m,v),this.batchVert(s,o,l,f,x,m,g),this.batchVert(e,n,u,c,x,m,d),this.batchVert(s,o,l,f,x,m,g),this.batchVert(a,h,l,c,x,m,p),this.onBatch(t),b},batchTri:function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p,v,g){void 0===g&&(g=this.currentUnit);var m=!1;return this.shouldFlush(3)&&(this.flush(),m=!0,g=this.setTexture2D(v)),this.batchVert(e,n,a,h,g,p,l),this.batchVert(i,r,a,c,g,p,f),this.batchVert(s,o,u,c,g,p,d),this.onBatch(t),m},drawFillRect:function(t,e,n,i,r,s,o,a){void 0===o&&(o=this.renderer.whiteTexture.glTexture),void 0===a&&(a=!0),t=Math.floor(t),e=Math.floor(e);var h=Math.floor(t+n),u=Math.floor(e+i),c=this.setTexture2D(o),f=l.getTintAppendFloatAlphaAndSwap(r,s),d=0,p=1;a&&(d=1,p=0),this.batchQuad(null,t,e,t,u,h,u,h,e,0,d,1,p,f,f,f,f,0,o,c)},setTexture2D:function(t){return void 0===t&&(t=this.renderer.whiteTexture.glTexture),this.currentUnit=this.renderer.setTexture2D(t),this.currentUnit},bindTexture:function(t,e){void 0===e&&(e=0);var n=this.gl;return n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,t),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t){return this.set1f(t,this.game.loop.getDuration()),this},set1f:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1f(t,e),this},set2f:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.set2f(t,e,n),this},set3f:function(t,e,n,i,r){return void 0===r&&(r=this.currentShader),r.set3f(t,e,n,i),this},set4f:function(t,e,n,i,r,s){return void 0===s&&(s=this.currentShader),s.set4f(t,e,n,i,r),this},set1fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1fv(t,e),this},set2fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set2fv(t,e),this},set3fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set3fv(t,e),this},set4fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set4fv(t,e),this},set1iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1iv(t,e),this},set2iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set2iv(t,e),this},set3iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set3iv(t,e),this},set4iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set4iv(t,e),this},set1i:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1i(t,e),this},set2i:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.set2i(t,e,n),this},set3i:function(t,e,n,i,r){return void 0===r&&(r=this.currentShader),r.set3i(t,e,n,i),this},set4i:function(t,e,n,i,r,s){return void 0===s&&(s=this.currentShader),s.set4i(t,e,n,i,r),this},setMatrix2fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix2fv(t,e,n),this},setMatrix3fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix3fv(t,e,n),this},setMatrix4fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix4fv(t,e,n),this},destroy:function(){var t;this.emit(o.DESTROY,this);var e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var n=this.renderTargets;for(t=0;t<n.length;t++)n[t].destroy();this.gl.deleteBuffer(this.vertexBuffer);var i=this.renderer;return i.off(u.RESIZE,this.resize,this),i.off(u.PRE_RENDER,this.onPreRender,this),i.off(u.RENDER,this.onRender,this),i.off(u.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this}});t.exports=d},function(t,e){t.exports=function(t,e,n,i){var r=n||e.strokeColor,s=i||e.strokeAlpha,o=(16711680&r)>>>16,a=(65280&r)>>>8,h=255&r;t.strokeStyle="rgba("+o+","+a+","+h+","+s+")",t.lineWidth=e.lineWidth}},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(6),u=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,o){var c="json";if(u(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"xhrSettings"),c=a(l,"extension",c),o=a(l,"dataKey",o)}var f={type:"json",cache:t.cacheManager.json,extension:c,responseType:"text",key:e,url:n,xhrSettings:i,config:o};s.call(this,t,f),u(n)&&(this.data=o?h(n,o):n,this.state=r.FILE_POPULATED)},onProcess:function(){if(this.state!==r.FILE_POPULATED){this.state=r.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw console.warn("Invalid JSON: "+this.key),this.onProcessError(),t}var e=this.config;this.data="string"==typeof e?h(t,e,t):t}this.onProcessComplete()}});o.register("json",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new c(this,t[r]));else this.addFile(new c(this,t,e,i,n));return this})),t.exports=c},function(t,e){t.exports={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14}},function(t,e,n){var i=n(158),r=n(26);t.exports=function(t,e,n,s,o){for(var a=null,h=null,u=null,c=null,l=r(t,e,n,s,null,o),f=0;f<l.length;f++){var d=l[f];d&&(d.collides?(a=i(d.x,d.y-1,!0,o),h=i(d.x,d.y+1,!0,o),u=i(d.x-1,d.y,!0,o),c=i(d.x+1,d.y,!0,o),d.faceTop=!a||!a.collides,d.faceBottom=!h||!h.collides,d.faceLeft=!u||!u.collides,d.faceRight=!c||!c.collides):d.resetFaces())}}},function(t,e,n){var i={};t.exports=i;var r=n(84),s=n(32);i.create=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],s={x:r.x,y:r.y,index:i,body:e,isInternal:!1,contact:null,offset:null};s.contact={vertex:s,normalImpulse:0,tangentImpulse:0},n.push(s)}return n},i.fromPath=function(t,e){var n=[];return t.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(t,e,i){n.push({x:parseFloat(e),y:parseFloat(i)})})),i.create(n,e)},i.centre=function(t){for(var e,n,s,o=i.area(t,!0),a={x:0,y:0},h=0;h<t.length;h++)s=(h+1)%t.length,e=r.cross(t[h],t[s]),n=r.mult(r.add(t[h],t[s]),e),a=r.add(a,n);return r.div(a,6*o)},i.mean=function(t){for(var e={x:0,y:0},n=0;n<t.length;n++)e.x+=t[n].x,e.y+=t[n].y;return r.div(e,t.length)},i.area=function(t,e){for(var n=0,i=t.length-1,r=0;r<t.length;r++)n+=(t[i].x-t[r].x)*(t[i].y+t[r].y),i=r;return e?n/2:Math.abs(n)/2},i.inertia=function(t,e){for(var n,i,s=0,o=0,a=t,h=0;h<a.length;h++)i=(h+1)%a.length,s+=(n=Math.abs(r.cross(a[i],a[h])))*(r.dot(a[i],a[i])+r.dot(a[i],a[h])+r.dot(a[h],a[h])),o+=n;return e/6*(s/o)},i.translate=function(t,e,n){var i;if(n)for(i=0;i<t.length;i++)t[i].x+=e.x*n,t[i].y+=e.y*n;else for(i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y;return t},i.rotate=function(t,e,n){if(0!==e){for(var i=Math.cos(e),r=Math.sin(e),s=0;s<t.length;s++){var o=t[s],a=o.x-n.x,h=o.y-n.y;o.x=n.x+(a*i-h*r),o.y=n.y+(a*r+h*i)}return t}},i.contains=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=t[(n+1)%t.length];if((e.x-i.x)*(r.y-i.y)+(e.y-i.y)*(i.x-r.x)>0)return!1}return!0},i.scale=function(t,e,n,s){if(1===e&&1===n)return t;var o,a;s=s||i.centre(t);for(var h=0;h<t.length;h++)o=t[h],a=r.sub(o,s),t[h].x=s.x+a.x*e,t[h].y=s.y+a.y*n;return t},i.chamfer=function(t,e,n,i,o){e="number"==typeof e?[e]:e||[8],n=void 0!==n?n:-1,i=i||2,o=o||14;for(var a=[],h=0;h<t.length;h++){var u=t[h-1>=0?h-1:t.length-1],c=t[h],l=t[(h+1)%t.length],f=e[h<e.length?h:e.length-1];if(0!==f){var d=r.normalise({x:c.y-u.y,y:u.x-c.x}),p=r.normalise({x:l.y-c.y,y:c.x-l.x}),v=Math.sqrt(2*Math.pow(f,2)),g=r.mult(s.clone(d),f),m=r.normalise(r.mult(r.add(d,p),.5)),y=r.sub(c,r.mult(m,v)),x=n;-1===n&&(x=1.75*Math.pow(f,.32)),(x=s.clamp(x,i,o))%2==1&&(x+=1);for(var b=Math.acos(r.dot(d,p))/x,w=0;w<x;w++)a.push(r.add(r.rotate(g,b*w),y))}else a.push(c)}return a},i.clockwiseSort=function(t){var e=i.mean(t);return t.sort((function(t,n){return r.angle(e,t)-r.angle(e,n)})),t},i.isConvex=function(t){var e,n,i,r,s=0,o=t.length;if(o<3)return null;for(e=0;e<o;e++)if(i=(e+2)%o,r=(t[n=(e+1)%o].x-t[e].x)*(t[i].y-t[n].y),(r-=(t[n].y-t[e].y)*(t[i].x-t[n].x))<0?s|=1:r>0&&(s|=2),3===s)return!1;return 0!==s||null},i.hull=function(t){var e,n,i=[],s=[];for((t=t.slice(0)).sort((function(t,e){var n=t.x-e.x;return 0!==n?n:t.y-e.y})),n=0;n<t.length;n+=1){for(e=t[n];s.length>=2&&r.cross3(s[s.length-2],s[s.length-1],e)<=0;)s.pop();s.push(e)}for(n=t.length-1;n>=0;n-=1){for(e=t[n];i.length>=2&&r.cross3(i[i.length-2],i[i.length-1],e)<=0;)i.pop();i.push(e)}return i.pop(),s.pop(),i.concat(s)}},function(t,e,n){var i=n(0),r=n(65),s=n(300),o=n(301),a=n(56),h=n(170),u=new i({initialize:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.type=a.CIRCLE,this.x=t,this.y=e,this._radius=n,this._diameter=2*n},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return h(this,t)},setTo:function(t,e,n){return this.x=t,this.y=e,this._radius=n,this._diameter=2*n,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});t.exports=u},function(t,e){t.exports=function(t,e,n){return t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-n)*(t.y-n)<=t.radius*t.radius}},function(t,e){t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},function(t,e){t.exports={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline"}},function(t,e){t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},function(t,e,n){var i=n(0),r=n(39),s=1e-6,o=new i({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new o(this)},set:function(t){return this.copy(t)},setValues:function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p,v){var g=this.val;return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=r,g[5]=s,g[6]=o,g[7]=a,g[8]=h,g[9]=u,g[10]=c,g[11]=l,g[12]=f,g[13]=d,g[14]=p,g[15]=v,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,n){var i=a.fromQuat(n).val,r=e.x,s=e.y,o=e.z;return this.setValues(i[0]*r,i[1]*r,i[2]*r,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],r=t[6],s=t[7],o=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=r,t[11]=t[14],t[12]=i,t[13]=s,t[14]=o,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],f=t[11],d=t[12],p=t[13],v=t[14],g=t[15],m=e*o-n*s,y=e*a-i*s,x=e*h-r*s,b=n*a-i*o,w=n*h-r*o,_=i*h-r*a,T=u*p-c*d,E=u*v-l*d,S=u*g-f*d,C=c*v-l*p,A=c*g-f*p,I=l*g-f*v,P=m*I-y*A+x*C+b*S-w*E+_*T;return P?(P=1/P,this.setValues((o*I-a*A+h*C)*P,(i*A-n*I-r*C)*P,(p*_-v*w+g*b)*P,(l*w-c*_-f*b)*P,(a*S-s*I-h*E)*P,(e*I-i*S+r*E)*P,(v*x-d*_-g*y)*P,(u*_-l*x+f*y)*P,(s*A-o*S+h*T)*P,(n*S-e*A-r*T)*P,(d*w-p*x+g*m)*P,(c*x-u*w-f*m)*P,(o*E-s*C-a*T)*P,(e*C-n*E+i*T)*P,(p*y-d*b-v*m)*P,(u*b-c*y+l*m)*P)):this},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],f=t[11],d=t[12],p=t[13],v=t[14],g=t[15];return this.setValues(o*(l*g-f*v)-c*(a*g-h*v)+p*(a*f-h*l),-(n*(l*g-f*v)-c*(i*g-r*v)+p*(i*f-r*l)),n*(a*g-h*v)-o*(i*g-r*v)+p*(i*h-r*a),-(n*(a*f-h*l)-o*(i*f-r*l)+c*(i*h-r*a)),-(s*(l*g-f*v)-u*(a*g-h*v)+d*(a*f-h*l)),e*(l*g-f*v)-u*(i*g-r*v)+d*(i*f-r*l),-(e*(a*g-h*v)-s*(i*g-r*v)+d*(i*h-r*a)),e*(a*f-h*l)-s*(i*f-r*l)+u*(i*h-r*a),s*(c*g-f*p)-u*(o*g-h*p)+d*(o*f-h*c),-(e*(c*g-f*p)-u*(n*g-r*p)+d*(n*f-r*c)),e*(o*g-h*p)-s*(n*g-r*p)+d*(n*h-r*o),-(e*(o*f-h*c)-s*(n*f-r*c)+u*(n*h-r*o)),-(s*(c*v-l*p)-u*(o*v-a*p)+d*(o*l-a*c)),e*(c*v-l*p)-u*(n*v-i*p)+d*(n*l-i*c),-(e*(o*v-a*p)-s*(n*v-i*p)+d*(n*a-i*o)),e*(o*l-a*c)-s*(n*l-i*c)+u*(n*a-i*o))},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],f=t[11],d=t[12],p=t[13],v=t[14],g=t[15];return(e*o-n*s)*(l*g-f*v)-(e*a-i*s)*(c*g-f*p)+(e*h-r*s)*(c*v-l*p)+(n*a-i*o)*(u*g-f*d)-(n*h-r*o)*(u*v-l*d)+(i*h-r*a)*(u*p-c*d)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=t.val,x=y[0],b=y[1],w=y[2],_=y[3];return e[0]=x*n+b*o+w*c+_*p,e[1]=x*i+b*a+w*l+_*v,e[2]=x*r+b*h+w*f+_*g,e[3]=x*s+b*u+w*d+_*m,x=y[4],b=y[5],w=y[6],_=y[7],e[4]=x*n+b*o+w*c+_*p,e[5]=x*i+b*a+w*l+_*v,e[6]=x*r+b*h+w*f+_*g,e[7]=x*s+b*u+w*d+_*m,x=y[8],b=y[9],w=y[10],_=y[11],e[8]=x*n+b*o+w*c+_*p,e[9]=x*i+b*a+w*l+_*v,e[10]=x*r+b*h+w*f+_*g,e[11]=x*s+b*u+w*d+_*m,x=y[12],b=y[13],w=y[14],_=y[15],e[12]=x*n+b*o+w*c+_*p,e[13]=x*i+b*a+w*l+_*v,e[14]=x*r+b*h+w*f+_*g,e[15]=x*s+b*u+w*d+_*m,this},multiplyLocal:function(t){var e=this.val,n=t.val;return this.setValues(e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.val,i=e.val,r=n[0],s=n[4],o=n[8],a=n[12],h=n[1],u=n[5],c=n[9],l=n[13],f=n[2],d=n[6],p=n[10],v=n[14],g=n[3],m=n[7],y=n[11],x=n[15],b=i[0],w=i[4],_=i[8],T=i[12],E=i[1],S=i[5],C=i[9],A=i[13],I=i[2],P=i[6],R=i[10],O=i[14],k=i[3],M=i[7],D=i[11],L=i[15];return this.setValues(r*b+s*E+o*I+a*k,h*b+u*E+c*I+l*k,f*b+d*E+p*I+v*k,g*b+m*E+y*I+x*k,r*w+s*S+o*P+a*M,h*w+u*S+c*P+l*M,f*w+d*S+p*P+v*M,g*w+m*S+y*P+x*M,r*_+s*C+o*R+a*D,h*_+u*C+c*R+l*D,f*_+d*C+p*R+v*D,g*_+m*C+y*R+x*D,r*T+s*A+o*O+a*L,h*T+u*A+c*O+l*L,f*T+d*A+p*O+v*L,g*T+m*A+y*O+x*L)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,o=t.y,a=t.z,h=r*s,u=r*o;return this.setValues(h*s+n,h*o-i*a,h*a+i*o,0,h*o+i*a,u*o+n,u*a-i*s,0,h*a-i*o,u*a+i*s,r*a*a+n,0,0,0,0,1)},rotate:function(t,e){var n=this.val,i=e.x,r=e.y,o=e.z,a=Math.sqrt(i*i+r*r+o*o);if(Math.abs(a)<s)return this;i*=a=1/a,r*=a,o*=a;var h=Math.sin(t),u=Math.cos(t),c=1-u,l=n[0],f=n[1],d=n[2],p=n[3],v=n[4],g=n[5],m=n[6],y=n[7],x=n[8],b=n[9],w=n[10],_=n[11],T=n[12],E=n[13],S=n[14],C=n[15],A=i*i*c+u,I=r*i*c+o*h,P=o*i*c-r*h,R=i*r*c-o*h,O=r*r*c+u,k=o*r*c+i*h,M=i*o*c+r*h,D=r*o*c-i*h,L=o*o*c+u;return this.setValues(l*A+v*I+x*P,f*A+g*I+b*P,d*A+m*I+w*P,p*A+y*I+_*P,l*R+v*O+x*k,f*R+g*O+b*k,d*R+m*O+w*k,p*R+y*O+_*k,l*M+v*D+x*L,f*M+g*D+b*L,d*M+m*D+w*L,p*M+y*D+_*L,T,E,S,C)},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[4],s=e[5],o=e[6],a=e[7],h=e[8],u=e[9],c=e[10],l=e[11];return e[4]=r*i+h*n,e[5]=s*i+u*n,e[6]=o*i+c*n,e[7]=a*i+l*n,e[8]=h*i-r*n,e[9]=u*i-s*n,e[10]=c*i-o*n,e[11]=l*i-a*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],h=e[8],u=e[9],c=e[10],l=e[11];return e[0]=r*i-h*n,e[1]=s*i-u*n,e[2]=o*i-c*n,e[3]=a*i-l*n,e[8]=r*n+h*i,e[9]=s*n+u*i,e[10]=o*n+c*i,e[11]=a*n+l*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],h=e[4],u=e[5],c=e[6],l=e[7];return e[0]=r*i+h*n,e[1]=s*i+u*n,e[2]=o*i+c*n,e[3]=a*i+l*n,e[4]=h*i-r*n,e[5]=u*i-s*n,e[6]=c*i-o*n,e[7]=l*i-a*n,this},fromRotationTranslation:function(t,e){var n=t.x,i=t.y,r=t.z,s=t.w,o=n+n,a=i+i,h=r+r,u=n*o,c=n*a,l=n*h,f=i*a,d=i*h,p=r*h,v=s*o,g=s*a,m=s*h;return this.setValues(1-(f+p),c+m,l-g,0,c-m,1-(u+p),d+v,0,l+g,d-v,1-(u+f),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,o=n+n,a=i+i,h=e*s,u=e*o,c=e*a,l=n*o,f=n*a,d=i*a,p=r*s,v=r*o,g=r*a;return this.setValues(1-(l+d),u+g,c-v,0,u-g,1-(h+d),f+p,0,c+v,f-p,1-(h+l),0,0,0,0,1)},frustum:function(t,e,n,i,r,s){var o=1/(e-t),a=1/(i-n),h=1/(r-s);return this.setValues(2*r*o,0,0,0,0,2*r*a,0,0,(e+t)*o,(i+n)*a,(s+r)*h,-1,0,0,s*r*2*h,0)},perspective:function(t,e,n,i){var r=1/Math.tan(t/2),s=1/(n-i);return this.setValues(r/e,0,0,0,0,r,0,0,0,0,(i+n)*s,-1,0,0,2*i*n*s,0)},perspectiveLH:function(t,e,n,i){return this.setValues(2*n/t,0,0,0,0,2*n/e,0,0,0,0,-i/(n-i),1,0,0,n*i/(n-i),0)},ortho:function(t,e,n,i,r,s){var o=t-e,a=n-i,h=r-s;return o=0===o?o:1/o,a=0===a?a:1/a,h=0===h?h:1/h,this.setValues(-2*o,0,0,0,0,-2*a,0,0,0,0,2*h,0,(t+e)*o,(i+n)*a,(s+r)*h,1)},lookAtRH:function(t,e,n){var i=this.val;return l.subVectors(t,e),0===l.getLengthSquared()&&(l.z=1),l.normalize(),u.crossVectors(n,l),0===u.getLengthSquared()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),u.crossVectors(n,l)),u.normalize(),c.crossVectors(l,u),i[0]=u.x,i[1]=u.y,i[2]=u.z,i[4]=c.x,i[5]=c.y,i[6]=c.z,i[8]=l.x,i[9]=l.y,i[10]=l.z,this},lookAt:function(t,e,n){var i=t.x,r=t.y,o=t.z,a=n.x,h=n.y,u=n.z,c=e.x,l=e.y,f=e.z;if(Math.abs(i-c)<s&&Math.abs(r-l)<s&&Math.abs(o-f)<s)return this.identity();var d=i-c,p=r-l,v=o-f,g=1/Math.sqrt(d*d+p*p+v*v),m=h*(v*=g)-u*(p*=g),y=u*(d*=g)-a*v,x=a*p-h*d;(g=Math.sqrt(m*m+y*y+x*x))?(m*=g=1/g,y*=g,x*=g):(m=0,y=0,x=0);var b=p*x-v*y,w=v*m-d*x,_=d*y-p*m;return(g=Math.sqrt(b*b+w*w+_*_))?(b*=g=1/g,w*=g,_*=g):(b=0,w=0,_=0),this.setValues(m,b,d,0,y,w,p,0,x,_,v,0,-(m*i+y*r+x*o),-(b*i+w*r+_*o),-(d*i+p*r+v*o),1)},yawPitchRoll:function(t,e,n){this.zero(),a.zero(),h.zero();var i=this.val,r=a.val,s=h.val,o=Math.sin(n),u=Math.cos(n);return i[10]=1,i[15]=1,i[0]=u,i[1]=o,i[4]=-o,i[5]=u,o=Math.sin(e),u=Math.cos(e),r[0]=1,r[15]=1,r[5]=u,r[10]=u,r[9]=-o,r[6]=o,o=Math.sin(t),u=Math.cos(t),s[5]=1,s[15]=1,s[0]=u,s[2]=-o,s[8]=o,s[10]=u,this.multiplyLocal(a),this.multiplyLocal(h),this},setWorldMatrix:function(t,e,n,i,r){return this.yawPitchRoll(t.y,t.x,t.z),a.scaling(n.x,n.y,n.z),h.xyz(e.x,e.y,e.z),this.multiplyLocal(a),this.multiplyLocal(h),i&&this.multiplyLocal(i),r&&this.multiplyLocal(r),this},multiplyToMat4:function(t,e){var n=this.val,i=t.val,r=n[0],s=n[1],o=n[2],a=n[3],h=n[4],u=n[5],c=n[6],l=n[7],f=n[8],d=n[9],p=n[10],v=n[11],g=n[12],m=n[13],y=n[14],x=n[15],b=i[0],w=i[1],_=i[2],T=i[3],E=i[4],S=i[5],C=i[6],A=i[7],I=i[8],P=i[9],R=i[10],O=i[11],k=i[12],M=i[13],D=i[14],L=i[15];return e.setValues(b*r+w*h+_*f+T*g,w*s+w*u+_*d+T*m,_*o+w*c+_*p+T*y,T*a+w*l+_*v+T*x,E*r+S*h+C*f+A*g,E*s+S*u+C*d+A*m,E*o+S*c+C*p+A*y,E*a+S*l+C*v+A*x,I*r+P*h+R*f+O*g,I*s+P*u+R*d+O*m,I*o+P*c+R*p+O*y,I*a+P*l+R*v+O*x,k*r+M*h+D*f+L*g,k*s+M*u+D*d+L*m,k*o+M*c+D*p+L*y,k*a+M*l+D*v+L*x)},fromRotationXYTranslation:function(t,e,n){var i=e.x,r=e.y,s=e.z,o=Math.sin(t.x),a=Math.cos(t.x),h=Math.sin(t.y),u=Math.cos(t.y),c=i,l=r,f=s,d=-o,p=0-d*h,v=0-a*h,g=d*u,m=a*u;return n||(c=u*i+h*s,l=p*i+a*r+g*s,f=v*i+o*r+m*s),this.setValues(u,p,v,0,0,a,o,0,h,g,m,0,c,l,f,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}}),a=new o,h=new o,u=new r,c=new r,l=new r;t.exports=o},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,a,h,u,c,d,p,g=e&&e.length,m=g?e[0]*n:t.length,y=r(t,0,m,n,!0),x=[];if(!y||y.next===y.prev)return x;if(g&&(y=function(t,e,n,i){var o,a,h,u=[];for(o=0,a=e.length;o<a;o++)(h=r(t,e[o]*i,o<a-1?e[o+1]*i:t.length,i,!1))===h.next&&(h.steiner=!0),u.push(v(h));for(u.sort(l),o=0;o<u.length;o++)f(u[o],n),n=s(n,n.next);return n}(t,e,y,n)),t.length>80*n){i=h=t[0],a=u=t[1];for(var b=n;b<m;b+=n)(c=t[b])<i&&(i=c),(d=t[b+1])<a&&(a=d),c>h&&(h=c),d>u&&(u=d);p=0!==(p=Math.max(h-i,u-a))?1/p:0}return o(y,x,n,i,a,p),x}function r(t,e,n,i,r){var s,o;if(r===I(t,e,n,i)>0)for(s=e;s<n;s+=i)o=S(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=S(s,t[s],t[s+1],o);return o&&x(o,o.next)&&(C(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!x(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{if(C(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function o(t,e,n,i,r,l,f){if(t){!f&&l&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=p(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,h,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1)}(r)}(t,i,r,l);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,l?h(t,i,r,l):a(t))e.push(d.i/n),e.push(t.i/n),e.push(v.i/n),C(t),t=v.next,g=v.next;else if((t=v)===g){f?1===f?o(t=u(s(t),e,n),e,n,i,r,l,2):2===f&&c(t,e,n,i,r,l):o(s(t),e,n,i,r,l,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(y(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&y(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function h(t,e,n,i){var r=t.prev,s=t,o=t.next;if(y(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,h=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,l=p(a,h,e,n,i),f=p(u,c,e,n,i),d=t.prevZ,v=t.nextZ;d&&d.z>=l&&v&&v.z<=f;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==t.prev&&v!==t.next&&g(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=l;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=f;){if(v!==t.prev&&v!==t.next&&g(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function u(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!x(r,o)&&b(r,i,i.next,o)&&T(r,o)&&T(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),C(i),C(i.next),i=t=o),i=i.next}while(i!==t);return s(i)}function c(t,e,n,i,r,a){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&m(h,u)){var c=E(h,u);return h=s(h,h.next),c=s(c,c.next),o(h,e,n,i,r,a),void o(c,e,n,i,r,a)}u=u.next}h=h.next}while(h!==t)}function l(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var h,u=n,c=n.x,l=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&g(s<l?r:o,s,c,l,s<l?o:r,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(r-i.x),T(i,t)&&(h<f||h===f&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,f=h)),i=i.next}while(i!==u);return n}(t,e)){var n=E(e,t);s(e,e.next),s(n,n.next)}}function d(t,e){return y(t.prev,t,e.prev)<0&&y(e.next,t,t.next)<0}function p(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(T(t,e)&&T(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(y(t.prev,t,e.prev)||y(t,e.prev,e))||x(t,e)&&y(t.prev,t,t.next)>0&&y(e.prev,e,e.next)>0)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,i){var r=_(y(t,e,n)),s=_(y(t,e,i)),o=_(y(n,i,t)),a=_(y(n,i,e));return r!==s&&o!==a||!(0!==r||!w(t,n,e))||!(0!==s||!w(t,i,e))||!(0!==o||!w(n,t,i))||!(0!==a||!w(n,e,i))}function w(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function _(t){return t>0?1:t<0?-1:0}function T(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function E(t,e){var n=new A(t.i,t.x,t.y),i=new A(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function S(t,e,n,i){var r=new A(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}i.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(I(t,0,s,n));if(r)for(var a=0,h=e.length;a<h;a++){var u=e[a]*n,c=a<h-1?e[a+1]*n:t.length;o-=Math.abs(I(t,u,c,n))}var l=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,d=i[a+1]*n,p=i[a+2]*n;l+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},t.exports=i},function(t,e,n){t.exports={COMPLETE:n(986),DECODED:n(987),DECODED_ALL:n(988),DESTROY:n(989),DETUNE:n(990),GLOBAL_DETUNE:n(991),GLOBAL_MUTE:n(992),GLOBAL_RATE:n(993),GLOBAL_VOLUME:n(994),LOOP:n(995),LOOPED:n(996),MUTE:n(997),PAN:n(998),PAUSE_ALL:n(999),PAUSE:n(1e3),PLAY:n(1001),RATE:n(1002),RESUME_ALL:n(1003),RESUME:n(1004),SEEK:n(1005),STOP_ALL:n(1006),STOP:n(1007),UNLOCKED:n(1008),VOLUME:n(1009)}},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function t(e,n,i,r,o){var u,c="png";if(h(n)){var l=n;n=a(l,"key"),i=a(l,"url"),u=a(l,"normalMap"),r=a(l,"xhrSettings"),c=a(l,"extension",c),o=a(l,"frameConfig")}Array.isArray(i)&&(u=i[1],i=i[0]);var f={type:"image",cache:e.textureManager,extension:c,responseType:"blob",key:n,url:i,xhrSettings:r,config:o};if(s.call(this,e,f),u){var d=new t(e,this.key,u,r,o);d.type="normalMap",this.setLink(d),e.addFile(d)}},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){s.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(t.data),t.onProcessError()},s.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var t,e=this.linkFile;e&&e.state===r.FILE_COMPLETE?(t="image"===this.type?this.cache.addImage(this.key,this.data,e.data):this.cache.addImage(e.key,e.data,this.data),this.pendingDestroy(t),e.pendingDestroy(t)):e||(t=this.cache.addImage(this.key,this.data),this.pendingDestroy(t))}});o.register("image",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e){t.exports=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)}},function(t,e,n){var i=n(164),r=n(0),s=n(11),o=n(15),a=n(1062),h=new r({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,a],initialize:function(t,e,n,r,s){o.call(this,t,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(r,s),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return s.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});t.exports=h},function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],r=e;r<n;r++)t[r]=t[r+1];return t.length=n,i}}},function(t,e,n){t.exports={ADDED_TO_SCENE:n(643),DESTROY:n(644),REMOVED_FROM_SCENE:n(645),VIDEO_COMPLETE:n(646),VIDEO_CREATED:n(647),VIDEO_ERROR:n(648),VIDEO_LOOP:n(649),VIDEO_PLAY:n(650),VIDEO_SEEKED:n(651),VIDEO_SEEKING:n(652),VIDEO_STOP:n(653),VIDEO_TIMEOUT:n(654),VIDEO_UNLOCKED:n(655)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t){var e={};for(var n in t)Array.isArray(t[n])?e[n]=t[n].slice(0):e[n]=t[n];return e}},function(t,e){t.exports=function(t,e,n,i){var r=t.length;if(e<0||e>r||e>=n||n>r||e+n>r){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},function(t,e){function n(t,e){return String(t).localeCompare(e)}function i(t,e,n,i){var r,s,o,a,h,u=t.length,c=0,l=2*n;for(r=0;r<u;r+=l)for(o=(s=r+n)+n,s>u&&(s=u),o>u&&(o=u),a=r,h=s;;)if(a<s&&h<o)e(t[a],t[h])<=0?i[c++]=t[a++]:i[c++]=t[h++];else if(a<s)i[c++]=t[a++];else{if(!(h<o))break;i[c++]=t[h++]}}t.exports=function(t,e){void 0===e&&(e=n);var r=function(t,e){var n=t.length;if(n<=1)return t;for(var r=new Array(n),s=1;s<n;s*=2){i(t,e,s,r);var o=t;t=r,r=o}return t}(t,e);return r!==t&&i(r,null,t.length,t),t}},function(t,e,n){var i=n(135),r=n(205);t.exports=function(t,e){var n=i.Power0;if("string"==typeof t)if(i.hasOwnProperty(t))n=i[t];else{var s="";t.indexOf(".")&&("in"===(s=t.substr(t.indexOf(".")+1)).toLowerCase()?s="easeIn":"out"===s.toLowerCase()?s="easeOut":"inout"===s.toLowerCase()&&(s="easeInOut")),t=r(t.substr(0,t.indexOf(".")+1)+s),i.hasOwnProperty(t)&&(n=i[t])}else"function"==typeof t?n=t:Array.isArray(t)&&t.length;if(!e)return n;var o=e.slice(0);return o.unshift(0),function(t){return o[0]=t,n.apply(this,o)}}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,r,s){var o=t.strokeTint,a=i.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*n);o.TL=a,o.TR=a,o.BL=a,o.BR=a;var h=e.pathData,u=h.length-1,c=e.lineWidth,l=c/2,f=h[0]-r,d=h[1]-s;e.closePath||(u-=2);for(var p=2;p<u;p+=2){var v=h[p]-r,g=h[p+1]-s;t.batchLine(f,d,v,g,l,l,c,p-2,!!e.closePath&&p===u-1),f=v,d=g}}},function(t,e,n){var i=n(0),r=n(115),s=n(476),o=n(477),a=n(56),h=n(47),u=n(181),c=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.type=a.TRIANGLE,this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return u(this,t)},setTo:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s,this},getLineA:function(t){return void 0===t&&(t=new h),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new h),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new h),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}}});t.exports=c},function(t,e){var n={};t.exports=n,n.create=function(t,e){return{x:t||0,y:e||0}},n.clone=function(t){return{x:t.x,y:t.y}},n.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},n.rotate=function(t,e,n){var i=Math.cos(e),r=Math.sin(e);n||(n={});var s=t.x*i-t.y*r;return n.y=t.x*r+t.y*i,n.x=s,n},n.rotateAbout=function(t,e,n,i){var r=Math.cos(e),s=Math.sin(e);i||(i={});var o=n.x+((t.x-n.x)*r-(t.y-n.y)*s);return i.y=n.y+((t.x-n.x)*s+(t.y-n.y)*r),i.x=o,i},n.normalise=function(t){var e=n.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},n.dot=function(t,e){return t.x*e.x+t.y*e.y},n.cross=function(t,e){return t.x*e.y-t.y*e.x},n.cross3=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},n.add=function(t,e,n){return n||(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n},n.sub=function(t,e,n){return n||(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},n.mult=function(t,e){return{x:t.x*e,y:t.y*e}},n.div=function(t,e){return{x:t.x/e,y:t.y/e}},n.perp=function(t,e){return{x:(e=!0===e?-1:1)*-t.y,y:e*t.x}},n.neg=function(t){return{x:-t.x,y:-t.y}},n.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(t,e){var n={};t.exports=n,n.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&n.update(e,t),e},n.update=function(t,e,n){t.min.x=1/0,t.max.x=-1/0,t.min.y=1/0,t.max.y=-1/0;for(var i=0;i<e.length;i++){var r=e[i];r.x>t.max.x&&(t.max.x=r.x),r.x<t.min.x&&(t.min.x=r.x),r.y>t.max.y&&(t.max.y=r.y),r.y<t.min.y&&(t.min.y=r.y)}n&&(n.x>0?t.max.x+=n.x:t.min.x+=n.x,n.y>0?t.max.y+=n.y:t.min.y+=n.y)},n.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},n.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},n.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},n.shift=function(t,e){var n=t.max.x-t.min.x,i=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+n,t.min.y=e.y,t.max.y=e.y+i}},function(t,e,n){var i=n(29),r=n(0),s=n(11),o=n(502),a=new r({Mixins:[s.Alpha,s.Flip,s.Visible],initialize:function(t,e,n,i,r,s,o,a){this.layer=t,this.index=e,this.x=n,this.y=i,this.width=r,this.height=s,this.right,this.bottom,this.baseWidth=void 0!==o?o:r,this.baseHeight=void 0!==a?a:s,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,this.collisionCallbackContext=this,this.tint=16777215,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=t.properties,this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldX(this.x,t):this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldY(this.y,t)-(this.height-this.baseHeight)*e.scaleY:this.y*this.baseHeight-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new o),e.x=this.getLeft(),e.y=this.getTop(),e.width=this.getRight()-e.x,e.height=this.getBottom()-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},intersects:function(t,e,n,i){return!(n<=this.pixelX||i<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){return void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,n,i,r){return void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=t),void 0===r&&(r=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=n,this.collideDown=i,this.faceLeft=t,this.faceRight=e,this.faceTop=n,this.faceBottom=i,r&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,n,i){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==n&&(this.baseWidth=n),void 0!==i&&(this.baseHeight=i),this.updatePixelXY(),this},updatePixelXY:function(){var t=this.layer.orientation;if(t===i.ORTHOGONAL)this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight;else if(t===i.ISOMETRIC)this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5;else if(t===i.STAGGERED)this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2);else if(t===i.HEXAGONAL){var e=this.layer.hexSideLength,n=(this.baseHeight-e)/2+e;this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*n}return this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});t.exports=a},function(t,e,n){var i={};t.exports=i;var r=n(63),s=n(32),o=n(41),a=n(85),h=n(84),u=n(1390);i.rectangle=function(t,e,n,i,a){a=a||{};var h={label:"Rectangle Body",position:{x:t,y:e},vertices:r.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var u=a.chamfer;h.vertices=r.chamfer(h.vertices,u.radius,u.quality,u.qualityMin,u.qualityMax),delete a.chamfer}return o.create(s.extend({},h,a))},i.trapezoid=function(t,e,n,i,a,h){h=h||{};var u,c=n*(a*=.5),l=c+(1-2*a)*n,f=l+c;u=a<.5?"L 0 0 L "+c+" "+-i+" L "+l+" "+-i+" L "+f+" 0":"L 0 0 L "+l+" "+-i+" L "+f+" 0";var d={label:"Trapezoid Body",position:{x:t,y:e},vertices:r.fromPath(u)};if(h.chamfer){var p=h.chamfer;d.vertices=r.chamfer(d.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete h.chamfer}return o.create(s.extend({},d,h))},i.circle=function(t,e,n,r,o){r=r||{};var a={label:"Circle Body",circleRadius:n};o=o||25;var h=Math.ceil(Math.max(10,Math.min(o,n)));return h%2==1&&(h+=1),i.polygon(t,e,h,n,s.extend({},a,r))},i.polygon=function(t,e,n,a,h){if(h=h||{},n<3)return i.circle(t,e,a,h);for(var u=2*Math.PI/n,c="",l=.5*u,f=0;f<n;f+=1){var d=l+f*u,p=Math.cos(d)*a,v=Math.sin(d)*a;c+="L "+p.toFixed(3)+" "+v.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:t,y:e},vertices:r.fromPath(c)};if(h.chamfer){var m=h.chamfer;g.vertices=r.chamfer(g.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete h.chamfer}return o.create(s.extend({},g,h))},i.fromVertices=function(t,e,n,a,h,c,l){var f,d,p,v,g,m;for(a=a||{},d=[],h=void 0!==h&&h,c=void 0!==c?c:.01,l=void 0!==l?l:10,u||s.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),s.isArray(n[0])||(n=[n]),m=0;m<n.length;m+=1)if(v=n[m],(p=r.isConvex(v))||!u)v=p?r.clockwiseSort(v):r.hull(v),d.push({position:{x:t,y:e},vertices:v});else{var y=v.map((function(t){return[t.x,t.y]}));u.makeCCW(y),!1!==c&&u.removeCollinearPoints(y,c);var x=u.quickDecomp(y);for(g=0;g<x.length;g++){var b=x[g].map((function(t){return{x:t[0],y:t[1]}}));l>0&&r.area(b)<l||d.push({position:r.centre(b),vertices:b})}}for(g=0;g<d.length;g++)d[g]=o.create(s.extend(d[g],a));return h&&i.flagCoincidentParts(d,5),d.length>1?(f=o.create(s.extend({parts:d.slice(0)},a)),o.setPosition(f,{x:t,y:e}),f):d[0]},i.flagCoincidentParts=function(t,e){void 0===e&&(e=5);for(var n=0;n<t.length;n++)for(var i=t[n],r=n+1;r<t.length;r++){var s=t[r];if(a.overlaps(i.bounds,s.bounds))for(var o=i.vertices,u=s.vertices,c=0;c<i.vertices.length;c++)for(var l=0;l<s.vertices.length;l++){var f=h.magnitudeSquared(h.sub(o[(c+1)%o.length],u[l])),d=h.magnitudeSquared(h.sub(o[c],u[(l+1)%u.length]));f<e&&d<e&&(o[c].isInternal=!0,u[l].isInternal=!0)}}return t}},function(t,e){t.exports=function(t){return t.x-t.width*t.originX+.5*t.width}},function(t,e){t.exports=function(t,e){var n=t.width*t.originX;return t.x=e+n-.5*t.width,t}},function(t,e){t.exports=function(t){return t.y-t.height*t.originY+.5*t.height}},function(t,e){t.exports=function(t,e){var n=t.height*t.originY;return t.y=e+n-.5*t.height,t}},function(t,e,n){t.exports={POST_RENDER:n(628),PRE_RENDER:n(629),RENDER:n(630),RESIZE:n(631)}},function(t,e,n){var i=n(75);t.exports=function(t,e,n,r){var s;if(void 0===r&&(r=t),!Array.isArray(e))return-1!==(s=t.indexOf(e))?(i(t,s),n&&n.call(r,e),e):null;for(var o=e.length-1,a=[];o>=0;){var h=e[o];-1!==(s=t.indexOf(h))&&(i(t,s),a.push(h),n&&n.call(r,h)),o--}return a}},function(t,e,n){var i=n(0),r=n(199),s=n(10),o=n(3),a=new i({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new o,this._tmpVec2B=new o},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,e){t||(t=new s),void 0===e&&(e=16);var n=this.getLength();e>n&&(e=n/2);var i=Math.max(1,Math.round(n/e));return r(this.getSpacedPoints(i),t)},getDistancePoints:function(t){var e=this.getLength(),n=Math.max(1,e/t);return this.getSpacedPoints(n)},getEndPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],i=this.getPoint(0,this._tmpVec2A),r=0;n.push(0);for(var s=1;s<=t;s++)r+=(e=this.getPoint(s/t,this._tmpVec2B)).distance(i),n.push(r),i.copy(e);return this.cacheArcLengths=n,n},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t,e,n){void 0===n&&(n=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var i=0;i<=t;i++)n.push(this.getPoint(i/t));return n},getRandomPoint:function(t){return void 0===t&&(t=new o),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,n){void 0===n&&(n=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var i=0;i<=t;i++){var r=this.getUtoTmapping(i/t,null,t);n.push(this.getPoint(r))}return n},getStartPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new o);var n=1e-4,i=t-n,r=t+n;return i<0&&(i=0),r>1&&(r=1),this.getPoint(i,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,n){var i,r=this.getLengths(n),s=0,o=r.length;i=e?Math.min(e,r[o-1]):t*r[o-1];for(var a,h=0,u=o-1;h<=u;)if((a=r[s=Math.floor(h+(u-h)/2)]-i)<0)h=s+1;else{if(!(a>0)){u=s;break}u=s-1}if(r[s=u]===i)return s/(o-1);var c=r[s];return(s+(i-c)/(r[s+1]-c))/(o-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});t.exports=a},function(t,e,n){t.exports={ADD:n(967),COMPLETE:n(968),FILE_COMPLETE:n(969),FILE_KEY_COMPLETE:n(970),FILE_LOAD_ERROR:n(971),FILE_LOAD:n(972),FILE_PROGRESS:n(973),POST_PROCESS:n(974),PROGRESS:n(975),START:n(976)}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x1,s=t.y1,o=t.x2,a=t.y2,h=e.x1,u=e.y1,c=e.x2,l=e.y2,f=(l-u)*(o-r)-(c-h)*(a-s);if(0===f)return!1;var d=((c-h)*(s-u)-(l-u)*(r-h))/f,p=((o-r)*(s-u)-(a-s)*(r-h))/f;return d>=0&&d<=1&&p>=0&&p<=1&&(n.x=r+d*(o-r),n.y=s+d*(a-s),!0)}},function(t,e){t.exports=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}},function(t,e,n){var i=n(18);t.exports=function(t,e,n){return(n-e)*(t=i(t,0,1))+e}},function(t,e){t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},function(t,e){t.exports={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26}},function(t,e,n){var i=n(0),r=n(315),s=new i({initialize:function(t,e){this.parent=t,this.events=e,e||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(r.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var n=this.get(t);return void 0===n&&(n=0),this.set(t,n+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,e){if(this._frozen)return this;if(this.has(t))this.values[t]=e;else{var n=this,i=this.list,s=this.events,o=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){if(!n._frozen){var a=i[t];i[t]=e,s.emit(r.CHANGE_DATA,o,t,e,a),s.emit(r.CHANGE_DATA_KEY+t,o,e,a)}}}),i[t]=e,s.emit(r.SET_DATA,o,t,e)}return this},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[1]=r,n[2]=this.list[r],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var e=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)}return this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(r.CHANGE_DATA),this.events.off(r.SET_DATA),this.events.off(r.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=s},function(t,e,n){var i=new(n(0))({initialize:function(t){if(this.entries={},this.size=0,Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1])},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach((function(t){delete this.entries[t]}),this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var n in e)if(!1===t(n,e[n]))break;return this},contains:function(t){var e=this.entries;for(var n in e)if(e[n]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var n=this.entries,i=t.entries;for(var r in i)n.hasOwnProperty(r)&&e?n[r]=i[r]:this.set(r,i[r]);return this}});t.exports=i},function(t,e){t.exports=function(t,e,n){return t<<16|e<<8|n}},function(t,e,n){t.exports={ENTER_FULLSCREEN:n(800),FULLSCREEN_FAILED:n(801),FULLSCREEN_UNSUPPORTED:n(802),LEAVE_FULLSCREEN:n(803),ORIENTATION_CHANGE:n(804),RESIZE:n(805)}},function(t,e,n){(function(e){var n={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};t.exports=function(){if("function"==typeof importScripts)return n;var t=navigator.userAgent;/Windows/.test(t)?n.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(n.iOS=!0,n.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),n.iOSVersion=parseInt(RegExp.$1,10)):n.macOS=!0:/Android/.test(t)?n.android=!0:/Linux/.test(t)?n.linux=!0:/iP[ao]d|iPhone/i.test(t)?(n.iOS=!0,navigator.appVersion.match(/OS (\d+)/),n.iOSVersion=parseInt(RegExp.$1,10),n.iPhone=-1!==t.toLowerCase().indexOf("iphone"),n.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?n.kindle=!0:/CrOS/.test(t)&&(n.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(n.android=!1,n.iOS=!1,n.macOS=!1,n.windows=!0,n.windowsPhone=!0);var i=/Silk/.test(t);return(n.windows||n.macOS||n.linux&&!i||n.chromeOS)&&(n.desktop=!0),(n.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(n.desktop=!1),navigator.standalone&&(n.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(n.cordova=!0),void 0!==window.ejecta&&(n.ejecta=!0)),void 0!==e&&e.versions&&e.versions.node&&(n.node=!0),n.node&&"object"==typeof e.versions&&(n.nodeWebkit=!!e.versions["node-webkit"],n.electron=!!e.versions.electron),/Crosswalk/.test(t)&&(n.crosswalk=!0),n.pixelRatio=window.devicePixelRatio||1,n}()}).call(this,n(807))},function(t,e,n){t.exports={ADD:n(860),ERROR:n(861),LOAD:n(862),READY:n(863),REMOVE:n(864)}},function(t,e){t.exports={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}}},function(t,e,n){var i=n(0),r=n(2),s=n(877),o=n(878),a=n(25),h=n(12),u=n(107),c=n(58),l=new i({Extends:c,initialize:function(t){var e=t.game.renderer,n=r(t,"fragShader",s);t.fragShader=h.parseFragmentShaderMaxTextures(n,e.maxTextures),t.vertShader=r(t,"vertShader",o),t.attributes=r(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:u.UNSIGNED_BYTE,normalized:!0}]),c.call(this,t),this._tempMatrix1=new a,this._tempMatrix2=new a,this._tempMatrix3=new a},boot:function(){c.prototype.boot.call(this),this.currentShader.set1iv("uMainSampler",this.renderer.textureIndexes)},batchSprite:function(t,e,n){this.manager.set(this,t);var i=this._tempMatrix1,r=this._tempMatrix2,s=this._tempMatrix3,o=t.frame,a=o.glTexture,u=o.u0,c=o.v0,l=o.u1,f=o.v1,d=o.x,p=o.y,v=o.cutWidth,g=o.cutHeight,m=o.customPivot,y=t.displayOriginX,x=t.displayOriginY,b=-y+d,w=-x+p;if(t.isCropped){var _=t._crop;_.flipX===t.flipX&&_.flipY===t.flipY||o.updateCropUVs(_,t.flipX,t.flipY),u=_.u0,c=_.v0,l=_.u1,f=_.v1,v=_.width,g=_.height,b=-y+(d=_.x),w=-x+(p=_.y)}var T=1,E=1;t.flipX&&(m||(b+=-o.realWidth+2*y),T=-1),(t.flipY||o.source.isGLTexture&&!a.flipY)&&(m||(w+=-o.realHeight+2*x),E=-1),r.applyITRS(t.x,t.y,t.rotation,t.scaleX*T,t.scaleY*E),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),r.e=t.x,r.f=t.y):(r.e-=e.scrollX*t.scrollFactorX,r.f-=e.scrollY*t.scrollFactorY),i.multiply(r,s);var S=b+v,C=w+g,A=e.roundPixels,I=s.getXRound(b,w,A),P=s.getYRound(b,w,A),R=s.getXRound(b,C,A),O=s.getYRound(b,C,A),k=s.getXRound(S,C,A),M=s.getYRound(S,C,A),D=s.getXRound(S,w,A),L=s.getYRound(S,w,A),N=h.getTintAppendFloatAlpha,F=e.alpha,B=N(t.tintTopLeft,F*t._alphaTL),U=N(t.tintTopRight,F*t._alphaTR),V=N(t.tintBottomLeft,F*t._alphaBL),Y=N(t.tintBottomRight,F*t._alphaBR);this.shouldFlush(6)&&this.flush();var z=this.setGameObject(t,o);this.manager.preBatch(t),this.batchQuad(t,I,P,R,O,k,M,D,L,u,c,l,f,B,U,V,Y,t.tintFill,a,z),this.manager.postBatch(t)},batchTexture:function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x,b,w,_,T,E,S,C,A,I,P,R,O){this.manager.set(this,t);var k=this._tempMatrix1,M=this._tempMatrix2,D=this._tempMatrix3,L=m/n+C,N=y/i+A,F=(m+x)/n+C,B=(y+b)/i+A,U=o,V=a,Y=-v,z=-g;if(t.isCropped){var X=t._crop,G=X.width,j=X.height;U=G,V=j,o=G,a=j;var W=m=X.x,H=y=X.y;l&&(W=x-X.x-G),f&&(H=b-X.y-j),L=W/n+C,N=H/i+A,F=(W+G)/n+C,B=(H+j)/i+A,Y=-v+m,z=-g+y}l&&(U*=-1,Y+=o),(f^=!R&&e.isRenderTexture?1:0)&&(V*=-1,z+=a);var q=Y+U,K=z+V;M.applyITRS(r,s,c,h,u),k.copyFrom(I.matrix),P?(k.multiplyWithOffset(P,-I.scrollX*d,-I.scrollY*p),M.e=r,M.f=s):(M.e-=I.scrollX*d,M.f-=I.scrollY*p),k.multiply(M,D);var Q=I.roundPixels,Z=D.getXRound(Y,z,Q),J=D.getYRound(Y,z,Q),$=D.getXRound(Y,K,Q),tt=D.getYRound(Y,K,Q),et=D.getXRound(q,K,Q),nt=D.getYRound(q,K,Q),it=D.getXRound(q,z,Q),rt=D.getYRound(q,z,Q);void 0===O&&(O=this.renderer.setTexture2D(e)),t&&this.manager.preBatch(t),this.batchQuad(t,Z,J,$,tt,et,nt,it,rt,L,N,F,B,w,_,T,E,S,e,O),t&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,n,i,r,s,o){this.manager.set(this);var a=this._tempMatrix1.copyFrom(s),u=this._tempMatrix2,c=e+t.width,l=n+t.height;o?a.multiply(o,u):u=a;var f=u.getX(e,n),d=u.getY(e,n),p=u.getX(e,l),v=u.getY(e,l),g=u.getX(c,l),m=u.getY(c,l),y=u.getX(c,n),x=u.getY(c,n),b=this.renderer.setTextureSource(t.source);i=h.getTintAppendFloatAlpha(i,r),this.batchQuad(null,f,d,p,v,g,m,y,x,t.u0,t.v0,t.u1,t.v1,i,i,i,i,0,t.glTexture,b)}});t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(17),o=new i({initialize:function(t,e,n,i,r,s,o){this.texture=t,this.name=e,this.source=t.source[n],this.sourceIndex=n,this.glTexture=this.source.glTexture,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0}},this.setSize(s,o,i,r)},setSize:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this.cutX=n,this.cutY=i,this.cutWidth=t,this.cutHeight=e,this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var r=this.data,s=r.cut;s.x=n,s.y=i,s.w=t,s.h=e,s.r=n+t,s.b=i+e,r.sourceSize.w=t,r.sourceSize.h=e,r.spriteSourceSize.w=t,r.spriteSourceSize.h=e,r.radius=.5*Math.sqrt(t*t+e*e);var o=r.drawImage;return o.x=n,o.y=i,o.width=t,o.height=e,this.updateUVs()},setTrim:function(t,e,n,i,r,s){var o=this.data,a=o.spriteSourceSize;return o.trim=!0,o.sourceSize.w=t,o.sourceSize.h=e,a.x=n,a.y=i,a.w=r,a.h=s,a.r=n+r,a.b=i+s,this.x=n,this.y=i,this.width=r,this.height=s,this.halfWidth=.5*r,this.halfHeight=.5*s,this.centerX=Math.floor(r/2),this.centerY=Math.floor(s/2),this.updateUVs()},setCropUVs:function(t,e,n,i,s,o,a){var h=this.cutX,u=this.cutY,c=this.cutWidth,l=this.cutHeight,f=this.realWidth,d=this.realHeight,p=h+(e=r(e,0,f)),v=u+(n=r(n,0,d)),g=i=r(i,0,f-e),m=s=r(s,0,d-n),y=this.data;if(y.trim){var x=y.spriteSourceSize,b=e+(i=r(i,0,c-e)),w=n+(s=r(s,0,l-n));if(x.r<e||x.b<n||x.x>b||x.y>w)p=0,v=0,g=0,m=0;else{var _=Math.max(x.x,e),T=Math.max(x.y,n),E=Math.min(x.r,b)-_,S=Math.min(x.b,w)-T;g=E,m=S,p=o?h+(c-(_-x.x)-E):h+(_-x.x),v=a?u+(l-(T-x.y)-S):u+(T-x.y),e=_,n=T,i=E,s=S}}else o&&(p=h+(c-e-i)),a&&(v=u+(l-n-s));var C=this.source.width,A=this.source.height;return t.u0=Math.max(0,p/C),t.v0=Math.max(0,v/A),t.u1=Math.min(1,(p+g)/C),t.v1=Math.min(1,(v+m)/A),t.x=e,t.y=n,t.cx=p,t.cy=v,t.cw=g,t.ch=m,t.width=i,t.height=s,t.flipX=o,t.flipY=a,t},updateCropUVs:function(t,e,n){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,n)},setUVs:function(t,e,n,i,r,s){var o=this.data.drawImage;return o.width=t,o.height=e,this.u0=n,this.v0=i,this.u1=r,this.v1=s,this},updateUVs:function(){var t=this.cutX,e=this.cutY,n=this.cutWidth,i=this.cutHeight,r=this.data.drawImage;r.width=n,r.height=i;var s=this.source.width,o=this.source.height;return this.u0=t/s,this.v0=e/o,this.u1=(t+n)/s,this.v1=(e+i)/o,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new o(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=s(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.source=null,this.texture=null,this.glTexture=null,this.customData=null,this.data=null},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},canvasData:{get:function(){return this.data.drawImage}}});t.exports=o},function(t,e,n){var i=n(208),r=n(0),s=n(1),o=n(80),a=new r({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=s,this.removeCallback=s,this._sortKey=""},add:function(t,e){return e?i.Add(this.list,t):i.Add(this.list,t,0,this.addCallback,this)},addAt:function(t,e,n){return n?i.AddAt(this.list,t,e):i.AddAt(this.list,t,e,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),o(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e){return i.CountAllMatching(this.list,t,e)},swap:function(t,e){i.Swap(this.list,t,e)},moveTo:function(t,e){return i.MoveTo(this.list,t,e)},remove:function(t,e){return e?i.Remove(this.list,t):i.Remove(this.list,t,this.removeCallback,this)},removeAt:function(t,e){return e?i.RemoveAt(this.list,t):i.RemoveAt(this.list,t,this.removeCallback,this)},removeBetween:function(t,e,n){return n?i.RemoveBetween(this.list,t,e):i.RemoveBetween(this.list,t,e,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(t){return i.BringToTop(this.list,t)},sendToBack:function(t){return i.SendToBack(this.list,t)},moveUp:function(t){return i.MoveUp(this.list,t),t},moveDown:function(t){return i.MoveDown(this.list,t),t},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e){return i.Replace(this.list,t,e)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});t.exports=a},function(t,e,n){var i=n(0),r=n(112),s=n(445),o=n(446),a=n(56),h=n(180),u=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.ELLIPSE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return h(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=u},function(t,e){t.exports=function(t,e,n){if(t.width<=0||t.height<=0)return!1;var i=(e-t.x)/t.width,r=(n-t.y)/t.height;return(i*=i)+(r*=r)<.25}},function(t,e,n){var i=n(275),r=n(0),s=n(76),o=n(9),a=n(207),h=n(2),u=n(6),c=n(7),l=n(437),f=n(150),d=n(74),p=new r({Extends:o,initialize:function(t,e,n){o.call(this),n?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?c(e[0])&&(n=e,e=null):c(e)&&(n=e,e=null),this.scene=t,this.children=new f,this.isParent=!0,this.type="Group",this.classType=h(n,"classType",d),this.name=h(n,"name",""),this.active=h(n,"active",!0),this.maxSize=h(n,"maxSize",-1),this.defaultKey=h(n,"defaultKey",null),this.defaultFrame=h(n,"defaultFrame",null),this.runChildUpdate=h(n,"runChildUpdate",!1),this.createCallback=h(n,"createCallback",null),this.removeCallback=h(n,"removeCallback",null),this.createMultipleCallback=h(n,"createMultipleCallback",null),this.internalCreateCallback=h(n,"internalCreateCallback",null),this.internalRemoveCallback=h(n,"internalRemoveCallback",null),e&&this.addMultiple(e),n&&this.createMultiple(n),this.on(s.ADDED_TO_SCENE,this.addedToScene,this),this.on(s.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,n,i,r,s){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultKey),void 0===i&&(i=this.defaultFrame),void 0===r&&(r=!0),void 0===s&&(s=!0),this.isFull())return null;var o=new this.classType(this.scene,t,e,n,i);return o.addToDisplayList(this.scene.sys.displayList),o.addToUpdateList(),o.visible=r,o.setActive(s),this.add(o),o},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var n=0;n<t.length;n++){var i=this.createFromConfig(t[n]);e=e.concat(i)}return e},createFromConfig:function(t){if(this.isFull())return[];this.classType=h(t,"classType",this.classType);var e=h(t,"key",void 0),n=h(t,"frame",null),r=h(t,"visible",!0),s=h(t,"active",!0),o=[];if(void 0===e)return o;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var a=h(t,"repeat",0),c=h(t,"randomKey",!1),f=h(t,"randomFrame",!1),d=h(t,"yoyo",!1),p=h(t,"quantity",!1),v=h(t,"frameQuantity",1),g=h(t,"max",0),m=l(e,n,{max:g,qty:p||v,random:c,randomB:f,repeat:a,yoyo:d});t.createCallback&&(this.createCallback=t.createCallback),t.removeCallback&&(this.removeCallback=t.removeCallback);for(var y=0;y<m.length;y++){var x=this.create(0,0,m[y].a,m[y].b,r,s);if(!x)break;o.push(x)}var b=u(t,"setXY.x",0),w=u(t,"setXY.y",0),_=u(t,"setXY.stepX",0),T=u(t,"setXY.stepY",0);i.SetXY(o,b,w,_,T);var E=u(t,"setRotation.value",0),S=u(t,"setRotation.step",0);i.SetRotation(o,E,S);var C=u(t,"setScale.x",1),A=u(t,"setScale.y",C),I=u(t,"setScale.stepX",0),P=u(t,"setScale.stepY",0);i.SetScale(o,C,A,I,P);var R=u(t,"setOrigin.x",.5),O=u(t,"setOrigin.y",R),k=u(t,"setOrigin.stepX",0),M=u(t,"setOrigin.stepY",0);i.SetOrigin(o,R,O,k,M);var D=u(t,"setAlpha.value",1),L=u(t,"setAlpha.step",0);i.SetAlpha(o,D,L);var N=u(t,"setDepth.value",0),F=u(t,"setDepth.step",0);i.SetDepth(o,N,F);var B=u(t,"setScrollFactor.x",1),U=u(t,"setScrollFactor.y",B),V=u(t,"setScrollFactor.stepX",0),Y=u(t,"setScrollFactor.stepY",0);i.SetScrollFactor(o,B,U,V,Y);var z=h(t,"hitArea",null),X=h(t,"hitAreaCallback",null);z&&i.SetHitArea(o,z,X);var G=h(t,"gridAlign",!1);return G&&i.GridAlign(o,G),this.createMultipleCallback&&this.createMultipleCallback.call(this,o),o},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var n=this.children.entries.slice(),i=0;i<n.length;i++){var r=n[i];r.active&&r.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(s.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var n=0;n<t.length;n++)this.add(t[n],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(s.DESTROY,this.remove,this),n?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,i=0;i<n.size;i++){var r=n.entries[i];r.off(s.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,n,i){return a(this.children.entries,t,e,n,i)},getFirst:function(t,e,n,i,r,s,o){return this.getHandler(!0,1,t,e,n,i,r,s,o)},getFirstNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!0,t,e,n,i,r,s,o,a)},getLast:function(t,e,n,i,r,s,o){return this.getHandler(!1,1,t,e,n,i,r,s,o)},getLastNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!1,t,e,n,i,r,s,o,a)},getHandler:function(t,e,n,i,r,s,o,a,h){var u,c;void 0===n&&(n=!1),void 0===i&&(i=!1);var l=0,f=this.children.entries;if(t)for(c=0;c<f.length;c++)if((u=f[c]).active===n){if(++l===e)break}else u=null;else for(c=f.length-1;c>=0;c--)if((u=f[c]).active===n){if(++l===e)break}else u=null;return u?("number"==typeof r&&(u.x=r),"number"==typeof s&&(u.y=s),u):i?this.create(r,s,o,a,h):null},get:function(t,e,n,i,r){return this.getFirst(!1,!0,t,e,n,i,r)},getFirstAlive:function(t,e,n,i,r,s){return this.getFirst(!0,t,e,n,i,r,s)},getFirstDead:function(t,e,n,i,r,s){return this.getFirst(!1,t,e,n,i,r,s)},playAnimation:function(t,e){return i.PlayAnimation(this.children.entries,t,e),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,n=0;n<this.children.size;n++)this.children.entries[n].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(t,e,n,r,s){return i.PropertyValueSet(this.children.entries,t,e,n,r,s),this},propertyValueInc:function(t,e,n,r,s){return i.PropertyValueInc(this.children.entries,t,e,n,r,s),this},setX:function(t,e){return i.SetX(this.children.entries,t,e),this},setY:function(t,e){return i.SetY(this.children.entries,t,e),this},setXY:function(t,e,n,r){return i.SetXY(this.children.entries,t,e,n,r),this},incX:function(t,e){return i.IncX(this.children.entries,t,e),this},incY:function(t,e){return i.IncY(this.children.entries,t,e),this},incXY:function(t,e,n,r){return i.IncXY(this.children.entries,t,e,n,r),this},shiftPosition:function(t,e,n){return i.ShiftPosition(this.children.entries,t,e,n),this},angle:function(t,e){return i.Angle(this.children.entries,t,e),this},rotate:function(t,e){return i.Rotate(this.children.entries,t,e),this},rotateAround:function(t,e){return i.RotateAround(this.children.entries,t,e),this},rotateAroundDistance:function(t,e,n){return i.RotateAroundDistance(this.children.entries,t,e,n),this},setAlpha:function(t,e){return i.SetAlpha(this.children.entries,t,e),this},setTint:function(t,e,n,r){return i.SetTint(this.children.entries,t,e,n,r),this},setOrigin:function(t,e,n,r){return i.SetOrigin(this.children.entries,t,e,n,r),this},scaleX:function(t,e){return i.ScaleX(this.children.entries,t,e),this},scaleY:function(t,e){return i.ScaleY(this.children.entries,t,e),this},scaleXY:function(t,e,n,r){return i.ScaleXY(this.children.entries,t,e,n,r),this},setDepth:function(t,e){return i.SetDepth(this.children.entries,t,e),this},setBlendMode:function(t){return i.SetBlendMode(this.children.entries,t),this},setHitArea:function(t,e){return i.SetHitArea(this.children.entries,t,e),this},shuffle:function(){return i.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(t,e,n){return i.SetVisible(this.children.entries,t,e,n),this},toggleVisible:function(){return i.ToggleVisible(this.children.entries),this},destroy:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.scene&&!this.ignoreDestroy&&(this.emit(s.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});t.exports=p},function(t,e,n){var i=n(12);t.exports=function(t,e,n,r,s,o){for(var a=i.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*r),h=n.pathData,u=n.pathIndexes,c=0;c<u.length;c+=3){var l=2*u[c],f=2*u[c+1],d=2*u[c+2],p=h[l+0]-s,v=h[l+1]-o,g=h[f+0]-s,m=h[f+1]-o,y=h[d+0]-s,x=h[d+1]-o,b=e.getX(p,v),w=e.getY(p,v),_=e.getX(g,m),T=e.getY(g,m),E=e.getX(y,x),S=e.getY(y,x);t.batchTri(b,w,_,T,E,S,a,a,a)}}},function(t,e){t.exports=function(t,e,n){var i=t.x3-t.x1,r=t.y3-t.y1,s=t.x2-t.x1,o=t.y2-t.y1,a=e-t.x1,h=n-t.y1,u=i*i+r*r,c=i*s+r*o,l=i*a+r*h,f=s*s+o*o,d=s*a+o*h,p=u*f-c*c,v=0===p?0:1/p,g=(f*l-c*d)*v,m=(u*d-c*l)*v;return g>=0&&m>=0&&g+m<1}},function(t,e,n){var i=n(0),r=n(10),s=n(117),o=n(3);function a(t,e,n,i){var r=t-n,s=e-i,o=r*r+s*s;return Math.sqrt(o)}var h=new i({initialize:function(t,e,n){this.vertex1=t,this.vertex2=e,this.vertex3=n,this.bounds=new r,this._inCenter=new o},getInCenter:function(t){void 0===t&&(t=!0);var e,n,i,r,s,o,h=this.vertex1,u=this.vertex2,c=this.vertex3;t?(e=h.x,n=h.y,i=u.x,r=u.y,s=c.x,o=c.y):(e=h.vx,n=h.vy,i=u.vx,r=u.vy,s=c.vx,o=c.vy);var l=a(s,o,i,r),f=a(e,n,s,o),d=a(i,r,e,n),p=l+f+d;return this._inCenter.set((e*l+i*f+s*d)/p,(n*l+r*f+o*d)/p)},contains:function(t,e,n){var i=this.vertex1,r=this.vertex2,s=this.vertex3,o=i.vx,a=i.vy,h=r.vx,u=r.vy,c=s.vx,l=s.vy;if(n){var f=n.a,d=n.b,p=n.c,v=n.d,g=n.e,m=n.f;o=i.vx*f+i.vy*p+g,a=i.vx*d+i.vy*v+m,h=r.vx*f+r.vy*p+g,u=r.vx*d+r.vy*v+m,c=s.vx*f+s.vy*p+g,l=s.vx*d+s.vy*v+m}var y=c-o,x=l-a,b=h-o,w=u-a,_=t-o,T=e-a,E=y*y+x*x,S=y*b+x*w,C=y*_+x*T,A=b*b+w*w,I=b*_+w*T,P=E*A-S*S,R=0===P?0:1/P,O=(A*C-S*I)*R,k=(E*I-S*C)*R;return O>=0&&k>=0&&O+k<1},isCounterClockwise:function(t){var e=this.vertex1,n=this.vertex2,i=this.vertex3,r=(n.vx-e.vx)*(i.vy-e.vy)-(n.vy-e.vy)*(i.vx-e.vx);return t<=0?r>=0:r<0},load:function(t,e,n,i,r){return n=this.vertex1.load(t,e,n,i,r),n=this.vertex2.load(t,e,n,i,r),this.vertex3.load(t,e,n,i,r)},transformCoordinatesLocal:function(t,e,n,i){return this.vertex1.transformCoordinatesLocal(t,e,n,i),this.vertex2.transformCoordinatesLocal(t,e,n,i),this.vertex3.transformCoordinatesLocal(t,e,n,i),this},updateBounds:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3,i=this.bounds;return i.x=Math.min(t.vx,e.vx,n.vx),i.y=Math.min(t.vy,e.vy,n.vy),i.width=Math.max(t.vx,e.vx,n.vx)-i.x,i.height=Math.max(t.vy,e.vy,n.vy)-i.y,this},isInView:function(t,e,n,i,r,o,a,h,u,c,l){var f=this.vertex1.update(r,o,a,h,u,c,l,i),d=this.vertex2.update(r,o,a,h,u,c,l,i),p=this.vertex3.update(r,o,a,h,u,c,l,i);if(f.ta<=0&&d.ta<=0&&p.ta<=0)return!1;if(e&&!this.isCounterClockwise(n))return!1;var v=this.bounds;return v.x=Math.min(f.tx,d.tx,p.tx),v.y=Math.min(f.ty,d.ty,p.ty),v.width=Math.max(f.tx,d.tx,p.tx)-v.x,v.height=Math.max(f.ty,d.ty,p.ty)-v.y,s(v,t.worldView)},translate:function(t,e){void 0===e&&(e=0);var n=this.vertex1,i=this.vertex2,r=this.vertex3;return n.x+=t,n.y+=e,i.x+=t,i.y+=e,r.x+=t,r.y+=e,this},x:{get:function(){return this.getInCenter().x},set:function(t){var e=this.getInCenter();this.translate(t-e.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(t){var e=this.getInCenter();this.translate(0,t-e.y)}},alpha:{get:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3;return(t.alpha+e.alpha+n.alpha)/3},set:function(t){this.vertex1.alpha=t,this.vertex2.alpha=t,this.vertex3.alpha=t}},depth:{get:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3;return(t.vz+e.vz+n.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}});t.exports=h},function(t,e){t.exports=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0||t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}},function(t,e,n){var i=n(0),r=n(12),s=n(39),o=new i({Extends:s,initialize:function(t,e,n,i,r,o,a,h,u,c){void 0===o&&(o=16777215),void 0===a&&(a=1),void 0===h&&(h=0),void 0===u&&(u=0),void 0===c&&(c=0),s.call(this,t,e,n),this.vx=0,this.vy=0,this.vz=0,this.nx=h,this.ny=u,this.nz=c,this.u=i,this.v=r,this.color=o,this.alpha=a,this.tx=0,this.ty=0,this.ta=0},setUVs:function(t,e){return this.u=t,this.v=e,this},transformCoordinatesLocal:function(t,e,n,i){var r=this.x,s=this.y,o=this.z,a=t.val,h=r*a[0]+s*a[4]+o*a[8]+a[12],u=r*a[1]+s*a[5]+o*a[9]+a[13],c=r*a[2]+s*a[6]+o*a[10]+a[14],l=r*a[3]+s*a[7]+o*a[11]+a[15];this.vx=h/l*e,this.vy=-u/l*n,this.vz=i<=0?c/l:-c/l},update:function(t,e,n,i,r,s,o,a){var h=this.vx*t+this.vy*n+r,u=this.vx*e+this.vy*i+s;return o&&(h=Math.round(h),u=Math.round(u)),this.tx=h,this.ty=u,this.ta=this.alpha*a,this},load:function(t,e,n,i,s){return t[++n]=this.tx,t[++n]=this.ty,t[++n]=this.u,t[++n]=this.v,t[++n]=i,t[++n]=s,e[++n]=r.getTintAppendFloatAlpha(this.color,this.ta),n}});t.exports=o},function(t,e,n){var i={};t.exports=i;var r=n(166),s=n(32),o=n(85),a=n(41);i.create=function(t){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},t)},i.setModified=function(t,e,n,s){if(r.trigger(t,"compositeModified",t),t.isModified=e,n&&t.parent&&i.setModified(t.parent,e,n,s),s)for(var o=0;o<t.composites.length;o++){var a=t.composites[o];i.setModified(a,e,n,s)}},i.add=function(t,e){var n=[].concat(e);r.trigger(t,"beforeAdd",{object:e});for(var o=0;o<n.length;o++){var a=n[o];switch(a.type){case"body":if(a.parent!==a){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(t,a);break;case"constraint":i.addConstraint(t,a);break;case"composite":i.addComposite(t,a);break;case"mouseConstraint":i.addConstraint(t,a.constraint)}}return r.trigger(t,"afterAdd",{object:e}),t},i.remove=function(t,e,n){var s=[].concat(e);r.trigger(t,"beforeRemove",{object:e});for(var o=0;o<s.length;o++){var a=s[o];switch(a.type){case"body":i.removeBody(t,a,n);break;case"constraint":i.removeConstraint(t,a,n);break;case"composite":i.removeComposite(t,a,n);break;case"mouseConstraint":i.removeConstraint(t,a.constraint)}}return r.trigger(t,"afterRemove",{object:e}),t},i.addComposite=function(t,e){return t.composites.push(e),e.parent=t,i.setModified(t,!0,!0,!1),t},i.removeComposite=function(t,e,n){var r=t.composites.indexOf(e);if(-1!==r&&(i.removeCompositeAt(t,r),i.setModified(t,!0,!0,!1)),n)for(var s=0;s<t.composites.length;s++)i.removeComposite(t.composites[s],e,!0);return t},i.removeCompositeAt=function(t,e){return t.composites.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addBody=function(t,e){return t.bodies.push(e),i.setModified(t,!0,!0,!1),t},i.removeBody=function(t,e,n){var r=t.bodies.indexOf(e);if(-1!==r&&(i.removeBodyAt(t,r),i.setModified(t,!0,!0,!1)),n)for(var s=0;s<t.composites.length;s++)i.removeBody(t.composites[s],e,!0);return t},i.removeBodyAt=function(t,e){return t.bodies.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addConstraint=function(t,e){return t.constraints.push(e),i.setModified(t,!0,!0,!1),t},i.removeConstraint=function(t,e,n){var r=t.constraints.indexOf(e);if(-1!==r&&i.removeConstraintAt(t,r),n)for(var s=0;s<t.composites.length;s++)i.removeConstraint(t.composites[s],e,!0);return t},i.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),i.setModified(t,!0,!0,!1),t},i.clear=function(t,e,n){if(n)for(var r=0;r<t.composites.length;r++)i.clear(t.composites[r],e,!0);return e?t.bodies=t.bodies.filter((function(t){return t.isStatic})):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,i.setModified(t,!0,!0,!1),t},i.allBodies=function(t){for(var e=[].concat(t.bodies),n=0;n<t.composites.length;n++)e=e.concat(i.allBodies(t.composites[n]));return e},i.allConstraints=function(t){for(var e=[].concat(t.constraints),n=0;n<t.composites.length;n++)e=e.concat(i.allConstraints(t.composites[n]));return e},i.allComposites=function(t){for(var e=[].concat(t.composites),n=0;n<t.composites.length;n++)e=e.concat(i.allComposites(t.composites[n]));return e},i.get=function(t,e,n){var r,s;switch(n){case"body":r=i.allBodies(t);break;case"constraint":r=i.allConstraints(t);break;case"composite":r=i.allComposites(t).concat(t)}return r?0===(s=r.filter((function(t){return t.id.toString()===e.toString()}))).length?null:s[0]:null},i.move=function(t,e,n){return i.remove(t,e),i.add(n,e),t},i.rebase=function(t){for(var e=i.allBodies(t).concat(i.allConstraints(t)).concat(i.allComposites(t)),n=0;n<e.length;n++)e[n].id=s.nextId();return i.setModified(t,!0,!0,!1),t},i.translate=function(t,e,n){for(var r=n?i.allBodies(t):t.bodies,s=0;s<r.length;s++)a.translate(r[s],e);return i.setModified(t,!0,!0,!1),t},i.rotate=function(t,e,n,r){for(var s=Math.cos(e),o=Math.sin(e),h=r?i.allBodies(t):t.bodies,u=0;u<h.length;u++){var c=h[u],l=c.position.x-n.x,f=c.position.y-n.y;a.setPosition(c,{x:n.x+(l*s-f*o),y:n.y+(l*o+f*s)}),a.rotate(c,e)}return i.setModified(t,!0,!0,!1),t},i.scale=function(t,e,n,r,s){for(var o=s?i.allBodies(t):t.bodies,h=0;h<o.length;h++){var u=o[h],c=u.position.x-r.x,l=u.position.y-r.y;a.setPosition(u,{x:r.x+c*e,y:r.y+l*n}),a.scale(u,e,n)}return i.setModified(t,!0,!0,!1),t},i.bounds=function(t){for(var e=i.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return o.create(n)}},function(t,e){t.exports=function(t,e,n){return t>=0&&t<n.width&&e>=0&&e<n.height}},function(t,e,n){var i=n(0),r=n(29),s=n(2),o=new i({initialize:function(t){void 0===t&&(t={}),this.name=s(t,"name","layer"),this.x=s(t,"x",0),this.y=s(t,"y",0),this.width=s(t,"width",0),this.height=s(t,"height",0),this.tileWidth=s(t,"tileWidth",0),this.tileHeight=s(t,"tileHeight",0),this.baseTileWidth=s(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=s(t,"baseTileHeight",this.tileHeight),this.orientation=s(t,"orientation",r.ORTHOGONAL),this.widthInPixels=s(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=s(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=s(t,"alpha",1),this.visible=s(t,"visible",!0),this.properties=s(t,"properties",[]),this.indexes=s(t,"indexes",[]),this.collideIndexes=s(t,"collideIndexes",[]),this.callbacks=s(t,"callbacks",[]),this.bodies=s(t,"bodies",[]),this.data=s(t,"data",[]),this.tilemapLayer=s(t,"tilemapLayer",null),this.hexSideLength=s(t,"hexSideLength",0)}});t.exports=o},function(t,e,n){var i=n(0),r=n(29),s=n(2),o=new i({initialize:function(t){void 0===t&&(t={}),this.name=s(t,"name","map"),this.width=s(t,"width",0),this.height=s(t,"height",0),this.infinite=s(t,"infinite",!1),this.tileWidth=s(t,"tileWidth",0),this.tileHeight=s(t,"tileHeight",0),this.widthInPixels=s(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=s(t,"heightInPixels",this.height*this.tileHeight),this.format=s(t,"format",null),this.orientation=s(t,"orientation",r.ORTHOGONAL),this.renderOrder=s(t,"renderOrder","right-down"),this.version=s(t,"version","1"),this.properties=s(t,"properties",{}),this.layers=s(t,"layers",[]),this.images=s(t,"images",[]),this.objects=s(t,"objects",{}),this.collision=s(t,"collision",{}),this.tilesets=s(t,"tilesets",[]),this.imageCollections=s(t,"imageCollections",[]),this.tiles=s(t,"tiles",[]),this.hexSideLength=s(t,"hexSideLength",0)}});t.exports=o},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o,a){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o={}),void 0===a&&(a={}),this.name=t,this.firstgid=e,this.tileWidth=n,this.tileHeight=i,this.tileMargin=r,this.tileSpacing=s,this.tileProperties=o,this.tileData=a,this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){return this.image=t,this.glTexture=t.get().source.glTexture,this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e){var n=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),i=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);n%1==0&&i%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),n=Math.floor(n),i=Math.floor(i),this.rows=n,this.columns=i,this.total=n*i,this.texCoordinates.length=0;for(var r=this.tileMargin,s=this.tileMargin,o=0;o<this.rows;o++){for(var a=0;a<this.columns;a++)this.texCoordinates.push({x:r,y:s}),r+=this.tileWidth+this.tileSpacing;r=this.tileMargin,s+=this.tileHeight+this.tileSpacing}return this}});t.exports=i},function(t,e){t.exports={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(1065),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Size,r.TextureCrop,r.Tint,r.Transform,r.Visible,o],initialize:function(t,e,n,i,r){s.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(i,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()}});t.exports=a},function(t,e){t.exports=function(t,e){return t.hasOwnProperty(e)}},function(t,e,n){var i=n(78);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r]);return n}},function(t,e,n){var i={};t.exports=i;var r=n(63),s=n(84),o=n(165),a=n(85),h=n(271),u=n(32);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(t){var e=t;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?s.add(e.bodyA.position,e.pointA):e.pointA,i=e.bodyB?s.add(e.bodyB.position,e.pointB):e.pointB,r=s.magnitude(s.sub(n,i));e.length=void 0!==e.length?e.length:r,e.id=e.id||u.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var o={visible:!0,type:"line",anchors:!0,lineColor:null,lineOpacity:null,lineThickness:null,pinSize:null,anchorColor:null,anchorSize:null};return 0===e.length&&e.stiffness>.1?(o.type="pin",o.anchors=!1):e.stiffness<.9&&(o.type="spring"),e.render=u.extend(o,e.render),e},i.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var n=t[e],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(t,e){for(var n=0;n<t.length;n+=1){var r=t[n],s=!r.bodyA||r.bodyA&&r.bodyA.isStatic,o=!r.bodyB||r.bodyB&&r.bodyB.isStatic;(s||o)&&i.solve(t[n],e)}for(n=0;n<t.length;n+=1)s=!(r=t[n]).bodyA||r.bodyA&&r.bodyA.isStatic,o=!r.bodyB||r.bodyB&&r.bodyB.isStatic,s||o||i.solve(t[n],e)},i.solve=function(t,e){var n=t.bodyA,r=t.bodyB,o=t.pointA,a=t.pointB;if(n||r){n&&!n.isStatic&&(s.rotate(o,n.angle-t.angleA,o),t.angleA=n.angle),r&&!r.isStatic&&(s.rotate(a,r.angle-t.angleB,a),t.angleB=r.angle);var h=o,u=a;if(n&&(h=s.add(n.position,o)),r&&(u=s.add(r.position,a)),h&&u){var c=s.sub(h,u),l=s.magnitude(c);l<i._minLength&&(l=i._minLength);var f,d,p,v,g,m=(l-t.length)/l,y=t.stiffness<1?t.stiffness*e:t.stiffness,x=s.mult(c,m*y),b=(n?n.inverseMass:0)+(r?r.inverseMass:0),w=b+((n?n.inverseInertia:0)+(r?r.inverseInertia:0));if(t.damping){var _=s.create();p=s.div(c,l),g=s.sub(r&&s.sub(r.position,r.positionPrev)||_,n&&s.sub(n.position,n.positionPrev)||_),v=s.dot(p,g)}n&&!n.isStatic&&(d=n.inverseMass/b,n.constraintImpulse.x-=x.x*d,n.constraintImpulse.y-=x.y*d,n.position.x-=x.x*d,n.position.y-=x.y*d,t.damping&&(n.positionPrev.x-=t.damping*p.x*v*d,n.positionPrev.y-=t.damping*p.y*v*d),f=s.cross(o,x)/w*i._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle-=f,n.angle-=f),r&&!r.isStatic&&(d=r.inverseMass/b,r.constraintImpulse.x+=x.x*d,r.constraintImpulse.y+=x.y*d,r.position.x+=x.x*d,r.position.y+=x.y*d,t.damping&&(r.positionPrev.x+=t.damping*p.x*v*d,r.positionPrev.y+=t.damping*p.y*v*d),f=s.cross(a,x)/w*i._torqueDampen*r.inverseInertia*(1-t.angularStiffness),r.constraintImpulse.angle+=f,r.angle+=f)}}},i.postSolveAll=function(t){for(var e=0;e<t.length;e++){var n=t[e],u=n.constraintImpulse;if(!(n.isStatic||0===u.x&&0===u.y&&0===u.angle)){o.set(n,!1);for(var c=0;c<n.parts.length;c++){var l=n.parts[c];r.translate(l.vertices,u),c>0&&(l.position.x+=u.x,l.position.y+=u.y),0!==u.angle&&(r.rotate(l.vertices,u.angle,n.position),h.rotate(l.axes,u.angle),c>0&&s.rotateAbout(l.position,u.angle,n.position,l.position)),a.update(l.bounds,l.vertices,n.velocity)}u.angle*=i._warming,u.x*=i._warming,u.y*=i._warming}}},i.pointAWorld=function(t){return{x:(t.bodyA?t.bodyA.position.x:0)+t.pointA.x,y:(t.bodyA?t.bodyA.position.y:0)+t.pointA.y}},i.pointBWorld=function(t){return{x:(t.bodyB?t.bodyB.position.x:0)+t.pointB.x,y:(t.bodyB?t.bodyB.position.y:0)+t.pointB.y}}},function(t,e,n){var i=n(35),r=n(64),s=n(65),o=n(0),a=n(11),h=n(15),u=n(10),c=n(57),l=new o({Extends:h,Mixins:[a.Depth,a.GetBounds,a.Origin,a.Transform,a.ScrollFactor,a.Visible],initialize:function(t,e,n,r,s){void 0===r&&(r=1),void 0===s&&(s=r),h.call(this,t,"Zone"),this.setPosition(e,n),this.width=r,this.height=s,this.blendMode=i.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,n){void 0===n&&(n=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return n&&i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new r(0,0,t),s)},setRectangleDropZone:function(t,e){return this.setDropZone(new u(0,0,t,e),c)},setDropZone:function(t,e){return void 0===t?this.setRectangleDropZone(this.width,this.height):this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,n){n.addToRenderList(e)},renderWebGL:function(t,e,n){n.addToRenderList(e)}});t.exports=l},function(t,e){t.exports=function(t){return 2*(t.width+t.height)}},function(t,e){t.exports=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},function(t,e,n){t.exports={ADD_ANIMATION:n(724),ANIMATION_COMPLETE:n(725),ANIMATION_COMPLETE_KEY:n(726),ANIMATION_REPEAT:n(727),ANIMATION_RESTART:n(728),ANIMATION_START:n(729),ANIMATION_STOP:n(730),ANIMATION_UPDATE:n(731),PAUSE_ALL:n(732),REMOVE_ANIMATION:n(733),RESUME_ALL:n(734)}},function(t,e,n){var i=n(0),r=n(11),s=n(36),o=n(9),a=n(37),h=n(10),u=n(25),c=n(187),l=n(3),f=new i({Extends:o,Mixins:[r.Alpha,r.Visible],initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),o.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new h,this.dirty=!0,this._x=t,this._y=e,this._width=n,this._height=i,this._bounds=new h,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new u,this.transparent=!0,this.backgroundColor=c("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new l(n/2,i/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[]},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,n){void 0===n&&(n=new l);var i=.5*this.width,r=.5*this.height;return n.x=t-i,n.y=e-r,this.useBounds&&(n.x=this.clampX(n.x),n.y=this.clampY(n.y)),n},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,n=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-n}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(!o)return t;var a=e[4],h=e[5],u=this.scrollX,c=this.scrollY,l=this.width,f=this.height,d=this.y,p=d+f,v=this.x,g=v+l,m=this.culledObjects,y=t.length;o=1/o,m.length=0;for(var x=0;x<y;++x){var b=t[x];if(b.hasOwnProperty("width")&&!b.parentContainer){var w=b.width,_=b.height,T=b.x-u*b.scrollFactorX-w*b.originX,E=b.y-c*b.scrollFactorY-_*b.originY;(T+w)*n+(E+_)*r+a>v&&T*n+E*r+a<g&&(T+w)*i+(E+_)*s+h>d&&T*i+E*s+h<p&&m.push(b)}else m.push(b)}return m},getWorldPoint:function(t,e,n){void 0===n&&(n=new l);var i=this.matrix.matrix,r=i[0],s=i[1],o=i[2],a=i[3],h=i[4],u=i[5],c=r*a-s*o;if(!c)return n.x=t,n.y=e,n;var f=a*(c=1/c),d=-s*c,p=-o*c,v=r*c,g=(o*u-a*h)*c,m=(s*h-r*u)*c,y=Math.cos(this.rotation),x=Math.sin(this.rotation),b=this.zoomX,w=this.zoomY,_=this.scrollX,T=this.scrollY,E=t+(_*y-T*x)*b,S=e+(_*x+T*y)*w;return n.x=E*f+S*p+g,n.y=E*d+S*v+m,n},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?this.ignore(i):i.isParent?this.ignore(i.getChildren()):i.cameraFilter|=e}return this},preRender:function(){this.renderList.length=0;var t=this.width,e=this.height,n=.5*t,i=.5*e,r=this.zoomX,s=this.zoomY,o=this.matrix,a=t*this.originX,h=e*this.originY,u=this.scrollX,c=this.scrollY;this.useBounds&&(u=this.clampX(u),c=this.clampY(c)),this.roundPixels&&(a=Math.round(a),h=Math.round(h)),this.scrollX=u,this.scrollY=c;var l=u+n,f=c+i;this.midPoint.set(l,f);var d=t/r,p=e/s;this.worldView.setTo(l-d/2,f-p/2,d,p),o.applyITRS(this.x+a,this.y+h,this.rotation,r,s),o.translate(-a,-h)},clampX:function(t){var e=this._bounds,n=this.displayWidth,i=e.x+(n-this.width)/2,r=Math.max(i,i+e.width-n);return t<i?t=i:t>r&&(t=r),t},clampY:function(t){var e=this._bounds,n=this.displayHeight,i=e.y+(n-this.height)/2,r=Math.max(i,i+e.height-n);return t<i?t=i:t>r&&(t=r),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=s(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=c(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,n,i,r){return void 0===r&&(r=!1),this._bounds.setTo(t,e,n,i),this.dirty=!0,this.useBounds=!0,r?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new h);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t){this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t;var e=t.sys;return this.sceneManager=e.game.scene,this.scaleManager=e.scale,this.cameraManager=e.cameras,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setZoom:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),0===t&&(t=.001),0===e&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},updateSystem:function(){if(this.scaleManager){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(a.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){this._scrollX=t,this.dirty=!0}},scrollY:{get:function(){return this._scrollY},set:function(t){this._scrollY=t,this.dirty=!0}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});t.exports=f},function(t,e,n){var i=n(334),r=n(335),s=n(336),o=n(337),a=n(338),h=n(339),u=n(340),c=n(341),l=n(342),f=n(343),d=n(344),p=n(345);t.exports={Power0:u,Power1:c.Out,Power2:o.Out,Power3:l.Out,Power4:f.Out,Linear:u,Quad:c.Out,Cubic:o.Out,Quart:l.Out,Quint:f.Out,Sine:d.Out,Expo:h.Out,Circ:s.Out,Elastic:a.Out,Back:i.Out,Bounce:r.Out,Stepped:p,"Quad.easeIn":c.In,"Cubic.easeIn":o.In,"Quart.easeIn":l.In,"Quint.easeIn":f.In,"Sine.easeIn":d.In,"Expo.easeIn":h.In,"Circ.easeIn":s.In,"Elastic.easeIn":a.In,"Back.easeIn":i.In,"Bounce.easeIn":r.In,"Quad.easeOut":c.Out,"Cubic.easeOut":o.Out,"Quart.easeOut":l.Out,"Quint.easeOut":f.Out,"Sine.easeOut":d.Out,"Expo.easeOut":h.Out,"Circ.easeOut":s.Out,"Elastic.easeOut":a.Out,"Back.easeOut":i.Out,"Bounce.easeOut":r.Out,"Quad.easeInOut":c.InOut,"Cubic.easeInOut":o.InOut,"Quart.easeInOut":l.InOut,"Quint.easeInOut":f.InOut,"Sine.easeInOut":d.InOut,"Expo.easeInOut":h.InOut,"Circ.easeInOut":s.InOut,"Elastic.easeInOut":a.InOut,"Back.easeInOut":i.InOut,"Bounce.easeInOut":r.InOut}},function(t,e){t.exports=function(t,e,n){return(e-t)*n+t}},function(t,e,n){var i,r=n(105),s={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0};t.exports=(i=navigator.userAgent,/Edge\/\d+/.test(i)?s.edge=!0:/Chrome\/(\d+)/.test(i)&&!r.windowsPhone?(s.chrome=!0,s.chromeVersion=parseInt(RegExp.$1,10)):/Firefox\D+(\d+)/.test(i)?(s.firefox=!0,s.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(i)&&r.iOS?s.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(i)?(s.ie=!0,s.ieVersion=parseInt(RegExp.$1,10)):/Opera/.test(i)?s.opera=!0:/Safari/.test(i)&&!r.windowsPhone?s.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(i)&&(s.ie=!0,s.trident=!0,s.tridentVersion=parseInt(RegExp.$1,10),s.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(i)&&(s.silk=!0),s)},function(t,e){t.exports=function(t,e){return Math.random()*(e-t)+t}},function(t,e){t.exports=function(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this.x=t*r,this.y=e*r,this.z=n*r,this.w=i*r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this.w=s+e*(t.w-s),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+r*r)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return e*e+n*n+i*i+r*r},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.val;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,h=a*e+s*i-o*n,u=a*n+o*e-r*i,c=a*i+r*n-s*e,l=-r*e-s*n-o*i;return this.x=h*a+l*-r+u*-o-c*-s,this.y=u*a+l*-s+c*-r-h*-o,this.z=c*a+l*-o+h*-s-u*-r,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},function(t,e,n){var i=n(0),r=n(92),s=new i({initialize:function(t,e,n,i,r,s,o){void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=!0),void 0===o&&(o=!1),this.renderer=t,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=i,this.minFilter=r,this.autoClear=s,this.autoResize=!1,this.resize(e,n),o&&this.setAutoResize(!0)},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(r.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(r.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){var n=t*this.scale,i=e*this.scale;if(n!==this.width||i!==this.height){var r=this.renderer;r.deleteFramebuffer(this.framebuffer),r.deleteTexture(this.texture),t*=this.scale,e*=this.scale,(t=Math.round(t))<=0&&(t=1),(e=Math.round(e))<=0&&(e=1),this.texture=r.createTextureFromSource(null,t,e,this.minFilter),this.framebuffer=r.createFramebuffer(t,e,this.texture,!1),this.width=t,this.height=e}return this},bind:function(t,e,n){if(void 0===t&&(t=!1),t&&this.renderer.flush(),e&&n&&this.resize(e,n),this.renderer.pushFramebuffer(this.framebuffer,!1,!1,!1),t&&this.adjustViewport(),this.autoClear){var i=this.renderer.gl;i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)}},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(){var t=this.renderer,e=t.gl;t.pushFramebuffer(this.framebuffer),e.disable(e.SCISSOR_TEST),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t.popFramebuffer(),t.resetScissor()},unbind:function(t){void 0===t&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),t.off(r.RESIZE,this.resize,this),this.renderer=null,this.framebuffer=null,this.texture=null}});t.exports=s},function(t,e){t.exports=function(t,e){var n;if(e)"string"==typeof e?n=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(n=e);else if(t.parentElement||null===e)return t;return n||(n=document.body),n.appendChild(t),t}},function(t,e){t.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175}},function(t,e){t.exports={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9}},function(t,e,n){var i=n(0),r=n(78),s=n(9),o=n(71),a=n(22),h=n(1),u=n(207),c=n(428),l=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.jsonCache=t.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,t.events.on(a.BLUR,this.onGameBlur,this),t.events.on(a.FOCUS,this.onGameFocus,this),t.events.on(a.PRE_STEP,this.update,this),t.events.once(a.DESTROY,this.destroy,this)},add:h,addAudioSprite:function(t,e){void 0===e&&(e={});var n=this.add(t,e);for(var i in n.spritemap=this.jsonCache.get(t).spritemap,n.spritemap)if(n.spritemap.hasOwnProperty(i)){var s=r(e),o=n.spritemap[i];s.loop=!!o.hasOwnProperty("loop")&&o.loop,n.addMarker({name:i,start:o.start,duration:o.end-o.start,config:s})}return n},get:function(t){return c(this.sounds,"key",t)},getAll:function(t){return u(this.sounds,"key",t)},play:function(t,e){var n=this.add(t);return n.once(o.COMPLETE,n.destroy,n),e?e.name?(n.addMarker(e),n.play(e.name)):n.play(e):n.play()},playAudioSprite:function(t,e,n){var i=this.addAudioSprite(t);return i.once(o.COMPLETE,i.destroy,i),i.play(e,n)},remove:function(t){var e=this.sounds.indexOf(t);return-1!==e&&(t.destroy(),this.sounds.splice(e,1),!0)},removeAll:function(){this.sounds.forEach((function(t){t.destroy()})),this.sounds.length=0},removeByKey:function(t){for(var e=0,n=this.sounds.length-1;n>=0;n--){var i=this.sounds[n];i.key===t&&(i.destroy(),this.sounds.splice(n,1),e++)}return e},pauseAll:function(){this.forEachActiveSound((function(t){t.pause()})),this.emit(o.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound((function(t){t.resume()})),this.emit(o.RESUME_ALL,this)},stopAll:function(){this.forEachActiveSound((function(t){t.stop()})),this.emit(o.STOP_ALL,this)},stopByKey:function(t){var e=0;return this.getAll(t).forEach((function(t){t.stop()&&e++})),e},unlock:h,onBlur:h,onFocus:h,onGameBlur:function(){this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.pauseOnBlur&&this.onFocus()},update:function(t,e){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(o.UNLOCKED,this));for(var n=this.sounds.length-1;n>=0;n--)this.sounds[n].pendingRemove&&this.sounds.splice(n,1);this.sounds.forEach((function(n){n.update(t,e)}))},destroy:function(){this.game.events.off(a.BLUR,this.onGameBlur,this),this.game.events.off(a.FOCUS,this.onGameFocus,this),this.game.events.off(a.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.game=null},forEachActiveSound:function(t,e){var n=this;this.sounds.forEach((function(i,r){i&&!i.pendingRemove&&t.call(e||n,i,r,n.sounds)}))},setRate:function(t){return this.rate=t,this},rate:{get:function(){return this._rate},set:function(t){this._rate=t,this.forEachActiveSound((function(t){t.calculateRate()})),this.emit(o.GLOBAL_RATE,this,t)}},setDetune:function(t){return this.detune=t,this},detune:{get:function(){return this._detune},set:function(t){this._detune=t,this.forEachActiveSound((function(t){t.calculateRate()})),this.emit(o.GLOBAL_DETUNE,this,t)}}});t.exports=l},function(t,e,n){var i=n(0),r=n(9),s=n(71),o=n(17),a=n(1),h=new i({Extends:r,initialize:function(t,e,n){r.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=o(this.config,n),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(t){return!(!t||!t.name||"string"!=typeof t.name||(this.markers[t.name]?(console.error("addMarker "+t.name+" already exists in Sound"),1):(t=o(!0,{name:"",start:0,duration:this.totalDuration-(t.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},t),this.markers[t.name]=t,0)))},updateMarker:function(t){return!(!t||!t.name||"string"!=typeof t.name||(this.markers[t.name]?(this.markers[t.name]=o(!0,this.markers[t.name],t),0):(console.warn("Audio Marker: "+t.name+" missing in Sound: "+this.key),1)))},removeMarker:function(t){var e=this.markers[t];return e?(this.markers[t]=null,e):null},play:function(t,e){if(void 0===t&&(t=""),"object"==typeof t&&(e=t,t=""),"string"!=typeof t)return!1;if(t){if(!this.markers[t])return console.warn("Marker: "+t+" missing in Sound: "+this.key),!1;this.currentMarker=this.markers[t],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}else this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;return this.resetConfig(),this.currentConfig=o(this.currentConfig,e),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return!(this.isPaused||!this.isPlaying||(this.isPlaying=!1,this.isPaused=!0,0))},resume:function(){return!(!this.isPaused||this.isPlaying||(this.isPlaying=!0,this.isPaused=!1,0))},stop:function(){return!(!this.isPaused&&!this.isPlaying||(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),0))},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:a,calculateRate:function(){var t=this.currentConfig.detune+this.manager.detune,e=Math.pow(1.0005777895065548,t);this.totalRate=this.currentConfig.rate*this.manager.rate*e},destroy:function(){this.pendingRemove||(this.emit(s.DESTROY,this),this.pendingRemove=!0,this.manager=null,this.key="",this.removeAllListeners(),this.isPlaying=!1,this.isPaused=!1,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});t.exports=h},function(t,e,n){var i=n(209),r=n(435);t.exports=function(t,e){if(void 0===e&&(e=90),!i(t))return null;if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)(t=r(t)).reverse();else if(-90===e||270===e||"rotateRight"===e)t.reverse(),t=r(t);else if(180===Math.abs(e)||"rotate180"===e){for(var n=0;n<t.length;n++)t[n].reverse();t.reverse()}return t}},function(t,e,n){var i=n(0),r=n(18),s=n(11),o=n(15),a=n(1040),h=n(1041),u=n(212),c=n(10),l=n(1042),f=new i({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Texture,s.Tint,s.Transform,s.Visible,l],initialize:function(t,e,n,i,r,s,h){void 0===r&&(r=""),void 0===h&&(h=0),o.call(this,t,"BitmapText"),this.font=i;var u=this.scene.sys.cache.bitmapFont.get(i);u||console.warn("Invalid BitmapText key: "+i),this.fontData=u.data,this._text="",this._fontSize=s||this.fontData.size,this._letterSpacing=0,this._align=h,this._bounds=a(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.setTexture(u.texture,u.frame),this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.setText(r)},setLeftAlign:function(){return this._align=f.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=f.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=f.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=.5),this.dropShadowX=t,this.dropShadowY=e,this.dropShadowColor=n,this.dropShadowAlpha=i,this},setCharacterTint:function(t,e,n,i,s,o,a){void 0===t&&(t=0),void 0===e&&(e=1),void 0===n&&(n=!1),void 0===i&&(i=-1),void 0===s&&(s=i,o=i,a=i);var h=this.text.length;-1===e&&(e=h),t<0&&(t=h+t),t=r(t,0,h-1);for(var u=r(t+e,t,h),c=this.charColors,l=t;l<u;l++){var f=c[l];if(-1===i)c[l]=null;else{var d=n?1:0;f?(f.tintEffect=d,f.tintTL=i,f.tintTR=s,f.tintBL=o,f.tintBR=a):c[l]={tintEffect:d,tintTL:i,tintTR:s,tintBL:o,tintBR:a}}}return this},setWordTint:function(t,e,n,i,r,s,o){void 0===e&&(e=1);for(var a=this.getTextBounds().words,h="number"==typeof t,u=0,c=0;c<a.length;c++){var l=a[c];if((h&&c===t||!h&&l.word===t)&&(this.setCharacterTint(l.i,l.word.length,n,i,r,s,o),++u===e))return this}return this},getTextBounds:function(t){var e=this._bounds;return(this._dirty||t||this.scaleX!==e.scaleX||this.scaleY!==e.scaleY)&&(a(this,t,!0,e),this._dirty=!1),e},getCharacterAt:function(t,e,n){for(var i=this.getLocalPoint(t,e,null,n),r=this.getTextBounds().characters,s=new c,o=0;o<r.length;o++){var a=r[o];if(s.setTo(a.x,a.t,a.r-a.x,a.b),s.contains(i.x,i.y))return a}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(t,e,n){if(void 0===e&&(e=this._fontSize),void 0===n&&(n=this._align),t!==this.font){var i=this.scene.sys.cache.bitmapFont.get(t);i&&(this.font=t,this.fontData=i.data,this._fontSize=e,this._align=n,this.setTexture(i.texture,i.frame),a(this,!1,!0,this._bounds))}return this},setMaxWidth:function(t,e){return this._maxWidth=t,this._dirty=!0,void 0!==e&&(this.wordWrapCharCode=e),this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},maxWidth:{set:function(t){this._maxWidth=t,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},toJSON:function(){var t=s.ToJSON(this),e={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,align:this.align};return t.data=e,t},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});f.ALIGN_LEFT=0,f.ALIGN_CENTER=1,f.ALIGN_RIGHT=2,f.ParseFromAtlas=h,f.ParseXMLBitmapFont=u,t.exports=f},function(t,e,n){var i=new(n(0))({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var n=0;n<this.entries.length;n++){var i=this.entries[n];if(i[t]===e)return i}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var n,i=this.entries.slice(),r=i.length;if(e)for(n=0;n<r&&!1!==t.call(e,i[n],n);n++);else for(n=0;n<r&&!1!==t(i[n],n);n++);return this},iterate:function(t,e){var n,i=this.entries.length;if(e)for(n=0;n<i&&!1!==t.call(e,this.entries[n],n);n++);else for(n=0;n<i&&!1!==t(this.entries[n],n);n++);return this},iterateLocal:function(t){var e,n=[];for(e=1;e<arguments.length;e++)n.push(arguments[e]);var i=this.entries.length;for(e=0;e<i;e++){var r=this.entries[e];r[t].apply(r,n)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(t){var e=new i;return t.entries.forEach((function(t){e.set(t)})),this.entries.forEach((function(t){e.set(t)})),e},intersect:function(t){var e=new i;return this.entries.forEach((function(n){t.contains(n)&&e.set(n)})),e},difference:function(t){var e=new i;return this.entries.forEach((function(n){t.contains(n)||e.set(n)})),e},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});t.exports=i},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(189),a=n(67),h=n(1179),u=new i({Extends:s,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.GetBounds,r.Mask,r.Pipeline,r.ScrollFactor,r.Transform,r.Visible,h],initialize:function(t,e,n,i,r,h,u){void 0===i&&(i=16777215),void 0===r&&(r=128),void 0===h&&(h=1),void 0===u&&(u=.1),s.call(this,t,"PointLight"),this.initPipeline(a.POINTLIGHT_PIPELINE),this.setPosition(e,n),this.color=o(i),this.intensity=h,this.attenuation=u,this.width=2*r,this.height=2*r,this._radius=r},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*t,this.height=2*t}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}});t.exports=u},function(t,e){t.exports=function(t,e){var n=e.width/2,i=e.height/2,r=Math.abs(t.x-e.x-n),s=Math.abs(t.y-e.y-i),o=n+t.radius,a=i+t.radius;if(r>o||s>a)return!1;if(r<=n||s<=i)return!0;var h=r-n,u=s-i;return h*h+u*u<=t.radius*t.radius}},function(t,e,n){var i=n(6),r={},s={register:function(t,e,n,i,s){r[t]={plugin:e,mapping:n,settingsKey:i,configKey:s}},getPlugin:function(t){return r[t]},install:function(t){var e=t.scene.sys,n=e.settings.input,s=e.game.config;for(var o in r){var a=r[o].plugin,h=r[o].mapping,u=r[o].settingsKey,c=r[o].configKey;i(n,u,s[c])&&(t[h]=new a(t))}},remove:function(t){r.hasOwnProperty(t)&&delete r[t]}};t.exports=s},function(t,e,n){t.exports={ANY_KEY_DOWN:n(1320),ANY_KEY_UP:n(1321),COMBO_MATCH:n(1322),DOWN:n(1323),KEY_DOWN:n(1324),KEY_UP:n(1325),UP:n(1326)}},function(t,e){t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},function(t,e){t.exports=function(t,e,n,i,r,s){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===r&&(r=0),void 0===s&&(s=!1),{responseType:t,async:e,user:n,password:i,timeout:r,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:s}}},function(t,e,n){var i=n(0),r=n(243),s=n(74),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Pushable,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},function(t,e,n){var i=n(120);t.exports=function(t,e,n,r){if(void 0===n&&(n=!1),i(t,e,r)){var s=r.data[e][t]||null;return s?-1===s.index?n?s:null:s:null}return null}},function(t,e){t.exports=function(t,e,n,i){var r,s,o,a=t.data,h=t.width,u=t.height,c=t.tilemapLayer,l=Math.max(0,e.left),f=Math.min(h,e.right),d=Math.max(0,e.top),p=Math.min(u,e.bottom);if(0===n)for(s=d;s<p;s++)for(r=l;a[s]&&r<f;r++)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(1===n)for(s=d;s<p;s++)for(r=f;a[s]&&r>=l;r--)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(2===n)for(s=p;s>=d;s--)for(r=l;a[s]&&r<f;r++)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(3===n)for(s=p;s>=d;s--)for(r=f;a[s]&&r>=l;r--)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);return c.tilesDrawn=i.length,c.tilesTotal=h*u,i}},function(t,e){t.exports=function(t,e,n){var i=n.collideIndexes.indexOf(t);e&&-1===i?n.collideIndexes.push(t):e||-1===i||n.collideIndexes.splice(i,1)}},function(t,e,n){var i=n(2);t.exports=function(t,e,n){if(!e)return{i:0,layers:t.layers,name:"",opacity:1,visible:!0,x:0,y:0};var r=e.x+i(e,"startx",0)*t.tilewidth+i(e,"offsetx",0),s=e.y+i(e,"starty",0)*t.tileheight+i(e,"offsety",0);return{i:0,layers:e.layers,name:n.name+e.name+"/",opacity:n.opacity*e.opacity,visible:n.visible&&e.visible,x:n.x+r,y:n.y+s}}},function(t,e){t.exports=function(t,e,n){return t.hasOwnProperty(e)?"function"==typeof t[e]?function(n,i,r,s,o,a){return t[e](n,i,r,s,o,a)}:function(){return t[e]}:"function"==typeof n?n:function(){return n}}},function(t,e,n){var i=n(265),r=n(13),s=n(99),o=n(81),a=n(162),h=n(583),u=n(263),c=n(6),l=n(264),f=n(266),d=n(268);t.exports=function(t,e,n){void 0===n&&(n=i);for(var p=n.targets?n.targets:u(e),v=h(e),g=a(e,"delay",n.delay),m=a(e,"duration",n.duration),y=c(e,"easeParams",n.easeParams),x=o(c(e,"ease",n.ease),y),b=a(e,"hold",n.hold),w=a(e,"repeat",n.repeat),_=a(e,"repeatDelay",n.repeatDelay),T=s(e,"yoyo",n.yoyo),E=s(e,"flipX",n.flipX),S=s(e,"flipY",n.flipY),C=[],A=0;A<v.length;A++)for(var I=v[A].key,P=v[A].value,R=0;R<p.length;R++){var O=l(I,P),k=d(p[R],R,I,O.getEnd,O.getStart,O.getActive,o(c(P,"ease",x),c(P,"easeParams",y)),a(P,"delay",g),a(P,"duration",m),s(P,"yoyo",T),a(P,"hold",b),a(P,"repeat",w),a(P,"repeatDelay",_),s(P,"flipX",E),s(P,"flipY",S));C.push(k)}var M=new f(t,C,p);M.offset=r(e,"offset",null),M.completeDelay=r(e,"completeDelay",0),M.loop=Math.round(r(e,"loop",0)),M.loopDelay=Math.round(r(e,"loopDelay",0)),M.paused=s(e,"paused",!1),M.useFrames=s(e,"useFrames",!1);for(var D=c(e,"callbackScope",M),L=[M,null],N=f.TYPES,F=0;F<N.length;F++){var B=N[F],U=c(e,B,!1);if(U){var V=c(e,B+"Scope",D),Y=c(e,B+"Params",[]);M.setCallback(B,U,L.concat(Y),V)}}return M}},function(t,e,n){var i=n(0),r=n(102),s=n(2),o=n(133),a=n(185),h=new i({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.on(o.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(void 0===t)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];null===this.nextAnim?this.nextAnim=i:this.nextAnimsQueue.push(i)}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var e=this.animationManager,n="string"==typeof t?t:s(t,"key",null),i=this.exists(n)?this.get(n):e.get(n);if(i){this.currentAnim=i;var r=i.getTotalFrames(),o=s(t,"frameRate",i.frameRate),a=s(t,"duration",i.duration);i.calculateDuration(this,r,a,o),this.delay=s(t,"delay",i.delay),this.repeat=s(t,"repeat",i.repeat),this.repeatDelay=s(t,"repeatDelay",i.repeatDelay),this.yoyo=s(t,"yoyo",i.yoyo),this.showOnStart=s(t,"showOnStart",i.showOnStart),this.hideOnComplete=s(t,"hideOnComplete",i.hideOnComplete),this.skipMissedFrames=s(t,"skipMissedFrames",i.skipMissedFrames),this.timeScale=s(t,"timeScale",this.timeScale);var h=s(t,"startFrame",0);h>i.getTotalFrames()&&(h=0);var u=i.frames[h];0!==h||this.forward||(u=i.getLastFrame()),this.currentFrame=u}else console.warn("Missing animation: "+n);return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(this.isPlaying){var n=this.nextAnim,i=this.nextAnimsQueue;n&&i.unshift(n),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}else this.delayCounter=e,this.play(t,!0);return this.parent},playAfterRepeat:function(t,e){if(void 0===e&&(e=1),this.isPlaying){var n=this.nextAnim,i=this.nextAnimsQueue;n&&i.unshift(n),-1!==this.repeatCounter&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}else this.play(t);return this.parent},play:function(t,e){void 0===e&&(e=!1);var n=this.currentAnim,i=this.parent,r="string"==typeof t?t:t.key;if(e&&this.isPlaying&&n.key===r)return i;if(n&&this.isPlaying){var s=this.animationManager.getMix(n.key,t);if(s>0)return this.playAfterDelay(t,s)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){void 0===e&&(e=!1);var n="string"==typeof t?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===n?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,n=this.parent;return e?(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter&&this.handleStart(),n):n},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(o.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(o.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(o.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(o.ANIMATION_COMPLETE,o.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var n=this.currentAnim,i=this.currentFrame,r=this.parent,s=i.textureFrame;r.emit(t,n,i,r,s),e&&r.emit(e+n.key,n,i,r,s)},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var n=this.currentAnim,i=this.parent;return n?(e&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),n.getFirstTick(this),this.emitEvents(o.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(n.frames[0]),this.parent):i},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return void 0===t&&(t=1),-1!==this.repeatCounter&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var n=this.currentAnim;if(this.isPlaying&&n&&!n.paused){if(this.accumulator+=e*this.timeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?n.nextFrame(this):n.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var i=0;do{this.forward?n.nextFrame(this):n.previousFrame(this),i++}while(this.accumulator>this.nextTick&&i<60)}}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(o.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return!!this.anims&&this.anims.has(t)},create:function(t){var e=t.key,n=!1;return e&&((n=this.get(e))||(n=new a(this,e,t),this.anims||(this.anims=new r),this.anims.set(e,n))),n},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(o.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});t.exports=h},function(t,e,n){var i={};t.exports=i;var r=n(166);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(t,e){for(var n=e*e*e,r=0;r<t.length;r++){var s=t[r],o=s.speed*s.speed+s.angularSpeed*s.angularSpeed;if(0===s.force.x&&0===s.force.y){var a=Math.min(s.motion,o),h=Math.max(s.motion,o);s.motion=i._minBias*a+(1-i._minBias)*h,s.sleepThreshold>0&&s.motion<i._motionSleepThreshold*n?(s.sleepCounter+=1,s.sleepCounter>=s.sleepThreshold&&i.set(s,!0)):s.sleepCounter>0&&(s.sleepCounter-=1)}else i.set(s,!1)}},i.afterCollisions=function(t,e){for(var n=e*e*e,r=0;r<t.length;r++){var s=t[r];if(s.isActive){var o=s.collision,a=o.bodyA.parent,h=o.bodyB.parent;if(!(a.isSleeping&&h.isSleeping||a.isStatic||h.isStatic)&&(a.isSleeping||h.isSleeping)){var u=a.isSleeping&&!a.isStatic?a:h,c=u===a?h:a;!u.isStatic&&c.motion>i._motionWakeThreshold*n&&i.set(u,!1)}}}},i.set=function(t,e){var n=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,n||r.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,n&&r.trigger(t,"sleepEnd"))}},function(t,e,n){var i={};t.exports=i;var r=n(32);i.on=function(t,e,n){for(var i,r=e.split(" "),s=0;s<r.length;s++)i=r[s],t.events=t.events||{},t.events[i]=t.events[i]||[],t.events[i].push(n);return n},i.off=function(t,e,n){if(e){"function"==typeof e&&(n=e,e=r.keys(t.events).join(" "));for(var i=e.split(" "),s=0;s<i.length;s++){var o=t.events[i[s]],a=[];if(n&&o)for(var h=0;h<o.length;h++)o[h]!==n&&a.push(o[h]);t.events[i[s]]=a}}else t.events={}},i.trigger=function(t,e,n){var i,s,o,a,h=t.events;if(h&&r.keys(h).length>0){n||(n={}),i=e.split(" ");for(var u=0;u<i.length;u++)if(o=h[s=i[u]]){(a=r.clone(n,!1)).name=s,a.source=t;for(var c=0;c<o.length;c++)o[c].apply(t,[a])}}}},function(t,e,n){var i=n(175),r=n(67),s=n(75),o={defaultPipeline:null,pipeline:null,hasPostPipeline:!1,postPipelines:null,pipelineData:null,initPipeline:function(t){void 0===t&&(t=r.MULTI_PIPELINE);var e=this.scene.sys.renderer;if(!e)return!1;var n=e.pipelines;if(this.postPipelines=[],this.pipelineData={},n){var i=n.get(t);if(i)return this.defaultPipeline=i,this.pipeline=i,!0}return!1},setPipeline:function(t,e,n){var r=this.scene.sys.renderer;if(!r)return this;var s=r.pipelines;if(s){var o=s.get(t);o&&(this.pipeline=o),e&&(this.pipelineData=n?i(e):e)}return this},setPostPipeline:function(t,e,n){var r=this.scene.sys.renderer;if(!r)return this;var s=r.pipelines;if(s){Array.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++){var a=s.getPostPipeline(t[o],this);a&&this.postPipelines.push(a)}e&&(this.pipelineData=n?i(e):e)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPipelineData:function(t,e){var n=this.pipelineData;return void 0===e?delete n[t]:n[t]=e,this},getPostPipeline:function(t){for(var e=this.postPipelines,n=[],i=0;i<e.length;i++){var r=e[i];("string"==typeof t&&r.name===t||r instanceof t)&&n.push(r)}return 1===n.length?n[0]:n},resetPipeline:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.pipeline=this.defaultPipeline,t&&(this.postPipelines=[],this.hasPostPipeline=!1),e&&(this.pipelineData={}),null!==this.pipeline},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,n=0;n<e.length;n++)e[n].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.pipelineData={})},removePostPipeline:function(t){for(var e=this.postPipelines,n=e.length-1;n>=0;n--){var i=e[n];("string"==typeof t&&i.name===t||"string"!=typeof t&&i instanceof t)&&(i.destroy(),s(e,n))}return this.hasPostPipeline=this.postPipelines.length>0,this},getPipelineName:function(){return this.pipeline.name}};t.exports=o},function(t,e){t.exports={DEFAULT:0,LINEAR:0,NEAREST:1}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x+t.radius*Math.cos(e),n.y=t.y+t.radius*Math.sin(e),n}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=2*Math.PI*Math.random(),r=Math.random()+Math.random(),s=r>1?2-r:r,o=s*Math.cos(n),a=s*Math.sin(n);return e.x=t.x+o*t.radius,e.y=t.y+a*t.radius,e}},function(t,e,n){var i=n(131),r=n(4);t.exports=function(t,e,n){if(void 0===n&&(n=new r),e<=0||e>=1)return n.x=t.x,n.y=t.y,n;var s=i(t)*e;return e>.5?(s-=t.width+t.height)<=t.width?(n.x=t.right-s,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(s-t.width)):s<=t.width?(n.x=t.x+s,n.y=t.y):(n.x=t.right,n.y=t.y+(s-t.width)),n}},function(t,e,n){var i=n(66),r=n(4);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&n>0&&(e=i(t)/n);for(var o=t.x1,a=t.y1,h=t.x2,u=t.y2,c=0;c<e;c++){var l=c/e,f=o+(h-o)*l,d=a+(u-a)*l;s.push(new r(f,d))}return s}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},function(t,e){var n=function(t){var e,i,r;if("object"!=typeof t||null===t)return t;for(r in e=Array.isArray(t)?[]:{},t)i=t[r],e[r]=n(i);return e};t.exports=n},function(t,e){t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s,o,a,h){void 0===h&&(h=new i);var u=Math.sin(s),c=Math.cos(s),l=c*o,f=u*o,d=-u*a,p=c*a,v=1/(l*p+d*-f);return h.x=p*v*t+-d*v*e+(r*d-n*p)*v,h.y=l*v*e+-f*v*t+(-r*l+n*f)*v,h}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());return e.x=t.x+r*Math.cos(n)*t.width/2,e.y=t.y+r*Math.sin(n)*t.height/2,e}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x2-t.x1,r=t.y2-t.y1,s=t.x3-t.x1,o=t.y3-t.y1,a=Math.random(),h=Math.random();return a+h>=1&&(a=1-a,h=1-h),e.x=t.x1+(n*a+s*h),e.y=t.y1+(r*a+o*h),e}},function(t,e){t.exports=function(t,e,n,i,r){var s=i+Math.atan2(t.y-n,t.x-e);return t.x=e+r*Math.cos(s),t.y=n+r*Math.sin(s),t}},function(t,e){t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},function(t,e){t.exports=function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)}},function(t,e,n){var i=n(18),r=n(0),s=n(133),o=n(318),a=n(319),h=n(6),u=n(320),c=new r({initialize:function(t,e,n){this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,h(n,"frames",[]),h(n,"defaultTextureKey",null),h(n,"sortFrames",!0)),this.frameRate=h(n,"frameRate",null),this.duration=h(n,"duration",null),this.msPerFrame,this.skipMissedFrames=h(n,"skipMissedFrames",!0),this.delay=h(n,"delay",0),this.repeat=h(n,"repeat",0),this.repeatDelay=h(n,"repeatDelay",0),this.yoyo=h(n,"yoyo",!1),this.showOnStart=h(n,"showOnStart",!1),this.hideOnComplete=h(n,"hideOnComplete",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(s.PAUSE_ALL,this.pause,this),this.manager.on(s.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,n,i){null===n&&null===i?(t.frameRate=24,t.duration=24/e*1e3):n&&null===i?(t.duration=n,t.frameRate=e/(n/1e3)):(t.frameRate=i,t.duration=e/i*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var n=this.getFrames(this.manager.textureManager,e);if(n.length>0){if(0===t)this.frames=n.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(n);else{var i=this.frames.slice(0,t),r=this.frames.slice(t);this.frames=i.concat(n,r)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.msPerFrame+t.currentFrame.duration},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,n,i){void 0===i&&(i=!0);var r,s,o,c,l=[],f=1;if("string"==typeof e){c=e;var d=t.get(c).getFrameNames();i&&u(d),e=[],d.forEach((function(t){e.push({key:c,frame:t})}))}if(!Array.isArray(e)||0===e.length)return l;for(o=0;o<e.length;o++){var p=e[o],v=h(p,"key",n);if(v){var g=h(p,"frame",0),m=t.getFrame(v,g);(s=new a(v,g,f,m)).duration=h(p,"duration",0),s.isFirst=!r,r&&(r.nextFrame=s,s.prevFrame=r),l.push(s),r=s,f++}}if(l.length>0){s.isLast=!0,s.nextFrame=l[0],l[0].prevFrame=s;var y=1/(l.length-1);for(o=0;o<l.length;o++)l[o].progress=o*y}return l},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.msPerFrame+t.currentFrame.duration},getFrameByProgress:function(t){return t=i(t,0,1),o(t,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0)return(0===t.repeatDelay||t.pendingRepeat)&&(t.forward=e),void this.repeatAnimation(t);if(t.inReverse===e||0!==t.repeatCounter){t.forward=e;var n=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,n)}else t.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?(t.inReverse&&!t.forward||(t.forward=!0),this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop){if(0===t._pendingStopValue)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showOnStart:this.showOnStart,hideOnComplete:this.hideOnComplete};return this.frames.forEach((function(e){t.frames.push(e.toJSON())})),t},updateFrameSequence:function(){for(var t,e=this.frames.length,n=1/(e-1),i=0;i<e;i++)(t=this.frames[i]).index=i+1,t.isFirst=!1,t.isLast=!1,t.progress=i*n,0===i?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[i+1])):i===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[i-1],t.nextFrame=this.frames[i+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(s.PAUSE_ALL,this.pause,this),this.manager.off(s.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});t.exports=c},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3);var r=0;if(e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var s=Math.ceil((r=e-t.length)/2);t=new Array(r-s+1).join(n)+t+new Array(s+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},function(t,e,n){var i=n(327),r=n(189),s=n(331),o=n(332);t.exports=function(t){switch(typeof t){case"string":return"rgb"===t.substr(0,3).toLowerCase()?o(t):i(t);case"number":return r(t);case"object":return s(t)}}},function(t,e,n){var i=n(103);function r(t,e,n,i){var r=(t+6*e)%6,s=Math.min(r,4-r,1);return Math.round(255*(i-i*n*Math.max(0,s)))}t.exports=function(t,e,n,s){void 0===e&&(e=1),void 0===n&&(n=1);var o=r(5,t,e,n),a=r(3,t,e,n),h=r(1,t,e,n);return s?s.setTo?s.setTo(o,a,h,s.alpha,!1):(s.r=o,s.g=a,s.b=h,s.color=i(o,a,h),s):{r:o,g:a,b:h,color:i(o,a,h)}}},function(t,e,n){var i=n(38),r=n(330);t.exports=function(t){var e=r(t);return new i(e.r,e.g,e.b,e.a)}},function(t,e){t.exports=function(t,e,n){return t.x=e-t.width/2,t.y=n-t.height/2,t}},function(t,e,n){var i=n(105),r=n(137),s=n(31),o={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};t.exports=function(){if("function"==typeof importScripts)return o;o.canvas=!!window.CanvasRenderingContext2D;try{o.localStorage=!!localStorage.getItem}catch(t){o.localStorage=!1}o.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),o.fileSystem=!!window.requestFileSystem;var t,e,n,a=!1;return o.webGL=function(){if(window.WebGLRenderingContext)try{var t=s.createWebGL(this),e=t.getContext("webgl")||t.getContext("experimental-webgl"),n=s.create2D(this),i=n.getContext("2d").createImageData(1,1);return a=i.data instanceof Uint8ClampedArray,s.remove(t),s.remove(n),!!e}catch(t){return!1}return!1}(),o.worker=!!window.Worker,o.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,o.getUserMedia=o.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,r.firefox&&r.firefoxVersion<21&&(o.getUserMedia=!1),!i.iOS&&(r.ie||r.firefox||r.chrome)&&(o.canvasBitBltShift=!0),(r.safari||r.mobileSafari)&&(o.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(o.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(o.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===n[0]||2712847316!==n[0]&&null)),o.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==o.littleEndian&&a,o}()},function(t,e){var n,i="";t.exports={disable:function(t){return""===i&&(i=n(t)),i&&(t[i]=!1),t},enable:function(t){return""===i&&(i=n(t)),i&&(t[i]=!0),t},getPrefix:n=function(t){for(var e=["i","webkitI","msI","mozI","oI"],n=0;n<e.length;n++){var i=e[n]+"mageSmoothingEnabled";if(i in t)return i}return null},isEnabled:function(t){return null!==i?t[i]:null}}},function(t,e,n){var i=n(14),r=n(17),s={Angle:n(812),Distance:n(821),Easing:n(826),Fuzzy:n(827),Interpolation:n(830),Pow2:n(835),Snap:n(837),RandomDataGenerator:n(839),Average:n(840),Bernstein:n(356),Between:n(195),CatmullRom:n(194),CeilTo:n(841),Clamp:n(18),DegToRad:n(36),Difference:n(842),Euler:n(843),Factorial:n(357),FloatBetween:n(138),FloorTo:n(844),FromPercent:n(98),GetSpeed:n(845),IsEven:n(846),IsEvenStrict:n(847),Linear:n(136),MaxAdd:n(848),MinSub:n(849),Percent:n(850),RadToDeg:n(196),RandomXY:n(851),RandomXYZ:n(852),RandomXYZW:n(853),Rotate:n(362),RotateAround:n(308),RotateAroundDistance:n(182),RotateTo:n(854),RoundAwayFromZero:n(363),RoundTo:n(855),SinCosTableGenerator:n(856),SmootherStep:n(183),SmoothStep:n(184),ToXY:n(857),TransformXY:n(177),Within:n(858),Wrap:n(68),Vector2:n(3),Vector3:n(39),Vector4:n(141),Matrix3:n(364),Matrix4:n(69),Quaternion:n(365),RotateVec3:n(859)};s=r(!1,s,i),t.exports=s},function(t,e){t.exports=function(t,e,n,i,r){var s=.5*(i-e),o=.5*(r-n),a=t*t;return(2*n-2*i+s+o)*(t*a)+(-3*n+3*i-2*s-o)*a+s*t+n}},function(t,e){t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},function(t,e,n){var i=n(14);t.exports=function(t){return t*i.RAD_TO_DEG}},function(t,e,n){t.exports={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]}},function(t,e,n){var i=new(n(0))({initialize:function(){this._matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.alpha=1,this._dirty=!0,this._data},set:function(t){return this._matrix=t,this._dirty=!0,this},reset:function(){var t=this._matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=1,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=1,t[13]=0,t[14]=0,t[15]=0,t[16]=0,t[17]=0,t[18]=1,t[19]=0,this._dirty=!0,this},getData:function(){if(this._dirty){var t=new Float32Array(this._matrix);t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,this._data=t,this._dirty=!1}return this._data},brightness:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=t;return this.multiply([n,0,0,0,0,0,n,0,0,0,0,0,n,0,0,0,0,0,1,0],e)},saturate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=2*t/3+1,i=-.5*(n-1);return this.multiply([n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0],e)},desaturate:function(t){return void 0===t&&(t=!1),this.saturate(-1,t)},hue:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),t=t/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=.213,s=.715,o=.072;return this.multiply([r+.787*n+i*-r,s+n*-s+i*-s,o+n*-o+.928*i,0,0,r+n*-r+.143*i,s+n*(1-s)+.14*i,o+n*-o+-.283*i,0,0,r+n*-r+-.787*i,s+n*-s+i*s,o+.928*n+i*o,0,0,0,0,0,1,0],e)},grayscale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!1),this.saturate(-t,e)},blackWhite:function(t){return void 0===t&&(t=!1),this.multiply([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},contrast:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=t+1,i=-.5*(n-1);return this.multiply([n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0],e)},negative:function(t){return void 0===t&&(t=!1),this.multiply([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},desaturateLuminance:function(t){return void 0===t&&(t=!1),this.multiply([.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],t)},sepia:function(t){return void 0===t&&(t=!1),this.multiply([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},night:function(t,e){return void 0===t&&(t=.1),void 0===e&&(e=!1),this.multiply([-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},lsd:function(t){return void 0===t&&(t=!1),this.multiply([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},brown:function(t){return void 0===t&&(t=!1),this.multiply([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},vintagePinhole:function(t){return void 0===t&&(t=!1),this.multiply([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},kodachrome:function(t){return void 0===t&&(t=!1),this.multiply([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},technicolor:function(t){return void 0===t&&(t=!1),this.multiply([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},polaroid:function(t){return void 0===t&&(t=!1),this.multiply([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},shiftToBGR:function(t){return void 0===t&&(t=!1),this.multiply([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},multiply:function(t,e){e||this.reset();for(var n=this._matrix,i=[],r=0;r<20;r++)i[r]=n[r];return n[0]=i[0]*t[0]+i[1]*t[5]+i[2]*t[10]+i[3]*t[15],n[1]=i[0]*t[1]+i[1]*t[6]+i[2]*t[11]+i[3]*t[16],n[2]=i[0]*t[2]+i[1]*t[7]+i[2]*t[12]+i[3]*t[17],n[3]=i[0]*t[3]+i[1]*t[8]+i[2]*t[13]+i[3]*t[18],n[4]=i[0]*t[4]+i[1]*t[9]+i[2]*t[14]+i[3]*t[19]+i[4],n[5]=i[5]*t[0]+i[6]*t[5]+i[7]*t[10]+i[8]*t[15],n[6]=i[5]*t[1]+i[6]*t[6]+i[7]*t[11]+i[8]*t[16],n[7]=i[5]*t[2]+i[6]*t[7]+i[7]*t[12]+i[8]*t[17],n[8]=i[5]*t[3]+i[6]*t[8]+i[7]*t[13]+i[8]*t[18],n[9]=i[5]*t[4]+i[6]*t[9]+i[7]*t[14]+i[8]*t[19]+i[9],n[10]=i[10]*t[0]+i[11]*t[5]+i[12]*t[10]+i[13]*t[15],n[11]=i[10]*t[1]+i[11]*t[6]+i[12]*t[11]+i[13]*t[16],n[12]=i[10]*t[2]+i[11]*t[7]+i[12]*t[12]+i[13]*t[17],n[13]=i[10]*t[3]+i[11]*t[8]+i[12]*t[13]+i[13]*t[18],n[14]=i[10]*t[4]+i[11]*t[9]+i[12]*t[14]+i[13]*t[19]+i[14],n[15]=i[15]*t[0]+i[16]*t[5]+i[17]*t[10]+i[18]*t[15],n[16]=i[15]*t[1]+i[16]*t[6]+i[17]*t[11]+i[18]*t[16],n[17]=i[15]*t[2]+i[16]*t[7]+i[17]*t[12]+i[18]*t[17],n[18]=i[15]*t[3]+i[16]*t[8]+i[17]*t[13]+i[18]*t[18],n[19]=i[15]*t[4]+i[16]*t[9]+i[17]*t[14]+i[18]*t[19]+i[19],this._dirty=!0,this}});t.exports=i},function(t,e,n){var i=n(10),r=n(14);t.exports=function(t,e){if(void 0===e&&(e=new i),0===t.length)return e;for(var n,s,o,a=Number.MAX_VALUE,h=Number.MAX_VALUE,u=r.MIN_SAFE_INTEGER,c=r.MIN_SAFE_INTEGER,l=0;l<t.length;l++)n=t[l],Array.isArray(n)?(s=n[0],o=n[1]):(s=n.x,o=n.y),a=Math.min(a,s),h=Math.min(h,o),u=Math.max(u,s),c=Math.max(c,o);return e.x=a,e.y=h,e.width=u-a,e.height=c-h,e}},function(t,e,n){var i=n(0),r=n(1),s=new i({initialize:function(t,e,n){this._rgb=[0,0,0],this.onChangeCallback=r,this.dirty=!1,this.set(t,e,n)},set:function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._rgb=[t,e,n],this.onChange(),this},equals:function(t,e,n){var i=this._rgb;return i.r===t&&i.g===e&&i.b===n},onChange:function(){this.dirty=!0;var t=this._rgb;this.onChangeCallback.call(this,t[0],t[1],t[2])},r:{get:function(){return this._rgb[0]},set:function(t){this._rgb[0]=t,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(t){this._rgb[1]=t,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(t){this._rgb[2]=t,this.onChange()}},destroy:function(){this.onChangeCallback=null}});t.exports=s},function(t,e,n){var i={CENTER:n(403),ORIENTATION:n(404),SCALE_MODE:n(405),ZOOM:n(406)};t.exports=i},function(t,e){t.exports=function(t){t.parentNode&&t.parentNode.removeChild(t)}},function(t,e){t.exports={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8}},function(t,e,n){var i=n(0),r=n(145),s=n(197),o=n(20),a=n(419),h=n(420),u=n(33),c=n(1),l=n(421),f=new i({initialize:function(t,e){this.scene=t,this.game,this.renderer,this.config=e,this.settings=l.create(e),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=c},init:function(t){this.settings.status=r.INIT,this.sceneUpdate=c,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var e=t.plugins;this.plugins=e,e.addToScene(this,s.Global,[s.CoreScene,h(this),a(this)]),this.events.emit(o.BOOT,this),this.settings.isBooted=!0},install:function(t){Array.isArray(t)||(t=[t]),this.plugins.installLocal(this,t)},step:function(t,e){var n=this.events;n.emit(o.PRE_UPDATE,t,e),n.emit(o.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),n.emit(o.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(o.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(o.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var e=this.events,n=this.settings;return this.settings.active&&(n.status=r.PAUSED,n.active=!1,e.emit(o.PAUSE,this,t)),this},resume:function(t){var e=this.events,n=this.settings;return this.settings.active||(n.status=r.RUNNING,n.active=!0,e.emit(o.RESUME,this,t)),this},sleep:function(t){var e=this.events,n=this.settings;return n.status=r.SLEEPING,n.active=!1,n.visible=!1,e.emit(o.SLEEP,this,t),this},wake:function(t){var e=this.events,n=this.settings;return n.status=r.RUNNING,n.active=!0,n.visible=!0,e.emit(o.WAKE,this,t),n.isTransition&&e.emit(o.TRANSITION_WAKE,n.transitionFrom,n.transitionDuration),this},getData:function(){return this.settings.data},isSleeping:function(){return this.settings.status===r.SLEEPING},isActive:function(){return this.settings.status===r.RUNNING},isPaused:function(){return this.settings.status===r.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var e=this.events,n=this.settings;t&&(n.data=t),n.status=r.START,n.active=!0,n.visible=!0,e.emit(o.START,this),e.emit(o.READY,this,t)},shutdown:function(t){var e=this.events,n=this.settings;e.off(o.TRANSITION_INIT),e.off(o.TRANSITION_START),e.off(o.TRANSITION_COMPLETE),e.off(o.TRANSITION_OUT),n.status=r.SHUTDOWN,n.active=!1,n.visible=!1,this.renderer===u.WEBGL&&this.renderer.resetTextures(!0),e.emit(o.SHUTDOWN,this,t)},destroy:function(){var t=this.events,e=this.settings;e.status=r.DESTROYED,e.active=!1,e.visible=!1,t.emit(o.DESTROY,this),t.removeAllListeners();for(var n=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],i=0;i<n.length;i++)this[n[i]]=null}});t.exports=f},function(t,e){t.exports=function(t){return t&&t[0].toUpperCase()+t.slice(1)}},function(t,e,n){var i=n(33),r=n(0),s=n(109),o=n(424),a="Texture.frame missing: ",h=new r({initialize:function(t,e,n,i,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var s=0;s<n.length;s++)this.source.push(new o(this,n[s],i,r))},add:function(t,e,n,i,r,o){if(this.has(t))return null;var a=new s(this,t,e,n,i,r,o);return this.frames[t]=a,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,a},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames[t]},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(a+t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var n=[];for(var i in this.frames)if("__BASE"!==i||e){var r=this.frames[i];r.sourceIndex===t&&n.push(r)}return n},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var n=e.indexOf("__BASE");-1!==n&&e.splice(n,1)}return e},getSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(a+t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e,n=this.frames[t];return n?e=n.sourceIndex:(console.warn(a+t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new o(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t;for(t=0;t<this.source.length;t++)this.source[t].destroy();for(t=0;t<this.dataSource.length;t++)this.dataSource[t].destroy();for(var e in this.frames)this.frames[e].destroy();this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key);var n=this.manager.game.renderer;n&&n.type===i.WEBGL&&n.resetTextures(!0),this.manager=null}});t.exports=h},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=[];if(i(t,r,s))for(var a=r;a<s;a++){var h=t[a];(!e||e&&void 0===n&&h.hasOwnProperty(e)||e&&void 0!==n&&h[e]===n)&&o.push(h)}return o}},function(t,e,n){t.exports={Matrix:n(1012),Add:n(1020),AddAt:n(1021),BringToTop:n(1022),CountAllMatching:n(1023),Each:n(1024),EachInRange:n(1025),FindClosestInSorted:n(318),GetAll:n(207),GetFirst:n(428),GetRandom:n(210),MoveDown:n(1026),MoveTo:n(1027),MoveUp:n(1028),NumberArray:n(322),NumberArrayStep:n(1029),QuickSelect:n(436),Range:n(437),Remove:n(93),RemoveAt:n(1030),RemoveBetween:n(1031),RemoveRandomElement:n(1032),Replace:n(1033),RotateLeft:n(178),RotateRight:n(179),SafeRange:n(79),SendToBack:n(1034),SetAll:n(1035),Shuffle:n(132),SortByDigits:n(320),SpliceOne:n(75),StableSort:n(80),Swap:n(1036)}},function(t,e){t.exports=function(t){if(!Array.isArray(t)||t.length<2||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},function(t,e,n){var i=n(0),r=n(9),s=n(438),o=new i({Extends:r,initialize:function(){r.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},add:function(t){return this._pending.push(t),this._toProcess++,t},remove:function(t){return this._destroy.push(t),this._toProcess++,t},removeAll:function(){for(var t=this._active,e=this._destroy,n=t.length;n--;)e.push(t[n]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,i=this._active;for(t=0;t<n.length;t++){e=n[t];var r=i.indexOf(e);-1!==r&&(i.splice(r,1),this.emit(s.PROCESS_QUEUE_REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)e=n[t],(!this.checkQueue||this.checkQueue&&-1===i.indexOf(e))&&(i.push(e),this.emit(s.PROCESS_QUEUE_ADD,e));return n.length=0,this._toProcess=0,i},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});t.exports=o},function(t,e){function n(t,e){return parseInt(t.getAttribute(e),10)}t.exports=function(t,e,i,r,s){void 0===i&&(i=0),void 0===r&&(r=0);var o=e.cutX,a=e.cutY,h=e.source.width,u=e.source.height,c=e.sourceIndex,l={},f=t.getElementsByTagName("info")[0],d=t.getElementsByTagName("common")[0];l.font=f.getAttribute("face"),l.size=n(f,"size"),l.lineHeight=n(d,"lineHeight")+r,l.chars={};var p=t.getElementsByTagName("char"),v=void 0!==e&&e.trimmed;if(v)var g=e.height,m=e.width;for(var y=0;y<p.length;y++){var x=p[y],b=n(x,"id"),w=String.fromCharCode(b),_=n(x,"x"),T=n(x,"y"),E=n(x,"width"),S=n(x,"height");v&&(_<m&&(m=_),T<g&&(g=T)),v&&0!==g&&0!==m&&(_-=e.x,T-=e.y);var C=(o+_)/h,A=(a+T)/u,I=(o+_+E)/h,P=(a+T+S)/u;if(l.chars[b]={x:_,y:T,width:E,height:S,centerX:Math.floor(E/2),centerY:Math.floor(S/2),xOffset:n(x,"xoffset"),yOffset:n(x,"yoffset"),xAdvance:n(x,"xadvance")+i,data:{},kerning:{},u0:C,v0:A,u1:I,v1:P},s&&0!==E&&0!==S){var R=s.add(w,c,_,T,E,S);R&&R.setUVs(E,S,C,A,I,P)}}var O=t.getElementsByTagName("kerning");for(y=0;y<O.length;y++){var k=O[y],M=n(k,"first"),D=n(k,"second"),L=n(k,"amount");l.chars[D].kerning[M]=L}return l}},function(t,e,n){var i=n(1046),r=n(440),s=n(0),o=n(11),a=n(109),h=n(15),u=n(110),c=new s({Extends:h,Mixins:[o.Alpha,o.BlendMode,o.Depth,o.Mask,o.Pipeline,o.ScrollFactor,o.Size,o.Texture,o.Transform,o.Visible,i],initialize:function(t,e,n,i,r){h.call(this,t,"Blitter"),this.setTexture(i,r),this.setPosition(e,n),this.initPipeline(),this.children=new u,this.renderList=[],this.dirty=!1},create:function(t,e,n,i,s){void 0===i&&(i=!0),void 0===s&&(s=this.children.length),void 0===n?n=this.frame:n instanceof a||(n=this.texture.get(n));var o=new r(this,t,e,n,i);return this.children.addAt(o,s,!1),this.dirty=!0,o},createFromCallback:function(t,e,n,i){for(var r=this.createMultiple(e,n,i),s=0;s<r.length;s++){var o=r[s];t.call(this,o,s)}return r},createMultiple:function(t,e,n){void 0===e&&(e=this.frame.name),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var i=[],r=this;return e.forEach((function(e){for(var s=0;s<t;s++)i.push(r.create(0,0,e,n))})),i},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});t.exports=c},function(t,e,n){var i=n(208),r=n(35),s=n(0),o=n(11),a=n(76),h=n(15),u=n(10),c=n(1049),l=n(441),f=n(3),d=new s({Extends:h,Mixins:[o.AlphaSingle,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.Pipeline,o.Transform,o.Visible,c],initialize:function(t,e,n,i){h.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPipeline(),this.setPosition(e,n),this.clearAlpha(),this.setBlendMode(r.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new u),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);t.setTo(e.x,e.y,0,0)}if(this.list.length>0){var n=this.list,i=new u,r=!1;t.setEmpty();for(var s=0;s<n.length;s++){var o=n[s];o.getBounds&&(o.getBounds(i),r?l(i,t,t):(t.setTo(i.x,i.y,i.width,i.height),r=!0))}}return t},addHandler:function(t){t.once(a.DESTROY,this.remove,this),this.exclusive&&(t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this)},removeHandler:function(t){t.off(a.DESTROY,this.remove),this.exclusive&&(t.parentContainer=null,t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new f),this.parentContainer?this.parentContainer.pointToContainer(t,e):e=new f(t.x,t.y);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e,n,r){return i.CountAllMatching(this.list,t,e,n,r)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++)n[r].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var r=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var s=0;s<r.length;s++)r[s].destroy();return this},removeAll:function(t){var e=i.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(t)for(var n=0;n<e.length;n++)e[n].destroy();return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){var n,i=[null],r=this.list.slice(),s=r.length;for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<s;n++)i[0]=r[n],t.apply(e,i);return this},iterate:function(t,e){var n,i=[null];for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}});t.exports=d},function(t,e,n){var i=n(149),r=n(0),s=n(1054),o=new r({Extends:i,Mixins:[s],initialize:function(t,e,n,r,s,o,a){i.call(this,t,e,n,r,s,o,a),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});t.exports=o},function(t,e,n){var i=n(134),r=n(0),s=n(217),o=n(303),a=n(304),h=n(305),u=n(309),c=n(167),l=n(312),f=n(313),d=n(314),p=n(111),v=n(15),g=n(2),m=n(6),y=n(14),x=n(67),b=n(1060),w=new r({Extends:v,Mixins:[o,a,h,u,c,f,d,l,b],initialize:function(t,e){var n=m(e,"x",0),i=m(e,"y",0);v.call(this,t,"Graphics"),this.setPosition(n,i),this.initPipeline(x.GRAPHICS_PIPELINE),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.setDefaultStyles(e)},setDefaultStyles:function(t){return m(t,"lineStyle",null)&&(this.defaultStrokeWidth=m(t,"lineStyle.width",1),this.defaultStrokeColor=m(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=m(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),m(t,"fillStyle",null)&&(this.defaultFillColor=m(t,"fillStyle.color",16777215),this.defaultFillAlpha=m(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(s.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(s.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,i,r,o,a,h){return void 0===r&&(r=1),void 0===o&&(o=r),void 0===a&&(a=r),void 0===h&&(h=r),this.commandBuffer.push(s.GRADIENT_FILL_STYLE,r,o,a,h,t,e,n,i),this},lineGradientStyle:function(t,e,n,i,r,o){return void 0===o&&(o=1),this.commandBuffer.push(s.GRADIENT_LINE_STYLE,t,o,e,n,i,r),this},beginPath:function(){return this.commandBuffer.push(s.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(s.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(s.FILL_PATH),this},fill:function(){return this.commandBuffer.push(s.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(s.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(s.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,y.PI2),this.fillPath(),this},strokeCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,y.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,i){return this.commandBuffer.push(s.FILL_RECT,t,e,n,i),this},strokeRect:function(t,e,n,i){var r=this._lineWidth/2,s=t-r,o=t+r;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+i),this.strokePath(),this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+n,e+i),this.strokePath(),this.beginPath(),this.moveTo(s,e),this.lineTo(o+n,e),this.strokePath(),this.beginPath(),this.moveTo(s,e+i),this.lineTo(o+n,e+i),this.strokePath(),this},fillRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,h=r;return"number"!=typeof r&&(s=g(r,"tl",20),o=g(r,"tr",20),a=g(r,"bl",20),h=g(r,"br",20)),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),this.arc(t+n-o,e+o,o,-y.TAU,0),this.lineTo(t+n,e+i-h),this.arc(t+n-h,e+i-h,h,0,y.TAU),this.lineTo(t+a,e+i),this.arc(t+a,e+i-a,a,y.TAU,Math.PI),this.lineTo(t,e+s),this.arc(t+s,e+s,s,-Math.PI,-y.TAU),this.fillPath(),this},strokeRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,h=r;return"number"!=typeof r&&(s=g(r,"tl",20),o=g(r,"tr",20),a=g(r,"bl",20),h=g(r,"br",20)),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),this.moveTo(t+n-o,e),this.arc(t+n-o,e+o,o,-y.TAU,0),this.lineTo(t+n,e+i-h),this.moveTo(t+n,e+i-h),this.arc(t+n-h,e+i-h,h,0,y.TAU),this.lineTo(t+a,e+i),this.moveTo(t+a,e+i),this.arc(t+a,e+i-a,a,y.TAU,Math.PI),this.lineTo(t,e+s),this.moveTo(t,e+s),this.arc(t+s,e+s,s,-Math.PI,-y.TAU),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(s.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.FILL_TRIANGLE,t,e,n,i,r,o),this},strokeTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.STROKE_TRIANGLE,t,e,n,i,r,o),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,n,i){return this.beginPath(),this.moveTo(t,e),this.lineTo(n,i),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(s.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(s.MOVE_TO,t,e),this},strokePoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.strokePoints(n,!0)},strokeEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new p(t,e,n,i).getPoints(r);return this.strokePoints(s,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.fillPoints(n,!0)},fillEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new p(t,e,n,i).getPoints(r);return this.fillPoints(s,!0)},arc:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this},slice:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.BEGIN_PATH),this.commandBuffer.push(s.MOVE_TO,t,e),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this.commandBuffer.push(s.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(s.SAVE),this},restore:function(){return this.commandBuffer.push(s.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(s.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(s.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(s.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,n){var i,r,s=this.scene.sys,o=s.game.renderer;if(void 0===e&&(e=s.scale.width),void 0===n&&(n=s.scale.height),w.TargetCamera.setScene(this.scene),w.TargetCamera.setViewport(0,0,e,n),w.TargetCamera.scrollX=this.x,w.TargetCamera.scrollY=this.y,"string"==typeof t)if(s.textures.exists(t)){var a=(i=s.textures.get(t)).getSourceImage();a instanceof HTMLCanvasElement&&(r=a.getContext("2d"))}else r=(i=s.textures.createCanvas(t,e,n)).getSourceImage().getContext("2d");else t instanceof HTMLCanvasElement&&(r=t.getContext("2d"));return r&&(this.renderCanvas(o,this,w.TargetCamera,null,r,!1),i&&i.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});w.TargetCamera=new i,t.exports=w},function(t,e){t.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.width/2,s=t.height/2;return n.x=t.x+r*Math.cos(e),n.y=t.y+s*Math.sin(e),n}},function(t,e,n){var i=n(35),r=n(0),s=n(11),o=n(176),a=n(101),h=n(9),u=n(76),c=n(110),l=n(1068),f=n(20),d=n(80),p=new r({Extends:c,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Mask,s.Pipeline,s.Visible,h,l],initialize:function(t,e){c.call(this,t),h.call(this),this.scene=t,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=t.sys,this.events=t.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPipeline(),this.clearAlpha(),this.setBlendMode(i.SKIP_CHECK),e&&this.add(e),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new a(this)),this},setData:function(t,e){return this.data||(this.data=new a(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new a(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new a(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new a(this)),this.data.get(t)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return o(this)},willRender:function(t){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return n.unshift(this.displayList.getIndex(t)),n},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(u.ADDED_TO_SCENE,t,this.scene),this.events.emit(f.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(u.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(f.REMOVED_FROM_SCENE,t,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(d(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},destroy:function(){if(this.scene&&!this.ignoreDestroy){this.emit(u.DESTROY,this);for(var t=this.list.length;t--;)this.list[t].destroy();this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}});t.exports=p},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(450),a=n(110),h=n(452),u=n(1072),c=new i({Extends:s,Mixins:[r.Depth,r.Mask,r.Pipeline,r.Transform,r.Visible,u],initialize:function(t,e,n,i){if(s.call(this,t,"ParticleEmitterManager"),this.blendMode=-1,this.timeScale=1,this.texture=null,this.frame=null,this.frameNames=[],null===n||"object"!=typeof n&&!Array.isArray(n)||(i=n,n=null),this.setTexture(e,n),this.initPipeline(),this.emitters=new a(this),this.wells=new a(this),i){Array.isArray(i)||(i=[i]);for(var r=0;r<i.length;r++)this.createEmitter(i[r])}},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){this.frame=this.texture.get(t);var e=this.texture.getFramesFromTextureSource(this.frame.sourceIndex),n=[];return e.forEach((function(t){n.push(t.name)})),this.frameNames=n,this.defaultFrame=this.frame,this},setEmitterFrames:function(t,e){Array.isArray(t)||(t=[t]);var n=e.frames;n.length=0;for(var i=0;i<t.length;i++){var r=t[i];-1!==this.frameNames.indexOf(r)&&n.push(this.texture.get(r))}return n.length>0?e.defaultFrame=n[0]:e.defaultFrame=this.defaultFrame,this},addEmitter:function(t){return this.emitters.add(t)},createEmitter:function(t){return this.addEmitter(new h(this,t))},removeEmitter:function(t){return this.emitters.remove(t,!0)},addGravityWell:function(t){return this.wells.add(t)},createGravityWell:function(t){return this.addGravityWell(new o(t))},emitParticle:function(t,e,n){for(var i=this.emitters.list,r=0;r<i.length;r++){var s=i[r];s.active&&s.emitParticle(t,e,n)}return this},emitParticleAt:function(t,e,n){return this.emitParticle(n,t,e)},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},getProcessors:function(){return this.wells.getAll("active",!0)},preUpdate:function(t,e){e*=this.timeScale;for(var n=this.emitters.list,i=0;i<n.length;i++){var r=n[i];r.active&&r.preUpdate(t,e)}},setAlpha:function(){},setScrollFactor:function(){},setBlendMode:function(){}});t.exports=c},function(t,e,n){var i=n(35),r=n(134),s=n(31),o=n(0),a=n(11),h=n(33),u=n(109),c=n(15),l=n(1),f=n(67),d=n(1076),p=n(142),v=n(12),g=n(222),m=new o({Extends:c,Mixins:[a.Alpha,a.BlendMode,a.ComputedSize,a.Crop,a.Depth,a.Flip,a.GetBounds,a.Mask,a.Origin,a.Pipeline,a.ScrollFactor,a.Tint,a.Transform,a.Visible,d],initialize:function(t,e,n,i,o,a,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=32),void 0===o&&(o=32),c.call(this,t,"RenderTexture"),this.renderer=t.sys.renderer,this.textureManager=t.sys.textures,this.globalTint=16777215,this.globalAlpha=1,this.canvas=null,this.dirty=!1,this._crop=this.resetCropObject(),this.texture=null,this.frame=null,this._saved=!1,void 0===a?(this.canvas=s.create2D(this,i,o),this.texture=t.sys.textures.addCanvas(g(),this.canvas),this.frame=this.texture.get()):(this.texture=t.sys.textures.get(a),this.frame=this.texture.get(u),this.canvas=this.frame.source.image,this._saved=!0,this.dirty=!0,this.width=this.frame.cutWidth,this.height=this.frame.cutHeight),this.context=this.canvas.getContext("2d"),this._eraseMode=!1,this.camera=new r(0,0,i,o),this.renderTarget=null;var d=this.renderer;d?d.type===h.WEBGL?(this.drawGameObject=this.batchGameObjectWebGL,this.renderTarget=new p(d,i,o,1,0,!1)):d.type===h.CANVAS&&(this.drawGameObject=this.batchGameObjectCanvas):this.drawGameObject=l,this.camera.setScene(t),this.setPosition(e,n),void 0===a&&this.setSize(i,o),this.setOrigin(0,0),this.initPipeline(f.SINGLE_PIPELINE)},setSize:function(t,e){return this.resize(t,e)},resize:function(t,e){void 0===e&&(e=t);var n=this.frame;if(t!==this.width||e!==this.height){if("__BASE"===n.name){this.canvas.width=t,this.canvas.height=e,this.texture.width=t,this.texture.height=e;var i=this.renderTarget;i&&(i.resize(t,e),n.glTexture=i.texture,n.source.isRenderTexture=!0,n.source.isGLTexture=!0,n.source.glTexture=i.texture),this.camera.setSize(t,e),n.source.width=t,n.source.height=e,n.setSize(t,e),this.width=t,this.height=e}}else{var r=this.texture.getSourceImage();n.cutX+t>r.width&&(t=r.width-n.cutX),n.cutY+e>r.height&&(e=r.height-n.cutY),n.setSize(t,e,n.cutX,n.cutY)}this.updateDisplayOrigin();var s=this.input;return s&&!s.customHitArea&&(s.hitArea.width=t,s.hitArea.height=e),this},setGlobalTint:function(t){return this.globalTint=t,this},setGlobalAlpha:function(t){return this.globalAlpha=t,this},saveTexture:function(t){return this.textureManager.renameTexture(this.texture.key,t),this._saved=!0,this.texture},fill:function(t,e,n,i,r,s){var o=this.frame,a=this.camera,h=this.renderer;void 0===e&&(e=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=o.cutWidth),void 0===s&&(s=o.cutHeight);var u=(t>>16&255)/255,c=(t>>8&255)/255,l=(255&t)/255,f=this.renderTarget;if(a.preRender(),f){f.bind(!0);var d=this.pipeline;d.manager.set(d);var p=f.width,g=f.height,m=h.width/p,y=h.height/g;d.drawFillRect(n*m,i*y,r*m,s*y,v.getTintFromFloats(l,c,u,1),e),f.unbind(!0)}else{var x=this.context;h.setContext(x),x.fillStyle="rgba("+u+","+c+","+l+","+e+")",x.fillRect(n+o.cutX,i+o.cutY,r,s),h.setContext()}return this.dirty=!0,this},clear:function(){if(this.dirty){var t=this.renderTarget;if(t)t.clear();else{var e=this.context;e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight),e.restore()}this.dirty=!1}return this},erase:function(t,e,n){return this._eraseMode=!0,this.draw(t,e,n,1,16777215),this._eraseMode=!1,this},draw:function(t,e,n,i,r){return this.beginDraw(),this.batchDraw(t,e,n,i,r),this.endDraw(),this},drawFrame:function(t,e,n,i,r,s){return this.beginDraw(),this.batchDrawFrame(t,e,n,i,r,s),this.endDraw(),this},beginDraw:function(){var t=this.camera,e=this.renderer,n=this.renderTarget;return t.preRender(),n?e.beginCapture(n.width,n.height):e.setContext(this.context),this},batchDraw:function(t,e,n,i,r){return void 0===i&&(i=this.globalAlpha),r=void 0===r?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(r>>16)+(65280&r)+((255&r)<<16),Array.isArray(t)||(t=[t]),this.batchList(t,e,n,i,r),this},batchDrawFrame:function(t,e,n,i,r,s){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.globalAlpha),s=void 0===s?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(s>>16)+(65280&s)+((255&s)<<16);var o=this.textureManager.getFrame(t,e);return o&&(this.renderTarget?this.pipeline.batchTextureFrame(o,n,i,s,r,this.camera.matrix,null):this.batchTextureFrame(o,n+this.frame.cutX,i+this.frame.cutY,r,s)),this},endDraw:function(){var t=this.renderer,e=this.renderTarget;if(e){var n=t.endCapture();t.pipelines.setUtility().blitFrame(n,e,1,!1,!1,this._eraseMode),t.resetScissor(),t.resetViewport()}else t.setContext();return this.dirty=!0,this},batchList:function(t,e,n,i,r){for(var s=0;s<t.length;s++){var o=t[s];o&&o!==this&&(o.renderWebGL||o.renderCanvas?this.drawGameObject(o,e,n):o.isParent||o.list?this.batchGroup(o.getChildren(),e,n):"string"==typeof o?this.batchTextureFrameKey(o,null,e,n,i,r):o instanceof u?this.batchTextureFrame(o,e,n,i,r):Array.isArray(o)&&this.batchList(o,e,n,i,r))}},batchGroup:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),e+=this.frame.cutX,n+=this.frame.cutY;for(var i=0;i<t.length;i++){var r=t[i];if(r.willRender(this.camera)){var s=r.x+e,o=r.y+n;this.drawGameObject(r,s,o)}}},batchGameObjectWebGL:function(t,e,n){void 0===e&&(e=t.x),void 0===n&&(n=t.y);var i=t.x,r=t.y;t.setPosition(e+this.frame.cutX,n+this.frame.cutY),t.renderDirect?t.renderDirect(this.renderer,t,this.camera):t.renderWebGL(this.renderer,t,this.camera),t.setPosition(i,r)},batchGameObjectCanvas:function(t,e,n){void 0===e&&(e=t.x),void 0===n&&(n=t.y);var r=t.x,s=t.y;if(this._eraseMode){var o=t.blendMode;t.blendMode=i.ERASE}t.setPosition(e+this.frame.cutX,n+this.frame.cutY),t.renderCanvas(this.renderer,t,this.camera,null),t.setPosition(r,s),this._eraseMode&&(t.blendMode=o)},batchTextureFrameKey:function(t,e,n,i,r,s){var o=this.textureManager.getFrame(t,e);o&&this.batchTextureFrame(o,n,i,r,s)},batchTextureFrame:function(t,e,n,i,r){if(void 0===e&&(e=0),void 0===n&&(n=0),e+=this.frame.cutX,n+=this.frame.cutY,this.renderTarget)this.pipeline.batchTextureFrame(t,e,n,r,i,this.camera.matrix,null);else{var s=this.context,o=t.canvasData,a=t.source.image,h=this.camera.matrix;s.save(),s.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",s.globalAlpha=i,h.setToContext(s),s.drawImage(a,o.x,o.y,o.width,o.height,e,n,o.width,o.height),s.restore()}},snapshotArea:function(t,e,n,i,r,s,o){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,r,!1,t,e,n,i,s,o):this.renderer.snapshotCanvas(this.canvas,r,!1,t,e,n,i,s,o),this},snapshot:function(t,e,n){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,t,!1,0,0,this.width,this.height,e,n):this.renderer.snapshotCanvas(this.canvas,t,!1,0,0,this.width,this.height,e,n),this},snapshotPixel:function(t,e,n){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,n,!0,t,e):this.renderer.snapshotCanvas(this.canvas,n,!0,t,e),this},preDestroy:function(){this._saved||(s.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.texture.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.texture=null)}});t.exports=m},function(t,e){t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}},function(t,e,n){var i=n(164),r=n(0),s=n(11),o=n(15),a=n(67),h=n(1082),u=n(3),c=new r({Extends:o,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Flip,s.Mask,s.Pipeline,s.Size,s.Texture,s.Transform,s.Visible,s.ScrollFactor,h],initialize:function(t,e,n,r,s,h,c,l,f){void 0===r&&(r="__DEFAULT"),void 0===h&&(h=2),void 0===c&&(c=!0),o.call(this,t,"Rope"),this.anims=new i(this),this.points=h,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===r,this.dirty=!1,this.horizontal=c,this._flipX=!1,this._flipY=!1,this._perp=new u,this.debugCallback=null,this.debugGraphic=null,this.setTexture(r,s),this.setPosition(e,n),this.setSizeToFrame(),this.initPipeline(a.ROPE_PIPELINE),Array.isArray(h)&&this.resizeArrays(h.length),this.setPoints(h,l,f),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){var n=this.anims.currentFrame;this.anims.update(t,e),this.anims.currentFrame!==n&&(this.updateUVs(),this.updateVertices())},play:function(t,e,n){return this.anims.play(t,e,n),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(t,e,n){return void 0===t&&(t=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(t,e,n))},setVertical:function(t,e,n){return void 0===t&&(t=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(t,e,n)):this},setTintFill:function(t){return void 0===t&&(t=!1),this.tintFill=t,this},setAlphas:function(t,e){var n=this.points.length;if(n<1)return this;var i,r=this.alphas;void 0===t?t=[1]:Array.isArray(t)||void 0!==e||(t=[t]);var s=0;if(void 0!==e)for(i=0;i<n;i++)r[s=2*i]=t,r[s+1]=e;else if(t.length===n)for(i=0;i<n;i++)r[s=2*i]=t[i],r[s+1]=t[i];else{var o=t[0];for(i=0;i<n;i++)s=2*i,t.length>s&&(o=t[s]),r[s]=o,t.length>s+1&&(o=t[s+1]),r[s+1]=o}return this},setColors:function(t){var e=this.points.length;if(e<1)return this;var n,i=this.colors;void 0===t?t=[16777215]:Array.isArray(t)||(t=[t]);var r=0;if(t.length===e)for(n=0;n<e;n++)i[r=2*n]=t[n],i[r+1]=t[n];else{var s=t[0];for(n=0;n<e;n++)r=2*n,t.length>r&&(s=t[r]),i[r]=s,t.length>r+1&&(s=t[r+1]),i[r+1]=s}return this},setPoints:function(t,e,n){if(void 0===t&&(t=2),"number"==typeof t){var i,r,s,o=t;if(o<2&&(o=2),t=[],this.horizontal)for(s=-this.frame.halfWidth,r=this.frame.width/(o-1),i=0;i<o;i++)t.push({x:s+i*r,y:0});else for(s=-this.frame.halfHeight,r=this.frame.height/(o-1),i=0;i<o;i++)t.push({x:0,y:s+i*r})}var a=t.length,h=this.points.length;return a<1?(console.warn("Rope: Not enough points given"),this):(1===a&&(t.unshift({x:0,y:0}),a++),h!==a&&this.resizeArrays(a),this.points=t,this.updateUVs(),null!=e&&this.setColors(e),null!=n&&this.setAlphas(n),this)},updateUVs:function(){for(var t=this.uv,e=this.points.length,n=this.frame.u0,i=this.frame.v0,r=this.frame.u1,s=this.frame.v1,o=(r-n)/(e-1),a=(s-i)/(e-1),h=0;h<e;h++){var u,c,l,f,d=4*h;this.horizontal?(this._flipX?(u=r-h*o,l=r-h*o):(u=n+h*o,l=n+h*o),this._flipY?(c=s,f=i):(c=i,f=s)):(this._flipX?(u=n,l=r):(u=r,l=n),this._flipY?(c=s-h*a,f=s-h*a):(c=i+h*a,f=i+h*a)),t[d+0]=u,t[d+1]=c,t[d+2]=l,t[d+3]=f}return this},resizeArrays:function(t){var e=this.colors,n=this.alphas;this.vertices=new Float32Array(4*t),this.uv=new Float32Array(4*t),e=new Uint32Array(2*t),n=new Float32Array(2*t);for(var i=0;i<2*t;i++)e[i]=16777215,n[i]=1;return this.colors=e,this.alphas=n,this.dirty=!0,this},updateVertices:function(){var t=this._perp,e=this.points,n=this.vertices,i=e.length;if(this.dirty=!1,!(i<1)){for(var r,s=e[0],o=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,a=0;a<i;a++){var h=e[a],u=4*a;r=a<i-1?e[a+1]:h,t.x=r.y-s.y,t.y=-(r.x-s.x);var c=t.length();t.x/=c,t.y/=c,t.x*=o,t.y*=o,n[u]=h.x+t.x,n[u+1]=h.y+t.y,n[u+2]=h.x-t.x,n[u+3]=h.y-t.y,s=h}return this}},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts:function(t,e,n){var i=t.debugGraphic,r=n[0],s=n[1],o=n[2],a=n[3];i.lineBetween(r,s,o,a);for(var h=4;h<e;h+=4){var u=n[h+0],c=n[h+1],l=n[h+2],f=n[h+3];i.lineBetween(r,s,u,c),i.lineBetween(o,a,l,f),i.lineBetween(o,a,u,c),i.lineBetween(u,c,l,f),r=u,s=c,o=l,a=f}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(t){return this._flipX=t,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(t){return this._flipY=t,this.updateUVs()}}});t.exports=c},function(t,e,n){var i=n(143),r=n(31),s=n(0),o=n(11),a=n(22),h=n(15),u=n(458),c=n(6),l=n(202),f=n(1085),d=n(459),p=new s({Extends:h,Mixins:[o.Alpha,o.BlendMode,o.ComputedSize,o.Crop,o.Depth,o.Flip,o.GetBounds,o.Mask,o.Origin,o.Pipeline,o.ScrollFactor,o.Tint,o.Transform,o.Visible,f],initialize:function(t,e,n,i,s){void 0===e&&(e=0),void 0===n&&(n=0),h.call(this,t,"Text"),this.renderer=t.sys.renderer,this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.canvas=r.create(this),this.context=this.canvas.getContext("2d"),this.style=new d(this,s),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(i),s&&s.padding&&this.setPadding(s.padding),s&&s.lineSpacing&&this.setLineSpacing(s.lineSpacing),t.sys.game.events.on(a.CONTEXT_RESTORED,(function(){this.dirty=!0}),this)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var n=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(n)&&(n=n.join("\n")),n}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,n){for(var i="",r=t.replace(/ +/gi," ").split(this.splitRegExp),s=r.length,o=0;o<s;o++){var a=r[o],h="";if(a=a.replace(/^ *|\s*$/gi,""),e.measureText(a).width<n)i+=a+"\n";else{for(var u=n,c=a.split(" "),l=0;l<c.length;l++){var f=c[l],d=f+" ",p=e.measureText(d).width;if(p>u){if(0===l){for(var v=d;v.length&&(v=v.slice(0,-1),!((p=e.measureText(v).width)<=u)););if(!v.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var g=f.substr(v.length);c[l]=g,h+=v}var m=c[l].length?l:l+1,y=c.slice(m).join(" ").replace(/[ \n]*$/gi,"");r[o+1]=y+" "+(r[o+1]||""),s=r.length;break}h+=d,u-=p}i+=h.replace(/[ \n]*$/gi,"")+"\n"}}return i.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,n){for(var i="",r=t.split(this.splitRegExp),s=r.length-1,o=e.measureText(" ").width,a=0;a<=s;a++){for(var h=n,u=r[a].split(" "),c=u.length-1,l=0;l<=c;l++){var f=u[l],d=e.measureText(f).width,p=d;l<c&&(p+=o),p>h&&l>0&&(i+="\n",h=n),i+=f,l<c?(i+=" ",h-=p):h-=d}a<s&&(i+="\n")}return i},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,n,i,r,s){return this.style.setShadow(t,e,n,i,r,s)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setPadding:function(t,e,n,i){if("object"==typeof t){var r=t,s=c(r,"x",null);null!==s?(t=s,n=s):(t=c(r,"left",0),n=c(r,"right",t));var o=c(r,"y",null);null!==o?(e=o,i=o):(e=c(r,"top",0),i=c(r,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=e);return this.padding.left=t,this.padding.top=e,this.padding.right=n,this.padding.bottom=i,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},updateText:function(){var t=this.canvas,e=this.context,n=this.style,i=n.resolution,r=n.metrics;n.syncFont(t,e);var s=this._text;(n.wordWrapWidth||n.wordWrapCallback)&&(s=this.runWordWrap(this._text));var o,a=s.split(this.splitRegExp),h=u(this,r,a),c=this.padding;0===n.fixedWidth?(this.width=h.width+c.left+c.right,o=h.width):(this.width=n.fixedWidth,(o=this.width-c.left-c.right)<h.width&&(o=h.width)),0===n.fixedHeight?this.height=h.height+c.top+c.bottom:this.height=n.fixedHeight;var l,f,d=this.width,p=this.height;this.updateDisplayOrigin(),d*=i,p*=i,d=Math.max(d,1),p=Math.max(p,1),t.width!==d||t.height!==p?(t.width=d,t.height=p,this.frame.setSize(d,p),n.syncFont(t,e)):e.clearRect(0,0,d,p),e.save(),e.scale(i,i),n.backgroundColor&&(e.fillStyle=n.backgroundColor,e.fillRect(0,0,d,p)),n.syncStyle(t,e),e.textBaseline="alphabetic",e.translate(c.left,c.top);for(var v=0;v<h.lines;v++){if(l=n.strokeThickness/2,f=n.strokeThickness/2+v*h.lineHeight+r.ascent,v>0&&(f+=h.lineSpacing*v),n.rtl)l=d-l;else if("right"===n.align)l+=o-h.lineWidths[v];else if("center"===n.align)l+=(o-h.lineWidths[v])/2;else if("justify"===n.align&&h.lineWidths[v]/h.width>=.85){var g=h.width-h.lineWidths[v],m=e.measureText(" ").width,y=a[v].trim(),x=y.split(" ");g+=(a[v].length-y.length)*m;for(var b=Math.floor(g/m),w=0;b>0;)x[w]+=" ",w=(w+1)%(x.length-1||1),--b;a[v]=x.join(" ")}this.autoRound&&(l=Math.round(l),f=Math.round(f)),n.strokeThickness&&(this.style.syncShadow(e,n.shadowStroke),e.strokeText(a[v],l,f)),n.color&&(this.style.syncShadow(e,n.shadowFill),e.fillText(a[v],l,f))}e.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;var _=this.input;return _&&!_.customHitArea&&(_.hitArea.width=this.width,_.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=o.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){this.style.rtl&&l(this.canvas),r.remove(this.canvas),this.texture.destroy()}});t.exports=p},function(t,e,n){var i=n(31),r=n(0),s=n(11),o=n(22),a=n(15),h=n(361),u=n(192),c=n(1088),l=n(3),f=new r({Extends:a,Mixins:[s.Alpha,s.BlendMode,s.ComputedSize,s.Crop,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Tint,s.Transform,s.Visible,c],initialize:function(t,e,n,r,s,u,c){var f=t.sys.renderer;a.call(this,t,"TileSprite");var d=t.sys.textures.get(u),p=d.get(c);r&&s?(r=Math.floor(r),s=Math.floor(s)):(r=p.width,s=p.height),this._tilePosition=new l,this._tileScale=new l(1,1),this.dirty=!1,this.renderer=f,this.canvas=i.create(this,r,s),this.context=this.canvas.getContext("2d"),this.displayTexture=d,this.displayFrame=p,this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.potWidth=h(p.width),this.potHeight=h(p.height),this.fillCanvas=i.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d"),this.fillPattern=null,this.setPosition(e,n),this.setSize(r,s),this.setFrame(c),this.setOriginFromFrame(),this.initPipeline(),t.sys.game.events.on(o.CONTEXT_RESTORED,(function(t){if(t){var e=t.gl;this.dirty=!0,this.fillPattern=null,this.fillPattern=t.createTexture2D(0,e.LINEAR,e.LINEAR,e.REPEAT,e.REPEAT,e.RGBA,this.fillCanvas,this.potWidth,this.potHeight)}}),this)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){var e=this.displayTexture.get(t);return this.potWidth=h(e.width),this.potHeight=h(e.height),this.canvas.width=0,e.cutWidth&&e.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=e,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,n=this.fillCanvas,i=this.potWidth,r=this.potHeight;this.renderer&&this.renderer.gl||(i=t.cutWidth,r=t.cutHeight),e.clearRect(0,0,i,r),n.width=i,n.height=r,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,i,r),this.renderer&&this.renderer.gl?this.fillPattern=this.renderer.canvasToTexture(n,this.fillPattern):this.fillPattern=e.createPattern(n,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||u.disable(e);var n=this._tileScale.x,i=this._tileScale.y,r=this._tilePosition.x,s=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(n,i),e.translate(-r,-s),e.fillStyle=this.fillPattern,e.fillRect(r,s,this.width/n,this.height/i),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),i.remove(this.canvas),i.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null,this.texture.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});t.exports=f},function(t,e,n){var i=n(0),r=n(18),s=n(11),o=n(76),a=n(22),h=n(51),u=n(15),c=n(71),l=n(222),f=n(1091),d=n(14),p=new i({Extends:u,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,f],initialize:function(t,e,n,i){u.call(this,t,"Video"),this.video=null,this.videoTexture=null,this.videoTextureSource=null,this.snapshotTexture=null,this.flipY=!1,this._key=l(),this.touchLocked=!0,this.playWhenUnlocked=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={play:this.playHandler.bind(this),error:this.loadErrorHandler.bind(this),end:this.completeHandler.bind(this),time:this.timeUpdateHandler.bind(this),seeking:this.seekingHandler.bind(this),seeked:this.seekedHandler.bind(this)},this._crop=this.resetCropObject(),this.markers={},this._markerIn=-1,this._markerOut=d.MAX_SAFE_INTEGER,this._lastUpdate=0,this._cacheKey="",this._isSeeking=!1,this.removeVideoElementOnDestroy=!1,this.setPosition(e,n),this.initPipeline(),i&&this.changeSource(i,!1);var r=t.sys.game.events;r.on(a.PAUSE,this.globalPause,this),r.on(a.RESUME,this.globalResume,this);var s=t.sys.sound;s&&s.on(c.GLOBAL_MUTE,this.globalMute,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},play:function(t,e,n){if(this.touchLocked&&this.playWhenUnlocked||this.isPlaying())return this;var i=this.video;if(!i)return console.warn("Video not loaded"),this;void 0===t&&(t=i.loop);var r=this.scene.sys.sound;r&&r.mute&&this.setMute(!0),isNaN(e)||(this._markerIn=e),!isNaN(n)&&n>e&&(this._markerOut=n),i.loop=t;var s=this._callbacks,o=i.play();return void 0!==o?o.then(this.playPromiseSuccessHandler.bind(this)).catch(this.playPromiseErrorHandler.bind(this)):(i.addEventListener("playing",s.play,!0),i.readyState<2&&(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval))),i.addEventListener("ended",s.end,!0),i.addEventListener("timeupdate",s.time,!0),i.addEventListener("seeking",s.seeking,!0),i.addEventListener("seeked",s.seeked,!0),this},changeSource:function(t,e,n,i,r){void 0===e&&(e=!0),this.video&&this.stop();var s=this.scene.sys.cache.video.get(t);return s?(this.video=s,this._cacheKey=t,this._codePaused=s.paused,this._codeMuted=s.muted,this.videoTexture?(this.scene.sys.textures.remove(this._key),this.videoTexture=this.scene.sys.textures.create(this._key,s,s.videoWidth,s.videoHeight),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,s.videoWidth,s.videoHeight),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(o.VIDEO_CREATED,this,s.videoWidth,s.videoHeight)):this.updateTexture(),s.currentTime=0,this._lastUpdate=0,e&&this.play(n,i,r)):this.video=null,this},addMarker:function(t,e,n){return!isNaN(e)&&e>=0&&!isNaN(n)&&(this.markers[t]=[e,n]),this},playMarker:function(t,e){var n=this.markers[t];return n&&this.play(e,n[0],n[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),void 0===r&&(r=n),void 0===s&&(s=i);var o=this.video,a=this.snapshotTexture;return a?(a.setSize(r,s),o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)):(a=this.scene.sys.textures.createCanvas(l(),r,s),this.snapshotTexture=a,o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)),a.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},loadURL:function(t,e,n){void 0===e&&(e="loadeddata"),void 0===n&&(n=!1),this.video&&this.stop(),this.videoTexture&&this.scene.sys.textures.remove(this._key);var i=document.createElement("video");return i.controls=!1,n&&(i.muted=!0,i.defaultMuted=!0,i.setAttribute("autoplay","autoplay")),i.setAttribute("playsinline","playsinline"),i.setAttribute("preload","auto"),i.addEventListener("error",this._callbacks.error,!0),i.src=t,i.load(),this.video=i,this},loadMediaStream:function(t,e,n){void 0===e&&(e="loadeddata"),void 0===n&&(n=!1),this.video&&this.stop(),this.videoTexture&&this.scene.sys.textures.remove(this._key);var i=document.createElement("video");i.controls=!1,n&&(i.muted=!0,i.defaultMuted=!0,i.setAttribute("autoplay","autoplay")),i.setAttribute("playsinline","playsinline"),i.setAttribute("preload","auto"),i.addEventListener("error",this._callbacks.error,!0);try{i.srcObject=t}catch(e){i.src=window.URL.createObjectURL(t)}return i.load(),this.video=i,this},playPromiseSuccessHandler:function(){this.touchLocked=!1,this.emit(o.VIDEO_PLAY,this),this._markerIn>-1&&(this.video.currentTime=this._markerIn)},playPromiseErrorHandler:function(t){this.scene.sys.input.once(h.POINTER_DOWN,this.unlockHandler,this),this.touchLocked=!0,this.playWhenUnlocked=!0,this.emit(o.VIDEO_ERROR,this,t)},playHandler:function(){this.touchLocked=!1,this.emit(o.VIDEO_PLAY,this),this.video.removeEventListener("playing",this._callbacks.play,!0)},loadErrorHandler:function(t){this.stop(),this.emit(o.VIDEO_ERROR,this,t)},unlockHandler:function(){this.touchLocked=!1,this.playWhenUnlocked=!1,this.emit(o.VIDEO_UNLOCKED,this),this._markerIn>-1&&(this.video.currentTime=this._markerIn),this.video.play(),this.emit(o.VIDEO_PLAY,this)},completeHandler:function(){this.emit(o.VIDEO_COMPLETE,this)},timeUpdateHandler:function(){this.video&&this.video.currentTime<this._lastUpdate&&(this.emit(o.VIDEO_LOOP,this),this._lastUpdate=0)},preUpdate:function(){var t=this.video;if(t){var e=t.currentTime;e!==this._lastUpdate&&(this._lastUpdate=e,this.updateTexture(),e>=this._markerOut&&(t.loop?(t.currentTime=this._markerIn,this.updateTexture(),this._lastUpdate=e,this.emit(o.VIDEO_LOOP,this)):(this.emit(o.VIDEO_COMPLETE,this),this.stop())))}},checkVideoProgress:function(){this.video.readyState>=2?this.updateTexture():(this.retry--,this.retry>0?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval):this.emit(o.VIDEO_TIMEOUT,this))},updateTexture:function(){var t=this.video,e=t.videoWidth,n=t.videoHeight;if(this.videoTexture){var i=this.videoTextureSource;i.source!==t&&(i.source=t,i.width=e,i.height=n),i.update()}else this.videoTexture=this.scene.sys.textures.create(this._key,t,e,n),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,e,n),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(o.VIDEO_CREATED,this,e,n)},getVideoKey:function(){return this._cacheKey},seekTo:function(t){var e=this.video;if(e){var n=e.duration;if(n!==1/0&&!isNaN(n)){var i=n*t;this.setCurrentTime(i)}}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"==typeof t){var n=t[0],i=parseFloat(t.substr(1));"+"===n?t=e.currentTime+i:"-"===n&&(t=e.currentTime-i)}e.currentTime=t,this._lastUpdate=t}return this},isSeeking:function(){return this._isSeeking},seekingHandler:function(){this._isSeeking=!0,this.emit(o.VIDEO_SEEKING,this)},seekedHandler:function(){this._isSeeking=!1,this.emit(o.VIDEO_SEEKED,this),this.video&&this.updateTexture()},getProgress:function(){var t=this.video;if(t){var e=t.currentTime,n=t.duration;if(n!==1/0&&!isNaN(n))return e/n}return 0},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var n=this.video;n&&(n.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&this.video.pause()},globalResume:function(){this._systemPaused=!1,this.video&&!this._codePaused&&this.video.play()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&(t?e.paused||e.pause():t||e.paused&&!this._systemPaused&&e.play()),this},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(t){return void 0===t&&(t=1),this.video&&(this.video.volume=r(t,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&this.scene.sys.textures.renameTexture(this._key,t),this._key=t,this.flipY=e,this.videoTextureSource&&this.videoTextureSource.setFlipY(e),this.videoTexture},stop:function(){var t=this.video;if(t){var e=this._callbacks;for(var n in e)t.removeEventListener(n,e[n],!0);t.pause()}return this._retryID&&window.clearTimeout(this._retryID),this.emit(o.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(),this.removeVideoElementOnDestroy&&this.removeVideoElement();var t=this.scene.sys.game.events;t.off(a.PAUSE,this.globalPause,this),t.off(a.RESUME,this.globalResume,this);var e=this.scene.sys.sound;e&&e.off(c.GLOBAL_MUTE,this.globalMute,this),this._retryID&&window.clearTimeout(this._retryID)}});t.exports=p},function(t,e,n){var i=n(0),r=n(228),s=n(470),o=n(56),a=new i({initialize:function(t){this.type=o.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,e){return r(this,t,e)},setTo:function(t){if(this.area=0,this.points=[],"string"==typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,n=Number.MAX_VALUE,i=0;i<t.length;i++)e={x:0,y:0},"number"==typeof t[i]||"string"==typeof t[i]?(e.x=parseFloat(t[i]),e.y=parseFloat(t[i+1]),i++):Array.isArray(t[i])?(e.x=t[i][0],e.y=t[i][1]):(e.x=t[i].x,e.y=t[i].y),this.points.push(e),e.y<n&&(n=e.y);return this.calculateArea(n),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,n=0,i=0;i<this.points.length-1;i++)t=this.points[i],n+=((e=this.points[i+1]).x-t.x)*(t.y+e.y);return t=this.points[0],e=this.points[this.points.length-1],n+=(t.x-e.x)*(e.y+t.y),this.area=.5*-n,this.area},getPoints:function(t,e,n){return s(this,t,e,n)}});t.exports=a},function(t,e){t.exports=function(t,e,n){for(var i=!1,r=-1,s=t.points.length-1;++r<t.points.length;s=r){var o=t.points[r].x,a=t.points[r].y,h=t.points[s].x,u=t.points[s].y;(a<=n&&n<u||u<=n&&n<a)&&e<(h-o)*(n-a)/(u-a)+o&&(i=!i)}return i}},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(2),a=n(17),h=n(478),u=n(1173),c=n(25),l=new i({Extends:s,Mixins:[r.ComputedSize,r.Depth,r.GetBounds,r.Mask,r.Origin,r.ScrollFactor,r.Transform,r.Visible,u],initialize:function(t,e,n,i,r,o,a,h){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===o&&(o=128),s.call(this,t,"Shader"),this.blendMode=-1,this.shader;var u=t.sys.renderer;this.renderer=u,this.gl=u.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=u.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new c,this._tempMatrix2=new c,this._tempMatrix3=new c,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=u.width,this._rendererHeight=u.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,i),this.setSize(r,o),this.setOrigin(.5,.5),this.setShader(e,a,h)},willRender:function(t){return!!this.renderToTexture||!(s.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(void 0===e&&(e=!1),!this.renderToTexture){var n=this.width,i=this.height,r=this.renderer;this.glTexture=r.createTextureFromSource(null,n,i,0),this.glTexture.flipY=e,this.framebuffer=r.createFramebuffer(n,i,this.glTexture,!1),this._rendererWidth=n,this._rendererHeight=i,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture,n,i))}return this.shader&&(r.pipelines.clear(),this.load(),this.flush(),r.pipelines.rebind()),this},setShader:function(t,e,n){if(void 0===e&&(e=[]),"string"==typeof t){var i=this.scene.sys.cache.shader;if(!i.has(t))return console.warn("Shader missing: "+t),this;this.shader=i.get(t)}else this.shader=t;var r=this.gl,s=this.renderer;this.program&&r.deleteProgram(this.program);var o=s.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.uniformMatrix4fv(r.getUniformLocation(o,"uViewMatrix"),!1,this.viewMatrix),r.uniformMatrix4fv(r.getUniformLocation(o,"uProjectionMatrix"),!1,this.projectionMatrix),r.uniform2f(r.getUniformLocation(o,"uResolution"),this.width,this.height),this.program=o;var h=new Date,u={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[h.getFullYear(),h.getMonth(),h.getDate(),60*h.getHours()*60+60*h.getMinutes()+h.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=a(!0,{},this.shader.uniforms,u):this.uniforms=u;for(var c=0;c<4;c++)e[c]&&this.setSampler2D("iChannel"+c,e[c],c,n);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,n,i){var r=1/(t-e),s=1/(n-i),o=this.projectionMatrix;o[0]=-2*r,o[5]=-2*s,o[10]=-.001,o[12]=(t+e)*r,o[13]=(i+n)*s,o[14]=-0;var a=this.program,h=this.gl;this.renderer.setProgram(a),h.uniformMatrix4fv(h.getUniformLocation(a,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=n},initUniforms:function(){var t=this.gl,e=this.renderer.glFuncMap,n=this.program;for(var i in this._textureCount=0,this.uniforms){var r=this.uniforms[i],s=r.type,o=e[s];r.uniformLocation=t.getUniformLocation(n,i),"sampler2D"!==s&&(r.glMatrix=o.matrix,r.glValueLength=o.length,r.glFunc=o.func)}},setSampler2DBuffer:function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s={});var o=this.uniforms[t];return o.value=e,s.width=n,s.height=i,o.textureData=s,this._textureCount=r,this.initSampler2D(o),this},setSampler2D:function(t,e,n,i){void 0===n&&(n=0);var r=this.scene.sys.textures;if(r.exists(e)){var s=r.getFrame(e);if(s.glTexture&&s.glTexture.isRenderTexture)return this.setSampler2DBuffer(t,s.glTexture,s.width,s.height,n,i);var o=this.uniforms[t],a=s.source;o.textureKey=e,o.source=a.image,o.value=s.glTexture,a.isGLTexture&&(i||(i={}),i.width=a.width,i.height=a.height),i&&(o.textureData=i),this._textureCount=n,this.initSampler2D(o)}return this},setUniform:function(t,e){return h(this.uniforms,t,e),this},getUniform:function(t){return o(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=this.gl;e.activeTexture(e.TEXTURE0+this._textureCount),e.bindTexture(e.TEXTURE_2D,t.value);var n=t.textureData;if(n&&!t.value.isRenderTexture){var i=e[o(n,"magFilter","linear").toUpperCase()],r=e[o(n,"minFilter","linear").toUpperCase()],s=e[o(n,"wrapS","repeat").toUpperCase()],a=e[o(n,"wrapT","repeat").toUpperCase()],h=e[o(n,"format","rgba").toUpperCase()];if(n.repeat&&(s=e.REPEAT,a=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var u=o(n,"width",512),c=o(n,"height",2),l=o(n,"border",0);e.texImage2D(e.TEXTURE_2D,0,h,u,c,l,h,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,h,e.RGBA,e.UNSIGNED_BYTE,t.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a)}this.renderer.setProgram(this.program),e.uniform1i(t.uniformLocation,this._textureCount),this._textureCount++}},syncUniforms:function(){var t,e,n,i,r,s=this.gl,o=this.uniforms,a=0;for(var h in o)n=(t=o[h]).glFunc,e=t.glValueLength,i=t.uniformLocation,null!==(r=t.value)&&(1===e?t.glMatrix?n.call(s,i,t.transpose,r):n.call(s,i,r):2===e?n.call(s,i,r.x,r.y):3===e?n.call(s,i,r.x,r.y,r.z):4===e?n.call(s,i,r.x,r.y,r.z,r.w):"sampler2D"===t.type&&(s.activeTexture(s.TEXTURE0+a),s.bindTexture(s.TEXTURE_2D,r),s.uniform1i(i,a),a++))},load:function(t){var e=this.gl,n=this.width,i=this.height,r=this.renderer,s=this.program,o=this.viewMatrix;if(!this.renderToTexture){var a=-this._displayOriginX,h=-this._displayOriginY;o[0]=t[0],o[1]=t[1],o[4]=t[2],o[5]=t[3],o[8]=t[4],o[9]=t[5],o[12]=o[0]*a+o[4]*h,o[13]=o[1]*a+o[5]*h}e.useProgram(s),e.uniformMatrix4fv(e.getUniformLocation(s,"uViewMatrix"),!1,o),e.uniform2f(e.getUniformLocation(s,"uResolution"),this.width,this.height);var u=this.uniforms,c=u.resolution;c.value.x=n,c.value.y=i,u.time.value=r.game.loop.getDuration();var l=this.pointer;if(l){var f=u.mouse,d=l.x/n,p=1-l.y/i;f.value.x=d.toFixed(2),f.value.y=p.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,n=this.program,i=this.gl,r=this.vertexBuffer,s=this.renderer,o=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(s.setFramebuffer(this.framebuffer),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)),i.bindBuffer(i.ARRAY_BUFFER,r);var a=i.getAttribLocation(n,"inPosition");-1!==a&&(i.enableVertexAttribArray(a),i.vertexAttribPointer(a,2,i.FLOAT,!1,o,0));var h=this.vertexViewF32;h[3]=e,h[4]=t,h[5]=e,h[8]=t,h[9]=e,h[10]=t,i.bufferSubData(i.ARRAY_BUFFER,0,this.bytes.subarray(0,6*o)),i.drawArrays(i.TRIANGLES,0,6),this.renderToTexture&&s.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},preDestroy:function(){var t=this.gl;t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(this.renderer.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null)}});t.exports=l},function(t,e,n){var i=n(0),r=n(11),s=n(36),o=n(116),a=n(15),h=n(479),u=n(480),c=n(19),l=n(69),f=n(1176),d=n(80),p=n(39),v=n(118),g=new i({Extends:a,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.Size,r.Texture,r.Transform,r.Visible,r.ScrollFactor,f],initialize:function(t,e,n,i,r,s,o,h,u,c,f,d){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i="__WHITE"),a.call(this,t,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new p,this.modelScale=new p(1,1,1),this.modelRotation=new p,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new l,this.viewPosition=new p,this.viewMatrix=new l,this.projectionMatrix=new l,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1;var v=t.sys.renderer;this.setPosition(e,n),this.setTexture(i,r),this.setSize(v.width,v.height),this.initPipeline(),this.setPerspective(v.width,v.height),s&&this.addVertices(s,o,h,u,c,f,d)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(t){return this.viewPosition.addScale(p.LEFT,t),this.dirtyCache[10]=1,this},panY:function(t){return this.viewPosition.y+=p.DOWN.y*t,this.dirtyCache[10]=1,this},panZ:function(t){return this.viewPosition.z+=t,this.dirtyCache[10]=1,this},setPerspective:function(t,e,n,i,r){return void 0===n&&(n=45),void 0===i&&(i=.01),void 0===r&&(r=1e3),this.projectionMatrix.perspective(s(n),t/e,i,r),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(t,e,n,i){return void 0===t&&(t=this.scene.sys.renderer.getAspectRatio()),void 0===e&&(e=1),void 0===n&&(n=-1e3),void 0===i&&(i=1e3),this.projectionMatrix.ortho(-t,t,-e,e,n,i),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach((function(t){t.destroy()})),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(t,e,n,i,r,s,o,a,h){var c=this.scene.sys.cache.obj.get(t);return c&&u(c,this,e,n,i,r,s,o,a,h),this},sortByDepth:function(t,e){return t.depth-e.depth},depthSort:function(){return d(this.faces,this.sortByDepth),this},addVertex:function(t,e,n,i,r,s,o){var a=new v(t,e,n,i,r,s,o);return this.vertices.push(a),a},addFace:function(t,e,n){var i=new o(t,e,n);return this.faces.push(i),this.dirtyCache[9]=-1,i},addVertices:function(t,e,n,i,r,s,o){var a=h(t,e,n,i,r,s,o);return a&&(this.faces=this.faces.concat(a.faces),this.vertices=this.vertices.concat(a.vertices)),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(t){return this.faces[t]},getFaceAt:function(t,e,n){void 0===n&&(n=this.scene.sys.cameras.main);for(var i=c(this,n).calc,r=this.faces,s=[],o=0;o<r.length;o++){var a=r[o];a.contains(t,e,i)&&s.push(a)}return d(s,this.sortByDepth)},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebug:null,this},isDirty:function(){var t=this.modelPosition,e=this.modelRotation,n=this.modelScale,i=this.dirtyCache,r=t.x,s=t.y,o=t.z,a=e.x,h=e.y,u=e.z,c=n.x,l=n.y,f=n.z,d=this.getFaceCount(),p=i[0],v=i[1],g=i[2],m=i[3],y=i[4],x=i[5],b=i[6],w=i[7],_=i[8],T=i[9];return i[0]=r,i[1]=s,i[2]=o,i[3]=a,i[4]=h,i[5]=u,i[6]=c,i[7]=l,i[8]=f,i[9]=d,p!==r||v!==s||g!==o||m!==a||y!==h||x!==u||b!==c||w!==l||_!==f||T!==d},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var t=this.dirtyCache;if(this.ignoreDirtyCache||t[10]||this.isDirty()){var e=this.width,n=this.height,i=this.viewMatrix,r=this.viewPosition;t[10]&&(i.identity(),i.translate(r),i.invert(),t[10]=0);var s=this.transformMatrix;s.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var o=r.z,a=this.faces,h=0;h<a.length;h++)a[h].transformCoordinatesLocal(s,e,n,o);this.depthSort()}},renderDebug:function(t,e){for(var n=t.debugGraphic,i=0;i<e.length;i++){var r=e[i],s=r.vertex1.tx,o=r.vertex1.ty,a=r.vertex2.tx,h=r.vertex2.ty,u=r.vertex3.tx,c=r.vertex3.ty;n.strokeTriangle(s,o,a,h,u,c)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null}});t.exports=g},function(t,e,n){var i=n(50);t.exports=function(t,e){return i(t.x,t.y,e.x,e.y)<=t.radius+e.radius}},function(t,e,n){var i=n(4),r=n(233);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a=t.x1,h=t.y1,u=t.x2,c=t.y2,l=e.x,f=e.y,d=e.radius,p=u-a,v=c-h,g=a-l,m=h-f,y=p*p+v*v,x=2*(p*g+v*m),b=x*x-4*y*(g*g+m*m-d*d);if(0===b){var w=-x/(2*y);s=a+w*p,o=h+w*v,w>=0&&w<=1&&n.push(new i(s,o))}else if(b>0){var _=(-x-Math.sqrt(b))/(2*y);s=a+_*p,o=h+_*v,_>=0&&_<=1&&n.push(new i(s,o));var T=(-x+Math.sqrt(b))/(2*y);s=a+T*p,o=h+T*v,T>=0&&T<=1&&n.push(new i(s,o))}}return n}},function(t,e,n){var i=n(65),r=new(n(4));t.exports=function(t,e,n){if(void 0===n&&(n=r),i(e,t.x1,t.y1))return n.x=t.x1,n.y=t.y1,!0;if(i(e,t.x2,t.y2))return n.x=t.x2,n.y=t.y2,!0;var s=t.x2-t.x1,o=t.y2-t.y1,a=e.x-t.x1,h=e.y-t.y1,u=s*s+o*o,c=s,l=o;if(u>0){var f=(a*s+h*o)/u;c*=f,l*=f}return n.x=t.x1+c,n.y=t.y1+l,c*c+l*l<=u&&c*s+l*o>=0&&i(e,n.x,n.y)}},function(t,e,n){var i=n(4),r=n(96),s=n(488);t.exports=function(t,e,n){if(void 0===n&&(n=[]),s(t,e))for(var o=e.getLineA(),a=e.getLineB(),h=e.getLineC(),u=e.getLineD(),c=[new i,new i,new i,new i],l=[r(o,t,c[0]),r(a,t,c[1]),r(h,t,c[2]),r(u,t,c[3])],f=0;f<4;f++)l[f]&&n.push(c[f]);return n}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=[]);for(var r,s,o,a,h,u,c=t.x3-t.x1,l=t.y3-t.y1,f=t.x2-t.x1,d=t.y2-t.y1,p=c*c+l*l,v=c*f+l*d,g=f*f+d*d,m=p*g-v*v,y=0===m?0:1/m,x=t.x1,b=t.y1,w=0;w<e.length&&(s=(p*(u=f*(o=e[w].x-x)+d*(a=e[w].y-b))-v*(h=c*o+l*a))*y,!((r=(g*h-v*u)*y)>=0&&s>=0&&r+s<1&&(i.push({x:e[w].x,y:e[w].y}),n)));w++);return i}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,o=t.x2-e,a=t.y2-n,t.x2=o*r-a*s+e,t.y2=o*s+a*r+n,t}},function(t,e){t.exports=function(t){return 0===t.height?NaN:t.width/t.height}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,o=t.x2-e,a=t.y2-n,t.x2=o*r-a*s+e,t.y2=o*s+a*r+n,o=t.x3-e,a=t.y3-n,t.x3=o*r-a*s+e,t.y3=o*s+a*r+n,t}},function(t,e,n){t.exports={BUTTON_DOWN:n(1307),BUTTON_UP:n(1308),CONNECTED:n(1309),DISCONNECTED:n(1310),GAMEPAD_BUTTON_DOWN:n(1311),GAMEPAD_BUTTON_UP:n(1312)}},function(t,e,n){var i=n(17),r=n(156);t.exports=function(t,e){var n=void 0===t?r():i({},t);if(e)for(var s in e)void 0!==e[s]&&(n[s]=e[s]);return n}},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=n(408),c=new i({Extends:s,initialize:function(t,e,n,i){var r="xml";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"xml",cache:t.cacheManager.xml,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=u(this.xhrLoader.responseText),this.data?this.onProcessComplete():(console.warn("Invalid XMLFile: "+this.key),this.onProcessError())}});o.register("xml",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){var r="text",o="txt",u=t.cacheManager.text;if(h(e)){var c=e;e=a(c,"key"),n=a(c,"url"),i=a(c,"xhrSettings"),o=a(c,"extension",o),r=a(c,"type",r),u=a(c,"cache",u)}var l={type:r,cache:u,extension:o,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("text",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e,n){t.exports={Acceleration:n(1365),Angular:n(1366),Bounce:n(1367),Debug:n(1368),Drag:n(1369),Enable:n(1370),Friction:n(1371),Gravity:n(1372),Immovable:n(1373),Mass:n(1374),OverlapCirc:n(523),OverlapRect:n(244),Pushable:n(1375),Size:n(1376),Velocity:n(1377)}},function(t,e){t.exports=function(t,e,n,i,r,s,o){void 0===s&&(s=!0),void 0===o&&(o=!1);var a=[],h=[],u=t.treeMinMax;if(u.minX=e,u.minY=n,u.maxX=e+i,u.maxY=n+r,o&&(h=t.staticTree.search(u)),s&&t.useTree)a=t.tree.search(u);else if(s){var c=t.bodies,l={position:{x:e,y:n},left:e,top:n,right:e+i,bottom:n+r,isCircle:!1},f=t.intersects;c.iterate((function(t){f(t,l)&&a.push(t)}))}return h.concat(a)}},function(t,e,n){t.exports={COLLIDE:n(1378),OVERLAP:n(1379),PAUSE:n(1380),RESUME:n(1381),TILE_COLLIDE:n(1382),TILE_OVERLAP:n(1383),WORLD_BOUNDS:n(1384),WORLD_STEP:n(1385)}},function(t,e,n){var i=n(61);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsX()+e.deltaAbsX()+r;return 0===t._dx&&0===e._dx?(t.embedded=!0,e.embedded=!0):t._dx>e._dx?(s=t.right-e.x)>o&&!n||!1===t.checkCollision.right||!1===e.checkCollision.left?s=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.right=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.left=!0)):t._dx<e._dx&&(-(s=t.x-e.width-e.x)>o&&!n||!1===t.checkCollision.left||!1===e.checkCollision.right?s=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.left=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.right=!0))),t.overlapX=s,e.overlapX=s,s}},function(t,e,n){var i=n(61);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsY()+e.deltaAbsY()+r;return 0===t._dy&&0===e._dy?(t.embedded=!0,e.embedded=!0):t._dy>e._dy?(s=t.bottom-e.y)>o&&!n||!1===t.checkCollision.down||!1===e.checkCollision.up?s=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.down=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.up=!0)):t._dy<e._dy&&(-(s=t.y-e.bottom)>o&&!n||!1===t.checkCollision.up||!1===e.checkCollision.down?s=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.up=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.down=!0))),t.overlapY=s,e.overlapY=s,s}},function(t,e){t.exports=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)}},function(t,e,n){t.exports={Bounce:n(1492),Collision:n(1493),Force:n(1494),Friction:n(1495),Gravity:n(1496),Mass:n(1497),Sensor:n(1498),SetBody:n(1499),Sleep:n(1500),Static:n(1517),Transform:n(1518),Velocity:n(1519)}},function(t,e){var n={};t.exports=n,n.create=function(t,e){var i=t.bodyA,r=t.bodyB,s={id:n.id(i,r),bodyA:i,bodyB:r,activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:i.isSensor||r.isSensor,timeCreated:e,timeUpdated:e,collision:null,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return n.update(s,t,e),s},n.update=function(t,e,i){if(t.collision=e,e.collided){var r=e.supports,s=t.activeContacts,o=e.parentA,a=e.parentB;t.inverseMass=o.inverseMass+a.inverseMass,t.friction=Math.min(o.friction,a.friction),t.frictionStatic=Math.max(o.frictionStatic,a.frictionStatic),t.restitution=Math.max(o.restitution,a.restitution),t.slop=Math.max(o.slop,a.slop);for(var h=0;h<r.length;h++)s[h]=r[h].contact;var u=r.length;u<s.length&&(s.length=u),t.separation=e.depth,n.setActive(t,!0,i)}else!0===t.isActive&&n.setActive(t,!1,i)},n.setActive=function(t,e,n){e?(t.isActive=!0,t.timeUpdated=n):(t.isActive=!1,t.activeContacts.length=0)},n.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}},function(t,e,n){t.exports={CalculateFacesAt:n(252),CalculateFacesWithin:n(62),CheckIsoBounds:n(541),Copy:n(1417),CreateFromTiles:n(1418),CullBounds:n(543),CullTiles:n(544),Fill:n(1419),FilterTiles:n(1420),FindByIndex:n(1421),FindTile:n(1422),ForEachTile:n(1423),GetCullTilesFunction:n(1424),GetTileAt:n(158),GetTileAtWorldXY:n(1425),GetTilesWithin:n(26),GetTilesWithinShape:n(1426),GetTilesWithinWorldXY:n(529),GetTileToWorldXFunction:n(1427),GetTileToWorldXYFunction:n(1428),GetTileToWorldYFunction:n(1429),GetWorldToTileXFunction:n(1430),GetWorldToTileXYFunction:n(1431),GetWorldToTileYFunction:n(1432),HasTileAt:n(562),HasTileAtWorldXY:n(1433),HexagonalCullBounds:n(546),HexagonalCullTiles:n(545),HexagonalTileToWorldXY:n(550),HexagonalTileToWorldY:n(554),HexagonalWorldToTileXY:n(556),HexagonalWorldToTileY:n(560),IsInLayerBounds:n(120),IsometricCullTiles:n(547),IsometricTileToWorldXY:n(551),IsometricWorldToTileXY:n(557),PutTileAt:n(257),PutTileAtWorldXY:n(1434),PutTilesAt:n(1435),Randomize:n(1436),RemoveTileAt:n(563),RemoveTileAtWorldXY:n(1437),RenderDebug:n(1438),ReplaceByIndex:n(542),RunCull:n(159),SetCollision:n(1439),SetCollisionBetween:n(1440),SetCollisionByExclusion:n(1441),SetCollisionByProperty:n(1442),SetCollisionFromCollisionGroup:n(1443),SetLayerCollisionIndex:n(160),SetTileCollision:n(73),SetTileIndexCallback:n(1444),SetTileLocationCallback:n(1445),Shuffle:n(1446),StaggeredCullBounds:n(549),StaggeredCullTiles:n(548),StaggeredTileToWorldXY:n(552),StaggeredTileToWorldY:n(555),StaggeredWorldToTileXY:n(558),StaggeredWorldToTileY:n(561),SwapByIndex:n(1447),TileToWorldX:n(253),TileToWorldXY:n(553),TileToWorldY:n(254),WeightedRandomize:n(1448),WorldToTileX:n(255),WorldToTileXY:n(559),WorldToTileY:n(256)}},function(t,e,n){var i=n(158);t.exports=function(t,e,n){var r=i(t,e,!0,n),s=i(t,e-1,!0,n),o=i(t,e+1,!0,n),a=i(t-1,e,!0,n),h=i(t+1,e,!0,n),u=r&&r.collides;return u&&(r.faceTop=!0,r.faceBottom=!0,r.faceLeft=!0,r.faceRight=!0),s&&s.collides&&(u&&(r.faceTop=!1),s.faceBottom=!u),o&&o.collides&&(u&&(r.faceBottom=!1),o.faceTop=!u),a&&a.collides&&(u&&(r.faceLeft=!1),a.faceRight=!u),h&&h.collides&&(u&&(r.faceRight=!1),h.faceLeft=!u),r&&!r.collides&&r.resetFaces(),r}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileWidth,r=n.tilemapLayer,s=0;return r&&(e||(e=r.scene.cameras.main),s=r.x+e.scrollX*(1-r.scrollFactorX),i*=r.scaleX),s+t*i}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;return r&&(e||(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY),s+t*i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=!0);var r=i.baseTileWidth,s=i.tilemapLayer;return s&&(n||(n=s.scene.cameras.main),t-=s.x+n.scrollX*(1-s.scrollFactorX),r*=s.scaleX),e?Math.floor(t/r):t/r}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=!0);var r=i.baseTileHeight,s=i.tilemapLayer;return s&&(n||(n=s.scene.cameras.main),t-=s.y+n.scrollY*(1-s.scrollFactorY),r*=s.scaleY),e?Math.floor(t/r):t/r}},function(t,e,n){var i=n(86),r=n(120),s=n(252),o=n(73);t.exports=function(t,e,n,a,h){if(void 0===a&&(a=!0),!r(e,n,h))return null;var u=h.data[n][e],c=u&&u.collides;if(t instanceof i)null===h.data[n][e]&&(h.data[n][e]=new i(h,t.index,e,n,h.tileWidth,h.tileHeight)),h.data[n][e].copy(t);else{var l=t;null===h.data[n][e]?h.data[n][e]=new i(h,l,e,n,h.tileWidth,h.tileHeight):h.data[n][e].index=l}var f=h.data[n][e],d=-1!==h.collideIndexes.indexOf(f.index);return o(f,d),a&&c!==f.collides&&s(e,n,h),f}},function(t,e,n){var i=n(29);t.exports=function(t){return"isometric"===(t=t.toLowerCase())?i.ISOMETRIC:"staggered"===t?i.STAGGERED:"hexagonal"===t?i.HEXAGONAL:i.ORTHOGONAL}},function(t,e,n){var i=n(40),r=n(121),s=n(122),o=n(86);t.exports=function(t,e,n,a,h){for(var u=new r({tileWidth:n,tileHeight:a}),c=new s({name:t,tileWidth:n,tileHeight:a,format:i.ARRAY_2D,layers:[u]}),l=[],f=e.length,d=0,p=0;p<e.length;p++){l[p]=[];for(var v=e[p],g=0;g<v.length;g++){var m=parseInt(v[g],10);isNaN(m)||-1===m?l[p][g]=h?null:new o(u,-1,g,p,n,a):l[p][g]=new o(u,m,g,p,n,a)}0===d&&(d=v.length)}return c.width=u.width=d,c.height=u.height=f,c.widthInPixels=u.widthInPixels=d*n,c.heightInPixels=u.heightInPixels=f*a,u.data=l,c}},function(t,e,n){var i=n(571),r=n(261),s=function(t){return{x:t.x,y:t.y}},o=["id","name","type","rotation","properties","visible","x","y","width","height"];t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);var a=i(t,o);if(a.x+=e,a.y+=n,t.gid){var h=r(t.gid);a.gid=h.gid,a.flippedHorizontal=h.flippedHorizontal,a.flippedVertical=h.flippedVertical,a.flippedAntiDiagonal=h.flippedAntiDiagonal}else t.polyline?a.polyline=t.polyline.map(s):t.polygon?a.polygon=t.polygon.map(s):t.ellipse?a.ellipse=t.ellipse:t.text?a.text=t.text:t.point?a.point=!0:a.rectangle=!0;return a}},function(t,e){t.exports=function(t){var e=Boolean(2147483648&t),n=Boolean(1073741824&t),i=Boolean(536870912&t);t&=536870911;var r=0,s=!1;return e&&n&&i?(r=Math.PI/2,s=!0):e&&n&&!i?(r=Math.PI,s=!1):e&&!n&&i?(r=Math.PI/2,s=!1):!e||n||i?!e&&n&&i?(r=3*Math.PI/2,s=!1):e||!n||i?e||n||!i?e||n||i||(r=0,s=!1):(r=3*Math.PI/2,s=!0):(r=Math.PI,s=!0):(r=0,s=!0),{gid:t,flippedHorizontal:e,flippedVertical:n,flippedAntiDiagonal:i,rotation:r,flipped:s}}},function(t,e,n){var i=n(40),r=n(122),s=n(564),o=n(580);t.exports=function(t,e,n,a,h,u,c,l){void 0===n&&(n=32),void 0===a&&(a=32),void 0===h&&(h=10),void 0===u&&(u=10),void 0===l&&(l=!1);var f=null;if(Array.isArray(c))f=s(void 0!==e?e:"map",i.ARRAY_2D,c,n,a,l);else if(void 0!==e){var d=t.cache.tilemap.get(e);d?f=s(e,d.format,d.data,n,a,l):console.warn("No map data found for key "+e)}return null===f&&(f=new r({tileWidth:n,tileHeight:a,width:h,height:u})),new o(t,f)}},function(t,e,n){var i=n(6);t.exports=function(t){var e=i(t,"targets",null);return null===e||("function"==typeof e&&(e=e.call()),Array.isArray(e)||(e=[e])),e}},function(t,e){function n(t){return!!t.getActive&&"function"==typeof t.getActive}function i(t){return!!t.getStart&&"function"==typeof t.getStart}function r(t){return!!t.getEnd&&"function"==typeof t.getEnd}var s=function(t,e){var o,a,h=function(t,e,n){return n},u=function(t,e,n){return n},c=null,l=typeof e;if("number"===l)h=function(){return e};else if("string"===l){var f=e[0],d=parseFloat(e.substr(2));switch(f){case"+":h=function(t,e,n){return n+d};break;case"-":h=function(t,e,n){return n-d};break;case"*":h=function(t,e,n){return n*d};break;case"/":h=function(t,e,n){return n/d};break;default:h=function(){return parseFloat(e)}}}else if("function"===l)h=e;else if("object"===l)if(i(a=e)||r(a)||n(a))n(e)&&(c=e.getActive),r(e)&&(h=e.getEnd),i(e)&&(u=e.getStart);else if(e.hasOwnProperty("value"))o=s(t,e.value);else{var p=e.hasOwnProperty("to"),v=e.hasOwnProperty("from"),g=e.hasOwnProperty("start");if(p&&(v||g)){if(o=s(t,e.to),g){var m=s(t,e.start);o.getActive=m.getEnd}if(v){var y=s(t,e.from);o.getStart=y.getEnd}}}return o||(o={getActive:c,getEnd:h,getStart:u}),o};t.exports=s},function(t,e){t.exports={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1}},function(t,e,n){var i=n(0),r=n(9),s=n(267),o=n(16),a=n(5),h=n(100),u=n(14),c=new i({Extends:r,initialize:function(t,e,n){r.call(this),this.parent=t,this.parentIsTimeline=t.hasOwnProperty("isTimeline"),this.data=e,this.totalData=e.length,this.targets=n,this.totalTargets=n.length,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.startDelay=0,this.hasStarted=!1,this.isSeeking=!1,this.completeDelay=0,this.countdown=0,this.offset=0,this.calculatedOffset=0,this.state=h.PENDING_ADD,this._pausedState=h.INIT,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onActive:null,onComplete:null,onLoop:null,onRepeat:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope},getValue:function(t){return void 0===t&&(t=0),this.data[t].current},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===h.ACTIVE},isPaused:function(){return this.state===h.PAUSED},hasTarget:function(t){return-1!==this.targets.indexOf(t)},updateTo:function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<this.totalData;i++){var r=this.data[i];r.key===t&&(r.end=e,n&&(r.start=r.current))}return this},restart:function(){return this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0,this.state===h.ACTIVE?this.seek(0):this.state===h.REMOVED?(this.seek(0),this.parent.makeActive(this),this):this.state===h.PENDING_ADD?this:this.play()},calcDuration:function(){for(var t=0,e=u.MAX_SAFE_INTEGER,n=this.data,i=0;i<this.totalData;i++){var r=n[i];r.t1=r.duration+r.hold,r.yoyo&&(r.t1+=r.duration),r.t2=r.t1+r.repeatDelay,r.totalDuration=r.delay+r.t1,-1===r.repeat?r.totalDuration+=999999999999*r.t2:r.repeat>0&&(r.totalDuration+=r.t2*r.repeat),r.totalDuration>t&&(t=r.totalDuration),r.delay<e&&(e=r.delay)}this.duration=Math.max(t,.001),this.loopCounter=-1===this.loop?999999999999:this.loop,this.loopCounter>0?this.totalDuration=this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.totalDuration=this.duration+this.completeDelay,this.startDelay=e},init:function(){if(this.paused&&!this.parentIsTimeline)return this.state=h.PENDING_ADD,this._pausedState=h.INIT,!1;for(var t=this.data,e=this.totalTargets,n=0;n<this.totalData;n++){var i=t[n],r=i.target,s=i.gen,o=i.key,a=i.index;i.delay=s.delay(r,o,0,a,e,this),i.duration=Math.max(s.duration(r,o,0,a,e,this),.001),i.hold=s.hold(r,o,0,a,e,this),i.repeat=s.repeat(r,o,0,a,e,this),i.repeatDelay=s.repeatDelay(r,o,0,a,e,this)}return this.calcDuration(),this.progress=0,this.totalProgress=0,this.elapsed=0,this.totalElapsed=0,this.state=h.INIT,!0},makeActive:function(){this.parent.makeActive(this),this.dispatchTweenEvent(s.TWEEN_ACTIVE,this.callbacks.onActive)},nextState:function(){this.loopCounter>0?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.state=h.LOOP_DELAY):(this.state=h.ACTIVE,this.dispatchTweenEvent(s.TWEEN_LOOP,this.callbacks.onLoop))):this.completeDelay>0?(this.state=h.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=h.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete))},pause:function(){return this.state===h.PAUSED||(this.paused=!0,this._pausedState=this.state,this.state=h.PAUSED),this},play:function(t){void 0===t&&(t=!1);var e=this.state;return e!==h.INIT||this.parentIsTimeline?e===h.ACTIVE||e===h.PENDING_ADD&&this._pausedState===h.PENDING_ADD?this:this.parentIsTimeline||e!==h.PENDING_REMOVE&&e!==h.REMOVED?(this.parentIsTimeline?(this.resetTweenData(t),0===this.calculatedOffset?this.state=h.ACTIVE:(this.countdown=this.calculatedOffset,this.state=h.OFFSET_DELAY)):this.paused?(this.paused=!1,this.makeActive()):(this.resetTweenData(t),this.state=h.ACTIVE,this.makeActive()),this):(this.seek(0),this.parent.makeActive(this),this):(this.resetTweenData(!1),this.state=h.ACTIVE,this)},resetTweenData:function(t){for(var e=this.data,n=this.totalData,i=this.totalTargets,r=0;r<n;r++){var s=e[r],o=s.target,a=s.key,u=s.index;s.progress=0,s.elapsed=0,s.repeatCounter=-1===s.repeat?999999999999:s.repeat,t?(s.start=s.getStartValue(o,a,s.start,u,i,this),s.end=s.getEndValue(o,a,s.end,u,i,this),s.current=s.start,s.state=h.PLAYING_FORWARD):s.state=h.PENDING_RENDER,s.delay>0&&(s.elapsed=s.delay,s.state=h.DELAY),s.getActiveValue&&(o[a]=s.getActiveValue(s.target,s.key,s.start))}},resume:function(){return this.state===h.PAUSED?(this.paused=!1,this.state=this._pausedState):this.play(),this},seek:function(t,e){void 0===e&&(e=16.6),this.state===h.REMOVED&&this.makeActive(),this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0;for(var n=this.data,i=this.totalTargets,r=0;r<this.totalData;r++){var s=n[r],o=s.target,a=s.gen,u=s.key,c=s.index;s.progress=0,s.elapsed=0,s.repeatCounter=-1===s.repeat?999999999999:s.repeat,s.delay=a.delay(o,u,0,c,i,this),s.duration=Math.max(a.duration(o,u,0,c,i,this),.001),s.hold=a.hold(o,u,0,c,i,this),s.repeat=a.repeat(o,u,0,c,i,this),s.repeatDelay=a.repeatDelay(o,u,0,c,i,this),s.current=s.start,s.state=h.PLAYING_FORWARD,this.updateTweenData(this,s,0,c,i),s.delay>0&&(s.elapsed=s.delay,s.state=h.DELAY)}this.calcDuration();var l=!1;this.state===h.PAUSED&&(l=!0,this.state=h.ACTIVE),this.isSeeking=!0;do{this.update(0,e)}while(this.totalProgress<t);return this.isSeeking=!1,l&&(this.state=h.PAUSED),this},setCallback:function(t,e,n,i){return this.callbacks[t]={func:e,scope:i,params:n},this},complete:function(t){return void 0===t&&(t=0),t?(this.state=h.COMPLETE_DELAY,this.countdown=t):(this.state=h.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete)),this},remove:function(){return this.parent.remove(this),this},stop:function(t){return this.state===h.ACTIVE&&void 0!==t&&this.seek(t),this.state!==h.REMOVED&&(this.state!==h.PAUSED&&this.state!==h.PENDING_ADD||(this.parentIsTimeline?(this.parent.manager._destroy.push(this),this.parent.manager._toProcess++):(this.parent._destroy.push(this),this.parent._toProcess++)),this.dispatchTweenEvent(s.TWEEN_STOP,this.callbacks.onStop),this.removeAllListeners(),this.state=h.PENDING_REMOVE),this},update:function(t,e){if(this.state===h.PAUSED)return!1;switch(this.useFrames&&(e=1*this.parent.timeScale),e*=this.timeScale,this.elapsed+=e,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=e,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case h.ACTIVE:this.hasStarted||this.isSeeking||(this.startDelay-=e,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchTweenEvent(s.TWEEN_START,this.callbacks.onStart)));for(var n=!1,i=0;i<this.totalData;i++){var r=this.data[i];this.updateTweenData(this,r,e)&&(n=!0)}n||this.nextState();break;case h.LOOP_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=h.ACTIVE,this.dispatchTweenEvent(s.TWEEN_LOOP,this.callbacks.onLoop));break;case h.OFFSET_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=h.ACTIVE);break;case h.COMPLETE_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=h.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete))}return this.state===h.PENDING_REMOVE},dispatchTweenDataEvent:function(t,e,n){this.isSeeking||(this.emit(t,this,n.key,n.target,n.current,n.previous),e&&(e.params[1]=n.target,e.func.apply(e.scope,e.params)))},dispatchTweenEvent:function(t,e){this.isSeeking||(this.emit(t,this,this.targets),e&&(e.params[1]=this.targets,e.func.apply(e.scope,e.params)))},setStateFromEnd:function(t,e,n){return e.yoyo?(e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),this.dispatchTweenDataEvent(s.TWEEN_YOYO,t.callbacks.onYoyo,e),e.start=e.getStartValue(e.target,e.key,e.start,e.index,t.totalTargets,t),h.PLAYING_BACKWARD):e.repeatCounter>0?(e.repeatCounter--,e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),e.start=e.getStartValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.end=e.getEndValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.repeatDelay>0?(e.elapsed=e.repeatDelay-n,e.current=e.start,e.target[e.key]=e.current,h.REPEAT_DELAY):(this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e),h.PLAYING_FORWARD)):h.COMPLETE},setStateFromStart:function(t,e,n){return e.repeatCounter>0?(e.repeatCounter--,e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),e.end=e.getEndValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.repeatDelay>0?(e.elapsed=e.repeatDelay-n,e.current=e.start,e.target[e.key]=e.current,h.REPEAT_DELAY):(this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e),h.PLAYING_FORWARD)):h.COMPLETE},updateTweenData:function(t,e,n){var i=e.target;switch(e.state){case h.PLAYING_FORWARD:case h.PLAYING_BACKWARD:if(!i){e.state=h.COMPLETE;break}var r=e.elapsed,o=e.duration,a=0;(r+=n)>o&&(a=r-o,r=o);var u=e.state===h.PLAYING_FORWARD,c=r/o;if(e.elapsed=r,e.progress=c,e.previous=e.current,1===c)u?(e.current=e.end,i[e.key]=e.end,e.hold>0?(e.elapsed=e.hold-a,e.state=h.HOLD_DELAY):e.state=this.setStateFromEnd(t,e,a)):(e.current=e.start,i[e.key]=e.start,e.state=this.setStateFromStart(t,e,a));else{var l=u?e.ease(c):e.ease(1-c);e.current=e.start+(e.end-e.start)*l,i[e.key]=e.current}this.dispatchTweenDataEvent(s.TWEEN_UPDATE,t.callbacks.onUpdate,e);break;case h.DELAY:e.elapsed-=n,e.elapsed<=0&&(e.elapsed=Math.abs(e.elapsed),e.state=h.PENDING_RENDER);break;case h.REPEAT_DELAY:e.elapsed-=n,e.elapsed<=0&&(e.elapsed=Math.abs(e.elapsed),e.state=h.PLAYING_FORWARD,this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e));break;case h.HOLD_DELAY:e.elapsed-=n,e.elapsed<=0&&(e.state=this.setStateFromEnd(t,e,Math.abs(e.elapsed)));break;case h.PENDING_RENDER:i?(e.start=e.getStartValue(i,e.key,i[e.key],e.index,t.totalTargets,t),e.end=e.getEndValue(i,e.key,e.start,e.index,t.totalTargets,t),e.current=e.start,i[e.key]=e.start,e.state=h.PLAYING_FORWARD):e.state=h.COMPLETE}return e.state!==h.COMPLETE}});c.TYPES=["onActive","onComplete","onLoop","onRepeat","onStart","onStop","onUpdate","onYoyo"],a.register("tween",(function(t){return this.scene.sys.tweens.add(t)})),o.register("tween",(function(t){return this.scene.sys.tweens.create(t)})),t.exports=c},function(t,e,n){t.exports={TIMELINE_COMPLETE:n(1463),TIMELINE_LOOP:n(1464),TIMELINE_PAUSE:n(1465),TIMELINE_RESUME:n(1466),TIMELINE_START:n(1467),TIMELINE_UPDATE:n(1468),TWEEN_ACTIVE:n(1469),TWEEN_COMPLETE:n(1470),TWEEN_LOOP:n(1471),TWEEN_REPEAT:n(1472),TWEEN_START:n(1473),TWEEN_STOP:n(1474),TWEEN_UPDATE:n(1475),TWEEN_YOYO:n(1476)}},function(t,e){t.exports=function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p){return{target:t,index:e,key:n,getActiveValue:s,getEndValue:i,getStartValue:r,ease:o,duration:0,totalDuration:0,delay:0,yoyo:u,hold:0,repeat:0,repeatDelay:0,flipX:d,flipY:p,progress:0,elapsed:0,repeatCounter:0,start:0,previous:0,current:0,end:0,t1:0,t2:0,gen:{delay:a,duration:h,hold:c,repeat:l,repeatDelay:f},state:0}}},function(t,e,n){var i=n(68);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},function(t,e,n){var i=n(68);t.exports=function(t){return i(t,-180,180)}},function(t,e,n){var i={};t.exports=i;var r=n(84),s=n(32);i.fromVertices=function(t){for(var e={},n=0;n<t.length;n++){var i=(n+1)%t.length,o=r.normalise({x:t[i].y-t[n].y,y:t[n].x-t[i].x}),a=0===o.y?1/0:o.x/o.y;e[a=a.toFixed(3).toString()]=o}return s.values(e)},i.rotate=function(t,e){if(0!==e)for(var n=Math.cos(e),i=Math.sin(e),r=0;r<t.length;r++){var s,o=t[r];s=o.x*n-o.y*i,o.y=o.x*i+o.y*n,o.x=s}}},function(t,e,n){t.exports={AFTER_ADD:n(1501),AFTER_REMOVE:n(1502),AFTER_UPDATE:n(1503),BEFORE_ADD:n(1504),BEFORE_REMOVE:n(1505),BEFORE_UPDATE:n(1506),COLLISION_ACTIVE:n(1507),COLLISION_END:n(1508),COLLISION_START:n(1509),DRAG_END:n(1510),DRAG:n(1511),DRAG_START:n(1512),PAUSE:n(1513),RESUME:n(1514),SLEEP_END:n(1515),SLEEP_START:n(1516)}},function(t,e,n){var i={};t.exports=i;var r=n(274),s=n(250),o=n(85);i.collisions=function(t,e){for(var n=[],a=e.pairs.table,h=e.metrics,u=0;u<t.length;u++){var c=t[u][0],l=t[u][1];if((!c.isStatic&&!c.isSleeping||!l.isStatic&&!l.isSleeping)&&i.canCollide(c.collisionFilter,l.collisionFilter)&&(h.midphaseTests+=1,o.overlaps(c.bounds,l.bounds)))for(var f=c.parts.length>1?1:0;f<c.parts.length;f++)for(var d=c.parts[f],p=l.parts.length>1?1:0;p<l.parts.length;p++){var v=l.parts[p];if(d===c&&v===l||o.overlaps(d.bounds,v.bounds)){var g,m=a[s.id(d,v)];g=m&&m.isActive?m.collision:null;var y=r.collides(d,v,g);h.narrowphaseTests+=1,y.reused&&(h.narrowReuseCount+=1),y.collided&&(n.push(y),h.narrowDetections+=1)}}}return n},i.canCollide=function(t,e){return t.group===e.group&&0!==t.group?t.group>0:0!=(t.mask&e.category)&&0!=(e.mask&t.category)}},function(t,e,n){var i={};t.exports=i;var r=n(63),s=n(84);i.collides=function(t,e,n){var o,a,h,u,c=!1;if(n){var l=t.parent,f=e.parent,d=l.speed*l.speed+l.angularSpeed*l.angularSpeed+f.speed*f.speed+f.angularSpeed*f.angularSpeed;c=n&&n.collided&&d<.2,u=n}else u={collided:!1,bodyA:t,bodyB:e};if(n&&c){var p=u.axisBody,v=p===t?e:t,g=[p.axes[n.axisNumber]];if(h=i._overlapAxes(p.vertices,v.vertices,g),u.reused=!0,h.overlap<=0)return u.collided=!1,u}else{if((o=i._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return u.collided=!1,u;if((a=i._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return u.collided=!1,u;o.overlap<a.overlap?(h=o,u.axisBody=t):(h=a,u.axisBody=e),u.axisNumber=h.axisNumber}u.bodyA=t.id<e.id?t:e,u.bodyB=t.id<e.id?e:t,u.collided=!0,u.depth=h.overlap,u.parentA=u.bodyA.parent,u.parentB=u.bodyB.parent,t=u.bodyA,e=u.bodyB,s.dot(h.axis,s.sub(e.position,t.position))<0?u.normal={x:h.axis.x,y:h.axis.y}:u.normal={x:-h.axis.x,y:-h.axis.y},u.tangent=s.perp(u.normal),u.penetration=u.penetration||{},u.penetration.x=u.normal.x*u.depth,u.penetration.y=u.normal.y*u.depth;var m=i._findSupports(t,e,u.normal),y=[];if(r.contains(t.vertices,m[0])&&y.push(m[0]),r.contains(t.vertices,m[1])&&y.push(m[1]),y.length<2){var x=i._findSupports(e,t,s.neg(u.normal));r.contains(e.vertices,x[0])&&y.push(x[0]),y.length<2&&r.contains(e.vertices,x[1])&&y.push(x[1])}return y.length<1&&(y=[m[0]]),u.supports=y,u},i._overlapAxes=function(t,e,n){for(var r,o,a=s._temp[0],h=s._temp[1],u={overlap:Number.MAX_VALUE},c=0;c<n.length;c++){if(o=n[c],i._projectToAxis(a,t,o),i._projectToAxis(h,e,o),(r=Math.min(a.max-h.min,h.max-a.min))<=0)return u.overlap=r,u;r<u.overlap&&(u.overlap=r,u.axis=o,u.axisNumber=c)}return u},i._projectToAxis=function(t,e,n){for(var i=s.dot(e[0],n),r=i,o=1;o<e.length;o+=1){var a=s.dot(e[o],n);a>r?r=a:a<i&&(i=a)}t.min=i,t.max=r},i._findSupports=function(t,e,n){for(var i,r,o,a,h=Number.MAX_VALUE,u=s._temp[0],c=e.vertices,l=t.position,f=0;f<c.length;f++)r=c[f],u.x=r.x-l.x,u.y=r.y-l.y,(i=-s.dot(n,u))<h&&(h=i,o=r);return r=c[o.index-1>=0?o.index-1:c.length-1],u.x=r.x-l.x,u.y=r.y-l.y,h=-s.dot(n,u),a=r,r=c[(o.index+1)%c.length],u.x=r.x-l.x,u.y=r.y-l.y,(i=-s.dot(n,u))<h&&(a=r),[o,a]}},function(t,e,n){t.exports={AlignTo:n(601),Angle:n(602),Call:n(603),GetFirst:n(604),GetLast:n(605),GridAlign:n(606),IncAlpha:n(678),IncX:n(679),IncXY:n(680),IncY:n(681),PlaceOnCircle:n(682),PlaceOnEllipse:n(683),PlaceOnLine:n(684),PlaceOnRectangle:n(685),PlaceOnTriangle:n(686),PlayAnimation:n(687),PropertyValueInc:n(46),PropertyValueSet:n(27),RandomCircle:n(688),RandomEllipse:n(689),RandomLine:n(690),RandomRectangle:n(691),RandomTriangle:n(692),Rotate:n(693),RotateAround:n(694),RotateAroundDistance:n(695),ScaleX:n(696),ScaleXY:n(697),ScaleY:n(698),SetAlpha:n(699),SetBlendMode:n(700),SetDepth:n(701),SetHitArea:n(702),SetOrigin:n(703),SetRotation:n(704),SetScale:n(705),SetScaleX:n(706),SetScaleY:n(707),SetScrollFactor:n(708),SetScrollFactorX:n(709),SetScrollFactorY:n(710),SetTint:n(711),SetVisible:n(712),SetX:n(713),SetXY:n(714),SetY:n(715),ShiftPosition:n(716),Shuffle:n(717),SmootherStep:n(718),SmoothStep:n(719),Spread:n(720),ToggleVisible:n(721),WrapInRectangle:n(722)}},function(t,e,n){var i=n(124),r=[];r[i.BOTTOM_CENTER]=n(277),r[i.BOTTOM_LEFT]=n(278),r[i.BOTTOM_RIGHT]=n(279),r[i.LEFT_BOTTOM]=n(280),r[i.LEFT_CENTER]=n(281),r[i.LEFT_TOP]=n(282),r[i.RIGHT_BOTTOM]=n(283),r[i.RIGHT_CENTER]=n(284),r[i.RIGHT_TOP]=n(285),r[i.TOP_CENTER]=n(286),r[i.TOP_LEFT]=n(287),r[i.TOP_RIGHT]=n(288),t.exports=function(t,e,n,i,s){return r[n](t,e,i,s)}},function(t,e,n){var i=n(42),r=n(88),s=n(89),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(43),s=n(53),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)-n),o(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(54),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(43),s=n(55),o=n(54);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(90),r=n(43),s=n(91),o=n(54);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(43),r=n(45),s=n(54),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(55),o=n(53);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(90),r=n(44),s=n(91),o=n(53);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(44),r=n(45),s=n(53),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(88),r=n(45),s=n(55),o=n(89);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},function(t,e,n){var i=n(43),r=n(45),s=n(55),o=n(53);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)-n),s(t,r(e)-a),t}},function(t,e,n){var i=n(44),r=n(45),s=n(55),o=n(54);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},function(t,e,n){var i=n(124),r=[];r[i.BOTTOM_CENTER]=n(290),r[i.BOTTOM_LEFT]=n(291),r[i.BOTTOM_RIGHT]=n(292),r[i.CENTER]=n(293),r[i.LEFT_CENTER]=n(295),r[i.RIGHT_CENTER]=n(296),r[i.TOP_CENTER]=n(297),r[i.TOP_LEFT]=n(298),r[i.TOP_RIGHT]=n(299),r[i.LEFT_BOTTOM]=r[i.BOTTOM_LEFT],r[i.LEFT_TOP]=r[i.TOP_LEFT],r[i.RIGHT_BOTTOM]=r[i.BOTTOM_RIGHT],r[i.RIGHT_TOP]=r[i.TOP_RIGHT],t.exports=function(t,e,n,i,s){return r[n](t,e,i,s)}},function(t,e,n){var i=n(42),r=n(88),s=n(55),o=n(89);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(43),s=n(55),o=n(53);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(55),o=n(54);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(294),r=n(88),s=n(90);t.exports=function(t,e,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),i(t,r(e)+n,s(e)+o),t}},function(t,e,n){var i=n(89),r=n(91);t.exports=function(t,e,n){return i(t,e),r(t,n)}},function(t,e,n){var i=n(90),r=n(43),s=n(91),o=n(53);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(90),r=n(44),s=n(91),o=n(54);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(88),r=n(45),s=n(89),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(43),r=n(45),s=n(53),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},function(t,e,n){var i=n(44),r=n(45),s=n(54),o=n(52);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(169),r=n(98),s=n(14),o=n(4);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},function(t,e,n){var i=n(302),r=n(169),s=n(98),o=n(14);t.exports=function(t,e,n,a){void 0===a&&(a=[]),!e&&n>0&&(e=i(t)/n);for(var h=0;h<e;h++){var u=s(h/e,0,o.PI2);a.push(r(t,u))}return a}},function(t,e){t.exports=function(t){return Math.PI*t.radius*2}},function(t,e,n){var i=n(18),r={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,0===e?this.renderFlags&=-3:this.renderFlags|=2}}};t.exports=r},function(t,e,n){var i=n(35),r={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"==typeof t&&(t=i[t]),(t|=0)>=-1&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=r},function(t,e){t.exports={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}}},function(t,e,n){var i=n(171),r=n(131);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&n>0&&(e=r(t)/n);for(var o=0;o<e;o++){var a=o/e;s.push(i(t,a))}return s}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x-e,a=t.y-n;return t.x=o*r-a*s+e,t.y=o*s+a*r+n,t}},function(t,e,n){var i=n(310),r=n(311),s={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t){return void 0===t&&(this.texture||this.shader)&&(t=this),new i(this.scene,t)},createGeometryMask:function(t){return void 0===t&&"Graphics"===this.type&&(t=this),new r(this.scene,t)}};t.exports=s},function(t,e,n){var i=n(0),r=n(22),s=n(92),o=new i({initialize:function(t,e){var n=t.sys.renderer;this.renderer=n,this.bitmapMask=e,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,this.createMask(),t.sys.game.events.on(r.CONTEXT_RESTORED,this.createMask,this),n&&n.on(s.RESIZE,this.createMask,this)},createMask:function(){var t=this.renderer;if(t&&t.gl){this.mainTexture&&this.clearMask();var e=t.width,n=t.height,i=0==(e&e-1)&&0==(n&n-1),r=t.gl,s=i?r.REPEAT:r.CLAMP_TO_EDGE,o=r.LINEAR;this.mainTexture=t.createTexture2D(0,o,o,s,s,r.RGBA,null,e,n),this.maskTexture=t.createTexture2D(0,o,o,s,s,r.RGBA,null,e,n),this.mainFramebuffer=t.createFramebuffer(e,n,this.mainTexture,!0),this.maskFramebuffer=t.createFramebuffer(e,n,this.maskTexture,!0)}},clearMask:function(){var t=this.renderer;t&&t.gl&&this.mainTexture&&(t.deleteTexture(this.mainTexture),t.deleteTexture(this.maskTexture),t.deleteFramebuffer(this.mainFramebuffer),t.deleteFramebuffer(this.maskFramebuffer),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null)},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,n)},postRenderWebGL:function(t,e){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.clearMask(),this.renderer&&this.renderer.off(s.RESIZE,this.createMask,this),this.bitmapMask=null,this.prevFramebuffer=null,this.renderer=null}});t.exports=o},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,r=this.geometryMask,s=t.maskCount;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),r.renderWebGL(t,r,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n?this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s+1,255):i.stencilFunc(i.EQUAL,s+1,255):this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s,255):i.stencilFunc(i.EQUAL,s,255)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var n=t.currentMask;if(0===t.maskStack.length)n.mask=null,e.disable(e.STENCIL_TEST);else{var i=t.maskStack[t.maskStack.length-1];i.mask.applyStencil(t,i.camera,!1),t.currentCameraMask.mask!==i.mask?(n.mask=i.mask,n.camera=i.camera):n.mask=null}},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},function(t,e){t.exports={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}},function(t,e,n){var i=n(14),r=n(25),s=n(177),o=n(269),a=n(270),h=n(3),u={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return a(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=a(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=o(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new r),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new r),void 0===e&&(e=new r);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getLocalPoint:function(t,e,n,i){n||(n=new h),i||(i=this.scene.sys.cameras.main);var r=i.scrollX,o=i.scrollY,a=t+r*this.scrollFactorX-r,u=e+o*this.scrollFactorY-o;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(a,u,n):s(a,u,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=u},function(t,e){t.exports={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}},function(t,e,n){t.exports={CHANGE_DATA:n(638),CHANGE_DATA_KEY:n(639),DESTROY:n(640),REMOVE_DATA:n(641),SET_DATA:n(642)}},function(t,e,n){var i=n(131),r=n(4);t.exports=function(t,e,n,s){if(void 0===s&&(s=[]),!e&&!n)return s;e?n=Math.round(i(t)/e):e=i(t)/n;for(var o=t.x,a=t.y,h=0,u=0;u<n;u++)switch(s.push(new r(o,a)),h){case 0:(o+=e)>=t.right&&(h=1,a+=o-t.right,o=t.right);break;case 1:(a+=e)>=t.bottom&&(h=2,o-=a-t.bottom,a=t.bottom);break;case 2:(o-=e)<=t.left&&(h=3,a-=t.left-o,o=t.left);break;case 3:(a-=e)<=t.top&&(h=0,a=t.top)}return s}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=[]);var i=Math.round(t.x1),r=Math.round(t.y1),s=Math.round(t.x2),o=Math.round(t.y2),a=Math.abs(s-i),h=Math.abs(o-r),u=i<s?1:-1,c=r<o?1:-1,l=a-h;n.push({x:i,y:r});for(var f=1;i!==s||r!==o;){var d=l<<1;d>-h&&(l-=h,i+=u),d<a&&(l+=a,r+=c),f%e==0&&n.push({x:i,y:r}),f++}return n}},function(t,e){t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,r,s=1;if(n){if(t<e[0][n])return e[0];for(;e[s][n]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),n?(i=e[s-1][n],(r=e[s][n])-t<=t-i?e[s]:e[s-1]):(i=e[s-1],(r=e[s])-t<=t-i?r:i)}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r){void 0===r&&(r=!1),this.textureKey=t,this.textureFrame=e,this.index=n,this.frame=i,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=r},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});t.exports=i},function(t,e){t.exports=function(t){var e=/\D/g;return t.sort((function(t,n){return parseInt(t.replace(e,""),10)-parseInt(n.replace(e,""),10)})),t}},function(t,e,n){var i=n(185),r=n(0),s=n(102),o=n(9),a=n(133),h=n(22),u=n(2),c=n(6),l=n(186),f=n(322),d=new r({Extends:o,initialize:function(t){o.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new s,this.mixes=new s,this.paused=!1,this.name="AnimationManager",t.events.once(h.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(h.DESTROY,this.destroy,this)},addMix:function(t,e,n){var i=this.anims,r=this.mixes,s="string"==typeof t?t:t.key,o="string"==typeof e?e:e.key;if(i.has(s)&&i.has(o)){var a=r.get(s);a||(a={}),a[o]=n,r.set(s,a)}return this},removeMix:function(t,e){var n=this.mixes,i="string"==typeof t?t:t.key,r=n.get(i);if(r)if(e){var s="string"==typeof e?e:e.key;r.hasOwnProperty(s)&&delete r[s]}else e||n.delete(i);return this},getMix:function(t,e){var n=this.mixes,i="string"==typeof t?t:t.key,r="string"==typeof e?e:e.key,s=n.get(i);return s&&s.hasOwnProperty(r)?s[r]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(a.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e){var n=[],i=this.game.cache.json.get(t);if(!i)return n;var r=this,s=c(i,"meta",null),o=c(i,"frames",null);return s&&o&&c(s,"frameTags",[]).forEach((function(i){var s=[],a=u(i,"name",null),h=u(i,"from",0),c=u(i,"to",0),l=u(i,"direction","forward");if(a&&(!e||e&&e.indexOf(a)>-1)){for(var f=[],d=Number.MAX_SAFE_INTEGER,p=h;p<=c;p++){var v=p.toString(),g=o[v];if(g){var m=u(g,"duration",Number.MAX_SAFE_INTEGER);m<d&&(d=m),f.push({frame:v,duration:m})}}f.forEach((function(e){s.push({key:t,frame:e.frame,duration:d-e.duration})}));var y=d*s.length;"reverse"===l&&(s=s.reverse());var x={key:a,frames:s,duration:y,yoyo:"pingpong"===l},b=r.create(x);b&&n.push(b)}})),n},create:function(t){var e=t.key,n=!1;return e&&((n=this.get(e))||(n=new i(this,e,t),this.anims.set(e,n),this.emit(a.ADD_ANIMATION,e,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"==typeof t&&(t=JSON.parse(t));var n=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var i=0;i<t.anims.length;i++)n.push(this.create(t.anims[i]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&n.push(this.create(t));return n},generateFrameNames:function(t,e){var n,i=c(e,"prefix",""),r=c(e,"start",0),s=c(e,"end",0),o=c(e,"suffix",""),a=c(e,"zeroPad",0),h=c(e,"outputArray",[]),u=c(e,"frames",!1),d=this.textureManager.get(t);if(!d)return h;if(e)for(u||(u=f(r,s)),n=0;n<u.length;n++){var p=i+l(u[n],a,"0",1)+o;d.has(p)?h.push({key:t,frame:p}):console.warn("generateFrameNames: Frame missing: "+p+" from texture: "+t)}else for(u=d.getFrameNames(),n=0;n<u.length;n++)h.push({key:t,frame:u[n]});return h},generateFrameNumbers:function(t,e){var n=c(e,"start",0),i=c(e,"end",-1),r=c(e,"first",!1),s=c(e,"outputArray",[]),o=c(e,"frames",!1),a=this.textureManager.get(t);if(!a)return s;r&&a.has(r)&&s.push({key:t,frame:r}),o||(-1===i&&(i=a.frameTotal-2),o=f(n,i));for(var h=0;h<o.length;h++)a.has(o[h])?s.push({key:t,frame:o[h]}):console.warn("generateFrameNumbers: Frame "+h+" missing from texture: "+t);return s},get:function(t){return this.anims.get(t)},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(a.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)e[n].anims.play(t);return this},staggerPlay:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!0),Array.isArray(e)||(e=[e]);var r=e.length;i||r--;for(var s=0;s<e.length;s++){var o=n<0?Math.abs(n)*(r-s):n*s;e[s].anims.playAfterDelay(t,o)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(a.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(a.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==t&&""!==t?e.anims.push(this.anims.get(t).toJSON()):this.anims.each((function(t,n){e.anims.push(n.toJSON())})),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});t.exports=d},function(t,e){t.exports=function(t,e,n,i){var r,s=[],o=!1;if((n||i)&&(o=!0,n||(n=""),i||(i="")),e<t)for(r=t;r>=e;r--)o?s.push(n+r.toString()+i):s.push(r);else for(r=t;r<=e;r++)o?s.push(n+r.toString()+i):s.push(r);return s}},function(t,e,n){var i=n(0),r=n(102),s=n(9),o=n(324),a=new i({initialize:function(){this.entries=new r,this.events=new s},add:function(t,e){return this.entries.set(t,e),this.events.emit(o.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(o.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});t.exports=a},function(t,e,n){t.exports={ADD:n(736),REMOVE:n(737)}},function(t,e,n){var i=n(323),r=n(0),s=n(22),o=new r({initialize:function(t){this.game=t,this.binary=new i,this.bitmapFont=new i,this.json=new i,this.physics=new i,this.shader=new i,this.audio=new i,this.video=new i,this.text=new i,this.html=new i,this.obj=new i,this.tilemap=new i,this.xml=new i,this.custom={},this.game.events.once(s.DESTROY,this.destroy,this)},addCustom:function(t){return this.custom.hasOwnProperty(t)||(this.custom[t]=new i),this.custom[t]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var n in this.custom)this.custom[n].destroy();this.custom=null,this.game=null}});t.exports=o},function(t,e,n){var i=n(134),r=n(190),s=n(18),o=n(0),a=n(11),h=n(333),u=n(37),c=n(136),l=n(10),f=n(3),d=new o({Extends:i,Mixins:[a.Flip,a.Tint,a.Pipeline],initialize:function(t,e,n,r){i.call(this,t,e,n,r),this.postPipelines=[],this.pipelineData={},this.inputEnabled=!0,this.fadeEffect=new h.Fade(this),this.flashEffect=new h.Flash(this),this.shakeEffect=new h.Shake(this),this.panEffect=new h.Pan(this),this.rotateToEffect=new h.RotateTo(this),this.zoomEffect=new h.Zoom(this),this.lerp=new f(1,1),this.followOffset=new f,this.deadzone=null,this._follow=null},setDeadzone:function(t,e){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=e):this.deadzone=new l(0,0,t,e),this._follow){var n=this.width/2,i=this.height/2,s=this._follow.x-this.followOffset.x,o=this._follow.y-this.followOffset.y;this.midPoint.set(s,o),this.scrollX=s-n,this.scrollY=o-i}r(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,n,i,r,s){return this.fadeEffect.start(!1,t,e,n,i,!0,r,s)},fadeOut:function(t,e,n,i,r,s){return this.fadeEffect.start(!0,t,e,n,i,!0,r,s)},fadeFrom:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!1,t,e,n,i,r,s,o)},fade:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!0,t,e,n,i,r,s,o)},flash:function(t,e,n,i,r,s,o){return this.flashEffect.start(t,e,n,i,r,s,o)},shake:function(t,e,n,i,r){return this.shakeEffect.start(t,e,n,i,r)},pan:function(t,e,n,i,r,s,o){return this.panEffect.start(t,e,n,i,r,s,o)},rotateTo:function(t,e,n,i,r,s,o){return this.rotateToEffect.start(t,e,n,i,r,s,o)},zoomTo:function(t,e,n,i,r,s){return this.zoomEffect.start(t,e,n,i,r,s)},preRender:function(){this.renderList.length=0;var t=this.width,e=this.height,n=.5*t,i=.5*e,s=this.zoom,o=this.matrix,a=t*this.originX,h=e*this.originY,l=this._follow,f=this.deadzone,d=this.scrollX,p=this.scrollY;f&&r(f,this.midPoint.x,this.midPoint.y);var v=!1;if(l&&!this.panEffect.isRunning){var g=l.x-this.followOffset.x,m=l.y-this.followOffset.y;f?(g<f.x?d=c(d,d-(f.x-g),this.lerp.x):g>f.right&&(d=c(d,d+(g-f.right),this.lerp.x)),m<f.y?p=c(p,p-(f.y-m),this.lerp.y):m>f.bottom&&(p=c(p,p+(m-f.bottom),this.lerp.y))):(d=c(d,g-a,this.lerp.x),p=c(p,m-h,this.lerp.y)),v=!0}this.useBounds&&(d=this.clampX(d),p=this.clampY(p)),this.roundPixels&&(a=Math.round(a),h=Math.round(h),d=Math.round(d),p=Math.round(p)),this.scrollX=d,this.scrollY=p;var y=d+n,x=p+i;this.midPoint.set(y,x);var b=t/s,w=e/s,_=y-b/2,T=x-w/2;this.roundPixels&&(_=Math.round(_),T=Math.round(T)),this.worldView.setTo(_,T,b,w),o.applyITRS(this.x+a,this.y+h,this.rotation,s,s),o.translate(-a,-h),this.shakeEffect.preRender(),v&&this.emit(u.FOLLOW_UPDATE,this,l)},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,i,r,o){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===i&&(i=n),void 0===r&&(r=0),void 0===o&&(o=r),this._follow=t,this.roundPixels=e,n=s(n,0,1),i=s(i,0,1),this.lerp.set(n,i),this.followOffset.set(r,o);var a=this.width/2,h=this.height/2,u=t.x-r,c=t.y-o;return this.midPoint.set(u,c),this.scrollX=u-a,this.scrollY=c-h,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.rotateToEffect.update(t,e),this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.resetFX(),i.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});t.exports=d},function(t,e,n){var i=n(38);t.exports=function(t){var e=new i;t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,i){return e+e+n+n+i+i}));var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){var r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);e.setTo(r,s,o)}return e}},function(t,e){t.exports=function(t,e,n,i){return i<<24|t<<16|e<<8|n}},function(t,e){t.exports=function(t,e,n,i){void 0===i&&(i={h:0,s:0,v:0}),t/=255,e/=255,n/=255;var r=Math.min(t,e,n),s=Math.max(t,e,n),o=s-r,a=0,h=0===s?0:o/s,u=s;return s!==r&&(s===t?a=(e-n)/o+(e<n?6:0):s===e?a=(n-t)/o+2:s===n&&(a=(t-e)/o+4),a/=6),i.hasOwnProperty("_h")?(i._h=a,i._s=h,i._v=u):(i.h=a,i.s=h,i.v=u),i}},function(t,e){t.exports=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}}},function(t,e,n){var i=n(38);t.exports=function(t){return new i(t.r,t.g,t.b,t.a)}},function(t,e,n){var i=n(38);t.exports=function(t){var e=new i,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t.toLowerCase());if(n){var r=parseInt(n[1],10),s=parseInt(n[2],10),o=parseInt(n[3],10),a=void 0!==n[4]?parseFloat(n[4]):1;e.setTo(r,s,o,255*a)}return e}},function(t,e,n){t.exports={Fade:n(761),Flash:n(762),Pan:n(763),Shake:n(796),RotateTo:n(797),Zoom:n(798)}},function(t,e,n){t.exports={In:n(764),Out:n(765),InOut:n(766)}},function(t,e,n){t.exports={In:n(767),Out:n(768),InOut:n(769)}},function(t,e,n){t.exports={In:n(770),Out:n(771),InOut:n(772)}},function(t,e,n){t.exports={In:n(773),Out:n(774),InOut:n(775)}},function(t,e,n){t.exports={In:n(776),Out:n(777),InOut:n(778)}},function(t,e,n){t.exports={In:n(779),Out:n(780),InOut:n(781)}},function(t,e,n){t.exports=n(782)},function(t,e,n){t.exports={In:n(783),Out:n(784),InOut:n(785)}},function(t,e,n){t.exports={In:n(786),Out:n(787),InOut:n(788)}},function(t,e,n){t.exports={In:n(789),Out:n(790),InOut:n(791)}},function(t,e,n){t.exports={In:n(792),Out:n(793),InOut:n(794)}},function(t,e,n){t.exports=n(795)},function(t,e,n){var i=n(0),r=n(33),s=n(347),o=n(2),a=n(6),h=n(7),u=n(193),c=n(1),l=n(197),f=n(187),d=new i({initialize:function(t){void 0===t&&(t={}),this.width=a(t,"width",1024),this.height=a(t,"height",768),this.zoom=a(t,"zoom",1),this.parent=a(t,"parent",void 0),this.scaleMode=a(t,"scaleMode",0),this.expandParent=a(t,"expandParent",!0),this.autoRound=a(t,"autoRound",!1),this.autoCenter=a(t,"autoCenter",0),this.resizeInterval=a(t,"resizeInterval",500),this.fullscreenTarget=a(t,"fullscreenTarget",null),this.minWidth=a(t,"minWidth",0),this.maxWidth=a(t,"maxWidth",0),this.minHeight=a(t,"minHeight",0),this.maxHeight=a(t,"maxHeight",0);var e=a(t,"scale",null);e&&(this.width=a(e,"width",this.width),this.height=a(e,"height",this.height),this.zoom=a(e,"zoom",this.zoom),this.parent=a(e,"parent",this.parent),this.scaleMode=a(e,"mode",this.scaleMode),this.expandParent=a(e,"expandParent",this.expandParent),this.autoRound=a(e,"autoRound",this.autoRound),this.autoCenter=a(e,"autoCenter",this.autoCenter),this.resizeInterval=a(e,"resizeInterval",this.resizeInterval),this.fullscreenTarget=a(e,"fullscreenTarget",this.fullscreenTarget),this.minWidth=a(e,"min.width",this.minWidth),this.maxWidth=a(e,"max.width",this.maxWidth),this.minHeight=a(e,"min.height",this.minHeight),this.maxHeight=a(e,"max.height",this.maxHeight)),this.renderType=a(t,"type",r.AUTO),this.canvas=a(t,"canvas",null),this.context=a(t,"context",null),this.canvasStyle=a(t,"canvasStyle",null),this.customEnvironment=a(t,"customEnvironment",!1),this.sceneConfig=a(t,"scene",null),this.seed=a(t,"seed",[(Date.now()*Math.random()).toString()]),u.RND=new u.RandomDataGenerator(this.seed),this.gameTitle=a(t,"title",""),this.gameURL=a(t,"url","https://phaser.io"),this.gameVersion=a(t,"version",""),this.autoFocus=a(t,"autoFocus",!0),this.domCreateContainer=a(t,"dom.createContainer",!1),this.domBehindCanvas=a(t,"dom.behindCanvas",!1),this.inputKeyboard=a(t,"input.keyboard",!0),this.inputKeyboardEventTarget=a(t,"input.keyboard.target",window),this.inputKeyboardCapture=a(t,"input.keyboard.capture",[]),this.inputMouse=a(t,"input.mouse",!0),this.inputMouseEventTarget=a(t,"input.mouse.target",null),this.inputMousePreventDefaultDown=a(t,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=a(t,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=a(t,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=a(t,"input.mouse.preventDefaultWheel",!0),this.inputTouch=a(t,"input.touch",s.input.touch),this.inputTouchEventTarget=a(t,"input.touch.target",null),this.inputTouchCapture=a(t,"input.touch.capture",!0),this.inputActivePointers=a(t,"input.activePointers",1),this.inputSmoothFactor=a(t,"input.smoothFactor",0),this.inputWindowEvents=a(t,"input.windowEvents",!0),this.inputGamepad=a(t,"input.gamepad",!1),this.inputGamepadEventTarget=a(t,"input.gamepad.target",window),this.disableContextMenu=a(t,"disableContextMenu",!1),this.audio=a(t,"audio",{}),this.hideBanner=!1===a(t,"banner",null),this.hidePhaser=a(t,"banner.hidePhaser",!1),this.bannerTextColor=a(t,"banner.text","#ffffff"),this.bannerBackgroundColor=a(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),""===this.gameTitle&&this.hidePhaser&&(this.hideBanner=!0),this.fps=a(t,"fps",null);var n=a(t,"render",t);this.pipeline=a(n,"pipeline",null),this.antialias=a(n,"antialias",!0),this.antialiasGL=a(n,"antialiasGL",!0),this.mipmapFilter=a(n,"mipmapFilter","LINEAR"),this.desynchronized=a(n,"desynchronized",!1),this.roundPixels=a(n,"roundPixels",!1),this.pixelArt=a(n,"pixelArt",1!==this.zoom),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=a(n,"transparent",!1),this.clearBeforeRender=a(n,"clearBeforeRender",!0),this.preserveDrawingBuffer=a(n,"preserveDrawingBuffer",!1),this.premultipliedAlpha=a(n,"premultipliedAlpha",!0),this.failIfMajorPerformanceCaveat=a(n,"failIfMajorPerformanceCaveat",!1),this.powerPreference=a(n,"powerPreference","default"),this.batchSize=a(n,"batchSize",4096),this.maxTextures=a(n,"maxTextures",-1),this.maxLights=a(n,"maxLights",10);var i=a(t,"backgroundColor",0);this.backgroundColor=f(i),this.transparent&&(this.backgroundColor=f(0),this.backgroundColor.alpha=0),this.preBoot=a(t,"callbacks.preBoot",c),this.postBoot=a(t,"callbacks.postBoot",c),this.physics=a(t,"physics",{}),this.defaultPhysicsSystem=a(this.physics,"default",!1),this.loaderBaseURL=a(t,"loader.baseURL",""),this.loaderPath=a(t,"loader.path","");var d=s.os.android?6:32;this.loaderMaxParallelDownloads=a(t,"loader.maxParallelDownloads",d),this.loaderCrossOrigin=a(t,"loader.crossOrigin",void 0),this.loaderResponseType=a(t,"loader.responseType",""),this.loaderAsync=a(t,"loader.async",!0),this.loaderUser=a(t,"loader.user",""),this.loaderPassword=a(t,"loader.password",""),this.loaderTimeout=a(t,"loader.timeout",0),this.loaderWithCredentials=a(t,"loader.withCredentials",!1),this.installGlobalPlugins=[],this.installScenePlugins=[];var p=a(t,"plugins",null),v=l.DefaultScene;p&&(Array.isArray(p)?this.defaultPlugins=p:h(p)&&(this.installGlobalPlugins=o(p,"global",[]),this.installScenePlugins=o(p,"scene",[]),Array.isArray(p.default)?v=p.default:Array.isArray(p.defaultMerge)&&(v=v.concat(p.defaultMerge)))),this.defaultPlugins=v;var g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=a(t,"images.default",g+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=a(t,"images.missing",g+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=a(t,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=r.WEBGL:window.FORCE_CANVAS&&(this.renderType=r.CANVAS))}});t.exports=d},function(t,e,n){t.exports={os:n(105),browser:n(137),features:n(191),input:n(808),audio:n(809),video:n(810),fullscreen:n(811),canvasFeatures:n(348)}},function(t,e,n){var i,r,s,o=n(31),a={supportInverseAlpha:!1,supportNewBlendModes:!1};t.exports=("function"!=typeof importScripts&&void 0!==document&&(a.supportNewBlendModes=(i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",r="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",(s=new Image).onload=function(){var t=new Image;t.onload=function(){var e=o.create(t,6,1).getContext("2d");if(e.globalCompositeOperation="multiply",e.drawImage(s,0,0),e.drawImage(t,2,0),!e.getImageData(2,0,1,1))return!1;var n=e.getImageData(2,0,1,1).data;o.remove(t),a.supportNewBlendModes=255===n[0]&&0===n[1]&&0===n[2]},t.src=i+"/wCKxvRF"+r},s.src=i+"AP804Oa6"+r,!1),a.supportInverseAlpha=function(){var t=o.create(this,2,1).getContext("2d");t.fillStyle="rgba(10, 20, 30, 0.5)",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1);if(null===e)return!1;t.putImageData(e,1,0);var n=t.getImageData(1,0,1,1);return n.data[0]===e.data[0]&&n.data[1]===e.data[1]&&n.data[2]===e.data[2]&&n.data[3]===e.data[3]}()),a)},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},function(t,e){t.exports=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},function(t,e){t.exports=function(t,e,n,i){var r=t-n,s=e-i;return r*r+s*s}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t>e-n}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},function(t,e,n){var i=n(357);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},function(t,e){t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},function(t,e){t.exports=function(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}},function(t,e){t.exports=function(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}},function(t,e,n){var i=n(184);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e){t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},function(t,e){t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},function(t,e){t.exports=function(t){return t>0?Math.ceil(t):Math.floor(t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=u*s-o*h,l=-u*r+o*a,f=h*r-s*a,d=e*c+n*l+i*f;return d?(d=1/d,t[0]=c*d,t[1]=(-u*n+i*h)*d,t[2]=(o*n-i*s)*d,t[3]=l*d,t[4]=(u*e-i*a)*d,t[5]=(-o*e+i*r)*d,t[6]=f*d,t[7]=(-h*e+n*a)*d,t[8]=(s*e-n*r)*d,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8];return t[0]=s*u-o*h,t[1]=i*h-n*u,t[2]=n*o-i*s,t[3]=o*a-r*u,t[4]=e*u-i*a,t[5]=i*r-e*o,t[6]=r*h-s*a,t[7]=n*a-e*h,t[8]=e*s-n*r,this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8];return e*(u*s-o*h)+n*(-u*r+o*a)+i*(h*r-s*a)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=t.val,f=l[0],d=l[1],p=l[2],v=l[3],g=l[4],m=l[5],y=l[6],x=l[7],b=l[8];return e[0]=f*n+d*s+p*h,e[1]=f*i+d*o+p*u,e[2]=f*r+d*a+p*c,e[3]=v*n+g*s+m*h,e[4]=v*i+g*o+m*u,e[5]=v*r+g*a+m*c,e[6]=y*n+x*s+b*h,e[7]=y*i+x*o+b*u,e[8]=y*r+x*a+b*c,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=Math.sin(t),u=Math.cos(t);return e[0]=u*n+h*s,e[1]=u*i+h*o,e[2]=u*r+h*a,e[3]=u*s-h*n,e[4]=u*o-h*i,e[5]=u*a-h*r,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,o=n+n,a=i+i,h=e*s,u=e*o,c=e*a,l=n*o,f=n*a,d=i*a,p=r*s,v=r*o,g=r*a,m=this.val;return m[0]=1-(l+d),m[3]=u+g,m[6]=c-v,m[1]=u-g,m[4]=1-(h+d),m[7]=f+p,m[2]=c+v,m[5]=f-p,m[8]=1-(h+l),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],m=e[14],y=e[15],x=i*h-r*a,b=i*u-s*a,w=i*c-o*a,_=r*u-s*h,T=r*c-o*h,E=s*c-o*u,S=l*g-f*v,C=l*m-d*v,A=l*y-p*v,I=f*m-d*g,P=f*y-p*g,R=d*y-p*m,O=x*R-b*P+w*I+_*A-T*C+E*S;return O?(O=1/O,n[0]=(h*R-u*P+c*I)*O,n[1]=(u*A-a*R-c*C)*O,n[2]=(a*P-h*A+c*S)*O,n[3]=(s*P-r*R-o*I)*O,n[4]=(i*R-s*A+o*C)*O,n[5]=(r*A-i*P-o*S)*O,n[6]=(g*E-m*T+y*_)*O,n[7]=(m*w-v*E-y*b)*O,n[8]=(v*T-g*w+y*x)*O,this):null}});t.exports=i},function(t,e,n){var i=n(0),r=n(364),s=n(1),o=n(39),a=1e-6,h=new Int8Array([1,2,0]),u=new Float32Array([0,0,0]),c=new o(1,0,0),l=new o(0,1,0),f=new o,d=new r,p=new i({initialize:function(t,e,n,i){this.onChangeCallback=s,this.set(t,e,n,i)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,n,i,r){return void 0===r&&(r=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=n||0,this._w=i||0),r&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this._x=t*r,this._y=e*r,this._z=n*r,this._w=i*r),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.set(n+e*(t.x-n),i+e*(t.y-i),r+e*(t.z-r),s+e*(t.w-s))},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(f.copy(c).cross(t).length()<a&&f.copy(l).cross(t),f.normalize(),this.setAxisAngle(f,Math.PI)):n>.999999?this.set(0,0,0,1):(f.copy(t).cross(e),this._x=f.x,this._y=f.y,this._z=f.z,this._w=1+n,this.normalize())},setAxes:function(t,e,n){var i=d.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(d).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.set(n*t.x,n*t.y,n*t.z,Math.cos(e))},multiply:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.x,o=t.y,a=t.z,h=t.w;return this.set(e*h+r*s+n*a-i*o,n*h+r*o+i*s-e*a,i*h+r*a+e*o-n*s,r*h-e*s-n*o-i*a)},slerp:function(t,e){var n=this.x,i=this.y,r=this.z,s=this.w,o=t.x,h=t.y,u=t.z,c=t.w,l=n*o+i*h+r*u+s*c;l<0&&(l=-l,o=-o,h=-h,u=-u,c=-c);var f=1-e,d=e;if(1-l>a){var p=Math.acos(l),v=Math.sin(p);f=Math.sin((1-e)*p)/v,d=Math.sin(e*p)/v}return this.set(f*n+d*o,f*i+d*h,f*r+d*u,f*s+d*c)},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i,s=r?1/r:0;return this.set(-t*s,-e*s,-n*s,i*s)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o+r*s,n*o+i*s,i*o-n*s,r*o-e*s)},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o-i*s,n*o+r*s,i*o+e*s,r*o-n*s)},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o+n*s,n*o-e*s,i*o+r*s,r*o-i*s)},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},setFromEuler:function(t,e){var n=t.x/2,i=t.y/2,r=t.z/2,s=Math.cos(n),o=Math.cos(i),a=Math.cos(r),h=Math.sin(n),u=Math.sin(i),c=Math.sin(r);switch(t.order){case"XYZ":this.set(h*o*a+s*u*c,s*u*a-h*o*c,s*o*c+h*u*a,s*o*a-h*u*c,e);break;case"YXZ":this.set(h*o*a+s*u*c,s*u*a-h*o*c,s*o*c-h*u*a,s*o*a+h*u*c,e);break;case"ZXY":this.set(h*o*a-s*u*c,s*u*a+h*o*c,s*o*c+h*u*a,s*o*a-h*u*c,e);break;case"ZYX":this.set(h*o*a-s*u*c,s*u*a+h*o*c,s*o*c-h*u*a,s*o*a+h*u*c,e);break;case"YZX":this.set(h*o*a+s*u*c,s*u*a+h*o*c,s*o*c-h*u*a,s*o*a-h*u*c,e);break;case"XZY":this.set(h*o*a-s*u*c,s*u*a-h*o*c,s*o*c+h*u*a,s*o*a+h*u*c,e)}return this},setFromRotationMatrix:function(t){var e,n=t.val,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],h=n[9],u=n[2],c=n[6],l=n[10],f=i+a+l;return f>0?(e=.5/Math.sqrt(f+1),this.set((c-h)*e,(s-u)*e,(o-r)*e,.25/e)):i>a&&i>l?(e=2*Math.sqrt(1+i-a-l),this.set(.25*e,(r+o)/e,(s+u)/e,(c-h)/e)):a>l?(e=2*Math.sqrt(1+a-i-l),this.set((r+o)/e,.25*e,(h+c)/e,(s-u)/e)):(e=2*Math.sqrt(1+l-i-a),this.set((s+u)/e,(h+c)/e,.25*e,(o-r)/e)),this},fromMat3:function(t){var e,n=t.val,i=n[0]+n[4]+n[8];if(i>0)e=Math.sqrt(i+1),this.w=.5*e,e=.5/e,this._x=(n[7]-n[5])*e,this._y=(n[2]-n[6])*e,this._z=(n[3]-n[1])*e;else{var r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);var s=h[r],o=h[s];e=Math.sqrt(n[3*r+r]-n[3*s+s]-n[3*o+o]+1),u[r]=.5*e,e=.5/e,u[s]=(n[3*s+r]+n[3*r+s])*e,u[o]=(n[3*o+r]+n[3*r+o])*e,this._x=u[0],this._y=u[1],this._z=u[2],this._w=(n[3*o+s]-n[3*s+o])*e}return this.onChangeCallback(this),this}});t.exports=p},function(t,e,n){var i=n(367),r=n(31),s=n(33),o=n(191);t.exports=function(t){var e=t.config;if((e.customEnvironment||e.canvas)&&e.renderType===s.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!e.customEnvironment&&!e.canvas&&e.renderType!==s.HEADLESS)if(e.renderType===s.CANVAS||e.renderType!==s.CANVAS&&!o.webGL){if(!o.canvas)throw new Error("Cannot create Canvas or WebGL context, aborting.");e.renderType=s.CANVAS}else e.renderType=s.WEBGL;e.antialias||r.disableSmoothing();var a,h,u=t.scale.baseSize,c=u.width,l=u.height;e.canvas?(t.canvas=e.canvas,t.canvas.width=c,t.canvas.height=l):t.canvas=r.create(t,c,l,e.renderType),e.canvasStyle&&(t.canvas.style=e.canvasStyle),e.antialias||i.setCrisp(t.canvas),e.renderType!==s.HEADLESS&&(a=n(368),h=n(371),e.renderType===s.WEBGL?t.renderer=new h(t):(t.renderer=new a(t),t.context=t.renderer.gameContext))}},function(t,e){t.exports={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach((function(e){t.style["image-rendering"]=e})),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}}},function(t,e,n){var i=n(37),r=n(369),s=n(0),o=n(33),a=n(9),h=n(92),u=n(370),c=n(104),l=n(106),f=n(25),d=new s({Extends:a,initialize:function(t){a.call(this);var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,backgroundColor:e.backgroundColor,antialias:e.antialias,roundPixels:e.roundPixels},this.game=t,this.type=o.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=t.canvas;var n={alpha:t.config.transparent,desynchronized:t.config.desynchronized};this.gameContext=e.context?e.context:this.gameCanvas.getContext("2d",n),this.currentContext=this.gameContext,this.antialias=t.config.antialias,this.blendModes=u(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new f,this._tempMatrix2=new f,this._tempMatrix3=new f,this.isBooted=!1,this.init()},init:function(){this.game.textures.once(l.READY,this.boot,this)},boot:function(){var t=this.game,e=t.scale.baseSize;this.width=e.width,this.height=e.height,this.isBooted=!0,t.scale.on(c.RESIZE,this.onResize,this),this.resize(e.width,e.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e,this.emit(h.RESIZE,t,e)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,n=this.width,i=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),e.clearBeforeRender&&(t.clearRect(0,0,n,i),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,n,i))),t.save(),this.drawCount=0,this.emit(h.PRE_RENDER)},render:function(t,e,n){var r=e.length;this.emit(h.RENDER,t,n);var s=n.x,o=n.y,a=n.width,u=n.height,c=n.renderToTexture?n.context:t.sys.context;c.save(),this.game.scene.customViewports&&(c.beginPath(),c.rect(s,o,a,u),c.clip()),this.currentContext=c;var l=n.mask;l&&l.preRenderCanvas(this,null,n._maskCamera),n.transparent||(c.fillStyle=n.backgroundColor.rgba,c.fillRect(s,o,a,u)),c.globalAlpha=n.alpha,c.globalCompositeOperation="source-over",this.drawCount+=r,n.renderToTexture&&n.emit(i.PRE_RENDER,n),n.matrix.copyToContext(c);for(var f=0;f<r;f++){var d=e[f];d.mask&&d.mask.preRenderCanvas(this,d,n),d.renderCanvas(this,d,n),d.mask&&d.mask.postRenderCanvas(this,d,n)}c.setTransform(1,0,0,1,0,0),c.globalCompositeOperation="source-over",c.globalAlpha=1,n.flashEffect.postRenderCanvas(c),n.fadeEffect.postRenderCanvas(c),n.dirty=!1,l&&l.postRenderCanvas(this),c.restore(),n.renderToTexture&&(n.emit(i.POST_RENDER,n),n.renderToGame&&t.sys.context.drawImage(n.canvas,s,o))},postRender:function(){this.gameContext.restore(),this.emit(h.POST_RENDER);var t=this.snapshotState;t.callback&&(r(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,e,n,i,s,o,a,h,u){void 0===n&&(n=!1),this.snapshotArea(i,s,o,a,e,h,u);var c=this.snapshotState;return c.getPixel=n,r(this.canvas,c),c.callback=null,this},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=Math.min(n,this.gameCanvas.width),a.height=Math.min(i,this.gameCanvas.height),this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,n,i){var r=n.alpha*t.alpha;if(0!==r){var s=this.currentContext,o=this._tempMatrix1,a=this._tempMatrix2,h=e.canvasData,u=h.x,c=h.y,l=e.cutWidth,f=e.cutHeight,d=e.customPivot,p=e.source.resolution,v=t.displayOriginX,g=t.displayOriginY,m=-v+e.x,y=-g+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),l=x.cw,f=x.ch,u=x.cx,c=x.cy,m=-v+x.x,y=-g+x.y,t.flipX&&(m>=0?m=-(m+l):m<0&&(m=Math.abs(m)-l)),t.flipY&&(y>=0?y=-(y+f):y<0&&(y=Math.abs(y)-f))}var b=1,w=1;t.flipX&&(d||(m+=-e.realWidth+2*v),b=-1),t.flipY&&(d||(y+=-e.realHeight+2*g),w=-1),a.applyITRS(t.x,t.y,t.rotation,t.scaleX*b,t.scaleY*w),o.copyFrom(n.matrix),i?(o.multiplyWithOffset(i,-n.scrollX*t.scrollFactorX,-n.scrollY*t.scrollFactorY),a.e=t.x,a.f=t.y):(a.e-=n.scrollX*t.scrollFactorX,a.f-=n.scrollY*t.scrollFactorY),o.multiply(a),s.save(),o.setToContext(s),s.globalCompositeOperation=this.blendModes[t.blendMode],s.globalAlpha=r,s.imageSmoothingEnabled=!(!this.antialias||e.source.scaleMode),t.mask&&t.mask.preRenderCanvas(this,t,n),s.drawImage(e.source.image,u,c,l,f,m,y,l/p,f/p),t.mask&&t.mask.postRenderCanvas(this,t,n),s.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});t.exports=d},function(t,e,n){var i=n(31),r=n(38),s=n(2);t.exports=function(t,e){var n=s(e,"callback"),o=s(e,"type","image/png"),a=s(e,"encoder",.92),h=Math.abs(Math.round(s(e,"x",0))),u=Math.abs(Math.round(s(e,"y",0))),c=s(e,"width",t.width),l=s(e,"height",t.height);if(s(e,"getPixel",!1)){var f=t.getContext("2d").getImageData(h,u,1,1).data;n.call(null,new r(f[0],f[1],f[2],f[3]/255))}else if(0!==h||0!==u||c!==t.width||l!==t.height){var d=i.createWebGL(this,c,l);d.getContext("2d").drawImage(t,h,u,c,l,0,0,c,l);var p=new Image;p.onerror=function(){n.call(null),i.remove(d)},p.onload=function(){n.call(null,p),i.remove(d)},p.src=d.toDataURL(o,a)}else{var v=new Image;v.onerror=function(){n.call(null)},v.onload=function(){n.call(null,v)},v.src=t.toDataURL(o,a)}}},function(t,e,n){var i=n(35),r=n(348);t.exports=function(){var t=[],e=r.supportNewBlendModes,n="source-over";return t[i.NORMAL]=n,t[i.ADD]="lighter",t[i.MULTIPLY]=e?"multiply":n,t[i.SCREEN]=e?"screen":n,t[i.OVERLAY]=e?"overlay":n,t[i.DARKEN]=e?"darken":n,t[i.LIGHTEN]=e?"lighten":n,t[i.COLOR_DODGE]=e?"color-dodge":n,t[i.COLOR_BURN]=e?"color-burn":n,t[i.HARD_LIGHT]=e?"hard-light":n,t[i.SOFT_LIGHT]=e?"soft-light":n,t[i.DIFFERENCE]=e?"difference":n,t[i.EXCLUSION]=e?"exclusion":n,t[i.HUE]=e?"hue":n,t[i.SATURATION]=e?"saturation":n,t[i.COLOR]=e?"color":n,t[i.LUMINOSITY]=e?"luminosity":n,t[i.ERASE]="destination-out",t[i.SOURCE_IN]="source-in",t[i.SOURCE_OUT]="source-out",t[i.SOURCE_ATOP]="source-atop",t[i.DESTINATION_OVER]="destination-over",t[i.DESTINATION_IN]="destination-in",t[i.DESTINATION_OUT]="destination-out",t[i.DESTINATION_ATOP]="destination-atop",t[i.LIGHTER]="lighter",t[i.COPY]="copy",t[i.XOR]="xor",t}},function(t,e,n){var i=n(93),r=n(37),s=n(0),o=n(33),a=n(9),h=n(92),u=n(22),c=n(139),l=n(69),f=n(1),d=n(372),p=n(142),v=n(104),g=n(106),m=n(12),y=n(383),x=new s({Extends:a,initialize:function(t){a.call(this);var e=t.config,n={alpha:e.transparent,desynchronized:e.desynchronized,depth:!1,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference,preserveDrawingBuffer:e.preserveDrawingBuffer};this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:n,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights,mipmapFilter:e.mipmapFilter},this.game=t,this.type=o.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.currentActiveTexture=0,this.startActiveTexture=0,this.maxTextures=0,this.textureIndexes,this.tempTextures,this.textureZero,this.normalTexture,this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=f,this.contextRestoredHandler=f,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats=[],this.compression={ETC1:!1,PVRTC:!1,S3TC:!1},this.drawingBufferHeight=0,this.blankTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.textureFlush=0,this.isTextureClean=!1,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.init(this.config)},init:function(t){var e,n=this.game,i=this.canvas,r=t.backgroundColor;if(!(e=n.config.context?n.config.context:i.getContext("webgl",t.contextCreation)||i.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e;var s=this;this.contextLostHandler=function(t){s.contextLost=!0,s.game.events.emit(u.CONTEXT_LOST,s),t.preventDefault()},this.contextRestoredHandler=function(){s.contextLost=!1,s.init(s.config),s.game.events.emit(u.CONTEXT_RESTORED,s)},i.addEventListener("webglcontextlost",this.contextLostHandler,!1),i.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),n.context=e;for(var a=0;a<=27;a++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats[0]=e.BYTE,this.glFormats[1]=e.SHORT,this.glFormats[2]=e.UNSIGNED_BYTE,this.glFormats[3]=e.UNSIGNED_SHORT,this.glFormats[4]=e.FLOAT,this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}};var h=e.getSupportedExtensions();t.maxTextures&&-1!==t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE));var c="WEBGL_compressed_texture_",f="WEBKIT_"+c;this.compression.ETC1=e.getExtension(c+"etc1")||e.getExtension(f+"etc1"),this.compression.PVRTC=e.getExtension(c+"pvrtc")||e.getExtension(f+"pvrtc"),this.compression.S3TC=e.getExtension(c+"s3tc")||e.getExtension(f+"s3tc"),this.supportedExtensions=h;var p="ANGLE_instanced_arrays";this.instancedArraysExtension=h.indexOf(p)>-1?e.getExtension(p):null;var v="OES_vertex_array_object";this.vaoExtension=h.indexOf(v)>-1?e.getExtension(v):null,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),this.mipmapFilter=e[t.mipmapFilter],this.maxTextures=m.checkShaderMax(e,t.maxTextures),this.textureIndexes=[];var y=this.tempTextures;if(Array.isArray(y))for(var x=0;a<this.maxTextures;x++)e.deleteTexture(y[x]);else y=new Array(this.maxTextures);for(var b=0;b<this.maxTextures;b++){var w=e.createTexture();e.activeTexture(e.TEXTURE0+b),e.bindTexture(e.TEXTURE_2D,w),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),y[b]=w,this.textureIndexes.push(b)}return this.tempTextures=y,this.currentActiveTexture=1,this.startActiveTexture++,e.activeTexture(e.TEXTURE1),this.pipelines=new d(this),this.setBlendMode(o.BlendModes.NORMAL),this.projectionMatrix=(new l).identity(),n.textures.once(g.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,n=t.scale.baseSize;this.width=n.width,this.height=n.height,this.isBooted=!0,this.renderTarget=new p(this,this.width,this.height,1,0,!0,!0),e.boot(t.config.pipeline),this.blankTexture=t.textures.getFrame("__DEFAULT"),this.whiteTexture=t.textures.getFrame("__WHITE");var i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,null),i.enable(i.SCISSOR_TEST),t.scale.on(v.RESIZE,this.onResize,this),this.resize(n.width,n.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},beginCapture:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e),this.resetTextures()},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var n=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),n.viewport(0,0,t,e),this.drawingBufferHeight=n.drawingBufferHeight,n.scissor(0,n.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(h.RESIZE,t,e),this},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return t===this.projectionWidth&&e===this.projectionHeight||(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){this.projectionWidth=this.width,this.projectionHeight=this.height,this.projectionMatrix.ortho(0,this.width,this.height,0,-1e3,1e3)},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=[t,e,n,i];return this.scissorStack.push(s),this.setScissor(t,e,n,i,r),this.currentScissor=s,s},setScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=this.gl,o=this.currentScissor,a=n>0&&i>0;if(o&&a){var h=o[0],u=o[1],c=o[2],l=o[3];a=h!==t||u!==e||c!==n||l!==i}a&&(this.flush(),s.scissor(t,r-e-i,n,i))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var n=e[0],i=e[1],r=e[2],s=e[3];r>0&&s>0&&t.scissor(n,this.drawingBufferHeight-i-s,r,s)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){void 0===e&&(e=!1);var n=this.gl,i=this.blendModes[t];return!!(e||t!==o.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),n.enable(n.BLEND),n.blendEquation(i.equation),i.func.length>2?n.blendFuncSeparate(i.func[0],i.func[1],i.func[2],i.func[3]):n.blendFunc(i.func[0],i.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,n){return this.blendModes[t]&&(this.blendModes[t].func=e,n&&(this.blendModes[t].equation=n)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},setBlankTexture:function(){this.setTexture2D(this.blankTexture.glTexture)},setTextureSource:function(t){if(this.pipelines.forceZero())return this.setTextureZero(t.glTexture,!0),0;var e=this.gl,n=this.currentActiveTexture;return t.glIndexCounter<this.startActiveTexture&&(t.glIndexCounter=this.startActiveTexture,n<this.maxTextures?(t.glIndex=n,e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t.glTexture),this.currentActiveTexture++):(this.flush(),this.startActiveTexture++,this.textureFlush++,t.glIndexCounter=this.startActiveTexture,t.glIndex=1,e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t.glTexture),this.currentActiveTexture=2)),this.isTextureClean=!1,t.glIndex},isNewNormalMap:function(t,e){return this.textureZero!==t||this.normalTexture!==e},setTextureZero:function(t,e){if(this.textureZero!==t){e&&this.flush();var n=this.gl;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t),this.textureZero=t}},clearTextureZero:function(){this.textureZero=null},setNormalMap:function(t){if(this.normalTexture!==t){var e=this.gl;e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),this.normalTexture=t,1===this.currentActiveTexture&&(this.currentActiveTexture=2)}},clearNormalMap:function(){this.normalTexture=null,this.startActiveTexture++,this.currentActiveTexture=1,this.textureFlush++},unbindTextures:function(){for(var t=this.gl,e=this.tempTextures,n=0;n<e.length;n++)t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,null);this.normalTexture=null,this.textureZero=null,this.currentActiveTexture=1,this.startActiveTexture++,this.textureFlush++},resetTextures:function(t){if(void 0===t&&(t=!1),!this.isTextureClean){this.flush();var e=this.gl,n=this.tempTextures;if(t){for(var i=0;i<n.length;i++)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,n[i]);e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n[1]),this.isTextureClean=!0}else e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n[0]),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n[1]);this.normalTexture=null,this.textureZero=null,this.currentActiveTexture=1,this.startActiveTexture++,this.textureFlush++}},setTexture2D:function(t){if(this.pipelines.forceZero())return this.setTextureZero(t,!0),0;var e=this.gl,n=this.currentActiveTexture;return t.glIndexCounter<this.startActiveTexture&&(t.glIndexCounter=this.startActiveTexture,n<this.maxTextures?(t.glIndex=n,e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),this.currentActiveTexture++):(this.flush(),this.startActiveTexture++,this.textureFlush++,t.glIndexCounter=this.startActiveTexture,t.glIndex=1,e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,t),this.currentActiveTexture=2)),this.isTextureClean=!1,t.glIndex},pushFramebuffer:function(t,e,n,i){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,n,i))},setFramebuffer:function(t,e,n,i){if(void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=!0),t===this.currentFramebuffer)return this;var r=this.gl,s=this.width,o=this.height;return t&&t.renderTexture&&i?(s=t.renderTexture.width,o=t.renderTexture.height):this.flush(),r.bindFramebuffer(r.FRAMEBUFFER,t),i&&r.viewport(0,0,s,o),e&&(t?(this.drawingBufferHeight=o,this.pushScissor(0,0,s,o)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,n&&this.resetTextures(),this},popFramebuffer:function(t,e,n){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===n&&(n=!0);var i=this.fboStack;i.pop();var r=i[i.length-1];return r||(r=null),this.setFramebuffer(r,t,e,n),r},setProgram:function(t){return t!==this.currentProgram&&(this.flush(),this.gl.useProgram(t),this.currentProgram=t,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram),this},createTextureFromSource:function(t,e,n,i){var r=this.gl,s=r.NEAREST,a=r.NEAREST,h=r.CLAMP_TO_EDGE;e=t?t.width:e,n=t?t.height:n;var u=c(e,n);return u&&(h=r.REPEAT),i===o.ScaleModes.LINEAR&&this.config.antialias&&(s=u?this.mipmapFilter:r.LINEAR,a=r.LINEAR),t||"number"!=typeof e||"number"!=typeof n?this.createTexture2D(0,s,a,h,h,r.RGBA,t):this.createTexture2D(0,s,a,h,h,r.RGBA,null,e,n)},createTexture2D:function(t,e,n,i,r,s,o,a,h,u,l,f){u=null==u||u,void 0===l&&(l=!1),void 0===f&&(f=!1);var d=this.gl,p=d.createTexture();d.activeTexture(d.TEXTURE0);var v=d.getParameter(d.TEXTURE_BINDING_2D);return d.bindTexture(d.TEXTURE_2D,p),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,r),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,f),null==o?d.texImage2D(d.TEXTURE_2D,t,s,a,h,0,s,d.UNSIGNED_BYTE,null):(l||(a=o.width,h=o.height),d.texImage2D(d.TEXTURE_2D,t,s,s,d.UNSIGNED_BYTE,o)),c(a,h)&&d.generateMipmap(d.TEXTURE_2D),v&&d.bindTexture(d.TEXTURE_2D,v),p.isAlphaPremultiplied=u,p.isRenderTexture=!1,p.width=a,p.height=h,p.glIndex=0,p.glIndexCounter=-1,p},createFramebuffer:function(t,e,n,i){var r,s=this.gl,o=s.createFramebuffer();if(this.setFramebuffer(o),i){var a=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,a),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t,e),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)}if(n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),(r=s.checkFramebufferStatus(s.FRAMEBUFFER))!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+{36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"}[r]);return o.renderTexture=n,this.setFramebuffer(null),this.resetTextures(),o},createProgram:function(t,e){var n=this.gl,i=n.createProgram(),r=n.createShader(n.VERTEX_SHADER),s=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(r,t),n.shaderSource(s,e),n.compileShader(r),n.compileShader(s),!n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Vertex Shader failed:\n"+n.getShaderInfoLog(r));if(!n.getShaderParameter(s,n.COMPILE_STATUS))throw new Error("Fragment Shader failed:\n"+n.getShaderInfoLog(s));if(n.attachShader(i,r),n.attachShader(i,s),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw new Error("Link Program failed:\n"+n.getProgramInfoLog(i));return n.useProgram(i),i},createVertexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,t,e),n.bindBuffer(n.ARRAY_BUFFER,null),i},createIndexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,e),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),i},deleteTexture:function(t,e){return e&&this.resetTextures(!0),t&&this.gl.deleteTexture(t),this},deleteFramebuffer:function(t){return t&&(this.gl.deleteFramebuffer(t),i(this.fboStack,t),this.currentFramebuffer===t&&(this.currentFramebuffer=null)),this},deleteProgram:function(t){return t&&this.gl.deleteProgram(t),this},deleteBuffer:function(t){return this.gl.deleteBuffer(t),this},preRenderCamera:function(t){var e=t.x,n=t.y,i=t.width,s=t.height,o=t.backgroundColor;t.emit(r.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,n,i,s),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),o.alphaGL>0&&this.pipelines.setMulti().drawFillRect(e,n,i,s,m.getTintFromFloats(o.blueGL,o.greenGL,o.redGL,1),o.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,n=this.currentCameraMask;return e.length>0?t=e[e.length-1]:n.mask&&n.mask.isStencil&&(t=n),t},postRenderCamera:function(t){var e=t.flashEffect,n=t.fadeEffect;if(e.isRunning||n.isRunning||n.isComplete){var i=this.pipelines.setMulti();e.postRenderWebGL(i,m.getTintFromFloats),n.postRenderWebGL(i,m.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(r.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.textureFlush=0,this.emit(h.PRE_RENDER)}},render:function(t,e,n){if(!this.contextLost){var i=e.length;if(this.emit(h.RENDER,t,n),this.preRenderCamera(n),0===i)return this.setBlendMode(o.BlendModes.NORMAL),void this.postRenderCamera(n);this.currentType="";for(var r=this.currentMask,s=0;s<i;s++){this.finalType=s===i-1;var a=e[s],u=a.mask;(r=this.currentMask).mask&&r.mask!==u&&r.mask.postRenderWebGL(this,r.camera),u&&r.mask!==u&&u.preRenderWebGL(this,a,n),a.blendMode!==this.currentBlendMode&&this.setBlendMode(a.blendMode);var c=a.type;c!==this.currentType&&(this.newType=!0,this.currentType=c),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[s+1].type===this.currentType,a.renderWebGL(this,a,n),this.newType=!1}(r=this.currentMask).mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(n)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(h.POST_RENDER);var t=this.snapshotState;t.callback&&(y(this.canvas,t),t.callback=null),this.textureFlush>0&&(this.startActiveTexture++,this.currentActiveTexture=1)}},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=Math.min(n,this.gl.drawingBufferWidth),a.height=Math.min(i,this.gl.drawingBufferHeight),this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,n,i,r,s,o,a,h,u,c){void 0===r&&(r=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=e),void 0===h&&(h=n);var l=this.currentFramebuffer;this.snapshotArea(s,o,a,h,i,u,c);var f=this.snapshotState;return f.getPixel=r,f.isFramebuffer=!0,f.bufferWidth=e,f.bufferHeight=n,this.setFramebuffer(t),y(this.canvas,f),this.setFramebuffer(l),f.callback=null,f.isFramebuffer=!1,this},canvasToTexture:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e?this.updateCanvasTexture(t,e,i):this.createCanvasTexture(t,n,i)},createCanvasTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=i.NEAREST,s=i.NEAREST,o=t.width,a=t.height,h=i.CLAMP_TO_EDGE,u=c(o,a);return!e&&u&&(h=i.REPEAT),this.config.antialias&&(r=u?this.mipmapFilter:i.LINEAR,s=i.LINEAR),this.createTexture2D(0,r,s,h,h,i.RGBA,t,o,a,!0,!1,n)},updateCanvasTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.width,s=t.height;if(r>0&&s>0){i.activeTexture(i.TEXTURE0);var o=i.getParameter(i.TEXTURE_BINDING_2D);i.bindTexture(i.TEXTURE_2D,e),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,o&&i.bindTexture(i.TEXTURE_2D,o)}return e},createVideoTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=i.NEAREST,s=i.NEAREST,o=t.videoWidth,a=t.videoHeight,h=i.CLAMP_TO_EDGE,u=c(o,a);return!e&&u&&(h=i.REPEAT),this.config.antialias&&(r=u?this.mipmapFilter:i.LINEAR,s=i.LINEAR),this.createTexture2D(0,r,s,h,h,i.RGBA,t,o,a,!0,!0,n)},updateVideoTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.videoWidth,s=t.videoHeight;if(r>0&&s>0){i.activeTexture(i.TEXTURE0);var o=i.getParameter(i.TEXTURE_BINDING_2D);i.bindTexture(i.TEXTURE_2D,e),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,o&&i.bindTexture(i.TEXTURE_2D,o)}return e},setTextureFilter:function(t,e){var n=this.gl,i=[n.LINEAR,n.NEAREST][e];n.activeTexture(n.TEXTURE0);var r=n.getParameter(n.TEXTURE_BINDING_2D);return n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,i),r&&n.bindTexture(n.TEXTURE_2D,r),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);for(var t=this.gl,e=this.tempTextures,n=0;n<e.length;n++)t.deleteTexture(e[n]);this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}});t.exports=x},function(t,e,n){var i=n(0),r=n(67),s=n(102),o=n(373),a=n(376),h=n(377),u=n(108),c=n(378),l=n(379),f=n(380),d=n(381),p=new i({initialize:function(t){this.game=t.game,this.renderer=t,this.classes=new s([[r.UTILITY_PIPELINE,d],[r.MULTI_PIPELINE,u],[r.BITMAPMASK_PIPELINE,o],[r.SINGLE_PIPELINE,f],[r.ROPE_PIPELINE,l],[r.LIGHT_PIPELINE,h],[r.POINTLIGHT_PIPELINE,c],[r.GRAPHICS_PIPELINE,a]]),this.postPipelineClasses=new s,this.pipelines=new s,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(t){var e,n,i=this,s=this.game;if(this.classes.each((function(t,n){e=i.add(t,new n({game:s})),t===r.UTILITY_PIPELINE&&(i.UTILITY_PIPELINE=e,i.fullFrame1=e.fullFrame1,i.fullFrame2=e.fullFrame2,i.halfFrame1=e.halfFrame1,i.halfFrame2=e.halfFrame2)})),this.MULTI_PIPELINE=this.get(r.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(r.BITMAPMASK_PIPELINE),t)for(n in t){var o=t[n];(e=new o(s)).isPostFX?this.postPipelineClasses.set(n,o):this.has(n)||(this.classes.set(n,o),this.add(n,e))}},add:function(t,e){if(!e.isPostFX){var n=this.pipelines,i=this.renderer;return n.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,n.set(t,e)),e.hasBooted||e.boot(),0!==i.width&&0!==i.height&&e.resize(i.width,i.height),e}console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return"string"==typeof t?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;return"string"==typeof t?e.get(t):e.contains(t)?t:void 0},getPostPipeline:function(t,e){var n,i=this.postPipelineClasses;if("string"==typeof t?n=i.get(t):"function"==typeof t?i.contains(t)&&(n=t):"object"==typeof t&&(n=i.get(t.name)),n){var r=new n(this.game);return e&&(r.gameObject=e),r}},remove:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!0),this.pipelines.delete(t),e&&this.classes.delete(t),n&&this.postPipelineClasses.delete(t)},set:function(t,e,n){if(!t.isPostFX)return this.isCurrent(t,n)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(n)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=e.length-1;n>=0;n--){var i=e[n];i.active&&i.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=0;n<e.length;n++){var i=e[n];i.active&&i.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=e.length-1;n>=0;n--){var i=e[n];i.active&&i.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=0;n<e.length;n++){var i=e[n];i.active&&i.postBatch(t)}}},isCurrent:function(t,e){var n=this.renderer,i=this.current;return i&&!e&&(e=i.currentShader),!(i!==t||e.program!==n.currentProgram)},copyFrame:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,n,i,r),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,n,i){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,n,i),this},blendFrames:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,n,i,r),this},blendFramesAdditive:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,n,i,r),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,n,i,r,s){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,n,i,r,s),this},copyFrameRect:function(t,e,n,i,r,s,o,a){return this.UTILITY_PIPELINE.copyFrameRect(t,e,n,i,r,s,o,a),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},rebind:function(t){void 0===t&&this.previous&&(t=this.previous);var e=this.renderer,n=e.gl;n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),e.hasActiveStencilMask()?n.clear(n.DEPTH_BUFFER_BIT):(n.disable(n.STENCIL_TEST),n.clear(n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT)),n.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var i=this.pipelines.entries;for(var r in i)i[r].glReset=!0;t&&(this.current=t,t.rebind()),e.resetTextures()},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0)},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.current=null,this.previous=null}});t.exports=p},function(t,e,n){var i=n(0),r=n(2),s=n(865),o=n(866),a=n(107),h=n(58),u=new i({Extends:h,initialize:function(t){t.fragShader=r(t,"fragShader",s),t.vertShader=r(t,"vertShader",o),t.batchSize=r(t,"batchSize",1),t.vertices=r(t,"vertices",[-1,1,-1,-7,7,1]),t.attributes=r(t,"attributes",[{name:"inPosition",size:2,type:a.FLOAT}]),h.call(this,t)},boot:function(){h.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){h.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,n){var i=this.gl;if(t.bitmapMask&&i){var r=this.renderer;r.flush(),r.pushFramebuffer(t.mainFramebuffer),i.disable(i.STENCIL_TEST),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),r.currentCameraMask.mask!==t&&(r.currentMask.mask=t,r.currentMask.camera=n)}},endMask:function(t,e){var n=this.gl,i=this.renderer,r=t.bitmapMask;if(r&&n){i.flush(),i.pushFramebuffer(t.maskFramebuffer),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),i.setBlendMode(0,!0),r.renderWebGL(i,r,e),i.flush(),i.popFramebuffer(),i.popFramebuffer();var s=i.getCurrentStencilMask();s?(n.enable(n.STENCIL_TEST),s.mask.applyStencil(i,s.camera,!0)):i.currentMask.mask=null,i.pipelines.set(this),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,t.maskTexture),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.mainTexture),this.set1i("uInvertMaskAlpha",t.invertAlpha),n.drawArrays(this.topology,0,3),i.resetTextures()}}});t.exports=u},function(t,e,n){t.exports={AFTER_FLUSH:n(867),BEFORE_FLUSH:n(868),BIND:n(869),BOOT:n(870),DESTROY:n(871),REBIND:n(872),RESIZE:n(873)}},function(t,e,n){var i=n(0),r=n(2),s=n(107),o=new i({initialize:function(t,e,n,i,r){this.pipeline=t,this.name=e,this.renderer=t.renderer,this.gl=this.renderer.gl,this.program=this.renderer.createProgram(n,i),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(r),this.createUniforms()},createAttributes:function(t){var e=0,n=0,i=[];this.vertexComponentCount=0;for(var o=0;o<t.length;o++){var a=t[o],h=a.name,u=r(a,"size",1),c=r(a,"type",s.FLOAT),l=c.enum,f=c.size,d=!!a.normalized;i.push({name:h,size:u,type:l,normalized:d,offset:n,enabled:!1,location:-1}),4===f?e+=u:e++,n+=u*f}this.vertexSize=n,this.vertexComponentCount=e,this.attributes=i},bind:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){void 0===t&&(t=!1);for(var e=this.gl,n=this.vertexSize,i=this.attributes,r=this.program,s=0;s<i.length;s++){var o=i[s],a=o.size,h=o.type,u=o.offset,c=o.enabled,l=o.location,f=!!o.normalized;if(t){var d=e.getAttribLocation(r,o.name);d>=0?(e.enableVertexAttribArray(d),e.vertexAttribPointer(d,a,h,f,n,u),o.enabled=!0,o.location=d):-1!==d&&e.disableVertexAttribArray(d)}else c?e.vertexAttribPointer(l,a,h,f,n,u):!c&&l>-1&&(e.disableVertexAttribArray(l),o.location=-1)}return this},createUniforms:function(){var t,e,n,i=this.gl,r=this.program,s=this.uniforms,o=i.getProgramParameter(r,i.ACTIVE_UNIFORMS);for(t=0;t<o;t++){var a=i.getActiveUniform(r,t);if(a){e=a.name,null!==(n=i.getUniformLocation(r,e))&&(s[e]={name:e,location:n,value1:null,value2:null,value3:null,value4:null});var h=e.indexOf("[");h>0&&(e=e.substr(0,h),s.hasOwnProperty(e)||null!==(n=i.getUniformLocation(r,e))&&(s[e]={name:e,location:n,value1:null,value2:null,value3:null,value4:null}))}}return this},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,n){var i=this.uniforms[e];return i?(i.value1!==n&&(i.value1=n,this.renderer.setProgram(this.program),t.call(this.gl,i.location,n),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,n,i){var r=this.uniforms[e];return r?(r.value1===n&&r.value2===i||(r.value1=n,r.value2=i,this.renderer.setProgram(this.program),t.call(this.gl,r.location,n,i),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,n,i,r){var s=this.uniforms[e];return s?(s.value1===n&&s.value2===i&&s.value3===r||(s.value1=n,s.value2=i,s.value3=r,this.renderer.setProgram(this.program),t.call(this.gl,s.location,n,i,r),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,n,i,r,s){var o=this.uniforms[e];return o?(o.value1===n&&o.value2===i&&o.value3===r&&o.value4===s||(o.value1=n,o.value2=i,o.value3=r,o.value4=s,this.renderer.setProgram(this.program),t.call(this.gl,o.location,n,i,r,s),this.pipeline.currentShader=this),this):this},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,n){return this.setUniform2(this.gl.uniform2f,t,e,n)},set3f:function(t,e,n,i){return this.setUniform3(this.gl.uniform3f,t,e,n,i)},set4f:function(t,e,n,i,r){return this.setUniform4(this.gl.uniform4f,t,e,n,i,r)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,n){return this.setUniform2(this.gl.uniform2i,t,e,n)},set3i:function(t,e,n,i){return this.setUniform3(this.gl.uniform3i,t,e,n,i)},set4i:function(t,e,n,i,r){return this.setUniform4(this.gl.uniform4i,t,e,n,i,r)},setMatrix2fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,n)},setMatrix3fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,n)},setMatrix4fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,n)},destroy:function(){this.gl.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null,this.attributes=null,this.uniforms=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(70),s=n(2),o=n(874),a=n(875),h=n(25),u=n(107),c=n(58),l=new i({Extends:c,initialize:function(t){t.fragShader=s(t,"fragShader",o),t.vertShader=s(t,"vertShader",a),t.attributes=s(t,"attributes",[{name:"inPosition",size:2},{name:"inColor",size:4,type:u.UNSIGNED_BYTE,normalized:!0}]),c.call(this,t),this.calcMatrix=new h,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},batchFillRect:function(t,e,n,i,r,s){this.renderer.pipelines.set(this);var o=this.calcMatrix;s&&s.multiply(r,o);var a=t+n,h=e+i,u=o.getX(t,e),c=o.getY(t,e),l=o.getX(t,h),f=o.getY(t,h),d=o.getX(a,h),p=o.getY(a,h),v=o.getX(a,e),g=o.getY(a,e),m=this.fillTint;this.batchQuad(u,c,l,f,d,p,v,g,m.TL,m.TR,m.BL,m.BR)},batchFillTriangle:function(t,e,n,i,r,s,o,a){this.renderer.pipelines.set(this);var h=this.calcMatrix;a&&a.multiply(o,h);var u=h.getX(t,e),c=h.getY(t,e),l=h.getX(n,i),f=h.getY(n,i),d=h.getX(r,s),p=h.getY(r,s),v=this.fillTint;this.batchTri(u,c,l,f,d,p,v.TL,v.TR,v.BL)},batchStrokeTriangle:function(t,e,n,i,r,s,o,a,h){var u=this.tempTriangle;u[0].x=t,u[0].y=e,u[0].width=o,u[1].x=n,u[1].y=i,u[1].width=o,u[2].x=r,u[2].y=s,u[2].width=o,u[3].x=t,u[3].y=e,u[3].width=o,this.batchStrokePath(u,o,!1,a,h)},batchFillPath:function(t,e,n){this.renderer.pipelines.set(this);var i=this.calcMatrix;n&&n.multiply(e,i);for(var s,o,a=t.length,h=this.polygonCache,u=this.fillTint.TL,c=this.fillTint.TR,l=this.fillTint.BL,f=0;f<a;++f)o=t[f],h.push(o.x,o.y);a=(s=r(h)).length;for(var d=0;d<a;d+=3){var p=2*s[d+0],v=2*s[d+1],g=2*s[d+2],m=h[p+0],y=h[p+1],x=h[v+0],b=h[v+1],w=h[g+0],_=h[g+1],T=i.getX(m,y),E=i.getY(m,y),S=i.getX(x,b),C=i.getY(x,b),A=i.getX(w,_),I=i.getY(w,_);this.batchTri(T,E,S,C,A,I,u,c,l)}h.length=0},batchStrokePath:function(t,e,n,i,r){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var s=t.length-1,o=0;o<s;o++){var a=t[o],h=t[o+1];this.batchLine(a.x,a.y,h.x,h.y,a.width/2,h.width/2,e,o,!n&&o===s-1,i,r)}},batchLine:function(t,e,n,i,r,s,o,a,h,u,c){this.renderer.pipelines.set(this);var l=this.calcMatrix;c&&c.multiply(u,l);var f=n-t,d=i-e,p=Math.sqrt(f*f+d*d),v=r*(i-e)/p,g=r*(t-n)/p,m=s*(i-e)/p,y=s*(t-n)/p,x=n-m,b=i-y,w=t-v,_=e-g,T=n+m,E=i+y,S=t+v,C=e+g,A=l.getX(x,b),I=l.getY(x,b),P=l.getX(w,_),R=l.getY(w,_),O=l.getX(T,E),k=l.getY(T,E),M=l.getX(S,C),D=l.getY(S,C),L=this.strokeTint,N=L.TL,F=L.TR,B=L.BL,U=L.BR;if(this.batchQuad(M,D,P,R,A,I,O,k,N,F,B,U),!(o<=2)){var V=this.prevQuad,Y=this.firstQuad;a>0&&V[4]?this.batchQuad(M,D,P,R,V[0],V[1],V[2],V[3],N,F,B,U):(Y[0]=M,Y[1]=D,Y[2]=P,Y[3]=R,Y[4]=1),h&&Y[4]?this.batchQuad(A,I,O,k,Y[0],Y[1],Y[2],Y[3],N,F,B,U):(V[0]=A,V[1]=I,V[2]=O,V[3]=k,V[4]=1)}},batchVert:function(t,e,n){var i=this.vertexViewF32,r=this.vertexViewU32,s=this.vertexCount*this.currentShader.vertexComponentCount-1;i[++s]=t,i[++s]=e,r[++s]=n,this.vertexCount++},batchQuad:function(t,e,n,i,r,s,o,a,h,u,c,l){var f=!1;return this.shouldFlush(6)&&(this.flush(),f=!0),this.batchVert(t,e,h),this.batchVert(n,i,c),this.batchVert(r,s,l),this.batchVert(t,e,h),this.batchVert(r,s,l),this.batchVert(o,a,u),f},batchTri:function(t,e,n,i,r,s,o,a,h){var u=!1;return this.shouldFlush(3)&&(this.flush(),u=!0),this.batchVert(t,e,o),this.batchVert(n,i,a),this.batchVert(r,s,h),u},destroy:function(){return c.prototype.destroy.call(this),this.polygonCache=null,this}});t.exports=l},function(t,e,n){var i=n(0),r=n(2),s=n(876),o=n(108),a=n(3),h=n(58),u=10,c=new a,l=new i({Extends:o,initialize:function(t){u=t.game.renderer.config.maxLights;for(var e=r(t,"fragShader",s),n=[],i=1;i<=u;i++)n.push({name:"lights"+i,fragShader:e.replace("%LIGHT_COUNT%",i.toString())});t.shaders=n,o.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.defaultNormalMap,this.lightsActive=!0},boot:function(){h.prototype.boot.call(this);var t=this.gl,e=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([127,127,255,255])),this.defaultNormalMap={glTexture:e};for(var n=0;n<this.shaders.length;n++)this["lightShader"+(n+1)]=this.shaders[n]},onRender:function(t,e){var n=t.sys.lights;if(this.lightsActive=!1,n&&n.active){var i=n.getLights(e),r=i.length;if(0!==r){var s;this.lightsActive=!0,this.setShader(this["lightShader"+r],!0);var o=this.renderer.height,a=e.matrix;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",e.x,e.y,e.rotation,e.zoom),this.set3f("uAmbientLightColor",n.ambientColor.r,n.ambientColor.g,n.ambientColor.b),s=0;s<r;s++){var h=i[s].light,u=h.color,l="uLights["+s+"].";a.transformPoint(h.x,h.y,c),this.set2f(l+"position",c.x-e.scrollX*h.scrollFactorX*e.zoom,o-(c.y-e.scrollY*h.scrollFactorY*e.zoom)),this.set3f(l+"color",u.r,u.g,u.b),this.set1f(l+"intensity",h.intensity),this.set1f(l+"radius",h.radius)}this.currentNormalMapRotation=null}}},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.vertexCount){this.vertexCount>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var n=-t,i=Math.cos(n),r=Math.sin(n);e[1]=r,e[3]=-r,e[0]=e[4]=i}else e[0]=e[4]=1,e[1]=e[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},setTexture2D:function(t,e){var n=this.renderer;void 0===t&&(t=n.tempTextures[0]);var i=this.getNormalMap(e);n.isNewNormalMap(t,i)&&(this.flush(),n.setTextureZero(t),n.setNormalMap(i));var r=e?e.rotation:0;return this.setNormalMapRotation(r),this.currentUnit=0,0},setGameObject:function(t,e){void 0===e&&(e=t.frame);var n=this.renderer,i=e.glTexture,r=this.getNormalMap(t);return n.isNewNormalMap()&&(this.flush(),n.setTextureZero(i),n.setNormalMap(r)),this.setNormalMapRotation(t.rotation),this.currentUnit=0,0},getNormalMap:function(t){var e;return t?t.displayTexture?e=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?e=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(e=Array.isArray(t.tileset)?t.tileset[0].image.dataSource[0]:t.tileset.image.dataSource[0]):e=this.defaultNormalMap,e||(e=this.defaultNormalMap),e.glTexture},batchSprite:function(t,e,n){this.lightsActive&&o.prototype.batchSprite.call(this,t,e,n)},batchTexture:function(t,e,n,i,r,s,a,h,u,c,l,f,d,p,v,g,m,y,x,b,w,_,T,E,S,C,A,I,P,R,O,k){this.lightsActive&&o.prototype.batchTexture.call(this,t,e,n,i,r,s,a,h,u,c,l,f,d,p,v,g,m,y,x,b,w,_,T,E,S,C,A,I,P,R,O,k)},batchTextureFrame:function(t,e,n,i,r,s,a){this.lightsActive&&o.prototype.batchTextureFrame.call(this,t,e,n,i,r,s,a)}});l.LIGHT_COUNT=u,t.exports=l},function(t,e,n){var i=n(0),r=n(2),s=n(879),o=n(880),a=n(58),h=new i({Extends:a,initialize:function(t){t.vertShader=r(t,"vertShader",o),t.fragShader=r(t,"fragShader",s),t.attributes=r(t,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),a.call(this,t)},onRender:function(t,e){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",e.zoom)},batchPointLight:function(t,e,n,i,r,s,o,a,h,u,c,l){var f=t.color,d=t.intensity,p=t.radius,v=t.attenuation,g=f.r*d,m=f.g*d,y=f.b*d,x=e.alpha*t.alpha;this.shouldFlush(6)&&this.flush(),this.batchLightVert(n,i,c,l,p,v,g,m,y,x),this.batchLightVert(r,s,c,l,p,v,g,m,y,x),this.batchLightVert(o,a,c,l,p,v,g,m,y,x),this.batchLightVert(n,i,c,l,p,v,g,m,y,x),this.batchLightVert(o,a,c,l,p,v,g,m,y,x),this.batchLightVert(h,u,c,l,p,v,g,m,y,x)},batchLightVert:function(t,e,n,i,r,s,o,a,h,u){var c=this.vertexViewF32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;c[++l]=t,c[++l]=e,c[++l]=n,c[++l]=i,c[++l]=r,c[++l]=s,c[++l]=o,c[++l]=a,c[++l]=h,c[++l]=u,this.vertexCount++}});t.exports=h},function(t,e,n){var i=n(0),r=n(2),s=n(108),o=new i({Extends:s,initialize:function(t){t.topology=5,t.batchSize=r(t,"batchSize",256),s.call(this,t)}});t.exports=o},function(t,e,n){var i=n(0),r=n(2),s=n(108),o=n(881),a=n(882),h=n(58),u=new i({Extends:s,initialize:function(t){t.fragShader=r(t,"fragShader",o),t.vertShader=r(t,"vertShader",a),t.forceZero=!0,s.call(this,t)},boot:function(){h.prototype.boot.call(this),this.set1i("uMainSampler",0)}});t.exports=u},function(t,e,n){var i=n(883),r=n(35),s=n(0),o=n(198),a=n(884),h=n(885),u=n(2),c=n(886),l=n(382),f=n(58),d=new s({Extends:f,initialize:function(t){t.renderTarget=u(t,"renderTarget",[{scale:1},{scale:1},{scale:.5},{scale:.5}]),t.vertShader=u(t,"vertShader",l),t.shaders=u(t,"shaders",[{name:"Copy",fragShader:h},{name:"AddBlend",fragShader:i},{name:"LinearBlend",fragShader:c},{name:"ColorMatrix",fragShader:a}]),t.attributes=u(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],t.batchSize=1,f.call(this,t),this.colorMatrix=new o,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){f.prototype.boot.call(this);var t=this.shaders,e=this.renderTargets;this.copyShader=t[0],this.addShader=t[1],this.linearShader=t[2],this.colorMatrixShader=t[3],this.fullFrame1=e[0],this.fullFrame2=e[1],this.halfFrame1=e[2],this.halfFrame2=e[3]},copyFrame:function(t,e,n,i,r){void 0===n&&(n=1),void 0===i&&(i=!0),void 0===r&&(r=!0);var s=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture,0)):s.viewport(0,0,t.width,t.height),i&&(r?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT)),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D,null)},blitFrame:function(t,e,n,i,s,o){void 0===n&&(n=1),void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===o&&(o=!1);var a=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture),t.height>e.height)a.viewport(0,0,t.width,t.height),this.setTargetUVs(t,e);else{var h=e.height-t.height;a.viewport(0,h,t.width,t.height)}if(a.bindFramebuffer(a.FRAMEBUFFER,e.framebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e.texture,0),i&&(s?a.clearColor(0,0,0,0):a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT)),o){var u=this.renderer.currentBlendMode;this.renderer.setBlendMode(r.ERASE)}a.bufferData(a.ARRAY_BUFFER,this.vertexData,a.STATIC_DRAW),a.drawArrays(a.TRIANGLES,0,6),o&&this.renderer.setBlendMode(u),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindTexture(a.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(t,e,n,i,r,s,o,a){void 0===o&&(o=!0),void 0===a&&(a=!0);var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,t.framebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,t.texture,0),o&&(a?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture),h.copyTexSubImage2D(h.TEXTURE_2D,0,0,0,n,i,r,s),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null)},copyToGame:function(t){var e=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),e.drawArrays(e.TRIANGLES,0,6),this.renderer.resetTextures()},drawFrame:function(t,e,n,i){void 0===n&&(n=!0),void 0===i&&(i=this.colorMatrix);var r=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",i.getData()),this.set1f("uAlpha",i.alpha),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture,0)):r.viewport(0,0,t.width,t.height),n?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)},blendFrames:function(t,e,n,i,r,s){void 0===i&&(i=1),void 0===r&&(r=!0),void 0===s&&(s=this.linearShader);var o=this.gl;this.setShader(s),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",i),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.texture),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,e.texture),n?(o.bindFramebuffer(o.FRAMEBUFFER,n.framebuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,n.texture,0),o.viewport(0,0,n.width,n.height)):o.viewport(0,0,t.width,t.height),r?o.clearColor(0,0,0,0):o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT),o.bufferData(o.ARRAY_BUFFER,this.vertexData,o.STATIC_DRAW),o.drawArrays(o.TRIANGLES,0,6),o.bindFramebuffer(o.FRAMEBUFFER,null),o.bindTexture(o.TEXTURE_2D,null)},blendFramesAdditive:function(t,e,n,i,r){this.blendFrames(t,e,n,i,r,this.addShader)},clearFrame:function(t,e){void 0===e&&(e=!0);var n=this.gl;n.viewport(0,0,t.width,t.height),n.bindFramebuffer(n.FRAMEBUFFER,t.framebuffer),e?n.clearColor(0,0,0,0):n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT);var i=this.renderer.currentFramebuffer;n.bindFramebuffer(n.FRAMEBUFFER,i)},setUVs:function(t,e,n,i,r,s,o,a){var h=this.vertexViewF32;h[2]=t,h[3]=e,h[6]=n,h[7]=i,h[10]=r,h[11]=s,h[14]=t,h[15]=e,h[18]=r,h[19]=s,h[22]=o,h[23]=a},setTargetUVs:function(t,e){var n=e.height/t.height;n=n>.5?.5-(n-.5):.5-n+.5,this.setUVs(0,n,0,1+n,1,1+n,1,n)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});t.exports=d},function(t,e){t.exports=["#define SHADER_NAME PHASER_QUAD_VS","","precision mediump float;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","","varying vec2 outFragCoord;","varying vec2 outTexCoord;","","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","","    gl_Position = vec4(inPosition, 0, 1);","}",""].join("\n")},function(t,e,n){var i=n(31),r=n(38),s=n(2);t.exports=function(t,e){var n=t.getContext("experimental-webgl"),o=s(e,"callback"),a=s(e,"type","image/png"),h=s(e,"encoder",.92),u=s(e,"x",0),c=s(e,"y",0),l=s(e,"getPixel",!1),f=s(e,"isFramebuffer",!1),d=f?s(e,"bufferWidth",1):n.drawingBufferWidth,p=f?s(e,"bufferHeight",1):n.drawingBufferHeight;if(l){var v=new Uint8Array(4),g=f?c:p-c;n.readPixels(u,g,1,1,n.RGBA,n.UNSIGNED_BYTE,v),o.call(null,new r(v[0],v[1],v[2],v[3]/255))}else{var m=s(e,"width",d),y=s(e,"height",p),x=new Uint8Array(m*y*4);n.readPixels(u,p-c-y,m,y,n.RGBA,n.UNSIGNED_BYTE,x);for(var b=i.createWebGL(this,m,y),w=b.getContext("2d"),_=w.getImageData(0,0,m,y),T=_.data,E=0;E<y;E++)for(var S=0;S<m;S++){var C=4*((y-E-1)*m+S),A=4*(E*m+S);T[A+0]=x[C+0],T[A+1]=x[C+1],T[A+2]=x[C+2],T[A+3]=x[C+3]}w.putImageData(_,0,0);var I=new Image;I.onerror=function(){o.call(null),i.remove(b)},I.onload=function(){o.call(null,I),i.remove(b)},I.src=b.toDataURL(a,h)}}},function(t,e,n){var i=n(33);t.exports=function(t){var e=t.config;if(!e.hideBanner){var n="WebGL";e.renderType===i.CANVAS?n="Canvas":e.renderType===i.HEADLESS&&(n="Headless");var r,s=e.audio,o=t.device.audio;if(r=o.webAudio&&!s.disableWebAudio?"Web Audio":s.noAudio||!o.webAudio&&!o.audioData?"No Audio":"HTML5 Audio",t.device.browser.ie)window.console&&console.log("Phaser v"+i.VERSION+" / https://phaser.io");else{var a,h="",u=[h];Array.isArray(e.bannerBackgroundColor)?(e.bannerBackgroundColor.forEach((function(t){h=h.concat("%c "),u.push("background: "+t),a=t})),u[u.length-1]="color: "+e.bannerTextColor+"; background: "+a):(h=h.concat("%c "),u.push("color: "+e.bannerTextColor+"; background: "+e.bannerBackgroundColor)),u.push("background: transparent"),e.gameTitle&&(h=h.concat(e.gameTitle),e.gameVersion&&(h=h.concat(" v"+e.gameVersion)),e.hidePhaser||(h=h.concat(" / "))),e.hidePhaser||(h=h.concat("Phaser v"+i.VERSION+" ("+n+" | "+r+")")),h=h.concat(" %c "+e.gameURL),u[0]=h,console.log.apply(console,u)}}}},function(t,e,n){var i=n(0),r=n(6),s=n(1),o=n(386),a=new i({initialize:function(t,e){this.game=t,this.raf=new o,this.started=!1,this.running=!1,this.minFps=r(e,"min",5),this.targetFps=r(e,"target",60),this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=s,this.forceSetTimeOut=r(e,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=r(e,"deltaHistory",10),this.panicMax=r(e,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=r(e,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.startTime+=this.time-this._pauseTime},resetDelta:function(){var t=window.performance.now();this.time=t,this.lastTime=t,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=Math.min(this._target,this.deltaHistory[e]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(t){if(this.started)return this;this.started=!0,this.running=!0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=t,this.raf.start(this.step.bind(this),this.forceSetTimeOut,this._target)},step:function(){var t=window.performance.now();this.now=t;var e=t-this.lastTime;e<0&&(e=0),this.rawDelta=e;var n=this.deltaIndex,i=this.deltaHistory,r=this.deltaSmoothingMax,s=e,o=e;if(this.smoothStep){(this._coolDown>0||!this.inFocus)&&(this._coolDown--,s=Math.min(s,this._target)),s>this._min&&(s=i[n],s=Math.min(s,this._min)),i[n]=s,this.deltaIndex++,this.deltaIndex>r&&(this.deltaIndex=0),o=0;for(var a=0;a<r;a++)o+=i[a];o/=r}this.delta=o,this.time+=this.rawDelta,t>this.nextFpsUpdate&&(this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0),this.framesThisSecond++;var h=o/this._target;this.callback(t,o,h),this.lastTime=t,this.frame++},tick:function(){this.step()},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(t){this.running||(t&&(this.startTime+=-this.lastTime+(this.lastTime+window.performance.now())),this.raf.start(this.step.bind(this),this.useRAF),this.running=!0,this.step())},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.callback=s,this.raf=null,this.game=null}});t.exports=a},function(t,e,n){var i=n(0),r=n(1),s=new i({initialize:function(){this.isRunning=!1,this.callback=r,this.tick=0,this.isSetTimeOut=!1,this.timeOutID=null,this.lastTime=0,this.target=0;var t=this;this.step=function e(){var n=window.performance.now();t.lastTime=t.tick,t.tick=n,t.callback(n),t.timeOutID=window.requestAnimationFrame(e)},this.stepTimeout=function e(){var n=Date.now(),i=Math.min(Math.max(2*t.target+t.tick-n,0),t.target);t.lastTime=t.tick,t.tick=n,t.callback(n),t.timeOutID=window.setTimeout(e,i)}},start:function(t,e,n){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.target=n,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=r}});t.exports=s},function(t,e,n){var i=n(22);t.exports=function(t){var e,n=t.events;void 0!==document.hidden?e="visibilitychange":["webkit","moz","ms"].forEach((function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},e=t+"visibilitychange")})),e&&document.addEventListener(e,(function(t){document.hidden||"pause"===t.type?n.emit(i.HIDDEN):n.emit(i.VISIBLE)}),!1),window.onblur=function(){n.emit(i.BLUR)},window.onfocus=function(){n.emit(i.FOCUS)},window.focus&&t.config.autoFocus&&window.focus()}},function(t,e,n){var i=n(389),r=n(31),s=n(6);t.exports=function(t){var e=s(t,"data",[]),n=s(t,"canvas",null),o=s(t,"palette",i),a=s(t,"pixelWidth",1),h=s(t,"pixelHeight",a),u=s(t,"resizeCanvas",!0),c=s(t,"clearCanvas",!0),l=s(t,"preRender",null),f=s(t,"postRender",null),d=Math.floor(Math.abs(e[0].length*a)),p=Math.floor(Math.abs(e.length*h));n||(n=r.create2D(this,d,p),u=!1,c=!1),u&&(n.width=d,n.height=p);var v=n.getContext("2d");c&&v.clearRect(0,0,d,p),l&&l(n,v);for(var g=0;g<e.length;g++)for(var m=e[g],y=0;y<m.length;y++){var x=m[y];"."!==x&&" "!==x&&(v.fillStyle=o[x],v.fillRect(y*a,g*h,a,h))}return f&&f(n,v),n}},function(t,e){t.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}},function(t,e,n){var i=n(0),r=n(358),s=n(94),o=n(3),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,"CubicBezierCurve"),Array.isArray(t)&&(i=new o(t[6],t[7]),n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n,this.p3=i},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,s=this.p2,a=this.p3;return e.set(r(t,n.x,i.x,s.x,a.x),r(t,n.y,i.y,s.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]),s=new o(e[6],e[7]);return new a(n,i,r,s)},t.exports=a},function(t,e,n){var i=n(0),r=n(94),s=n(36),o=n(6),a=n(196),h=n(3),u=new i({Extends:r,initialize:function(t,e,n,i,a,u,c,l){if("object"==typeof t){var f=t;t=o(f,"x",0),e=o(f,"y",0),n=o(f,"xRadius",0),i=o(f,"yRadius",n),a=o(f,"startAngle",0),u=o(f,"endAngle",360),c=o(f,"clockwise",!1),l=o(f,"rotation",0)}else void 0===i&&(i=n),void 0===a&&(a=0),void 0===u&&(u=360),void 0===c&&(c=!1),void 0===l&&(l=0);r.call(this,"EllipseCurve"),this.p0=new h(t,e),this._xRadius=n,this._yRadius=i,this._startAngle=s(a),this._endAngle=s(u),this._clockwise=c,this._rotation=s(l)},getStartPoint:function(t){return void 0===t&&(t=new h),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new h);for(var n=2*Math.PI,i=this._endAngle-this._startAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),this._clockwise&&!r&&(i===n?i=-n:i-=n);var s=this._startAngle+t*i,o=this.p0.x+this._xRadius*Math.cos(s),a=this.p0.y+this._yRadius*Math.sin(s);if(0!==this._rotation){var u=Math.cos(this._rotation),c=Math.sin(this._rotation),l=o-this.p0.x,f=a-this.p0.y;o=l*u-f*c+this.p0.x,a=l*c+f*u+this.p0.y}return e.set(o,a)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return a(this._startAngle)},set:function(t){this._startAngle=s(t)}},endAngle:{get:function(){return a(this._endAngle)},set:function(t){this._endAngle=s(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return a(this._rotation)},set:function(t){this._rotation=s(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:a(this._startAngle),endAngle:a(this._endAngle),clockwise:this._clockwise,rotation:a(this._rotation)}}});u.fromJSON=function(t){return new u(t)},t.exports=u},function(t,e,n){var i=n(0),r=n(94),s=n(199),o=n(10),a=n(3),h=new i({Extends:r,initialize:function(t,e){r.call(this,"LineCurve"),Array.isArray(t)&&(e=new a(t[2],t[3]),t=new a(t[0],t[1])),this.p0=t,this.p1=e,this.arcLengthDivisions=1},getBounds:function(t){return void 0===t&&(t=new o),s([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new a),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new a),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(t,e){return void 0===e&&(e=new a),e.copy(this.p1).subtract(this.p0).normalize(),e},getUtoTmapping:function(t,e,n){var i;if(e){var r=this.getLengths(n),s=r[r.length-1];i=Math.min(e,s)/s}else i=t;return i},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});h.fromJSON=function(t){var e=t.points,n=new a(e[0],e[1]),i=new a(e[2],e[3]);return new h(n,i)},t.exports=h},function(t,e,n){var i=n(0),r=n(3),s=new i({initialize:function(t,e){this.active=!1,this.p0=new r(t,e)},getPoint:function(t,e){return void 0===e&&(e=new r),e.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});t.exports=s},function(t,e,n){var i=n(0),r=n(94),s=n(359),o=n(3),a=new i({Extends:r,initialize:function(t,e,n){r.call(this,"QuadraticBezier"),Array.isArray(t)&&(n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,r=this.p2;return e.set(s(t,n.x,i.x,r.x),s(t,n.y,i.y,r.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]);return new a(n,i,r)},t.exports=a},function(t,e,n){var i=n(194),r=n(0),s=n(94),o=n(3),a=new r({Extends:s,initialize:function(t){void 0===t&&(t=[]),s.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var n=new o;"number"==typeof t[e]?(n.x=t[e],n.y=t[e+1],e++):Array.isArray(t[e])?(n.x=t[e][0],n.y=t[e][1]):(n.x=t[e].x,n.y=t[e].y),this.points.push(n)}return this},addPoint:function(t,e){var n=new o(t,e);return this.points.push(n),n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.points,r=(n.length-1)*t,s=Math.floor(r),a=r-s,h=n[0===s?s:s-1],u=n[s],c=n[s>n.length-2?n.length-1:s+1],l=n[s>n.length-3?n.length-1:s+2];return e.set(i(a,h.x,u.x,c.x,l.x),i(a,h.y,u.y,c.y,l.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});a.fromJSON=function(t){return new a(t.points)},t.exports=a},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),n&&""!==n||(n=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===i&&(i=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=n,this.uniforms=i}});t.exports=i},function(t,e,n){var i=n(38);i.ColorSpectrum=n(908),i.ColorToRGBA=n(909),i.ComponentToHex=n(398),i.GetColor=n(103),i.GetColor32=n(328),i.HexStringToColor=n(327),i.HSLToColor=n(910),i.HSVColorWheel=n(911),i.HSVToRGB=n(188),i.HueToComponent=n(399),i.IntegerToColor=n(189),i.IntegerToRGB=n(330),i.Interpolate=n(912),i.ObjectToColor=n(331),i.RandomRGB=n(913),i.RGBStringToColor=n(332),i.RGBToHSV=n(329),i.RGBToString=n(914),i.ValueToColor=n(187),t.exports=i},function(t,e){t.exports=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},function(t,e){t.exports=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},function(t,e,n){var i=n(105);t.exports=function(t){if("complete"!==document.readyState&&"interactive"!==document.readyState){var e=function(){document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?i.cordova?document.addEventListener("deviceready",e,!1):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}else t()}},function(t,e){t.exports=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),n={w:0,h:0},i=document.createElement("div");return i.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(i),n.w=90===e?i.offsetHeight:window.innerWidth,n.h=90===e?window.innerWidth:i.offsetHeight,document.documentElement.removeChild(i),i=null,90!==Math.abs(window.orientation)?n.h:n.w}},function(t,e,n){var i=n(201);t.exports=function(t,e){var n=window.screen,r=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);return r&&"string"==typeof r.type?r.type:"string"==typeof r?r:"number"==typeof window.orientation?0===window.orientation||180===window.orientation?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?i.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?i.ORIENTATION.LANDSCAPE:void 0:e>t?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE}},function(t,e){t.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}},function(t,e){t.exports={LANDSCAPE:"landscape-primary",PORTRAIT:"portrait-primary"}},function(t,e){t.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5}},function(t,e){t.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}},function(t,e){t.exports=function(t){var e;return""!==t&&("string"==typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e}},function(t,e){t.exports=function(t){var e="";try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}},function(t,e,n){var i=n(0),r=n(203),s=n(9),o=n(51),a=n(22),h=n(410),u=n(411),c=n(412),l=n(413),f=n(25),d=n(177),p=new i({initialize:function(t,e){this.game=t,this.scaleManager,this.canvas,this.config=e,this.enabled=!0,this.events=new s,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new h(this):null,this.mouse=e.inputMouse?new u(this):null,this.touch=e.inputTouch?new l(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers,e.inputTouch&&1===this.pointersTotal&&(this.pointersTotal=2);for(var n=0;n<=this.pointersTotal;n++){var i=new c(this,n);i.smoothFactor=e.inputSmoothFactor,this.pointers.push(i)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new f,this._tempMatrix2=new f,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(a.BOOT,this.boot,this)},boot:function(){this.canvas=this.game.canvas,this.scaleManager=this.game.scale,this.events.emit(o.MANAGER_BOOT),this.game.events.on(a.PRE_RENDER,this.preRender,this),this.game.events.once(a.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(o.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(o.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,n=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(o.MANAGER_UPDATE);for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t){t.cursor&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var n=0;n<t;n++){var i=this.pointers.length,r=new c(this,i);r.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(r),this.pointersTotal++,e.push(r)}return e},updateInputPlugins:function(t,e){var n=this.game.scene.getScenes(!0,!0);this._tempSkip=!1;for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&(r.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip))return}},onTouchStart:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(!a.active){a.touchstart(s,t),this.activePointer=a,n.push(a);break}}this.updateInputPlugins(r.TOUCH_START,n)},onTouchMove:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchmove(s,t),this.activePointer=a,n.push(a);break}}this.updateInputPlugins(r.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchend(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_END,n)},onTouchCancel:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchcancel(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_CANCEL,n)},onMouseDown:function(t){var e=this.mousePointer;e.down(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var e=this.mousePointer;e.move(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var e=this.mousePointer;e.up(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var e=this.mousePointer;e.wheel(t),this.activePointer=e,this.updateInputPlugins(r.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(o.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var n=t.input;if(!n||!n.enabled||!n.alwaysEnabled&&!t.willRender(e))return!1;var i=!0,r=t.parentContainer;if(r)do{if(!r.willRender(e)){i=!1;break}r=r.parentContainer}while(r);return i},hitTest:function(t,e,n,i){void 0===i&&(i=this._tempHitTest);var r=this._tempPoint,s=n.scrollX,o=n.scrollY;i.length=0;var a=t.x,h=t.y;n.getWorldPoint(a,h,r),t.worldX=r.x,t.worldY=r.y;for(var u={x:0,y:0},c=this._tempMatrix,l=this._tempMatrix2,f=0;f<e.length;f++){var p=e[f];if(this.inputCandidate(p,n)){var v=r.x+s*p.scrollFactorX-s,g=r.y+o*p.scrollFactorY-o;p.parentContainer?(p.getWorldTransformMatrix(c,l),c.applyInverse(v,g,u)):d(v,g,p.x,p.y,p.rotation,p.scaleX,p.scaleY,u),this.pointWithinHitArea(p,u.x,u.y)&&i.push(p)}}return i},pointWithinHitArea:function(t,e,n){e+=t.displayOriginX,n+=t.displayOriginY;var i=t.input;return!(!i||!i.hitAreaCallback(i.hitArea,e,n,t)||(i.localX=e,i.localY=n,0))},pointWithinInteractiveObject:function(t,e,n){return!!t.hitArea&&(e+=t.gameObject.displayOriginX,n+=t.gameObject.displayOriginY,t.localX=e,t.localY=n,t.hitAreaCallback(t.hitArea,e,n,t))},transformPointer:function(t,e,n,i){var r=t.position,s=t.prevPosition;s.x=r.x,s.y=r.y;var o=this.scaleManager.transformX(e),a=this.scaleManager.transformY(n),h=t.smoothFactor;i&&0!==h?(r.x=o*h+s.x*(1-h),r.y=a*h+s.y*(1-h)):(r.x=o,r.y=a)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(a.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});t.exports=p},function(t,e,n){var i=n(93),r=n(0),s=n(22),o=n(51),a=n(144),h=n(1),u=new r({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=h,this.onKeyUp=h,t.events.once(o.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(s.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(o.MANAGER_PROCESS);var n=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!n&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}},this.onKeyUp=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(o.MANAGER_PROCESS);var n=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!n&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var i=t[n];"string"==typeof i&&(i=a[i.trim().toUpperCase()]),-1===e.indexOf(i)&&e.push(i)}this.preventDefault=e.length>0},removeCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var r=t[n];"string"==typeof r&&(r=a[r.toUpperCase()]),i(e,r)}this.preventDefault=e.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(s.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});t.exports=u},function(t,e,n){var i=n(0),r=n(191),s=n(51),o=n(1),a=new i({initialize:function(t){this.manager=t,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=o,this.onMouseDown=o,this.onMouseUp=o,this.onMouseDownWindow=o,this.onMouseUpWindow=o,this.onMouseOver=o,this.onMouseOut=o,this.onMouseWheel=o,this.pointerLockChange=o,this.isTop=!0,t.events.once(s.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1})),this},requestPointerLock:function(){if(r.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){r.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var e=this,n=this.manager,i=n.canvas,s=window&&window.focus&&n.game.config.autoFocus;this.onMouseMove=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseMove(t),e.preventDefaultMove&&t.preventDefault())},this.onMouseDown=function(t){s&&window.focus(),!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseDown(t),e.preventDefaultDown&&t.target===i&&t.preventDefault())},this.onMouseDownWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onMouseDown(t)},this.onMouseUp=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseUp(t),e.preventDefaultUp&&t.target===i&&t.preventDefault())},this.onMouseUpWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onMouseUp(t)},this.onMouseOver=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.setCanvasOver(t)},this.onMouseOut=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.setCanvasOut(t)},this.onMouseWheel=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.onMouseWheel(t),e.preventDefaultWheel&&t.target===i&&t.preventDefault()};var o={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,o),t.addEventListener("mouseout",this.onMouseOut,o),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,o),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,o),window.top.addEventListener("mouseup",this.onMouseUpWindow,o)}catch(t){window.addEventListener("mousedown",this.onMouseDownWindow,o),window.addEventListener("mouseup",this.onMouseUpWindow,o),this.isTop=!1}r.pointerLock&&(this.pointerLockChange=function(t){var i=e.target;e.locked=document.pointerLockElement===i||document.mozPointerLockElement===i||document.webkitPointerLockElement===i,n.onPointerLockChange(t)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&((t=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),r.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=a},function(t,e,n){var i=n(349),r=n(0),s=n(50),o=n(125),a=n(360),h=n(3),u=n(105),c=new r({initialize:function(t,e){this.manager=t,this.id=e,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new h,this.prevPosition=new h,this.midPoint=new h(-1,-1),this.velocity=new h,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var t=this.position.x,e=this.position.y,n=this.midPoint.x,r=this.midPoint.y;if(t!==n||e!==r){var s=a(this.motionFactor,n,t),h=a(this.motionFactor,r,e);o(s,t,.1)&&(s=t),o(h,e,.1)&&(h=e),this.midPoint.set(s,h);var u=t-s,c=e-h;this.velocity.set(u,c),this.angle=i(s,h,t,e),this.distance=Math.sqrt(u*u+c*c)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),u.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.button&&!this.isDown},rightButtonReleased:function(){return 2===this.button&&!this.isDown},middleButtonReleased:function(){return 1===this.button&&!this.isDown},backButtonReleased:function(){return 3===this.button&&!this.isDown},forwardButtonReleased:function(){return 4===this.button&&!this.isDown},getDistance:function(){return this.isDown?s(this.downX,this.downY,this.x,this.y):s(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var n=this.prevPosition.x,i=this.prevPosition.y,r=this.position.x,s=this.position.y,o=0;o<t;o++){var h=1/t*o;e[o]={x:a(h,n,r),y:a(h,i,s)}}return e},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});t.exports=c},function(t,e,n){var i=n(0),r=n(51),s=n(1),o=new i({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=s,this.onTouchStartWindow=s,this.onTouchMove=s,this.onTouchEnd=s,this.onTouchEndWindow=s,this.onTouchCancel=s,this.onTouchCancelWindow=s,this.onTouchOver=s,this.onTouchOut=s,t.events.once(r.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target||(this.target=this.manager.game.canvas),t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1})),this},startListeners:function(){var t=this,e=this.manager.canvas,n=window&&window.focus&&this.manager.game.config.autoFocus;this.onTouchStart=function(i){n&&window.focus(),!i.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchStart(i),t.capture&&i.cancelable&&i.target===e&&i.preventDefault())},this.onTouchStartWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onTouchStart(n)},this.onTouchMove=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchMove(e),t.capture&&e.cancelable&&e.preventDefault())},this.onTouchEnd=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchEnd(n),t.capture&&n.cancelable&&n.target===e&&n.preventDefault())},this.onTouchEndWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onTouchEnd(n)},this.onTouchCancel=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchCancel(e),t.capture&&e.preventDefault())},this.onTouchCancelWindow=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.onTouchCancel(e)},this.onTouchOver=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOver(e)},this.onTouchOut=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOut(e)};var i=this.target;if(i){var r={passive:!0},s={passive:!1};i.addEventListener("touchstart",this.onTouchStart,this.capture?s:r),i.addEventListener("touchmove",this.onTouchMove,this.capture?s:r),i.addEventListener("touchend",this.onTouchEnd,this.capture?s:r),i.addEventListener("touchcancel",this.onTouchCancel,this.capture?s:r),i.addEventListener("touchover",this.onTouchOver,this.capture?s:r),i.addEventListener("touchout",this.onTouchOut,this.capture?s:r),window&&this.manager.game.config.inputWindowEvents&&(window.addEventListener("touchstart",this.onTouchStartWindow,s),window.addEventListener("touchend",this.onTouchEndWindow,s),window.addEventListener("touchcancel",this.onTouchCancelWindow,s)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),t.removeEventListener("touchover",this.onTouchOver),t.removeEventListener("touchout",this.onTouchOut),window&&(window.removeEventListener("touchstart",this.onTouchStartWindow),window.removeEventListener("touchend",this.onTouchEndWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(22),s=n(9),o=n(8),a=n(16),h=n(5),u=n(2),c=n(24),l=n(93),f=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted?this.boot():t.events.once(r.BOOT,this.boot,this)},boot:function(){var t,e,n,i,s,o,a,h=this.game.config,c=h.installGlobalPlugins;for(c=c.concat(this._pendingGlobal),t=0;t<c.length;t++)e=c[t],n=u(e,"key",null),i=u(e,"plugin",null),s=u(e,"start",!1),o=u(e,"mapping",null),a=u(e,"data",null),n&&(i?this.install(n,i,s,o,a):console.warn("Missing `plugin` for key: "+n));for(c=(c=h.installScenePlugins).concat(this._pendingScene),t=0;t<c.length;t++)e=c[t],n=u(e,"key",null),i=u(e,"plugin",null),o=u(e,"mapping",null),n&&(i?this.installScenePlugin(n,i,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(r.DESTROY,this.destroy,this)},addToScene:function(t,e,n){var i,r,s,o=this.game,a=t.scene,h=t.settings.map,u=t.settings.isBooted;for(i=0;i<e.length;i++)o[r=e[i]]?(t[r]=o[r],h.hasOwnProperty(r)&&(a[h[r]]=t[r])):"game"===r&&h.hasOwnProperty(r)&&(a[h[r]]=o);for(var l=0;l<n.length;l++)for(s=n[l],i=0;i<s.length;i++)if(r=s[i],c.hasCore(r)){var f=c.getCore(r),d=new f.plugin(a,this);t[f.mapping]=d,f.custom?a[f.mapping]=d:h.hasOwnProperty(f.mapping)&&(a[h[f.mapping]]=d),u&&d.boot()}for(s=this.plugins,i=0;i<s.length;i++){var p=s[i];p.mapping&&(a[p.mapping]=p.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t.concat(this.scenePlugins)},installScenePlugin:function(t,e,n,i,r){if(void 0===r&&(r=!1),"function"==typeof e){if(c.hasCore(t)){if(!r&&c.hasCore(t))return void console.warn("Scene Plugin key in use: "+t)}else c.register(t,e,n,!0),this.scenePlugins.push(t);if(i){var s=new e(i,this);i.sys[t]=s,n&&""!==n&&(i[n]=s),s.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,n,i,r){if(void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=null),"function"!=typeof e)return console.warn("Invalid Plugin: "+t),null;if(c.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==i&&(n=!0),this.game.isBooted){if(c.registerCustom(t,e,i,r),n)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:n,mapping:i,data:r});return null},getIndex:function(t){for(var e=this.plugins,n=0;n<e.length;n++)if(e[n].key===t)return n;return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var n=this.getEntry(e);return n&&!n.active?(n.active=!0,n.plugin.start()):n||(n=this.createEntry(t,e)),n?n.plugin:null},createEntry:function(t,e){var n=c.getCustom(t);if(n){var i=new n.plugin(this);n={key:e,plugin:i,active:!0,mapping:n.mapping,data:n.data},this.plugins.push(n),i.init(n.data),i.start()}return n},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var n=this.getEntry(t);if(n)return n.plugin;var i=this.getClass(t);return i&&e?(n=this.createEntry(t,t))?n.plugin:null:i||null},getClass:function(t){return c.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&l(this.plugins,e),c.removeCustom(t)},removeScenePlugin:function(t){l(this.scenePlugins,t),c.remove(t)},registerGameObject:function(t,e,n){return e&&h.register(t,e),n&&a.register(t,n),this},removeGameObject:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),e&&h.remove(t),n&&a.remove(t),this},registerFileType:function(t,e,n){o.register(t,e),n&&n.sys.load&&(n.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();c.destroyCustomPlugins(),this.game.noReturn&&c.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});t.exports=f},function(t,e,n){var i=n(201),r=n(0),s=n(9),o=n(104),a=n(22),h=n(401),u=n(407),c=n(402),l=n(1),f=n(10),d=n(416),p=n(77),v=n(3),g=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.canvas,this.canvasBounds=new f,this.parent=null,this.parentIsWindow=!1,this.parentSize=new d,this.gameSize=new d,this.baseSize=new d,this.displaySize=new d,this.scaleMode=i.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new v(1,1),this.autoRound=!1,this.autoCenter=i.CENTER.NO_CENTER,this.orientation=i.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.listeners={orientationChange:l,windowResize:l,fullScreenChange:l,fullScreenError:l}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(a.BOOT,this.boot,this)},boot:function(){var t=this.game;this.canvas=t.canvas,this.fullscreen=t.device.fullscreen,this.scaleMode!==i.SCALE_MODE.RESIZE&&this.displaySize.setAspectMode(this.scaleMode),this.scaleMode===i.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),t.events.on(a.PRE_STEP,this.step,this),t.events.once(a.READY,this.refresh,this),t.events.once(a.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(t){this.getParent(t),this.getParentBounds();var e=t.width,n=t.height,r=t.scaleMode,s=t.zoom,o=t.autoRound;if("string"==typeof e){var a=this.parentSize.width;0===a&&(a=window.innerWidth);var h=parseInt(e,10)/100;e=Math.floor(a*h)}if("string"==typeof n){var u=this.parentSize.height;0===u&&(u=window.innerHeight);var l=parseInt(n,10)/100;n=Math.floor(u*l)}this.scaleMode=r,this.autoRound=o,this.autoCenter=t.autoCenter,this.resizeInterval=t.resizeInterval,o&&(e=Math.floor(e),n=Math.floor(n)),this.gameSize.setSize(e,n),s===i.ZOOM.MAX_ZOOM&&(s=this.getMaxZoom()),this.zoom=s,1!==s&&(this._resetZoom=!0),this.baseSize.setSize(e,n),o&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),t.minWidth>0&&this.displaySize.setMin(t.minWidth*s,t.minHeight*s),t.maxWidth>0&&this.displaySize.setMax(t.maxWidth*s,t.maxHeight*s),this.displaySize.setSize(e,n),this.orientation=c(e,n)},getParent:function(t){var e=t.parent;if(null!==e){if(this.parent=u(e),this.parentIsWindow=this.parent===document.body,t.expandParent&&t.scaleMode!==i.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}t.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=u(t.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=h(!0));var n=e.width,i=e.height;return(t.width!==n||t.height!==i)&&(t.setSize(n,i),!0)},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e.call(screen,t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var n=this.autoRound;n&&(t=Math.floor(t),e=Math.floor(e));var i=this.width,r=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(i,r)},resize:function(t,e){var n=this.zoom,i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var r=this.width,s=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*n,e*n),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var o=this.canvas.style,a=t*n,h=e*n;return i&&(a=Math.floor(a),h=Math.floor(h)),a===t&&h===e||(o.width=a+"px",o.height=h+"px"),this.refresh(r,s)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var n=this.game.domContainer;if(n){this.baseSize.setCSS(n);var i=this.canvas.style,r=n.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=i.marginLeft,r.marginTop=i.marginTop}return this.emit(o.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=c(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(o.ORIENTATION_CHANGE,t))}},updateScale:function(){var t,e,n=this.canvas.style,r=this.gameSize.width,s=this.gameSize.height,o=this.zoom,a=this.autoRound;this.scaleMode===i.SCALE_MODE.NONE?(this.displaySize.setSize(r*o,s*o),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),this._resetZoom&&(n.width=t+"px",n.height=e+"px",this._resetZoom=!1)):this.scaleMode===i.SCALE_MODE.RESIZE?(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),this.canvas.width=t,this.canvas.height=e):(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),n.width=t+"px",n.height=e+"px"),this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=p(this.parentSize.width,this.gameSize.width,0,!0),e=p(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var t=this.autoCenter;if(t!==i.CENTER.NO_CENTER){var e=this.canvas,n=e.style,r=e.getBoundingClientRect(),s=r.width,o=r.height,a=Math.floor((this.parentSize.width-s)/2),h=Math.floor((this.parentSize.height-o)/2);t===i.CENTER.CENTER_HORIZONTALLY?h=0:t===i.CENTER.CENTER_VERTICALLY&&(a=0),n.marginLeft=a+"px",n.marginTop=h+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var n=this.getFullscreenTarget();e.keyboard?n[e.request](Element.ALLOW_KEYBOARD_INPUT):n[e.request](t)}}else this.emit(o.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(o.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(o.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}return this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(o.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget(),this.getParentBounds(),this.emit(o.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.listeners;e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0},e.windowResize=function(){t.updateBounds(),t.dirty=!0},window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available&&(e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)},["webkit","moz",""].forEach((function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)})),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1))},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():this.stopFullscreen()},onFullScreenError:function(){this.removeFullscreenTarget()},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.listeners;window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1),["webkit","moz",""].forEach((function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)})),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===i.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===i.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});t.exports=g},function(t,e,n){var i=n(18),r=n(0),s=n(77),o=n(3),a=new r({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=null),this._width=t,this._height=e,this._parent=i,this.aspectMode=n,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new o},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.minWidth=i(t,0,this.maxWidth),this.minHeight=i(e,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(t,e){return void 0===t&&(t=Number.MAX_VALUE),void 0===e&&(e=t),this.maxWidth=i(t,this.minWidth,Number.MAX_VALUE),this.maxHeight=i(e,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case a.NONE:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case a.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case a.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(s(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case a.FIT:this.constrain(t,e,!0);break;case a.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minWidth,this.maxWidth),e&&this._parent&&t>this._parent.width&&(t=Math.max(this.minWidth,this._parent.width)),t},getNewHeight:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minHeight,this.maxHeight),e&&this._parent&&t>this._parent.height&&(t=Math.max(this.minHeight,this._parent.height)),t},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var i=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=s(t,i.x))/this.aspectRatio,i.y>0&&(t=(e=s(e,i.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=s(e,i.y))*this.aspectRatio,i.x>0&&(e=(t=s(t,i.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});a.NONE=0,a.WIDTH_CONTROLS_HEIGHT=1,a.HEIGHT_CONTROLS_WIDTH=2,a.FIT=3,a.ENVELOP=4,t.exports=a},function(t,e,n){var i=n(0),r=n(145),s=n(20),o=n(22),a=n(6),h=n(95),u=n(1),c=n(418),l=n(204),f=new i({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)this._pending.push({key:"default",scene:e[n],autoStart:0===n,data:{}})}t.events.once(o.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,n,i;for(t=0;t<this._pending.length;t++){var r;n=(e=this._pending[t]).key,(i=e.scene)instanceof c?r=this.createSceneFromInstance(n,i):"object"==typeof i?r=this.createSceneFromObject(n,i):"function"==typeof i&&(r=this.createSceneFromFunction(n,i)),n=r.sys.settings.key,this.keys[n]=r,this.scenes.push(r),this._data[n]&&(r.sys.settings.data=this._data[n].data,this._data[n].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(n)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(0!==t||0!==e){var n,i;if(t){for(n=0;n<t;n++)i=this._pending[n],this.add(i.key,i.scene,i.autoStart,i.data);for(n=0;n<this._start.length;n++)i=this._start[n],this.start(i);return this._start.length=0,void(this._pending.length=0)}for(n=0;n<this._queue.length;n++)this[(i=this._queue[n]).op](i.keyA,i.keyB);this._queue.length=0}},add:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:n,data:i}),this.isBooted||(this._data[t]={data:i}),null):(t=this.getKey(t,e),e instanceof c?r=this.createSceneFromInstance(t,e):"object"==typeof e?(e.key=t,r=this.createSceneFromObject(t,e)):"function"==typeof e&&(r=this.createSceneFromFunction(t,e)),r.sys.settings.data=i,t=r.sys.settings.key,this.keys[t]=r,this.scenes.push(r),(n||r.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),r);var r},remove:function(t){if(this.isProcessing)this._queue.push({op:"remove",keyA:t,keyB:null});else{var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var n=this.scenes.indexOf(e),i=e.sys.settings.key;n>-1&&(delete this.keys[i],this.scenes.splice(n,1),this._start.indexOf(i)>-1&&(n=this._start.indexOf(i),this._start.splice(n,1)),e.sys.destroy())}return this},bootScene:function(t){var e,n=t.sys,i=n.settings;n.sceneUpdate=u,t.init&&(t.init.call(t,i.data),i.status=r.INIT,i.isTransition&&n.events.emit(s.TRANSITION_INIT,i.transitionFrom,i.transitionDuration)),n.load&&(e=n.load).reset(),e&&t.preload?(t.preload.call(t),0===e.list.size?this.create(t):(i.status=r.LOADING,e.once(h.COMPLETE,this.loadComplete,this),e.start())):this.create(t)},loadComplete:function(t){this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,e){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var i=this.scenes[n].sys;i.settings.status>r.START&&i.settings.status<=r.RUNNING&&i.step(t,e)}},render:function(t){for(var e=0;e<this.scenes.length;e++){var n=this.scenes[e].sys;n.settings.visible&&n.settings.status>=r.LOADING&&n.settings.status<r.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var e=t.sys,n=e.settings;t.create&&(n.status=r.CREATING,t.create.call(t,n.data),n.status===r.DESTROYED)||(n.isTransition&&e.events.emit(s.TRANSITION_START,n.transitionFrom,n.transitionDuration),t.update&&(e.sceneUpdate=t.update),n.status=r.RUNNING,e.events.emit(s.CREATE,t))},createSceneFromFunction:function(t,e){var n=new e;if(n instanceof c){var i=n.sys.settings.key;if(""!==i&&(t=i),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return this.createSceneFromInstance(t,n)}return n.sys=new l(n),n.sys.settings.key=t,n.sys.init(this.game),n},createSceneFromInstance:function(t,e){return""===e.sys.settings.key&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var n=new c(e),i=n.sys.settings.key;""!==i?t=i:n.sys.settings.key=t,n.sys.init(this.game);for(var r=["init","preload","create","update","render"],s=0;s<r.length;s++){var o=a(e,r[s],null);o&&(n[r[s]]=o)}if(e.hasOwnProperty("extend"))for(var h in e.extend)if(e.extend.hasOwnProperty(h)){var u=e.extend[h];"data"===h&&n.hasOwnProperty("data")&&"object"==typeof u?n.data.merge(u):"sys"!==h&&(n[h]=u)}return n},getKey:function(t,e){if(t||(t="default"),"function"==typeof e)return t;if(e instanceof c?t=e.sys.settings.key:"object"==typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var n=[],i=this.scenes,r=0;r<i.length;r++){var s=i[r];s&&(!t||t&&s.sys.isActive())&&n.push(s)}return e?n.reverse():n},getScene:function(t){if("string"==typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var n=this.getScene(t);return n&&n.sys.pause(e),this},resume:function(t,e){var n=this.getScene(t);return n&&n.sys.resume(e),this},sleep:function(t,e){var n=this.getScene(t);return n&&!n.sys.isTransitioning()&&n.sys.sleep(e),this},wake:function(t,e){var n=this.getScene(t);return n&&n.sys.wake(e),this},run:function(t,e){var n=this.getScene(t);if(!n){for(var i=0;i<this._pending.length;i++)if(this._pending[i].key===t){this.queueOp("start",t,e);break}return this}n.sys.isSleeping()?n.sys.wake(e):n.sys.isPaused()?n.sys.resume(e):this.start(t,e)},start:function(t,e){if(!this.isBooted)return this._data[t]={autoStart:!0,data:e},this;var n=this.getScene(t);if(n){var i,s=n.sys;if(s.isActive()||s.isPaused())s.shutdown(),s.sceneUpdate=u,s.start(e);else if(s.sceneUpdate=u,s.start(e),s.load&&(i=s.load),i&&s.settings.hasOwnProperty("pack")&&(i.reset(),i.addPack({payload:s.settings.pack})))return s.settings.status=r.LOADING,i.once(h.COMPLETE,this.payloadComplete,this),i.start(),this;this.bootScene(n)}return this},stop:function(t,e){var n=this.getScene(t);return n&&!n.sys.isTransitioning()&&n.sys.shutdown(e),this},switch:function(t,e){var n=this.getScene(t),i=this.getScene(e);return n&&i&&n!==i&&(this.sleep(t),this.isSleeping(e)?this.wake(e):this.start(e)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)this._queue.push({op:"bringToTop",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e<this.scenes.length){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.push(n)}}return this},sendToBack:function(t){if(this.isProcessing)this._queue.push({op:"sendToBack",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e>0){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(n)}}return this},moveDown:function(t){if(this.isProcessing)this._queue.push({op:"moveDown",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e>0){var n=e-1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveUp:function(t){if(this.isProcessing)this._queue.push({op:"moveUp",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e<this.scenes.length-1){var n=e+1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveAbove",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i){var r=this.getAt(i);this.scenes.splice(i,1),this.scenes.splice(n+1,0,r)}}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveBelow",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i){var r=this.getAt(i);this.scenes.splice(i,1),0===n?this.scenes.unshift(r):this.scenes.splice(n,0,r)}}return this},queueOp:function(t,e,n){return this._queue.push({op:t,keyA:e,keyB:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"swapPosition",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(n!==i&&-1!==n&&-1!==i){var r=this.getAt(n);this.scenes[n]=this.scenes[i],this.scenes[i]=r}}return this},dump:function(){for(var t=[],e=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var i=this.scenes[n].sys,s=!i.settings.visible||i.settings.status!==r.RUNNING&&i.settings.status!==r.PAUSED?"[-] ":"[*] ";s+=i.settings.key+" ("+e[i.settings.status]+")",t.push(s)}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++)this.scenes[t].sys.destroy();this.update=u,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null}});t.exports=f},function(t,e,n){var i=n(0),r=n(204),s=new i({initialize:function(t){this.sys=new r(this,t),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}});t.exports=s},function(t,e,n){var i=n(2),r=n(205);t.exports=function(t){var e=t.game.config.defaultPhysicsSystem,n=i(t.settings,"physics",!1);if(e||n){var s=[];if(e&&s.push(r(e+"Physics")),n)for(var o in n)o=r(o.concat("Physics")),-1===s.indexOf(o)&&s.push(o);return s}}},function(t,e,n){var i=n(2);t.exports=function(t){var e=t.plugins.getDefaultScenePlugins(),n=i(t.settings,"plugins",!1);return Array.isArray(n)?n:e||[]}},function(t,e,n){var i=n(145),r=n(6),s=n(128),o=n(977),a={create:function(t){return"string"==typeof t?t={key:t}:void 0===t&&(t={}),{status:i.PENDING,key:r(t,"key",""),active:r(t,"active",!1),visible:r(t,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:r(t,"pack",!1),cameras:r(t,"cameras",null),map:r(t,"map",s(o,r(t,"mapAdd",{}))),physics:r(t,"physics",{}),loader:r(t,"loader",{}),plugins:r(t,"plugins",!1),input:r(t,"input",{})}}};t.exports=a},function(t,e,n){var i=n(31),r=n(423),s=n(0),o=n(38),a=n(33),h=n(9),u=n(106),c=n(22),l=n(388),f=n(6),d=n(425),p=n(206),v=new s({Extends:h,initialize:function(t){h.call(this),this.game=t,this.name="TextureManager",this.list={},this._tempCanvas=i.create2D(this,1,1),this._tempContext=this._tempCanvas.getContext("2d"),this._pending=0,t.events.once(c.BOOT,this.boot,this)},boot:function(){this.on(u.LOAD,this.updatePending,this),this.on(u.ERROR,this.updatePending,this);var t=this.game.config;this.addBase64("__DEFAULT",t.defaultImage),this.addBase64("__MISSING",t.missingImage),this.addBase64("__WHITE",t.whiteImage),this._pending=3,this.game.events.once(c.DESTROY,this.destroy,this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(u.LOAD),this.off(u.ERROR),this.emit(u.READY))},checkKey:function(t){return!this.exists(t)||(console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"==typeof t){if(!this.exists(t))return console.warn("No texture found matching key: "+t),this;t=this.get(t)}return this.list.hasOwnProperty(t.key)&&(t.destroy(),this.emit(u.REMOVE,t.key)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var n=this,i=new Image;i.onerror=function(){n.emit(u.ERROR,t)},i.onload=function(){var e=n.create(t,i);d.Image(e,0),n.emit(u.ADD,t,e),n.emit(u.LOAD,t,e)},i.src=e}return this},getBase64:function(t,e,n,r){void 0===n&&(n="image/png"),void 0===r&&(r=.92);var s="",o=this.getFrame(t,e);if(o&&(o.source.isRenderTexture||o.source.isGLTexture))console.warn("Cannot getBase64 from WebGL Texture");else if(o){var a=o.canvasData,h=i.create2D(this,a.width,a.height);h.getContext("2d").drawImage(o.source.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),s=h.toDataURL(n,r),i.remove(h)}return s},addImage:function(t,e,n){var i=null;return this.checkKey(t)&&(i=this.create(t,e),d.Image(i,0),n&&i.setDataSource(n),this.emit(u.ADD,t,i)),i},addGLTexture:function(t,e,n,i){var r=null;return this.checkKey(t)&&(void 0===n&&(n=e.width),void 0===i&&(i=e.height),(r=this.create(t,e,n,i)).add("__BASE",0,0,0,n,i),this.emit(u.ADD,t,r)),r},addRenderTexture:function(t,e){var n=null;return this.checkKey(t)&&((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(u.ADD,t,n)),n},generate:function(t,e){if(this.checkKey(t)){var n=i.create(this,1,1);return e.canvas=n,l(e),this.addCanvas(t,n)}return null},createCanvas:function(t,e,n){if(void 0===e&&(e=256),void 0===n&&(n=256),this.checkKey(t)){var r=i.create(this,e,n,a.CANVAS,!0);return this.addCanvas(t,r)}return null},addCanvas:function(t,e,n){void 0===n&&(n=!1);var i=null;return n?i=new r(this,t,e,e.width,e.height):this.checkKey(t)&&(i=new r(this,t,e,e.width,e.height),this.list[t]=i,this.emit(u.ADD,t,i)),i},addAtlas:function(t,e,n,i){return Array.isArray(n.textures)||Array.isArray(n.frames)?this.addAtlasJSONArray(t,e,n,i):this.addAtlasJSONHash(t,e,n,i)},addAtlasJSONArray:function(t,e,n,i){var r=null;if(this.checkKey(t)){if(r=this.create(t,e),Array.isArray(n))for(var s=1===n.length,o=0;o<r.source.length;o++){var a=s?n[0]:n[o];d.JSONArray(r,o,a)}else d.JSONArray(r,0,n);i&&r.setDataSource(i),this.emit(u.ADD,t,r)}return r},addAtlasJSONHash:function(t,e,n,i){var r=null;if(this.checkKey(t)){if(r=this.create(t,e),Array.isArray(n))for(var s=0;s<n.length;s++)d.JSONHash(r,s,n[s]);else d.JSONHash(r,0,n);i&&r.setDataSource(i),this.emit(u.ADD,t,r)}return r},addAtlasXML:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=this.create(t,e),d.AtlasXML(r,0,n),i&&r.setDataSource(i),this.emit(u.ADD,t,r)),r},addUnityAtlas:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=this.create(t,e),d.UnityYAML(r,0,n),i&&r.setDataSource(i),this.emit(u.ADD,t,r)),r},addSpriteSheet:function(t,e,n){var i=null;if(this.checkKey(t)){var r=(i=this.create(t,e)).source[0].width,s=i.source[0].height;d.SpriteSheet(i,0,0,0,r,s,n),this.emit(u.ADD,t,i)}return i},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var n=f(e,"atlas",null),i=f(e,"frame",null);if(n&&i){var r=this.get(n).get(i);if(r){var s=this.create(t,r.source.image);return r.trimmed?d.SpriteSheetFromAtlas(s,r,e):d.SpriteSheet(s,0,r.cutX,r.cutY,r.cutWidth,r.cutHeight,e),this.emit(u.ADD,t,s),s}}},create:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=new p(this,t,e,n,i),this.list[t]=r),r},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof p?t:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&t.push(e);return t},getPixel:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(t+=s.x,e+=s.y,t>=s.x&&t<s.r&&e>=s.y&&e<s.b){var a=this._tempContext;a.clearRect(0,0,1,1),a.drawImage(r.source.image,t,e,1,1,0,0,1,1);var h=a.getImageData(0,0,1,1);return new o(h.data[0],h.data[1],h.data[2],h.data[3])}}return null},getPixelAlpha:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(t+=s.x,e+=s.y,t>=s.x&&t<s.r&&e>=s.y&&e<s.b){var o=this._tempContext;return o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,n){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(n)),t},renameTexture:function(t,e){var n=this.get(t);return!(!n||t===e||(n.key=e,this.list[e]=n,delete this.list[t],0))},each:function(t,e){for(var n=[null],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[0]=this.list[r],t.apply(e,n)},destroy:function(){for(var t in this.list)this.list[t].destroy();this.list={},this.game=null,i.remove(this._tempCanvas)}});t.exports=v},function(t,e,n){var i=n(0),r=n(18),s=n(38),o=n(33),a=n(139),h=n(206),u=new i({Extends:h,initialize:function(t,e,n,i,r){h.call(this,t,e,n,i,r),this.add("__BASE",0,0,0,i,r),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d"),this.width=i,this.height=r,this.imageData=this.context.getImageData(0,0,i,r),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===o.WEBGL&&this.refresh(),this},draw:function(t,e,n){return this.context.drawImage(n,t,e),this.update()},drawFrame:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=this.manager.getFrame(t,e);if(r){var s=r.canvasData,o=r.cutWidth,a=r.cutHeight,h=r.source.resolution;return this.context.drawImage(r.source.image,s.x,s.y,o,a,n,i,o/h,a/h),this.update()}return this},setPixel:function(t,e,n,i,r,s){if(void 0===s&&(s=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var o=this.context.getImageData(t,e,1,1);o.data[0]=n,o.data[1]=i,o.data[2]=r,o.data[3]=s,this.context.putImageData(o,t,e)}return this},putData:function(t,e,n,i,r,s,o){return void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=t.width),void 0===o&&(o=t.height),this.context.putImageData(t,e,n,i,r,s,o),this},getData:function(t,e,n,i){return t=r(Math.floor(t),0,this.width-1),e=r(Math.floor(e),0,this.height-1),n=r(n,1,this.width-t),i=r(i,1,this.height-e),this.context.getImageData(t,e,n,i)},getPixel:function(t,e,n){n||(n=new s);var i=this.getIndex(t,e);if(i>-1){var r=this.data,o=r[i+0],a=r[i+1],h=r[i+2],u=r[i+3];n.setTo(o,a,h,u)}return n},getPixels:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=n),t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e));for(var o=r(t,0,this.width),a=r(t+n,0,this.width),h=r(e,0,this.height),u=r(e+i,0,this.height),c=new s,l=[],f=h;f<u;f++){for(var d=[],p=o;p<a;p++)c=this.getPixel(p,f,c),d.push({x:p,y:f,color:c.color,alpha:c.alphaGL});l.push(d)}return l},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),this.context.clearRect(t,e,n,i),this.update()},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=a(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){h.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});t.exports=u},function(t,e,n){var i=n(31),r=n(0),s=n(139),o=n(168),a=new r({initialize:function(t,e,n,i,r){void 0===r&&(r=!1);var a=t.manager.game;this.renderer=a.renderer,this.texture=t,this.source=e,this.image=e,this.compressionAlgorithm=null,this.resolution=1,this.width=n||e.naturalWidth||e.videoWidth||e.width||0,this.height=i||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=o.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type,this.isGLTexture=window.hasOwnProperty("WebGLTexture")&&e instanceof WebGLTexture,this.isPowerOf2=s(this.width,this.height),this.glTexture=null,this.glIndex=0,this.glIndexCounter=-1,this.flipY=r,this.init(a)},init:function(t){var e=this.renderer;e&&(e.gl?this.isCanvas?this.glTexture=e.createCanvasTexture(this.image,!1,this.flipY):this.isVideo?this.glTexture=e.createVideoTexture(this.image,!1,this.flipY):this.isRenderTexture?(this.image=this.source.canvas,this.glTexture=e.createTextureFromSource(null,this.width,this.height,this.scaleMode)):this.isGLTexture?this.glTexture=this.source:this.glTexture=e.createTextureFromSource(this.image,this.width,this.height,this.scaleMode):this.isRenderTexture&&(this.image=this.source.canvas)),t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),this.flipY=t,this},update:function(){var t=this.renderer.gl;t&&this.isCanvas?this.glTexture=this.renderer.updateCanvasTexture(this.image,this.glTexture,this.flipY):t&&this.isVideo&&(this.glTexture=this.renderer.updateVideoTexture(this.image,this.glTexture,this.flipY))},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture,!0),this.isCanvas&&i.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});t.exports=a},function(t,e,n){t.exports={AtlasXML:n(978),Canvas:n(979),Image:n(980),JSONArray:n(981),JSONHash:n(982),SpriteSheet:n(983),SpriteSheetFromAtlas:n(984),UnityYAML:n(985)}},function(t,e,n){var i=n(427),r=n(430),s=n(432),o={create:function(t){var e=t.config.audio,n=t.device.audio;return e.noAudio||!n.webAudio&&!n.audioData?new r(t):n.webAudio&&!e.disableWebAudio?new s(t):new i(t)}};t.exports=o},function(t,e,n){var i=n(146),r=n(0),s=n(71),o=n(429),a=new r({Extends:i,initialize:function(t){this.override=!0,this.audioPlayDelay=.1,this.loopEndOffset=.05,this.onBlurPausedSounds=[],this.locked="ontouchstart"in window,this.lockedActionsQueue=this.locked?[]:null,this._mute=!1,this._volume=1,i.call(this,t)},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},unlock:function(){this.locked=!1;var t=this;if(this.game.cache.audio.entries.each((function(e,n){for(var i=0;i<n.length;i++)if("true"===n[i].dataset.locked)return t.locked=!0,!1;return!0})),this.locked){var e=!1,n=function(){e=!0},i=function(){if(e)e=!1;else{document.body.removeEventListener("touchmove",n),document.body.removeEventListener("touchend",i);var r=[];if(t.game.cache.audio.entries.each((function(t,e){for(var n=0;n<e.length;n++){var i=e[n];"true"===i.dataset.locked&&r.push(i)}return!0})),0!==r.length){var s=r[r.length-1];s.oncanplaythrough=function(){s.oncanplaythrough=null,r.forEach((function(t){t.dataset.locked="false"})),t.unlocked=!0},r.forEach((function(t){t.load()}))}}};this.once(s.UNLOCKED,(function(){for(this.forEachActiveSound((function(t){null===t.currentMarker&&0===t.duration&&(t.duration=t.tags[0].duration),t.totalDuration=t.tags[0].duration}));this.lockedActionsQueue.length;){var t=this.lockedActionsQueue.shift();t.sound[t.prop].apply?t.sound[t.prop].apply(t.sound,t.value||[]):t.sound[t.prop]=t.value}}),this),document.body.addEventListener("touchmove",n,!1),document.body.addEventListener("touchend",i,!1)}},onBlur:function(){this.forEachActiveSound((function(t){t.isPlaying&&(this.onBlurPausedSounds.push(t),t.onBlur())}))},onFocus:function(){this.onBlurPausedSounds.forEach((function(t){t.onFocus()})),this.onBlurPausedSounds.length=0},destroy:function(){i.prototype.destroy.call(this),this.onBlurPausedSounds.length=0,this.onBlurPausedSounds=null},isLocked:function(t,e,n){return"true"===t.tags[0].dataset.locked&&(this.lockedActionsQueue.push({sound:t,prop:e,value:n}),!0)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return this._mute},set:function(t){this._mute=t,this.forEachActiveSound((function(t){t.updateMute()})),this.emit(s.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this._volume},set:function(t){this._volume=t,this.forEachActiveSound((function(t){t.updateVolume()})),this.emit(s.GLOBAL_VOLUME,this,t)}}});t.exports=a},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];if(!e||e&&void 0===n&&a.hasOwnProperty(e)||e&&void 0!==n&&a[e]===n)return a}return null}},function(t,e,n){var i=n(147),r=n(0),s=n(71),o=n(18),a=new r({Extends:i,initialize:function(t,e,n){if(void 0===n&&(n={}),this.tags=t.game.cache.audio.get(e),!this.tags)throw new Error('There is no audio asset with key "'+e+'" in the audio cache');this.audio=null,this.startTime=0,this.previousTime=0,this.duration=this.tags[0].duration,this.totalDuration=this.tags[0].duration,i.call(this,t,e,n)},play:function(t,e){return!(this.manager.isLocked(this,"play",[t,e])||!i.prototype.play.call(this,t,e)||!this.pickAndPlayAudioTag()||(this.emit(s.PLAY,this),0))},pause:function(){return!(this.manager.isLocked(this,"pause")||this.startTime>0||!i.prototype.pause.call(this)||(this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.stopAndReleaseAudioTag(),this.emit(s.PAUSE,this),0))},resume:function(){return!(this.manager.isLocked(this,"resume")||this.startTime>0||!i.prototype.resume.call(this)||!this.pickAndPlayAudioTag()||(this.emit(s.RESUME,this),0))},stop:function(){return!this.manager.isLocked(this,"stop")&&!!i.prototype.stop.call(this)&&(this.stopAndReleaseAudioTag(),this.emit(s.STOP,this),!0)},pickAndPlayAudioTag:function(){if(!this.pickAudioTag())return this.reset(),!1;var t=this.currentConfig.seek,e=this.currentConfig.delay,n=(this.currentMarker?this.currentMarker.start:0)+t;return this.previousTime=n,this.audio.currentTime=n,this.applyConfig(),0===e?(this.startTime=0,this.audio.paused&&this.playCatchPromise()):(this.startTime=window.performance.now()+1e3*e,this.audio.paused||this.audio.pause()),this.resetConfig(),!0},pickAudioTag:function(){if(this.audio)return!0;for(var t=0;t<this.tags.length;t++){var e=this.tags[t];if("false"===e.dataset.used)return e.dataset.used="true",this.audio=e,!0}if(!this.manager.override)return!1;var n=[];this.manager.forEachActiveSound((function(t){t.key===this.key&&t.audio&&n.push(t)}),this),n.sort((function(t,e){return t.loop===e.loop?e.seek/e.duration-t.seek/t.duration:t.loop?1:-1}));var i=n[0];return this.audio=i.audio,i.reset(),i.audio=null,i.startTime=0,i.previousTime=0,!0},playCatchPromise:function(){var t=this.audio.play();t&&t.catch((function(t){console.warn(t)}))},stopAndReleaseAudioTag:function(){this.startTime=0,this.previousTime=0,this.audio&&(this.audio.pause(),this.audio.dataset.used="false",this.audio=null)},reset:function(){i.prototype.stop.call(this)},onBlur:function(){this.isPlaying=!1,this.isPaused=!0,this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1e3),this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=!0,this.isPaused=!1,this.pickAndPlayAudioTag()},update:function(t){if(this.isPlaying)if(this.startTime>0)this.startTime<t-this.manager.audioPlayDelay&&(this.audio.currentTime+=Math.max(0,t-this.startTime)/1e3,this.startTime=0,this.previousTime=this.audio.currentTime,this.playCatchPromise());else{var e=this.currentMarker?this.currentMarker.start:0,n=e+this.duration,i=this.audio.currentTime;if(this.currentConfig.loop)i>=n-this.manager.loopEndOffset?(this.audio.currentTime=e+Math.max(0,i-n),i=this.audio.currentTime):i<e&&(this.audio.currentTime+=e,i=this.audio.currentTime),i<this.previousTime&&this.emit(s.LOOPED,this);else if(i>=n)return this.reset(),this.stopAndReleaseAudioTag(),void this.emit(s.COMPLETE,this);this.previousTime=i}},destroy:function(){i.prototype.destroy.call(this),this.tags=null,this.audio&&this.stopAndReleaseAudioTag()},updateMute:function(){this.audio&&(this.audio.muted=this.currentConfig.mute||this.manager.mute)},updateVolume:function(){this.audio&&(this.audio.volume=o(this.currentConfig.volume*this.manager.volume,0,1))},calculateRate:function(){i.prototype.calculateRate.call(this),this.audio&&(this.audio.playbackRate=this.totalRate)},mute:{get:function(){return this.currentConfig.mute},set:function(t){this.currentConfig.mute=t,this.manager.isLocked(this,"mute",t)||(this.updateMute(),this.emit(s.MUTE,this,t))}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.currentConfig.volume},set:function(t){this.currentConfig.volume=t,this.manager.isLocked(this,"volume",t)||(this.updateVolume(),this.emit(s.VOLUME,this,t))}},setVolume:function(t){return this.volume=t,this},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.manager.isLocked(this,s.RATE,t)||(this.calculateRate(),this.emit(s.RATE,this,t))}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.manager.isLocked(this,s.DETUNE,t)||(this.calculateRate(),this.emit(s.DETUNE,this,t))}},setDetune:function(t){return this.detune=t,this},seek:{get:function(){return this.isPlaying?this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0):this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.isLocked(this,"seek",t)||this.startTime>0||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.isPlaying?(this.previousTime=t,this.audio.currentTime=t):this.isPaused&&(this.currentConfig.seek=t),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.manager.isLocked(this,"loop",t)||(this.audio&&(this.audio.loop=t),this.emit(s.LOOP,this,t))}},setLoop:function(t){return this.loop=t,this},pan:{get:function(){return this.currentConfig.pan},set:function(t){this.currentConfig.pan=t,this.emit(s.PAN,this,t)}},setPan:function(t){return this.pan=t,this}});t.exports=a},function(t,e,n){var i=n(146),r=n(0),s=n(9),o=n(431),a=n(1),h=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},addAudioSprite:function(t,e){var n=this.add(t,e);return n.spritemap={},n},play:function(t,e){return!1},playAudioSprite:function(t,e,n){return!1},remove:function(t){return i.prototype.remove.call(this,t)},removeByKey:function(t){return i.prototype.removeByKey.call(this,t)},pauseAll:a,resumeAll:a,stopAll:a,update:a,setRate:a,setDetune:a,setMute:a,setVolume:a,forEachActiveSound:function(t,e){i.prototype.forEachActiveSound.call(this,t,e)},destroy:function(){i.prototype.destroy.call(this)}});t.exports=h},function(t,e,n){var i=n(147),r=n(0),s=n(9),o=n(17),a=function(){return!1},h=function(){return this},u=new r({Extends:s,initialize:function(t,e,n){void 0===n&&(n={}),s.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=o({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},n),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:a,updateMarker:a,removeMarker:function(){return null},play:a,pause:a,resume:a,stop:a,destroy:function(){i.prototype.destroy.call(this)},setMute:h,setVolume:h,setRate:h,setDetune:h,setSeek:h,setLoop:h,setPan:h});t.exports=u},function(t,e,n){var i=n(433),r=n(146),s=n(0),o=n(71),a=n(22),h=n(434),u=new s({Extends:r,initialize:function(t){this.context=this.createAudioContext(t),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked="suspended"===this.context.state&&("ontouchstart"in window||"onclick"in window),r.call(this,t),this.locked&&t.isBooted?this.unlock():t.events.once(a.BOOT,this.unlock,this)},createAudioContext:function(t){var e=t.config.audio;return e.context?(e.context.resume(),e.context):window.hasOwnProperty("AudioContext")?new AudioContext:window.hasOwnProperty("webkitAudioContext")?new window.webkitAudioContext:void 0},setAudioContext:function(t){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=t,this.masterMuteNode=t.createGain(),this.masterVolumeNode=t.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(t.destination),this.destination=this.masterMuteNode,this},add:function(t,e){var n=new h(this,t,e);return this.sounds.push(n),n},decodeAudio:function(t,e){var n;n=Array.isArray(t)?t:[{key:t,data:e}];for(var r=this.game.cache.audio,s=n.length,a=0;a<n.length;a++){var h=n[a],u=h.key,c=h.data;"string"==typeof c&&(c=i(c));var l=function(t,e){r.add(t,e),this.emit(o.DECODED,t),0==--s&&this.emit(o.DECODED_ALL)}.bind(this,u),f=function(t,e){console.error("Error decoding audio: "+t+" - ",e?e.message:""),0==--s&&this.emit(o.DECODED_ALL)}.bind(this,u);this.context.decodeAudioData(c,l,f)}},unlock:function(){var t=this,e=document.body,n=function n(){t.context&&t.context.resume().then((function(){e.removeEventListener("touchstart",n),e.removeEventListener("touchend",n),e.removeEventListener("click",n),e.removeEventListener("keydown",n),t.unlocked=!0}),(function(){e.removeEventListener("touchstart",n),e.removeEventListener("touchend",n),e.removeEventListener("click",n),e.removeEventListener("keydown",n)}))};e&&(e.addEventListener("touchstart",n,!1),e.addEventListener("touchend",n,!1),e.addEventListener("click",n,!1),e.addEventListener("keydown",n,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){this.locked||this.context.resume()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context)this.context.suspend();else{var t=this;this.context.close().then((function(){t.context=null}))}r.prototype.destroy.call(this)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return 0===this.masterMuteNode.gain.value},set:function(t){this.masterMuteNode.gain.setValueAtTime(t?0:1,0),this.emit(o.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(t){this.masterVolumeNode.gain.setValueAtTime(t,0),this.emit(o.GLOBAL_VOLUME,this,t)}}});t.exports=u},function(t,e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),r=0;r<n.length;r++)i[n.charCodeAt(r)]=r;t.exports=function(t){var e,n,r,s,o=(t=t.substr(t.indexOf(",")+1)).length,a=.75*o,h=0;"="===t[o-1]&&(a--,"="===t[o-2]&&a--);for(var u=new ArrayBuffer(a),c=new Uint8Array(u),l=0;l<o;l+=4)e=i[t.charCodeAt(l)],n=i[t.charCodeAt(l+1)],r=i[t.charCodeAt(l+2)],s=i[t.charCodeAt(l+3)],c[h++]=e<<2|n>>4,c[h++]=(15&n)<<4|r>>2,c[h++]=(3&r)<<6|63&s;return u}},function(t,e,n){var i=n(147),r=n(0),s=n(71),o=new r({Extends:i,initialize:function(t,e,n){if(void 0===n&&(n={}),this.audioBuffer=t.game.cache.audio.get(e),!this.audioBuffer)throw new Error('Audio key "'+e+'" missing from cache');this.source=null,this.loopSource=null,this.muteNode=t.context.createGain(),this.volumeNode=t.context.createGain(),this.pannerNode=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),t.context.createStereoPanner?(this.pannerNode=t.context.createStereoPanner(),this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(t.destination)):this.volumeNode.connect(t.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,i.call(this,t,e,n)},play:function(t,e){return!!i.prototype.play.call(this,t,e)&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(s.PLAY,this),!0)},pause:function(){return!(this.manager.context.currentTime<this.startTime||!i.prototype.pause.call(this)||(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(s.PAUSE,this),0))},resume:function(){return!(this.manager.context.currentTime<this.startTime||!i.prototype.resume.call(this)||(this.createAndStartBufferSource(),this.emit(s.RESUME,this),0))},stop:function(){return!!i.prototype.stop.call(this)&&(this.stopAndRemoveBufferSource(),this.emit(s.STOP,this),!0)},createAndStartBufferSource:function(){var t=this.currentConfig.seek,e=this.currentConfig.delay,n=this.manager.context.currentTime+e,i=(this.currentMarker?this.currentMarker.start:0)+t,r=this.duration-t;this.playTime=n-t,this.startTime=n,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,n),Math.max(0,i),Math.max(0,r)),this.resetConfig()},createAndStartLoopBufferSource:function(){var t=this.getLoopTime(),e=this.currentMarker?this.currentMarker.start:0,n=this.duration;this.loopTime=t,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,t),Math.max(0,e),Math.max(0,n))},createBufferSource:function(){var t=this,e=this.manager.context.createBufferSource();return e.buffer=this.audioBuffer,e.connect(this.muteNode),e.onended=function(e){e.target===t.source&&(t.currentConfig.loop?t.hasLooped=!0:t.hasEnded=!0)},e},stopAndRemoveBufferSource:function(){this.source&&(this.source.stop(),this.source.disconnect(),this.source=null),this.playTime=0,this.startTime=0,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1}),i.prototype.applyConfig.call(this)},update:function(){this.hasEnded?(this.hasEnded=!1,i.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(s.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(s.LOOPED,this))},destroy:function(){i.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.rateUpdates.length=0,this.rateUpdates=null},calculateRate:function(){i.prototype.calculateRate.call(this);var t=this.manager.context.currentTime;this.source&&"number"==typeof this.totalRate&&this.source.playbackRate.setValueAtTime(this.totalRate,t),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,t)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var t=0,e=0;e<this.rateUpdates.length;e++)t+=((e<this.rateUpdates.length-1?this.rateUpdates[e+1].time:this.manager.context.currentTime-this.playTime)-this.rateUpdates[e].time)*this.rateUpdates[e].rate;return t},getLoopTime:function(){for(var t=0,e=0;e<this.rateUpdates.length-1;e++)t+=(this.rateUpdates[e+1].time-this.rateUpdates[e].time)*this.rateUpdates[e].rate;var n=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+n.time+(this.duration-t)/n.rate},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.calculateRate(),this.emit(s.RATE,this,t)}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.calculateRate(),this.emit(s.DETUNE,this,t)}},setDetune:function(t){return this.detune=t,this},mute:{get:function(){return 0===this.muteNode.gain.value},set:function(t){this.currentConfig.mute=t,this.muteNode.gain.setValueAtTime(t?0:1,0),this.emit(s.MUTE,this,t)}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(t){this.currentConfig.volume=t,this.volumeNode.gain.setValueAtTime(t,0),this.emit(s.VOLUME,this,t)}},setVolume:function(t){return this.volume=t,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.currentConfig.seek=t,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),t&&this.createAndStartLoopBufferSource()),this.emit(s.LOOP,this,t)}},setLoop:function(t){return this.loop=t,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(t){this.currentConfig.pan=t,this.pannerNode&&this.pannerNode.pan.setValueAtTime(t,this.manager.context.currentTime),this.emit(s.PAN,this,t)}},setPan:function(t){return this.pan=t,this}});t.exports=o},function(t,e){t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),r=0;r<n;r++){i[r]=new Array(e);for(var s=e-1;s>-1;s--)i[r][s]=t[s][r]}return i}},function(t,e){function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t,e,s,o,a){for(void 0===s&&(s=0),void 0===o&&(o=t.length-1),void 0===a&&(a=i);o>s;){if(o-s>600){var h=o-s+1,u=e-s+1,c=Math.log(h),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(h-l)/h)*(u-h/2<0?-1:1),d=Math.max(s,Math.floor(e-u*l/h+f)),p=Math.min(o,Math.floor(e+(h-u)*l/h+f));r(t,e,d,p,a)}var v=t[e],g=s,m=o;for(n(t,s,e),a(t[o],v)>0&&n(t,s,o);g<m;){for(n(t,g,m),g++,m--;a(t[g],v)<0;)g++;for(;a(t[m],v)>0;)m--}0===a(t[s],v)?n(t,s,m):n(t,++m,o),m<=e&&(s=m+1),e<=m&&(o=m-1)}};t.exports=r},function(t,e,n){var i=n(6),r=n(132),s=function(t,e,n){for(var i=[],r=0;r<t.length;r++)for(var s=0;s<e.length;s++)for(var o=0;o<n;o++)i.push({a:t[r],b:e[s]});return i};t.exports=function(t,e,n){var o=i(n,"max",0),a=i(n,"qty",1),h=i(n,"random",!1),u=i(n,"randomB",!1),c=i(n,"repeat",0),l=i(n,"yoyo",!1),f=[];if(u&&r(e),-1===c)if(0===o)c=0;else{var d=t.length*e.length*a;l&&(d*=2),c=Math.ceil(o/d)}for(var p=0;p<=c;p++){var v=s(t,e,a);h&&r(v),f=f.concat(v),l&&(v.reverse(),f=f.concat(v))}return o&&f.splice(o),f}},function(t,e,n){t.exports={PROCESS_QUEUE_ADD:n(1038),PROCESS_QUEUE_REMOVE:n(1039)}},function(t,e,n){var i=n(13);t.exports=function(t,e){var n=i(e,"anims",null);if(null===n)return t;if("string"==typeof n)t.anims.play(n);else if("object"==typeof n){var r=t.anims,s=i(n,"key",void 0);if(s){var o=i(n,"startFrame",void 0),a=i(n,"delay",0),h=i(n,"repeat",0),u=i(n,"repeatDelay",0),c=i(n,"yoyo",!1),l=i(n,"play",!1),f=i(n,"delayedPlay",0),d={key:s,delay:a,repeat:h,repeatDelay:u,yoyo:c,startFrame:o};l?r.play(d):f>0?r.playAfterDelay(d,f):r.load(d)}}return t}},function(t,e,n){var i=n(0),r=n(109),s=new i({initialize:function(t,e,n,i,r){this.parent=t,this.x=e,this.y=n,this.frame=i,this.data={},this.tint=16777215,this._visible=r,this._alpha=1,this.flipX=!1,this.flipY=!1},setFrame:function(t){return void 0===t?this.frame=this.parent.frame:t instanceof r&&t.texture===this.parent.texture?this.frame=t:this.frame=this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,n){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,n&&this.setFrame(n),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!=t>0,this._alpha=t}}});t.exports=s},function(t,e,n){var i=n(10);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=Math.min(t.x,e.x),s=Math.min(t.y,e.y),o=Math.max(t.right,e.right)-r,a=Math.max(t.bottom,e.bottom)-s;return n.setTo(r,s,o,a)}},function(t,e,n){var i=n(0),r=n(11),s=n(1052),o=n(15),a=n(7),h=n(202),u=n(20),c=n(141),l=new i({Extends:o,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Origin,r.ScrollFactor,r.Transform,r.Visible,s],initialize:function(t,e,n,i,r,s){o.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,this.cache=t.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new c,this.rotate3dAngle="deg",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,n),"string"==typeof i?"#"===i[0]?this.setElement(i.substr(1),r,s):this.createElement(i,r,s):i&&this.setElement(i,r,s),t.sys.events.on(u.SLEEP,this.handleSceneEvent,this),t.sys.events.on(u.WAKE,this.handleSceneEvent,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},handleSceneEvent:function(t){var e=this.node,n=e.style;e&&(n.display=t.settings.visible?"block":"none")},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,n){return this.setElement(document.createElement(t),e,n)},setElement:function(t,e,n){var i;if(this.removeElement(),"string"==typeof t?("#"===t[0]&&(t=t.substr(1)),i=document.getElementById(t)):"object"==typeof t&&1===t.nodeType&&(i=t),!i)return this;if(this.node=i,e&&a(e))for(var r in e)i.style[r]=e[r];else"string"==typeof e&&(i.style=e);return i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent&&this.parent.appendChild(i),n&&(i.innerText=n),this.updateSize()},createFromCache:function(t,e){var n=this.cache.get(t);return n&&this.createFromHTML(n,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var n=document.createElement(e);return this.node=n,n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent&&this.parent.appendChild(n),n.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(h(this.node),this.node=null),this},updateSize:function(){var t=this.node,e=t.getBoundingClientRect();return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=e.width||0,this.displayHeight=e.height||0,this},getChildByProperty:function(t,e){if(this.node)for(var n=this.node.querySelectorAll("*"),i=0;i<n.length;i++)if(n[i][t]===e)return n[i];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preUpdate:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(u.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(u.WAKE,this.handleSceneEvent,this)}});t.exports=l},function(t,e,n){var i=n(1053),r=n(15),s=n(25),o=new s,a=new s,h=new s;t.exports=function(t,e,n,s){if(e.node){var u=e.node.style,c=e.scene.sys.settings;if(!u||!c.visible||r.RENDER_MASK!==e.renderFlags||0!==e.cameraFilter&&e.cameraFilter&n.id||e.parentContainer&&!e.parentContainer.willRender())u.display="none";else{var l=e.parentContainer,f=n.alpha*e.alpha;l&&(f*=l.alpha);var d=o,p=a,v=h,g=0,m=0,y="0%",x="0%";s?(g=e.width*e.scaleX*e.originX,m=e.height*e.scaleY*e.originY,p.applyITRS(e.x-g,e.y-m,e.rotation,e.scaleX,e.scaleY),d.copyFrom(n.matrix),d.multiplyWithOffset(s,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),p.e=e.x-g,p.f=e.y-m,d.multiply(p,v)):(g=e.width*e.originX,m=e.height*e.originY,p.applyITRS(e.x-g,e.y-m,e.rotation,e.scaleX,e.scaleY),d.copyFrom(n.matrix),y=100*e.originX+"%",x=100*e.originY+"%",p.e-=n.scrollX*e.scrollFactorX,p.f-=n.scrollY*e.scrollFactorY,d.multiply(p,v)),e.transformOnly||(u.display="block",u.opacity=f,u.zIndex=e._depth,u.mixBlendMode=i[e._blendMode]),u.transform=v.getCSSMatrix()+" skew("+e.skewX+"rad, "+e.skewY+"rad) rotate3d("+e.rotate3d.x+","+e.rotate3d.y+","+e.rotate3d.z+","+e.rotate3d.w+e.rotate3dAngle+")",u.transformOrigin=y+" "+x}}}},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(1057),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.Origin,r.ScrollFactor,r.Size,r.Texture,r.Tint,r.Transform,r.Visible,o],initialize:function(t){s.call(this,t,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});t.exports=a},function(t,e,n){var i=n(218),r=n(98),s=n(14),o=n(4);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},function(t,e,n){var i=n(447),r=n(218),s=n(98),o=n(14);t.exports=function(t,e,n,a){void 0===a&&(a=[]),!e&&n>0&&(e=i(t)/n);for(var h=0;h<e;h++){var u=s(h/e,0,o.PI2);a.push(r(t,u))}return a}},function(t,e){t.exports=function(t){var e=t.width/2,n=t.height/2,i=Math.pow(e-n,2)/Math.pow(e+n,2);return Math.PI*(e+n)*(1+3*i/(10+Math.sqrt(4-3*i)))}},function(t,e,n){var i=n(217),r=n(30);t.exports=function(t,e,n,s,o,a){var h=e.commandBuffer,u=h.length,c=o||t.currentContext;if(0!==u&&r(t,c,e,n,s)){n.addToRenderList(e);var l=1,f=1,d=0,p=0,v=1,g=0,m=0,y=0;c.beginPath();for(var x=0;x<u;++x)switch(h[x]){case i.ARC:c.arc(h[x+1],h[x+2],h[x+3],h[x+4],h[x+5],h[x+6]),x+=7;break;case i.LINE_STYLE:v=h[x+1],d=h[x+2],l=h[x+3],g=(16711680&d)>>>16,m=(65280&d)>>>8,y=255&d,c.strokeStyle="rgba("+g+","+m+","+y+","+l+")",c.lineWidth=v,x+=3;break;case i.FILL_STYLE:p=h[x+1],f=h[x+2],g=(16711680&p)>>>16,m=(65280&p)>>>8,y=255&p,c.fillStyle="rgba("+g+","+m+","+y+","+f+")",x+=2;break;case i.BEGIN_PATH:c.beginPath();break;case i.CLOSE_PATH:c.closePath();break;case i.FILL_PATH:a||c.fill();break;case i.STROKE_PATH:a||c.stroke();break;case i.FILL_RECT:a?c.rect(h[x+1],h[x+2],h[x+3],h[x+4]):c.fillRect(h[x+1],h[x+2],h[x+3],h[x+4]),x+=4;break;case i.FILL_TRIANGLE:c.beginPath(),c.moveTo(h[x+1],h[x+2]),c.lineTo(h[x+3],h[x+4]),c.lineTo(h[x+5],h[x+6]),c.closePath(),a||c.fill(),x+=6;break;case i.STROKE_TRIANGLE:c.beginPath(),c.moveTo(h[x+1],h[x+2]),c.lineTo(h[x+3],h[x+4]),c.lineTo(h[x+5],h[x+6]),c.closePath(),a||c.stroke(),x+=6;break;case i.LINE_TO:c.lineTo(h[x+1],h[x+2]),x+=2;break;case i.MOVE_TO:c.moveTo(h[x+1],h[x+2]),x+=2;break;case i.LINE_FX_TO:c.lineTo(h[x+1],h[x+2]),x+=5;break;case i.MOVE_FX_TO:c.moveTo(h[x+1],h[x+2]),x+=5;break;case i.SAVE:c.save();break;case i.RESTORE:c.restore();break;case i.TRANSLATE:c.translate(h[x+1],h[x+2]),x+=2;break;case i.SCALE:c.scale(h[x+1],h[x+2]),x+=2;break;case i.ROTATE:c.rotate(h[x+1]),x+=1;break;case i.GRADIENT_FILL_STYLE:x+=5;break;case i.GRADIENT_LINE_STYLE:x+=6}c.restore()}}},function(t,e,n){var i=n(0),r=n(138),s=n(81),o=n(2),a=n(68),h=new i({initialize:function(t,e,n,i){void 0===i&&(i=!1),this.propertyKey=e,this.propertyValue=n,this.defaultValue=n,this.steps=0,this.counter=0,this.start=0,this.end=0,this.ease,this.emitOnly=i,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.loadConfig(t)},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=o(t,this.propertyKey,this.defaultValue),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return this.propertyValue},onChange:function(t){return this.propertyValue=t,this.setMethods()},setMethods:function(){var t=this.propertyValue,e=typeof t;if(this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,"number"===e)this.onEmit=this.staticValueEmit,this.onUpdate=this.staticValueUpdate;else if(Array.isArray(t))this.onEmit=this.randomStaticValueEmit;else if("function"===e)this.emitOnly?this.onEmit=t:this.onUpdate=t;else if("object"===e&&this.hasBoth(t,"start","end")){this.start=t.start,this.end=t.end;var n=this.has(t,"random");if(n&&(this.onEmit=this.randomRangedValueEmit),this.has(t,"steps"))this.steps=t.steps,this.counter=this.start,this.onEmit=this.steppedEmit;else{var i=this.has(t,"ease")?t.ease:"Linear";this.ease=s(i,t.easeParams),n||(this.onEmit=this.easedValueEmit),this.onUpdate=this.easeValueUpdate}}else if("object"===e&&this.hasBoth(t,"min","max"))this.start=t.min,this.end=t.max,this.onEmit=this.randomRangedValueEmit;else if("object"===e&&this.has(t,"random")){var r=t.random;Array.isArray(r)&&(this.start=r[0],this.end=r[1]),this.onEmit=this.randomRangedValueEmit}else"object"===e&&this.hasEither(t,"onEmit","onUpdate")&&(this.has(t,"onEmit")&&(this.onEmit=t.onEmit),this.has(t,"onUpdate")&&(this.onUpdate=t.onUpdate));return this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,n){return t.hasOwnProperty(e)&&t.hasOwnProperty(n)},hasEither:function(t,e,n){return t.hasOwnProperty(e)||t.hasOwnProperty(n)},defaultEmit:function(t,e,n){return n},defaultUpdate:function(t,e,n,i){return i},staticValueEmit:function(){return this.propertyValue},staticValueUpdate:function(){return this.propertyValue},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.propertyValue[t]},randomRangedValueEmit:function(t,e){var n=r(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=n),n},steppedEmit:function(){var t=this.counter,e=this.counter+(this.end-this.start)/this.steps;return this.counter=a(e,this.start,this.end),t},easedValueEmit:function(t,e){if(t&&t.data[e]){var n=t.data[e];n.min=this.start,n.max=this.end}return this.start},easeValueUpdate:function(t,e,n){var i=t.data[e];return(i.max-i.min)*this.ease(n)+i.min}});t.exports=h},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t,e,n,i,s){if("object"==typeof t){var o=t;t=r(o,"x",0),e=r(o,"y",0),n=r(o,"power",0),i=r(o,"epsilon",100),s=r(o,"gravity",50)}else void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=100),void 0===s&&(s=50);this.x=t,this.y=e,this.active=!0,this._gravity=s,this._power=0,this._epsilon=0,this.power=n,this.epsilon=i},update:function(t,e){var n=this.x-t.x,i=this.y-t.y,r=n*n+i*i;if(0!==r){var s=Math.sqrt(r);r<this._epsilon&&(r=this._epsilon);var o=this._power*e/(r*s)*100;t.velocityX+=n*o,t.velocityY+=i*o}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});t.exports=s},function(t,e,n){var i=n(0),r=n(36),s=n(50),o=new i({initialize:function(t){this.emitter=t,this.frame=null,this.x=0,this.y=0,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215,current:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1}}},isAlive:function(){return this.lifeCurrent>0},resetPosition:function(){this.x=0,this.y=0},fire:function(t,e){var n=this.emitter;this.frame=n.getFrame(),n.emitZone&&n.emitZone.getPoint(this),this.x+=void 0===t?n.x.onEmit(this,"x"):t,this.y+=void 0===e?n.y.onEmit(this,"y"):e,this.life=n.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0;var i=n.speedX.onEmit(this,"speedX"),o=n.speedY?n.speedY.onEmit(this,"speedY"):i;if(n.radial){var a=r(n.angle.onEmit(this,"angle"));this.velocityX=Math.cos(a)*Math.abs(i),this.velocityY=Math.sin(a)*Math.abs(o)}else if(n.moveTo){var h=n.moveToX.onEmit(this,"moveToX"),u=n.moveToY?n.moveToY.onEmit(this,"moveToY"):h,c=Math.atan2(u-this.y,h-this.x),l=s(this.x,this.y,h,u)/(this.life/1e3);this.velocityX=Math.cos(c)*l,this.velocityY=Math.sin(c)*l}else this.velocityX=i,this.velocityY=o;n.acceleration&&(this.accelerationX=n.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=n.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=n.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=n.maxVelocityY.onEmit(this,"maxVelocityY"),this.delayCurrent=n.delay.onEmit(this,"delay"),this.scaleX=n.scaleX.onEmit(this,"scaleX"),this.scaleY=n.scaleY?n.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=n.rotate.onEmit(this,"rotate"),this.rotation=r(this.angle),this.bounce=n.bounce.onEmit(this,"bounce"),this.alpha=n.alpha.onEmit(this,"alpha"),this.tint=n.tint.onEmit(this,"tint")},computeVelocity:function(t,e,n,i){var r=this.velocityX,s=this.velocityY,o=this.accelerationX,a=this.accelerationY,h=this.maxVelocityX,u=this.maxVelocityY;r+=t.gravityX*n,s+=t.gravityY*n,o&&(r+=o*n),a&&(s+=a*n),r>h?r=h:r<-h&&(r=-h),s>u?s=u:s<-u&&(s=-u),this.velocityX=r,this.velocityY=s;for(var c=0;c<i.length;c++)i[c].update(this,e,n)},checkBounds:function(t){var e=t.bounds,n=-this.bounce;this.x<e.x&&t.collideLeft?(this.x=e.x,this.velocityX*=n):this.x>e.right&&t.collideRight&&(this.x=e.right,this.velocityX*=n),this.y<e.y&&t.collideTop?(this.y=e.y,this.velocityY*=n):this.y>e.bottom&&t.collideBottom&&(this.y=e.bottom,this.velocityY*=n)},update:function(t,e,n){if(this.delayCurrent>0)return this.delayCurrent-=t,!1;var i=this.emitter,s=1-this.lifeCurrent/this.life;return this.lifeT=s,this.computeVelocity(i,t,e,n),this.x+=this.velocityX*e,this.y+=this.velocityY*e,i.bounds&&this.checkBounds(i),i.deathZone&&i.deathZone.willKill(this)?(this.lifeCurrent=0,!0):(this.scaleX=i.scaleX.onUpdate(this,"scaleX",s,this.scaleX),i.scaleY?this.scaleY=i.scaleY.onUpdate(this,"scaleY",s,this.scaleY):this.scaleY=this.scaleX,this.angle=i.rotate.onUpdate(this,"rotate",s,this.angle),this.rotation=r(this.angle),this.alpha=i.alpha.onUpdate(this,"alpha",s,this.alpha),this.tint=i.tint.onUpdate(this,"tint",s,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0)}});t.exports=o},function(t,e,n){var i=n(35),r=n(0),s=n(11),o=n(453),a=n(454),h=n(449),u=n(2),c=n(210),l=n(455),f=n(127),d=n(451),p=n(456),v=n(10),g=n(80),m=n(3),y=n(68),x=new r({Mixins:[s.BlendMode,s.Mask,s.ScrollFactor,s.Visible],initialize:function(t,e){this.manager=t,this.texture=t.texture,this.frames=[t.defaultFrame],this.defaultFrame=t.defaultFrame,this.configFastMap=["active","blendMode","collideBottom","collideLeft","collideRight","collideTop","deathCallback","deathCallbackScope","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxParticles","name","on","particleBringToTop","particleClass","radial","timeScale","trackVisible","visible"],this.configOpMap=["accelerationX","accelerationY","angle","alpha","bounce","delay","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],this.name="",this.particleClass=d,this.x=new h(e,"x",0,!0),this.y=new h(e,"y",0,!0),this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.accelerationX=new h(e,"accelerationX",0,!0),this.accelerationY=new h(e,"accelerationY",0,!0),this.maxVelocityX=new h(e,"maxVelocityX",1e4,!0),this.maxVelocityY=new h(e,"maxVelocityY",1e4,!0),this.speedX=new h(e,"speedX",0,!0),this.speedY=new h(e,"speedY",0,!0),this.moveTo=!1,this.moveToX=new h(e,"moveToX",0,!0),this.moveToY=new h(e,"moveToY",0,!0),this.bounce=new h(e,"bounce",0,!0),this.scaleX=new h(e,"scaleX",1),this.scaleY=new h(e,"scaleY",1),this.tint=new h(e,"tint",16777215),this.alpha=new h(e,"alpha",1),this.lifespan=new h(e,"lifespan",1e3,!0),this.angle=new h(e,"angle",{min:0,max:360},!0),this.rotate=new h(e,"rotate",0),this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.quantity=new h(e,"quantity",1,!0),this.delay=new h(e,"delay",0,!0),this.frequency=0,this.on=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZone=null,this.deathZone=null,this.bounds=null,this.collideLeft=!0,this.collideRight=!0,this.collideTop=!0,this.collideBottom=!0,this.active=!0,this.visible=!0,this.blendMode=i.NORMAL,this.follow=null,this.followOffset=new m,this.trackVisible=!1,this.currentFrame=0,this.randomFrame=!0,this.frameQuantity=1,this.dead=[],this.alive=[],this._counter=0,this._frameCounter=0,e&&this.fromJSON(e)},fromJSON:function(t){if(!t)return this;var e=0,n="";for(e=0;e<this.configFastMap.length;e++)n=this.configFastMap[e],f(t,n)&&(this[n]=u(t,n));for(e=0;e<this.configOpMap.length;e++)n=this.configOpMap[e],f(t,n)&&this[n].loadConfig(t);if(this.acceleration=0!==this.accelerationX.propertyValue||0!==this.accelerationY.propertyValue,this.moveTo=0!==this.moveToX.propertyValue||0!==this.moveToY.propertyValue,f(t,"speed")&&(this.speedX.loadConfig(t,"speed"),this.speedY=null),(l(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),f(t,"scale")&&(this.scaleX.loadConfig(t,"scale"),this.scaleY=null),f(t,"callbackScope")){var i=u(t,"callbackScope",null);this.emitCallbackScope=i,this.deathCallbackScope=i}return f(t,"emitZone")&&this.setEmitZone(t.emitZone),f(t,"deathZone")&&this.setDeathZone(t.deathZone),f(t,"bounds")&&this.setBounds(t.bounds),f(t,"followOffset")&&this.followOffset.setFromObject(u(t,"followOffset",0)),f(t,"frame")&&this.setFrame(t.frame),f(t,"reserve")&&this.reserve(t.reserve),this},toJSON:function(t){void 0===t&&(t={});var e=0,n="";for(e=0;e<this.configFastMap.length;e++)t[n=this.configFastMap[e]]=this[n];for(e=0;e<this.configOpMap.length;e++)this[n=this.configOpMap[e]]&&(t[n]=this[n].toJSON());return this.speedY||(delete t.speedX,t.speed=this.speedX.toJSON()),this.scaleY||(delete t.scaleX,t.scale=this.scaleX.toJSON()),t},startFollow:function(t,e,n,i){return void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=!1),this.follow=t,this.followOffset.set(e,n),this.trackVisible=i,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){if(1===this.frames.length)return this.defaultFrame;if(this.randomFrame)return c(this.frames);var t=this.frames[this.currentFrame];return this._frameCounter++,this._frameCounter===this.frameQuantity&&(this._frameCounter=0,this.currentFrame=y(this.currentFrame+1,0,this._frameLength)),t},setFrame:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),this.randomFrame=e,this.frameQuantity=n,this.currentFrame=0,this._frameCounter=0;var i=typeof t;if(Array.isArray(t)||"string"===i||"number"===i)this.manager.setEmitterFrames(t,this);else if("object"===i){var r=t;(t=u(r,"frames",null))&&this.manager.setEmitterFrames(t,this);var s=u(r,"cycle",!1);this.randomFrame=!s,this.frameQuantity=u(r,"quantity",n)}return this._frameLength=this.frames.length,1===this._frameLength&&(this.frameQuantity=1,this.randomFrame=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},setPosition:function(t,e){return this.x.onChange(t),this.y.onChange(e),this},setBounds:function(t,e,n,i){if("object"==typeof t){var r=t;t=r.x,e=r.y,n=f(r,"w")?r.w:r.width,i=f(r,"h")?r.h:r.height}return this.bounds?this.bounds.setTo(t,e,n,i):this.bounds=new v(t,e,n,i),this},setSpeedX:function(t){return this.speedX.onChange(t),this.radial=!1,this},setSpeedY:function(t){return this.speedY&&(this.speedY.onChange(t),this.radial=!1),this},setSpeed:function(t){return this.speedX.onChange(t),this.speedY=null,this.radial=!0,this},setScaleX:function(t){return this.scaleX.onChange(t),this},setScaleY:function(t){return this.scaleY.onChange(t),this},setScale:function(t){return this.scaleX.onChange(t),this.scaleY=null,this},setGravityX:function(t){return this.gravityX=t,this},setGravityY:function(t){return this.gravityY=t,this},setGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setAlpha:function(t){return this.alpha.onChange(t),this},setTint:function(t){return this.tint.onChange(t),this},setEmitterAngle:function(t){return this.angle.onChange(t),this},setAngle:function(t){return this.angle.onChange(t),this},setLifespan:function(t){return this.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity.onChange(t),this},setFrequency:function(t,e){return this.frequency=t,this._counter=0,e&&this.quantity.onChange(e),this},setEmitZone:function(t){if(void 0===t)this.emitZone=null;else{var e=u(t,"type","random"),n=u(t,"source",null);switch(e){case"random":this.emitZone=new p(n);break;case"edge":var i=u(t,"quantity",1),r=u(t,"stepRate",0),s=u(t,"yoyo",!1),o=u(t,"seamless",!0);this.emitZone=new a(n,i,r,s,o)}}return this},setDeathZone:function(t){if(void 0===t)this.deathZone=null;else{var e=u(t,"type","onEnter"),n=u(t,"source",null);if(n&&"function"==typeof n.contains){var i="onEnter"===e;this.deathZone=new o(n,i)}}return this},reserve:function(t){for(var e=this.dead,n=0;n<t;n++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()===this.maxParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var n=this.alive,i=n.length,r=0;r<i;++r)t.call(e,n[r],this);return this},forEachDead:function(t,e){for(var n=this.dead,i=n.length,r=0;r<i;++r)t.call(e,n[r],this);return this},start:function(){return this.on=!0,this._counter=0,this},stop:function(){return this.on=!1,this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},remove:function(){return this.manager.removeEmitter(this),this},depthSort:function(){return g(this.alive,this.depthSortCallback),this},flow:function(t,e){return void 0===e&&(e=1),this.frequency=t,this.quantity.onChange(e),this.start()},explode:function(t,e,n){return this.frequency=-1,this.emitParticle(t,e,n)},emitParticleAt:function(t,e,n){return this.emitParticle(n,t,e)},emitParticle:function(t,e,n){if(!this.atLimit()){void 0===t&&(t=this.quantity.onEmit());for(var i=this.dead,r=this.follow?this.follow.x+this.followOffset.x:e,s=this.follow?this.follow.y+this.followOffset.y:n,o=0;o<t;o++){var a=i.pop();if(a||(a=new this.particleClass(this)),a.fire(r,s),this.particleBringToTop?this.alive.push(a):this.alive.unshift(a),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,a,this),this.atLimit())break}return a}},preUpdate:function(t,e){var n=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible);var i=this.manager.getProcessors(),r=this.alive,s=this.dead,o=0,a=[],h=r.length;for(o=0;o<h;o++){var u=r[o];u.update(e,n,i)&&a.push({index:o,particle:u})}if((h=a.length)>0){var c=this.deathCallback,l=this.deathCallbackScope;for(o=h-1;o>=0;o--){var f=a[o];r.splice(f.index,1),s.push(f.particle),c&&c.call(l,f.particle),f.particle.resetPosition()}}this.on&&(0===this.frequency?this.emitParticle():this.frequency>0&&(this._counter-=e,this._counter<=0&&(this.emitParticle(),this._counter=this.frequency-Math.abs(this._counter))))},depthSortCallback:function(t,e){return t.y-e.y}});t.exports=x},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=this.source.contains(t.x,t.y);return e&&this.killOnEnter||!e&&!this.killOnEnter}});t.exports=i},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!0),this.source=t,this.points=[],this.quantity=e,this.stepRate=n,this.yoyo=i,this.counter=-1,this.seamless=r,this._length=0,this._direction=0,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var n=this._length;return this._length=this.points.length,this._length<n&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});t.exports=i},function(t,e){t.exports=function(t,e){for(var n=0;n<e.length;n++)if(t.hasOwnProperty(e[n]))return!0;return!1}},function(t,e,n){var i=n(0),r=n(3),s=new i({initialize:function(t){this.source=t,this._tempVec=new r},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});t.exports=s},function(t,e,n){var i=n(0),r=n(11),s=n(74),o=new i({Extends:s,Mixins:[r.PathFollower],initialize:function(t,e,n,i,r,o){s.call(this,t,n,i,r,o),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});t.exports=o},function(t,e){t.exports=function(t,e,n){var i=t.canvas,r=t.context,s=t.style,o=[],a=0,h=n.length;s.maxLines>0&&s.maxLines<n.length&&(h=s.maxLines),s.syncFont(i,r);for(var u=0;u<h;u++){var c=s.strokeThickness;c+=r.measureText(n[u]).width,s.wordWrap&&(c-=r.measureText(" ").width),o[u]=Math.ceil(c),a=Math.max(a,o[u])}var l=e.fontSize+s.strokeThickness,f=l*h,d=t.lineSpacing;return h>1&&(f+=d*(h-1)),{width:a,height:f,lines:h,lineWidths:o,lineSpacing:d,lineHeight:l}}},function(t,e,n){var i=n(0),r=n(13),s=n(6),o=n(460),a={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|Mqgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},h=new i({initialize:function(t,e){this.parent=t,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(e,!1,!0);var n=s(e,"metrics",!1);this.metrics=n?{ascent:s(n,"ascent",0),descent:s(n,"descent",0),fontSize:s(n,"fontSize",0)}:o(this)},setStyle:function(t,e,n){for(var i in void 0===e&&(e=!0),void 0===n&&(n=!1),t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),a){var o=n?a[i][1]:this[i];this[i]="wordWrapCallback"===i||"wordWrapCallbackScope"===i?s(t,a[i][0],o):r(t,a[i][0],o)}var h=s(t,"font",null);null!==h&&this.setFont(h,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var u=s(t,"fill",null);return null!==u&&(this.color=u),e?this.update(!0):this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=o(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,i="",r="";if("string"!=typeof t)n=s(t,"fontFamily","Courier"),i=s(t,"fontSize","16px"),r=s(t,"fontStyle","");else{var o=t.split(" "),a=0;r=o.length>2?o[a++]:"",i=o[a++]||"16px",n=o[a++]||"Courier"}return n===this.fontFamily&&i===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=i,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n="#000"),void 0===i&&(i=0),void 0===r&&(r=!1),void 0===s&&(s=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=n,this.shadowBlur=i,this.shadowStroke=r,this.shadowFill=s,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in a)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});t.exports=h},function(t,e,n){var i=n(31);t.exports=function(t){var e=i.create(this),n=e.getContext("2d");t.syncFont(e,n);var r=n.measureText(t.testString);if(r.hasOwnProperty("actualBoundingBoxAscent")){var s=r.actualBoundingBoxAscent,o=r.actualBoundingBoxDescent;return i.remove(e),{ascent:s,descent:o,fontSize:s+o}}var a=Math.ceil(r.width*t.baselineX),h=a,u=2*h;h=h*t.baselineY|0,e.width=a,e.height=u,n.fillStyle="#f00",n.fillRect(0,0,a,u),n.font=t._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(t.testString,0,h);var c={ascent:0,descent:0,fontSize:0};if(!n.getImageData(0,0,a,u))return c.ascent=h,c.descent=h+6,c.fontSize=c.ascent+c.descent,i.remove(e),c;var l,f,d=n.getImageData(0,0,a,u).data,p=d.length,v=4*a,g=0,m=!1;for(l=0;l<h;l++){for(f=0;f<v;f+=4)if(255!==d[g+f]){m=!0;break}if(m)break;g+=v}for(c.ascent=h-l,g=p-v,m=!1,l=u;l>h;l--){for(f=0;f<v;f+=4)if(255!==d[g+f]){m=!0;break}if(m)break;g-=v}return c.descent=l-h,c.fontSize=c.ascent+c.descent,i.remove(e),c}},function(t,e,n){var i=n(1094),r=n(0),s=n(36),o=n(70),a=n(64),h=n(14),u=n(34),c=new r({Extends:u,Mixins:[i],initialize:function(t,e,n,i,r,s,o,h,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=0),void 0===s&&(s=360),void 0===o&&(o=!1),u.call(this,t,"Arc",new a(0,0,i)),this._startAngle=r,this._endAngle=s,this._anticlockwise=o,this._iterations=.01,this.setPosition(e,n);var l=2*this.geom.radius;this.setSize(l,l),void 0!==h&&this.setFillStyle(h,c),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,n=this.geom.radius,i=s(this._startAngle),r=s(this._endAngle),a=n,u=n;r-=i,this._anticlockwise?r<-h.PI2?r=-h.PI2:r>0&&(r=-h.PI2+r%h.PI2):r>h.PI2?r=h.PI2:r<0&&(r=h.PI2+r%h.PI2);for(var c,l=[a+Math.cos(i)*n,u+Math.sin(i)*n];e<1;)c=r*e+i,l.push(a+Math.cos(c)*n,u+Math.sin(c)*n),e+=t;return c=r+i,l.push(a+Math.cos(c)*n,u+Math.sin(c)*n),l.push(a+Math.cos(i)*n,u+Math.sin(i)*n),this.pathIndexes=o(l),this.pathData=l,this}});t.exports=c},function(t,e,n){var i=n(0),r=n(1097),s=n(70),o=n(10),a=n(34),h=new i({Extends:a,Mixins:[r],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),a.call(this,t,"Curve",i),this._smoothness=32,this._curveBounds=new o,this.closePath=!1,this.setPosition(e,n),void 0!==r&&this.setFillStyle(r,s),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],i=this.geom.getPoints(e),r=0;r<i.length;r++)n.push(i[r].x,i[r].y);return n.push(i[0].x,i[0].y),this.pathIndexes=s(n),this.pathData=n,this}});t.exports=h},function(t,e,n){var i=n(0),r=n(70),s=n(1100),o=n(111),a=n(34),h=new i({Extends:a,Mixins:[s],initialize:function(t,e,n,i,r,s,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=128),a.call(this,t,"Ellipse",new o(i/2,r/2,i,r)),this._smoothness=64,this.setPosition(e,n),this.width=i,this.height=r,void 0!==s&&this.setFillStyle(s,h),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setPosition(t/2,e/2),this.geom.setSize(t,e),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],e=this.geom.getPoints(this._smoothness),n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=r(t),this.pathData=t,this}});t.exports=h},function(t,e,n){var i=n(0),r=n(34),s=n(1103),o=new i({Extends:r,Mixins:[s],initialize:function(t,e,n,i,s,o,a,h,u,c,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===s&&(s=128),void 0===o&&(o=32),void 0===a&&(a=32),r.call(this,t,"Grid",null),this.cellWidth=o,this.cellHeight=a,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(e,n),this.setSize(i,s),this.setFillStyle(h,u),void 0!==c&&this.setOutlineStyle(c,l),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});t.exports=o},function(t,e,n){var i=n(1106),r=n(0),s=n(34),o=new r({Extends:s,Mixins:[i],initialize:function(t,e,n,i,r,o,a,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=15658734),void 0===a&&(a=10066329),void 0===h&&(h=13421772),s.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=o,this.fillLeft=a,this.fillRight=h,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},function(t,e,n){var i=n(0),r=n(1109),s=n(34),o=new i({Extends:s,Mixins:[r],initialize:function(t,e,n,i,r,o,a,h,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=!1),void 0===a&&(a=15658734),void 0===h&&(h=10066329),void 0===u&&(u=13421772),s.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=a,this.fillLeft=h,this.fillRight=u,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=o,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},function(t,e,n){var i=n(0),r=n(34),s=n(47),o=n(1112),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,h,u,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=128),void 0===h&&(h=0),r.call(this,t,"Line",new s(i,o,a,h));var l=Math.max(1,this.geom.right-this.geom.left),f=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(e,n),this.setSize(l,f),void 0!==u&&this.setStrokeStyle(1,u,c),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,n,i){return this.geom.setTo(t,e,n,i),this}});t.exports=a},function(t,e,n){var i=n(1115),r=n(0),s=n(70),o=n(469),a=n(227),h=n(34),u=n(472),c=new r({Extends:h,Mixins:[i],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),h.call(this,t,"Polygon",new a(i));var u=o(this.geom);this.setPosition(e,n),this.setSize(u.width,u.height),void 0!==r&&this.setFillStyle(r,s),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)u(this.geom);return this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=c},function(t,e,n){var i=n(10);t.exports=function(t,e){void 0===e&&(e=new i);for(var n,r=1/0,s=1/0,o=-r,a=-s,h=0;h<t.points.length;h++)n=t.points[h],r=Math.min(r,n.x),s=Math.min(s,n.y),o=Math.max(o,n.x),a=Math.max(a,n.y);return e.x=r,e.y=s,e.width=o-r,e.height=a-s,e}},function(t,e,n){var i=n(66),r=n(47),s=n(471);t.exports=function(t,e,n,o){void 0===o&&(o=[]);var a=t.points,h=s(t);!e&&n>0&&(e=h/n);for(var u=0;u<e;u++)for(var c=h*(u/e),l=0,f=0;f<a.length;f++){var d=a[f],p=a[(f+1)%a.length],v=new r(d.x,d.y,p.x,p.y),g=i(v);if(!(c<l||c>l+g)){var m=v.getPoint((c-l)/g);o.push(m);break}l+=g}return o}},function(t,e,n){var i=n(66),r=n(47);t.exports=function(t){for(var e=t.points,n=0,s=0;s<e.length;s++){var o=e[s],a=e[(s+1)%e.length],h=new r(o.x,o.y,a.x,a.y);n+=i(h)}return n}},function(t,e){var n=function(t,e){return t[0]=e[0],t[1]=e[1],t};t.exports=function(t){var e,i=[],r=t.points;for(e=0;e<r.length;e++)i.push([r[e].x,r[e].y]);var s=[];for(i.length>0&&s.push(n([0,0],i[0])),e=0;e<i.length-1;e++){var o=i[e],a=i[e+1],h=o[0],u=o[1],c=a[0],l=a[1];s.push([.85*h+.15*c,.85*u+.15*l]),s.push([.15*h+.85*c,.15*u+.85*l])}return i.length>1&&s.push(n([0,0],i[i.length-1])),t.setTo(s)}},function(t,e,n){var i=n(0),r=n(10),s=n(34),o=n(1118),a=new i({Extends:s,Mixins:[o],initialize:function(t,e,n,i,o,a,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===o&&(o=128),s.call(this,t,"Rectangle",new r(0,0,i,o)),this.setPosition(e,n),this.setSize(i,o),void 0!==a&&this.setFillStyle(a,h),this.updateDisplayOrigin(),this.updateData()},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),e.getLineD(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(1121),r=n(0),s=n(70),o=n(34),a=new r({Extends:o,Mixins:[i],initialize:function(t,e,n,i,r,s,a,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=5),void 0===r&&(r=32),void 0===s&&(s=64),o.call(this,t,"Star",null),this._points=i,this._innerRadius=r,this._outerRadius=s,this.setPosition(e,n),this.setSize(2*s,2*s),void 0!==a&&this.setFillStyle(a,h),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,i=this._outerRadius,r=Math.PI/2*3,o=Math.PI/e,a=i,h=i;t.push(a,h+-i);for(var u=0;u<e;u++)t.push(a+Math.cos(r)*i,h+Math.sin(r)*i),r+=o,t.push(a+Math.cos(r)*n,h+Math.sin(r)*n),r+=o;return t.push(a,h+-i),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(0),r=n(34),s=n(83),o=n(1124),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,h,u,c,l,f){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=128),void 0===a&&(a=64),void 0===h&&(h=0),void 0===u&&(u=128),void 0===c&&(c=128),r.call(this,t,"Triangle",new s(i,o,a,h,u,c));var d=this.geom.right-this.geom.left,p=this.geom.bottom-this.geom.top;this.setPosition(e,n),this.setSize(d,p),void 0!==l&&this.setFillStyle(l,f),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,n,i,r,s){return this.geom.setTo(t,e,n,i,r,s),this.updateData()},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(4),r=n(66);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();if(e<=0||e>=1)return n.x=s.x1,n.y=s.y1,n;var h=r(s),u=r(o),c=r(a),l=(h+u+c)*e,f=0;return l<h?(f=l/h,n.x=s.x1+(s.x2-s.x1)*f,n.y=s.y1+(s.y2-s.y1)*f):l>h+u?(f=(l-=h+u)/c,n.x=a.x1+(a.x2-a.x1)*f,n.y=a.y1+(a.y2-a.y1)*f):(f=(l-=h)/u,n.x=o.x1+(o.x2-o.x1)*f,n.y=o.y1+(o.y2-o.y1)*f),n}},function(t,e,n){var i=n(66),r=n(4);t.exports=function(t,e,n,s){void 0===s&&(s=[]);var o=t.getLineA(),a=t.getLineB(),h=t.getLineC(),u=i(o),c=i(a),l=i(h),f=u+c+l;!e&&n>0&&(e=f/n);for(var d=0;d<e;d++){var p=f*(d/e),v=0,g=new r;p<u?(v=p/u,g.x=o.x1+(o.x2-o.x1)*v,g.y=o.y1+(o.y2-o.y1)*v):p>u+c?(v=(p-=u+c)/l,g.x=h.x1+(h.x2-h.x1)*v,g.y=h.y1+(h.y2-h.y1)*v):(v=(p-=u)/c,g.x=a.x1+(a.x2-a.x1)*v,g.y=a.y1+(a.y2-a.y1)*v),s.push(g)}return s}},function(t,e){t.exports=function(t,e,n){if(!t||"number"==typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=n,!0;if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=t,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o]))return!1;s=r,r=r[i[o]]}return s[i[i.length-1]]=n,!0}return!1}},function(t,e,n){var i=n(116),r=n(118);t.exports=function(t,e,n,s,o,a,h){if(void 0===s&&(s=!1),void 0===a&&(a=16777215),void 0===h&&(h=1),t.length===e.length){var u,c,l,f,d,p,v,g,m,y,x,b={faces:[],vertices:[]},w=s?3:2,_=Array.isArray(a),T=Array.isArray(h);if(Array.isArray(n)&&n.length>0)for(u=0;u<n.length;u++){var E=n[u],S=2*n[u],C=n[u]*w;c=t[C],l=t[C+1],f=s?t[C+2]:0,d=e[S],p=e[S+1],v=_?a[E]:a,g=T?h[E]:h,m=0,y=0,x=0,o&&(m=o[C],y=o[C+1],x=s?o[C+2]:0),b.vertices.push(new r(c,l,f,d,p,v,g,m,y,x))}else{var A=0,I=0;for(u=0;u<t.length;u+=w)c=t[u],l=t[u+1],f=s?t[u+2]:0,d=e[A],p=e[A+1],v=_?a[I]:a,g=T?h[I]:h,m=0,y=0,x=0,o&&(m=o[u],y=o[u+1],x=s?o[u+2]:0),b.vertices.push(new r(c,l,f,d,p,v,g,m,y,x)),A+=2,I++}for(u=0;u<b.vertices.length;u+=3){var P=b.vertices[u],R=b.vertices[u+1],O=b.vertices[u+2];b.faces.push(new i(P,R,O))}return b}console.warn("GenerateVerts: vertices and uvs count not equal")}},function(t,e,n){var i=n(116),r=n(69),s=n(39),o=n(118),a=new s,h=new s,u=new r;t.exports=function(t,e,n,r,s,c,l,f,d,p){void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===c&&(c=0),void 0===l&&(l=0),void 0===f&&(f=0),void 0===d&&(d=0),void 0===p&&(p=!0);var v={faces:[],verts:[]},g=t.materials;a.set(r,s,c),h.set(l,f,d),u.fromRotationXYTranslation(h,a,p);for(var m=0;m<t.models.length;m++)for(var y=t.models[m],x=y.vertices,b=y.textureCoords,w=y.faces,_=0;_<w.length;_++){var T=w[_],E=T.vertices[0],S=T.vertices[1],C=T.vertices[2],A=x[E.vertexIndex],I=x[S.vertexIndex],P=x[C.vertexIndex],R=E.textureCoordsIndex,O=S.textureCoordsIndex,k=C.textureCoordsIndex,M=-1===R?{u:0,v:1}:b[R],D=-1===O?{u:0,v:0}:b[O],L=-1===k?{u:1,v:1}:b[k],N=16777215;""!==T.material&&g[T.material]&&(N=g[T.material]);var F=new o(A.x*n,A.y*n,A.z*n,M.u,M.v,N).transformMat4(u),B=new o(I.x*n,I.y*n,I.z*n,D.u,D.v,N).transformMat4(u),U=new o(P.x*n,P.y*n,P.z*n,L.u,L.v,N).transformMat4(u);v.verts.push(F,B,U),v.faces.push(new i(F,B,U))}return e&&(e.faces=e.faces.concat(v.faces),e.vertices=e.vertices.concat(v.verts)),v}},function(t,e,n){var i=n(64),r=n(0),s=n(11),o=n(200),a=n(12),h=new r({Extends:i,Mixins:[s.ScrollFactor,s.Visible],initialize:function(t,e,n,r,s,a,h){i.call(this,t,e,n),this.color=new o(r,s,a),this.intensity=h,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1)},willRender:function(t){return!(h.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setColor:function(t){var e=a.getFloatsFromUintRGB(t);return this.color.set(e[0],e[1],e[2]),this},setIntensity:function(t){return this.intensity=t,this},setRadius:function(t){return this.radius=t,this}});h.RENDER_MASK=15,t.exports=h},function(t,e,n){var i=n(152),r=n(0),s=n(50),o=n(481),a=n(151),h=n(200),u=n(75),c=n(80),l=n(12),f=new r({initialize:function(){this.lights=[],this.ambientColor=new h(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(t,e,n,i,r,s){return this.systems.displayList.add(new a(this.scene,t,e,n,i,r,s))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(t){for(var e=this.lights,n=t.worldView,r=[],o=0;o<e.length;o++){var a=e[o];a.willRender(t)&&i(a,n)&&r.push({light:a,distance:s(a.x,a.y,n.centerX,n.centerY)})}return r.length>this.maxLights&&(c(r,this.sortByDistance),r=r.slice(0,this.maxLights)),this.visibleLights=r.length,r},sortByDistance:function(t,e){return t.distance>=e.distance},setAmbientColor:function(t){var e=l.getFloatsFromUintRGB(t);return this.ambientColor.set(e[0],e[1],e[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=128),void 0===i&&(i=16777215),void 0===r&&(r=1);var s=l.getFloatsFromUintRGB(i),a=new o(t,e,n,s[0],s[1],s[2],r);return this.lights.push(a),a},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&u(this.lights,e),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}});t.exports=f},function(t,e,n){var i=n(56),r=n(17),s={Circle:n(1188),Ellipse:n(1198),Intersects:n(484),Line:n(1218),Mesh:n(1240),Point:n(1243),Polygon:n(1257),Rectangle:n(502),Triangle:n(1290)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={CircleToCircle:n(231),CircleToRectangle:n(152),GetCircleToCircle:n(1208),GetCircleToRectangle:n(1209),GetLineToCircle:n(232),GetLineToLine:n(485),GetLineToPoints:n(486),GetLineToPolygon:n(487),GetLineToRectangle:n(234),GetRaysFromPointToPolygon:n(1210),GetRectangleIntersection:n(1211),GetRectangleToRectangle:n(1212),GetRectangleToTriangle:n(1213),GetTriangleToCircle:n(1214),GetTriangleToLine:n(492),GetTriangleToTriangle:n(1215),LineToCircle:n(233),LineToLine:n(96),LineToRectangle:n(488),PointToLine:n(496),PointToLineSegment:n(1216),RectangleToRectangle:n(117),RectangleToTriangle:n(489),RectangleToValues:n(1217),TriangleToCircle:n(491),TriangleToLine:n(493),TriangleToTriangle:n(494)}},function(t,e,n){var i=n(39);t.exports=function(t,e,n){var r=t.x1,s=t.y1,o=t.x2,a=t.y2,h=e.x1,u=e.y1,c=o-r,l=a-s,f=e.x2-h,d=e.y2-u;if(0===c||0==d*c-f*l)return!1;var p=(c*(u-s)+l*(r-h))/(f*l-d*c),v=(h+f*p-r)/c;return v<0||p<0||p>1?null:(void 0===n&&(n=new i),n.set(r+c*v,s+l*v,v))}},function(t,e,n){var i=n(39),r=n(485),s=new(n(47)),o=new i;t.exports=function(t,e,n){void 0===n&&(n=new i);var a=!1;n.set(),o.set();for(var h=e[0],u=1;u<e.length;u++){var c=e[u];s.setTo(h.x,h.y,c.x,c.y),h=c,r(t,s,o)&&(!a||o.z<n.z)&&(n.copy(o),a=!0)}return a?n:null}},function(t,e,n){var i=n(39),r=n(141),s=n(486),o=new i;t.exports=function(t,e,n){void 0===n&&(n=new r),Array.isArray(e)||(e=[e]);var i=!1;n.set(),o.set();for(var a=0;a<e.length;a++)s(t,e[a].points,o)&&(!i||o.z<n.z)&&(n.set(o.x,o.y,o.z,a),i=!0);return i?n:null}},function(t,e){t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=e.x,a=e.y,h=e.right,u=e.bottom,c=0;if(n>=o&&n<=h&&i>=a&&i<=u||r>=o&&r<=h&&s>=a&&s<=u)return!0;if(n<o&&r>=o){if((c=i+(s-i)*(o-n)/(r-n))>a&&c<=u)return!0}else if(n>h&&r<=h&&(c=i+(s-i)*(h-n)/(r-n))>=a&&c<=u)return!0;if(i<a&&s>=a){if((c=n+(r-n)*(a-i)/(s-i))>=o&&c<=h)return!0}else if(i>u&&s<=u&&(c=n+(r-n)*(u-i)/(s-i))>=o&&c<=h)return!0;return!1}},function(t,e,n){var i=n(96),r=n(57),s=n(235),o=n(490);t.exports=function(t,e){if(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)return!1;var n=e.getLineA(),a=e.getLineB(),h=e.getLineC();if(r(t,n.x1,n.y1)||r(t,n.x2,n.y2))return!0;if(r(t,a.x1,a.y1)||r(t,a.x2,a.y2))return!0;if(r(t,h.x1,h.y1)||r(t,h.x2,h.y2))return!0;var u=t.getLineA(),c=t.getLineB(),l=t.getLineC(),f=t.getLineD();if(i(n,u)||i(n,c)||i(n,l)||i(n,f))return!0;if(i(a,u)||i(a,c)||i(a,l)||i(a,f))return!0;if(i(h,u)||i(h,c)||i(h,l)||i(h,f))return!0;var d=o(t);return s(e,d,!0).length>0}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e}},function(t,e,n){var i=n(233),r=n(115);t.exports=function(t,e){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top||!r(t,e.x,e.y)&&!i(t.getLineA(),e)&&!i(t.getLineB(),e)&&!i(t.getLineC(),e))}},function(t,e,n){var i=n(4),r=n(493),s=n(96);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e))for(var o=t.getLineA(),a=t.getLineB(),h=t.getLineC(),u=[new i,new i,new i],c=[s(o,e,u[0]),s(a,e,u[1]),s(h,e,u[2])],l=0;l<3;l++)c[l]&&n.push(u[l]);return n}},function(t,e,n){var i=n(96);t.exports=function(t,e){return!!(t.contains(e.x1,e.y1)||t.contains(e.x2,e.y2)||i(t.getLineA(),e)||i(t.getLineB(),e)||i(t.getLineC(),e))}},function(t,e,n){var i=n(235),r=n(495),s=n(96);t.exports=function(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;var n=t.getLineA(),o=t.getLineB(),a=t.getLineC(),h=e.getLineA(),u=e.getLineB(),c=e.getLineC();if(s(n,h)||s(n,u)||s(n,c))return!0;if(s(o,h)||s(o,u)||s(o,c))return!0;if(s(a,h)||s(a,u)||s(a,c))return!0;var l=r(t),f=i(e,l,!0);return f.length>0||(l=r(e),(f=i(t,l,!0)).length>0)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=1);var i=e.x1,r=e.y1,s=e.x2,o=e.y2,a=t.x,h=t.y,u=(s-i)*(s-i)+(o-r)*(o-r);if(0===u)return!1;var c=((a-i)*(s-i)+(h-r)*(o-r))/u;if(c<0)return Math.sqrt((i-a)*(i-a)+(r-h)*(r-h))<=n;if(c>=0&&c<=1){var l=((r-h)*(s-i)-(i-a)*(o-r))/u;return Math.abs(l)*Math.sqrt(u)<=n}return Math.sqrt((s-a)*(s-a)+(o-h)*(o-h))<=n}},function(t,e,n){var i=n(14),r=n(68),s=n(97);t.exports=function(t){var e=s(t)-i.TAU;return r(e,-Math.PI,Math.PI)}},function(t,e){var n=!0,i="untitled",r="",s="";function o(t){return 0===t.models.length&&t.models.push({faces:[],name:i,textureCoords:[],vertexNormals:[],vertices:[]}),r="",t.models[t.models.length-1]}function a(t,e){var n=t.length>=2?t[1]:i;e.models.push({faces:[],name:n,textureCoords:[],vertexNormals:[],vertices:[]}),r=""}function h(t){2===t.length&&(r=t[1])}function u(t,e){var n=t.length,i=n>=2?parseFloat(t[1]):0,r=n>=3?parseFloat(t[2]):0,s=n>=4?parseFloat(t[3]):0;o(e).vertices.push({x:i,y:r,z:s})}function c(t,e){var i=t.length,r=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;isNaN(r)&&(r=0),isNaN(s)&&(s=0),isNaN(a)&&(a=0),n&&(s=1-s),o(e).textureCoords.push({u:r,v:s,w:a})}function l(t,e){var n=t.length,i=n>=2?parseFloat(t[1]):0,r=n>=3?parseFloat(t[2]):0,s=n>=4?parseFloat(t[3]):0;o(e).vertexNormals.push({x:i,y:r,z:s})}function f(t,e){var n=t.length-1;if(!(n<3)){for(var i={group:r,material:s,vertices:[]},a=0;a<n;a++){var h=t[a+1].split("/"),u=h.length;if(!(u<1||u>3)){var c=0,l=0,f=0;c=parseInt(h[0],10),u>1&&""!==h[1]&&(l=parseInt(h[1],10)),u>2&&(f=parseInt(h[2],10)),0!==c&&(c<0&&(c=o(e).vertices.length+1+c),l-=1,c-=1,f-=1,i.vertices.push({textureCoordsIndex:l,vertexIndex:c,vertexNormalIndex:f}))}}o(e).faces.push(i)}}function d(t,e){t.length>=2&&e.materialLibraries.push(t[1])}function p(t){t.length>=2&&(s=t[1])}t.exports=function(t,e){void 0===e&&(e=!0),n=e;var i,o,v={materials:{},materialLibraries:[],models:[]};r="",s="";for(var g=t.split("\n"),m=0;m<g.length;m++){var y=(i=g[m],o=void 0,o=i.indexOf("#"),o>-1?i.substring(0,o):i).replace(/\s\s+/g," ").trim().split(" ");switch(y[0].toLowerCase()){case"o":a(y,v);break;case"g":h(y);break;case"v":u(y,v);break;case"vt":c(y,v);break;case"vn":l(y,v);break;case"f":f(y,v);break;case"mtllib":d(y,v);break;case"usemtl":p(y)}}return v}},function(t,e,n){var i=n(103);t.exports=function(t){for(var e={},n=t.split("\n"),r="",s=0;s<n.length;s++){var o=n[s].trim();if(0!==o.indexOf("#")&&""!==o){var a=o.replace(/\s\s+/g," ").trim().split(" ");switch(a[0].toLowerCase()){case"newmtl":r=a[1];break;case"kd":var h=Math.floor(255*a[1]),u=a.length>=2?Math.floor(255*a[2]):h,c=a.length>=3?Math.floor(255*a[3]):h;e[r]=i(h,u,c)}}}return e}},function(t,e){t.exports=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},function(t,e){t.exports=function(t){return t.x*t.x+t.y*t.y}},function(t,e,n){var i=n(10);i.Area=n(1264),i.Ceil=n(1265),i.CeilAll=n(1266),i.CenterOn=n(190),i.Clone=n(1267),i.Contains=n(57),i.ContainsPoint=n(1268),i.ContainsRect=n(503),i.CopyFrom=n(1269),i.Decompose=n(490),i.Equals=n(1270),i.FitInside=n(1271),i.FitOutside=n(1272),i.Floor=n(1273),i.FloorAll=n(1274),i.FromPoints=n(199),i.FromXY=n(1275),i.GetAspectRatio=n(237),i.GetCenter=n(1276),i.GetPoint=n(171),i.GetPoints=n(306),i.GetSize=n(1277),i.Inflate=n(1278),i.Intersection=n(1279),i.MarchingAnts=n(316),i.MergePoints=n(1280),i.MergeRect=n(1281),i.MergeXY=n(1282),i.Offset=n(1283),i.OffsetPoint=n(1284),i.Overlaps=n(1285),i.Perimeter=n(131),i.PerimeterPoint=n(1286),i.Random=n(174),i.RandomOutside=n(1287),i.SameDimensions=n(1288),i.Scale=n(1289),i.Union=n(441),t.exports=i},function(t,e){t.exports=function(t,e){return!(e.width*e.height>t.width*t.height)&&e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2+t.x3)/3,e.y=(t.y1+t.y2+t.y3)/3,e}},function(t,e){t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t.x3+=e,t.y3+=n,t}},function(t,e,n){var i=n(4);function r(t,e,n,i){var r=t-n,s=e-i,o=r*r+s*s;return Math.sqrt(o)}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x1,s=t.y1,o=t.x2,a=t.y2,h=t.x3,u=t.y3,c=r(h,u,o,a),l=r(n,s,h,u),f=r(o,a,n,s),d=c+l+f;return e.x=(n*c+o*l+h*f)/d,e.y=(s*c+a*l+u*f)/d,e}},function(t,e){t.exports=function(t,e){return function(n,i,r,s){var o=t.getPixelAlpha(i,r,s.texture.key,s.frame.name);return o&&o>=e}}},function(t,e){t.exports=function(t,e,n){return{gameObject:t,enabled:!0,alwaysEnabled:!1,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:n,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragX:0,dragY:0}}},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});t.exports=i},function(t,e,n){var i=n(0),r=n(239),s=new i({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var e=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(r.BUTTON_DOWN,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(r.BUTTON_UP,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});t.exports=s},function(t,e,n){var i=n(509),r=n(510),s=n(0),o=n(9),a=n(3),h=new s({Extends:o,initialize:function(t,e){o.call(this),this.manager=t,this.pad=e,this.id=e.id,this.index=e.index;for(var n=[],s=0;s<e.buttons.length;s++)n.push(new r(this,s));this.buttons=n;var h=[];for(s=0;s<e.axes.length;s++)h.push(new i(this,s));this.axes=h,this.vibration=e.vibrationActuator;var u={value:0,pressed:!1};this._LCLeft=n[14]?n[14]:u,this._LCRight=n[15]?n[15]:u,this._LCTop=n[12]?n[12]:u,this._LCBottom=n[13]?n[13]:u,this._RCLeft=n[2]?n[2]:u,this._RCRight=n[1]?n[1]:u,this._RCTop=n[3]?n[3]:u,this._RCBottom=n[0]?n[0]:u,this._FBLeftTop=n[4]?n[4]:u,this._FBLeftBottom=n[6]?n[6]:u,this._FBRightTop=n[5]?n[5]:u,this._FBRightBottom=n[7]?n[7]:u;var c={value:0};this._HAxisLeft=h[0]?h[0]:c,this._VAxisLeft=h[1]?h[1]:c,this._HAxisRight=h[2]?h[2]:c,this._VAxisRight=h[3]?h[3]:c,this.leftStick=new a,this.rightStick=new a,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){if(!(t.timestamp<this._created)){var e,n=this.buttons,i=t.buttons,r=n.length;for(e=0;e<r;e++)n[e].update(i[e].value);var s=this.axes,o=t.axes;for(r=s.length,e=0;e<r;e++)s[e].update(o[e]);r>=2&&(this.leftStick.set(s[0].getValue(),s[1].getValue()),r>=4&&this.rightStick.set(s[2].getValue(),s[3].getValue()))}},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});t.exports=h},function(t,e,n){var i=n(0),r=n(9),s=n(154),o=new i({Extends:r,initialize:function(t,e){r.call(this),this.plugin=t,this.keyCode=e,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(s.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(s.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(s.UP,this,t))},reset:function(){return this.preventDefault=!0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(154),s=n(2),o=n(514),a=n(516),h=new i({initialize:function(t,e,n){if(void 0===n&&(n={}),e.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var i=0;i<e.length;i++){var h=e[i];"string"==typeof h?this.keyCodes.push(h.toUpperCase().charCodeAt(0)):"number"==typeof h?this.keyCodes.push(h):h.hasOwnProperty("keyCode")&&this.keyCodes.push(h.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=s(n,"resetOnWrongKey",!0),this.maxKeyDelay=s(n,"maxKeyDelay",0),this.resetOnMatch=s(n,"resetOnMatch",!1),this.deleteOnMatch=s(n,"deleteOnMatch",!1);var u=this;this.onKeyDown=function(t){!u.matched&&u.enabled&&o(t,u)&&(u.manager.emit(r.COMBO_MATCH,u,t),u.resetOnMatch?a(u):u.deleteOnMatch&&u.destroy())},this.manager.on(r.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(r.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});t.exports=h},function(t,e,n){var i=n(515);t.exports=function(t,e){if(e.matched)return!0;var n=!1,r=!1;if(t.keyCode===e.current)if(e.index>0&&e.maxKeyDelay>0){var s=e.timeLastMatched+e.maxKeyDelay;t.timeStamp<=s&&(r=!0,n=i(t,e))}else r=!0,n=i(t,e);return!r&&e.resetOnWrongKey&&(e.index=0,e.current=e.keyCodes[0]),n&&(e.timeLastMatched=t.timeStamp,e.matched=!0,e.timeMatched=t.timeStamp),n}},function(t,e){t.exports=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)}},function(t,e){t.exports=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t}},function(t,e,n){var i=n(240);t.exports=function(t,e){var n=i(e,t.xhrSettings),r=new XMLHttpRequest;if(r.open("GET",t.src,n.async,n.user,n.password),r.responseType=t.xhrSettings.responseType,r.timeout=n.timeout,n.headers)for(var s in n.headers)r.setRequestHeader(s,n.headers[s]);return n.header&&n.headerValue&&r.setRequestHeader(n.header,n.headerValue),n.requestedWith&&r.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&r.overrideMimeType(n.overrideMimeType),n.withCredentials&&(r.withCredentials=!0),r.onload=t.onLoad.bind(t,r),r.onerror=t.onError.bind(t,r),r.onprogress=t.onProgress.bind(t),r.send(),r}},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(519),u=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,r){if(u(e)){var o=e;e=a(o,"key"),i=a(o,"xhrSettings"),r=a(o,"context",r)}var h={type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:i,config:{context:r}};s.call(this,t,h)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,(function(e){t.data=e,t.onProcessComplete()}),(function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()})),this.config.context=null}});c.create=function(t,e,n,i,r){var s=t.systems.game,o=s.config.audio,l=s.device.audio;u(e)&&(n=a(e,"url",[]),i=a(e,"config",{}));var f=c.getAudioURL(s,n);return f?l.webAudio&&!o.disableWebAudio?new c(t,e,f,r,s.sound.context):new h(t,e,f,i):null},c.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=a(e[n],"url",e[n]);if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return{url:i,type:""};var r=i.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=a(e[n],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:i,type:r}}return null},o.register("audio",(function(t,e,n,i){var r,s=this.systems.game,o=s.config.audio,a=s.device.audio;if(o.noAudio||!a.webAudio&&!a.audioData)return this;if(Array.isArray(t))for(var h=0;h<t.length;h++)(r=c.create(this,t[h]))&&this.addFile(r);else(r=c.create(this,t,e,n,i))&&this.addFile(r);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(95),s=n(23),o=n(2),a=n(155),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){if(h(e)){var r=e;e=o(r,"key"),i=o(r,"config",i)}var a={type:"audio",cache:t.cacheManager.audio,extension:n.type,key:e,url:n.url,config:i};s.call(this,t,a),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var e=t.target;e.oncanplaythrough=null,e.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(r.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var n=new Audio;n.dataset||(n.dataset={}),n.dataset.name=this.key+("0"+e).slice(-2),n.dataset.used="false",this.locked?n.dataset.locked="true":(n.dataset.locked="false",n.preload="auto",n.oncanplaythrough=this.onProgress.bind(this),n.onerror=this.onError.bind(this)),this.data.push(n)}for(e=0;e<this.data.length;e++)(n=this.data[e]).src=a(this,this.loader.baseURL),this.locked||n.load();this.locked&&setTimeout(this.onLoad.bind(this))}});t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){var r="js";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"script",cache:!1,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("script",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e,n){var i=n(522),r=n(157),s=n(0),o=n(61),a=n(524),h=n(525),u=new s({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,n,i,r){return this.world.addCollider(t,e,n,i,r)},overlap:function(t,e,n,i,r){return this.world.addOverlap(t,e,n,i,r)},existing:function(t,e){var n=e?o.STATIC_BODY:o.DYNAMIC_BODY;return this.world.enableBody(t,n),t},staticImage:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,o.STATIC_BODY),s},image:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,o.DYNAMIC_BODY),s},staticSprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,o.STATIC_BODY),s},sprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,o.DYNAMIC_BODY),s},staticGroup:function(t,e){return this.sys.updateList.add(new h(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new a(this.world,this.world.scene,t,e))},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=u},function(t,e,n){var i=n(0),r=n(243),s=n(126),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Pushable,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},function(t,e,n){var i=n(244),r=n(64),s=n(231),o=n(152);t.exports=function(t,e,n,a,h,u){var c=i(t,e-a,n-a,2*a,2*a,h,u);if(0===c.length)return c;for(var l=new r(e,n,a),f=new r,d=[],p=0;p<c.length;p++){var v=c[p];v.isCircle?(f.setTo(v.center.x,v.center.y,v.halfWidth),s(l,f)&&d.push(v)):o(l,v)&&d.push(v)}return d}},function(t,e,n){var i=n(157),r=n(0),s=n(61),o=n(2),a=n(113),h=n(7),u=new r({Extends:a,initialize:function(t,e,n,r){if(n||r)if(h(n))r=n,n=null,r.internalCreateCallback=this.createCallbackHandler,r.internalRemoveCallback=this.removeCallbackHandler;else if(Array.isArray(n)&&h(n[0])){r=n[0];var u=this;n.forEach((function(t){t.internalCreateCallback=u.createCallbackHandler,t.internalRemoveCallback=u.removeCallbackHandler})),n=null}else r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};else r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};this.world=t,r.classType=o(r,"classType",i),this.physicsType=s.DYNAMIC_BODY,this.defaults={setCollideWorldBounds:o(r,"collideWorldBounds",!1),setBoundsRectangle:o(r,"customBoundsRectangle",null),setAccelerationX:o(r,"accelerationX",0),setAccelerationY:o(r,"accelerationY",0),setAllowDrag:o(r,"allowDrag",!0),setAllowGravity:o(r,"allowGravity",!0),setAllowRotation:o(r,"allowRotation",!0),setBounceX:o(r,"bounceX",0),setBounceY:o(r,"bounceY",0),setDragX:o(r,"dragX",0),setDragY:o(r,"dragY",0),setEnable:o(r,"enable",!0),setGravityX:o(r,"gravityX",0),setGravityY:o(r,"gravityY",0),setFrictionX:o(r,"frictionX",0),setFrictionY:o(r,"frictionY",0),setMaxVelocityX:o(r,"maxVelocityX",1e4),setMaxVelocityY:o(r,"maxVelocityY",1e4),setVelocityX:o(r,"velocityX",0),setVelocityY:o(r,"velocityY",0),setAngularVelocity:o(r,"angularVelocity",0),setAngularAcceleration:o(r,"angularAcceleration",0),setAngularDrag:o(r,"angularDrag",0),setMass:o(r,"mass",1),setImmovable:o(r,"immovable",!1)},a.call(this,e,n,r),this.type="PhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,s.DYNAMIC_BODY);var e=t.body;for(var n in this.defaults)e[n](this.defaults[n])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,n){void 0===n&&(n=0);for(var i=this.getChildren(),r=0;r<i.length;r++)i[r].body.velocity.set(t+r*n,e+r*n);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.x=t+i*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.y=t+i*e;return this}});t.exports=u},function(t,e,n){var i=n(157),r=n(0),s=n(61),o=n(2),a=n(113),h=n(7),u=new r({Extends:a,initialize:function(t,e,n,r){n||r?h(n)?(r=n,n=null,r.internalCreateCallback=this.createCallbackHandler,r.internalRemoveCallback=this.removeCallbackHandler,r.createMultipleCallback=this.createMultipleCallbackHandler,r.classType=o(r,"classType",i)):Array.isArray(n)&&h(n[0])?(r=n,n=null,r.forEach((function(t){t.internalCreateCallback=this.createCallbackHandler,t.internalRemoveCallback=this.removeCallbackHandler,t.createMultipleCallback=this.createMultipleCallbackHandler,t.classType=o(t,"classType",i)}))):r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:i},this.world=t,this.physicsType=s.STATIC_BODY,a.call(this,e,n,r),this.type="StaticPhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,s.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});t.exports=u},function(t,e,n){var i=n(350),r=n(527),s=n(18),o=n(0),a=n(528),h=n(61),u=n(50),c=n(9),l=n(245),f=n(125),d=n(354),p=n(355),v=n(246),g=n(247),m=n(529),y=n(6),x=n(14),b=n(211),w=n(530),_=n(10),T=n(531),E=n(532),S=n(537),C=n(538),A=n(150),I=n(539),P=n(248),R=n(25),O=n(3),k=n(68),M=new o({Extends:c,initialize:function(t,e){c.call(this),this.scene=t,this.bodies=new A,this.staticBodies=new A,this.pendingDestroy=new A,this.colliders=new b,this.gravity=new O(y(e,"gravity.x",0),y(e,"gravity.y",0)),this.bounds=new _(y(e,"x",0),y(e,"y",0),y(e,"width",t.sys.scale.width),y(e,"height",t.sys.scale.height)),this.checkCollision={up:y(e,"checkCollision.up",!0),down:y(e,"checkCollision.down",!0),left:y(e,"checkCollision.left",!0),right:y(e,"checkCollision.right",!0)},this.fps=y(e,"fps",60),this.fixedStep=y(e,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=y(e,"timeScale",1),this.OVERLAP_BIAS=y(e,"overlapBias",4),this.TILE_BIAS=y(e,"tileBias",16),this.forceX=y(e,"forceX",!1),this.isPaused=y(e,"isPaused",!1),this._total=0,this.drawDebug=y(e,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:y(e,"debugShowBody",!0),debugShowStaticBody:y(e,"debugShowStaticBody",!0),debugShowVelocity:y(e,"debugShowVelocity",!0),bodyDebugColor:y(e,"debugBodyColor",16711935),staticBodyDebugColor:y(e,"debugStaticBodyColor",255),velocityDebugColor:y(e,"debugVelocityColor",65280)},this.maxEntries=y(e,"maxEntries",16),this.useTree=y(e,"useTree",!0),this.tree=new T(this.maxEntries),this.staticTree=new T(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new R,this._tempMatrix2=new R,this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=h.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.isParent)for(var r=i.getChildren(),s=0;s<r.length;s++){var o=r[s];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(i,e)}},enableBody:function(t,e){return void 0===e&&(e=h.DYNAMIC_BODY),t.body||(e===h.DYNAMIC_BODY?t.body=new r(this,t):e===h.STATIC_BODY&&(t.body=new I(this,t))),this.add(t.body),t},add:function(t){return t.physicsType===h.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===h.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];if(n.isParent)for(var i=n.getChildren(),r=0;r<i.length;r++){var s=i[r];s.isParent?this.disable(s):this.disableBody(s.body)}else this.disableBody(n.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===h.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===h.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,n,i,r,s,o,a){return this.bounds.setTo(t,e,n,i),void 0!==r&&this.setBoundsCollision(r,s,o,a),this},setBoundsCollision:function(t,e,n,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=n,this.checkCollision.down=i,this},pause:function(){return this.isPaused=!0,this.emit(l.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(l.RESUME),this},addCollider:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new a(this,!1,t,e,n,i,r);return this.colliders.add(s),s},addOverlap:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new a(this,!0,t,e,n,i,r);return this.colliders.add(s),s},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var n,i,r=this._frameTime,s=this._frameTimeMS*this.timeScale;this._elapsed+=e;var o=this.bodies.entries,a=this._elapsed>=s;for(this.fixedStep||(r=.001*e,a=!0,this._elapsed=0),n=0;n<o.length;n++)(i=o[n]).enable&&i.preUpdate(a,r);if(a){this._elapsed-=s,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(o));var h=this.colliders.update();for(n=0;n<h.length;n++){var u=h[n];u.active&&u.update()}this.emit(l.WORLD_STEP,r)}for(;this._elapsed>=s;)this._elapsed-=s,this.step(r)}},step:function(t){var e,n,i=this.bodies.entries,r=i.length;for(e=0;e<r;e++)(n=i[e]).enable&&n.update(t);this.useTree&&(this.tree.clear(),this.tree.load(i));var s=this.colliders.update();for(e=0;e<s.length;e++){var o=s[e];o.active&&o.update()}this.emit(l.WORLD_STEP,t),this.stepsLastFrame++},postUpdate:function(){var t,e,n=this.bodies.entries,i=n.length,r=this.bodies,s=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<i;t++)(e=n[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o);for(i=(n=s.entries).length,t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o)}var a=this.pendingDestroy;if(a.size>0){var u=this.tree,c=this.staticTree;for(i=(n=a.entries).length,t=0;t<i;t++)(e=n[t]).physicsType===h.DYNAMIC_BODY?(u.remove(e),r.delete(e)):e.physicsType===h.STATIC_BODY&&(c.remove(e),s.delete(e)),e.world=void 0,e.gameObject=void 0;a.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,i=t.angularAcceleration,r=t.angularDrag,o=t.maxAngular;i?n+=i*e:t.allowDrag&&r&&(d(n-(r*=e),0,.1)?n-=r:p(n+r,0,.1)?n+=r:n=0);var a=(n=s(n,-o,o))-t.angularVelocity;t.angularVelocity+=a,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,i=t.acceleration.x,r=t.drag.x,o=t.maxVelocity.x,a=t.velocity.y,h=t.acceleration.y,u=t.drag.y,c=t.maxVelocity.y,l=t.speed,v=t.maxSpeed,g=t.allowDrag,m=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,a+=(this.gravity.y+t.gravity.y)*e),i?n+=i*e:g&&r&&(m?(n*=r=Math.pow(r,e),l=Math.sqrt(n*n+a*a),f(l,0,.001)&&(n=0)):d(n-(r*=e),0,.01)?n-=r:p(n+r,0,.01)?n+=r:n=0),h?a+=h*e:g&&u&&(m?(a*=u=Math.pow(u,e),l=Math.sqrt(n*n+a*a),f(l,0,.001)&&(a=0)):d(a-(u*=e),0,.01)?a-=u:p(a+u,0,.01)?a+=u:a=0),n=s(n,-o,o),a=s(a,-c,c),t.velocity.set(n,a),v>-1&&l>v&&(t.velocity.normalize().scale(v),l=v),t.speed=l},separate:function(t,e,n,i,r,s){if(!s&&!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e))return!1;if(n&&!1===n.call(i,t.gameObject,e.gameObject))return!1;if(t.isCircle&&e.isCircle)return this.separateCircle(t,e,r);if(t.isCircle!==e.isCircle){var o=t.isCircle?e:t,a=t.isCircle?t:e,h={x:o.x,y:o.y,right:o.right,bottom:o.bottom},u=a.center;if((u.y<h.y||u.y>h.bottom)&&(u.x<h.x||u.x>h.right))return this.separateCircle(t,e,r)}var c=!1,f=!1;r?(c=S(t,e,r,this.OVERLAP_BIAS),f=C(t,e,r,this.OVERLAP_BIAS)):this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(c=S(t,e,r,this.OVERLAP_BIAS),this.intersects(t,e)&&(f=C(t,e,r,this.OVERLAP_BIAS))):(f=C(t,e,r,this.OVERLAP_BIAS),this.intersects(t,e)&&(c=S(t,e,r,this.OVERLAP_BIAS)));var d=c||f;return d&&(r?(t.onOverlap||e.onOverlap)&&this.emit(l.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(l.COLLIDE,t.gameObject,e.gameObject,t,e)),d},separateCircle:function(t,e,n,r){v(t,e,!1,r),g(t,e,!1,r);var s=0;if(t.isCircle!==e.isCircle){var o={x:e.isCircle?t.position.x:e.position.x,y:e.isCircle?t.position.y:e.position.y,right:e.isCircle?t.right:e.right,bottom:e.isCircle?t.bottom:e.bottom},a={x:t.isCircle?t.center.x:e.center.x,y:t.isCircle?t.center.y:e.center.y,radius:t.isCircle?t.halfWidth:e.halfWidth};a.y<o.y?a.x<o.x?s=u(a.x,a.y,o.x,o.y)-a.radius:a.x>o.right&&(s=u(a.x,a.y,o.right,o.y)-a.radius):a.y>o.bottom&&(a.x<o.x?s=u(a.x,a.y,o.x,o.bottom)-a.radius:a.x>o.right&&(s=u(a.x,a.y,o.right,o.bottom)-a.radius)),s*=-1}else s=t.halfWidth+e.halfWidth-u(t.center.x,t.center.y,e.center.x,e.center.y);if(t.overlapR=s,e.overlapR=s,n||0===s||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==s&&(t.onOverlap||e.onOverlap)&&this.emit(l.OVERLAP,t.gameObject,e.gameObject,t,e),0!==s;var h=t.center.x-e.center.x,c=t.center.y-e.center.y,f=Math.sqrt(Math.pow(h,2)+Math.pow(c,2)),d=(e.center.x-t.center.x)/f||0,p=(e.center.y-t.center.y)/f||0,m=2*(t.velocity.x*d+t.velocity.y*p-e.velocity.x*d-e.velocity.y*p)/(t.mass+e.mass);(t.immovable||e.immovable)&&(m*=2),t.immovable||(t.velocity.x=t.velocity.x-m/t.mass*d,t.velocity.y=t.velocity.y-m/t.mass*p),e.immovable||(e.velocity.x=e.velocity.x+m/e.mass*d,e.velocity.y=e.velocity.y+m/e.mass*p),t.immovable||e.immovable||(s/=2);var y=i(t.center,e.center),b=(s+x.EPSILON)*Math.cos(y),w=(s+x.EPSILON)*Math.sin(y);return t.immovable||(t.x-=b,t.y-=w,t.updateCenter()),e.immovable||(e.x+=b,e.y+=w,e.updateCenter()),t.velocity.x*=t.bounce.x,t.velocity.y*=t.bounce.y,e.velocity.x*=e.bounce.x,e.velocity.y*=e.bounce.y,(t.onCollide||e.onCollide)&&this.emit(l.COLLIDE,t.gameObject,e.gameObject,t,e),!0},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?u(t.center.x,t.center.y,e.center.x,e.center.y)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.position.x||t.bottom<=e.position.y||t.position.x>=e.right||t.position.y>=e.bottom))},circleBodyIntersects:function(t,e){var n=s(t.center.x,e.left,e.right),i=s(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-i)*(t.center.y-i)<=t.halfWidth*t.halfWidth},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!1)},collideObjects:function(t,e,n,i,r,s){var o,a;t.isParent&&void 0===t.physicsType&&(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var h=Array.isArray(t),u=Array.isArray(e);if(this._total=0,h||u)if(!h&&u)for(o=0;o<e.length;o++)this.collideHandler(t,e[o],n,i,r,s);else if(h&&!u)if(e)for(o=0;o<t.length;o++)this.collideHandler(t[o],e,n,i,r,s);else for(o=0;o<t.length;o++){var c=t[o];for(a=o+1;a<t.length;a++)o!==a&&this.collideHandler(c,t[a],n,i,r,s)}else for(o=0;o<t.length;o++)for(a=0;a<e.length;a++)this.collideHandler(t[o],e[a],n,i,r,s);else this.collideHandler(t,e,n,i,r,s);return this._total>0},collideHandler:function(t,e,n,i,r,s){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,n,i,r,s);if(!t||!e)return!1;if(t.body){if(e.body)return this.collideSpriteVsSprite(t,e,n,i,r,s);if(e.isParent)return this.collideSpriteVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,n,i,r,s)}else if(t.isParent){if(e.body)return this.collideSpriteVsGroup(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,n,i,r,s)}else if(t.isTilemap){if(e.body)return this.collideSpriteVsTilemapLayer(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,n,i,r,s)}},collideSpriteVsSprite:function(t,e,n,i,r,s){return!(!t.body||!e.body||(this.separate(t.body,e.body,i,r,s)&&(n&&n.call(r,t,e),this._total++),0))},collideSpriteVsGroup:function(t,e,n,i,r,s){var o,a,u,c=t.body;if(0!==e.length&&c&&c.enable&&!c.checkCollision.none)if(this.useTree||e.physicsType===h.STATIC_BODY){var l=this.treeMinMax;l.minX=c.left,l.minY=c.top,l.maxX=c.right,l.maxY=c.bottom;var f=e.physicsType===h.DYNAMIC_BODY?this.tree.search(l):this.staticTree.search(l);for(a=f.length,o=0;o<a;o++)c!==(u=f[o])&&u.enable&&!u.checkCollision.none&&e.contains(u.gameObject)&&this.separate(c,u,i,r,s,!0)&&(n&&n.call(r,c.gameObject,u.gameObject),this._total++)}else{var d=e.getChildren(),p=e.children.entries.indexOf(t);for(a=d.length,o=0;o<a;o++)(u=d[o].body)&&o!==p&&u.enable&&this.separate(c,u,i,r,s)&&(n&&n.call(r,c.gameObject,u.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,n,i,r,s){var o=t.getChildren();if(0===o.length)return!1;for(var a=!1,h=0;h<o.length;h++)o[h].body&&this.collideSpriteVsTilemapLayer(o[h],e,n,i,r,s)&&(a=!0);return a},collideTiles:function(t,e,n,i,r){return!(!t.body.enable||0===e.length)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!1,!1)},overlapTiles:function(t,e,n,i,r){return!(!t.body.enable||0===e.length)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,n,i,r,s){var o=t.body;if(!o.enable||o.checkCollision.none)return!1;var a=o.position.x,h=o.position.y,u=o.width,c=o.height,l=e.layer;if(l.tileWidth>l.baseTileWidth){var f=(l.tileWidth-l.baseTileWidth)*e.scaleX;a-=f,u+=f}l.tileHeight>l.baseTileHeight&&(c+=(l.tileHeight-l.baseTileHeight)*e.scaleY);var d=m(a,h,u,c,null,e.scene.cameras.main,e.layer);return 0!==d.length&&this.collideSpriteVsTilesHandler(t,d,n,i,r,s,!0)},collideSpriteVsTilesHandler:function(t,e,n,i,r,s,o){for(var a,h,u=t.body,c={left:0,right:0,top:0,bottom:0},f=!1,d=0;d<e.length;d++){var p=(h=(a=e[d]).tilemapLayer).tileToWorldXY(a.x,a.y);c.left=p.x,c.top=p.y,a.baseHeight!==a.height&&(c.top-=(a.height-a.baseHeight)*h.scaleY),c.right=c.left+a.width*h.scaleX,c.bottom=c.top+a.height*h.scaleY,P(c,u)&&(!i||i.call(r,t,a))&&w(a,t)&&(s||E(d,u,a,c,h,this.TILE_BIAS,o))&&(this._total++,f=!0,n&&n.call(r,t,a),s&&u.onOverlap?this.emit(l.TILE_OVERLAP,t,a,u):u.onCollide&&this.emit(l.TILE_COLLIDE,t,a,u))}return f},collideGroupVsGroup:function(t,e,n,i,r,s){if(0!==t.length&&0!==e.length)for(var o=t.getChildren(),a=0;a<o.length;a++)this.collideSpriteVsGroup(o[a],e,n,i,r,s)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var n=0;n<t.length;n++)this.wrapObject(t[n],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=k(t.x,this.bounds.left-e,this.bounds.right+e),t.y=k(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null}});t.exports=M},function(t,e,n){var i=n(0),r=n(61),s=n(245),o=n(196),a=n(10),h=n(57),u=n(3),c=new i({initialize:function(t,e){var n=e.displayWidth?e.displayWidth:64,i=e.displayHeight?e.displayHeight:64;this.world=t,this.gameObject=e,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new u,this.position=new u(e.x-e.scaleX*e.displayOriginX,e.y-e.scaleY*e.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=i,this.sourceWidth=n,this.sourceHeight=i,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(i/2),this.center=new u(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new u,this.newVelocity=new u,this.deltaMax=new u,this.acceleration=new u,this.allowDrag=!0,this.drag=new u,this.allowGravity=!0,this.gravity=new u,this.bounce=new u,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new u(1e4,1e4),this.maxSpeed=-1,this.friction=new u(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=r.FACING_NONE,this.immovable=!1,this.pushable=!0,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.syncBounds=!1,this.physicsType=r.DYNAMIC_BODY,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new a},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var n=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=n.tx,e.y=n.ty,e.rotation=o(n.rotation),e.scaleX=n.scaleX,e.scaleY=n.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var i=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,i=!0}else{var s=Math.abs(e.scaleX),a=Math.abs(e.scaleY);this._sx===s&&this._sy===a||(this.width=this.sourceWidth*s,this.height=this.sourceHeight*a,this._sx=s,this._sy=a,i=!0)}i&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var t=this.transform;this.position.x=t.x+t.scaleX*(this.offset.x-t.displayOriginX),this.position.y=t.y+t.scaleY*(this.offset.y-t.displayOriginY),this.updateCenter()},resetFlags:function(t){void 0===t&&(t=!1);var e=this.wasTouching,n=this.touching,i=this.blocked;t?(e.none=!0,e.up=!1,e.down=!1,e.left=!1,e.right=!1):(e.none=n.none,e.up=n.up,e.down=n.down,e.left=n.left,e.right=n.right),n.none=!0,n.up=!1,n.down=!1,n.left=!1,n.right=!1,i.none=!0,i.up=!1,i.down=!1,i.left=!1,i.right=!1,this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){t&&this.resetFlags(),this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves&&(this.prev.x=this.position.x,this.prev.y=this.position.y,this.prevFrame.x=this.position.x,this.prevFrame.y=this.position.y),t&&this.update(e)},update:function(t){if(this.prev.x=this.position.x,this.prev.y=this.position.y,this.moves){this.world.updateMotion(this,t);var e=this.velocity.x,n=this.velocity.y;this.newVelocity.set(e*t,n*t),this.position.add(this.newVelocity),this.updateCenter(),this.angle=Math.atan2(n,e),this.speed=Math.sqrt(e*e+n*n),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.world.emit(s.WORLD_BOUNDS,this,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)}this._dx=this.position.x-this.prev.x,this._dy=this.position.y-this.prev.y},postUpdate:function(){var t=this.position.x-this.prevFrame.x,e=this.position.y-this.prevFrame.y;if(this.moves){var n=this.deltaMax.x,i=this.deltaMax.y;0!==n&&0!==t&&(t<0&&t<-n?t=-n:t>0&&t>n&&(t=n)),0!==i&&0!==e&&(e<0&&e<-i?e=-i:e>0&&e>i&&(e=i)),this.gameObject.x+=t,this.gameObject.y+=e}t<0?this.facing=r.FACING_LEFT:t>0&&(this.facing=r.FACING_RIGHT),e<0?this.facing=r.FACING_UP:e>0&&(this.facing=r.FACING_DOWN),this.allowRotation&&(this.gameObject.angle+=this.deltaZ()),this._tx=t,this._ty=e},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.customBoundsRectangle,n=this.world.checkCollision,i=this.worldBounce?-this.worldBounce.x:-this.bounce.x,r=this.worldBounce?-this.worldBounce.y:-this.bounce.y,s=!1;return t.x<e.x&&n.left?(t.x=e.x,this.velocity.x*=i,this.blocked.left=!0,s=!0):this.right>e.right&&n.right&&(t.x=e.right-this.width,this.velocity.x*=i,this.blocked.right=!0,s=!0),t.y<e.y&&n.up?(t.y=e.y,this.velocity.y*=r,this.blocked.up=!0,s=!0):this.bottom>e.bottom&&n.down&&(t.y=e.bottom-this.height,this.velocity.y*=r,this.blocked.down=!0,s=!0),s&&(this.blocked.none=!1,this.updateCenter()),s},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;if(!t&&i.frame&&(t=i.frame.realWidth),!e&&i.frame&&(e=i.frame.realHeight),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),n&&i.getCenter){var r=(i.width-t)/2,s=(i.height-e)/2;this.offset.set(r,s)}return this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var n=this.gameObject;n.setPosition(t,e),n.getTopLeft?n.getTopLeft(this.position):this.position.set(t,e),this.prev.copy(this.position),this.prevFrame.copy(this.position),this.rotation=n.angle,this.preRotation=n.angle,this.updateBounds(),this.updateCenter(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:h(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(n,i,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(n,i,n+this.velocity.x/2,i+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setCollideWorldBounds:function(t,e,n,i){void 0===t&&(t=!0),this.collideWorldBounds=t;var r=void 0!==e,s=void 0!==n;return(r||s)&&(this.worldBounce||(this.worldBounce=new u),r&&(this.worldBounce.x=e),s&&(this.worldBounce.y=n)),void 0!==i&&(this.onWorldBounds=i),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){this.velocity.x=t;var e=t,n=this.velocity.y;return this.speed=Math.sqrt(e*e+n*n),this},setVelocityY:function(t){this.velocity.y=t;var e=this.velocity.x,n=t;return this.speed=Math.sqrt(e*e+n*n),this},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxVelocityX:function(t){return this.maxVelocity.x=t,this},setMaxVelocityY:function(t){return this.maxVelocity.y=t,this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDamping:function(t){return this.useDamping=t,this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},processX:function(t,e,n,i){this.x+=t,this.updateCenter(),null!==e&&(this.velocity.x=e);var r=this.blocked;n&&(r.left=!0),i&&(r.right=!0)},processY:function(t,e,n,i){this.y+=t,this.updateCenter(),null!==e&&(this.velocity.y=e);var r=this.blocked;n&&(r.up=!0),i&&(r.down=!0)},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=c},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=n,this.object2=i,this.collideCallback=r,this.processCallback=s,this.callbackContext=o},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});t.exports=i},function(t,e,n){var i=n(26),r=n(3),s=new r,o=new r;t.exports=function(t,e,n,r,a,h,u){var c=u.tilemapLayer.tilemap._convert.WorldToTileXY;c(t,e,!0,s,h,u);var l=s.x,f=s.y;c(t+n,e+r,!1,o,h,u);var d=Math.ceil(o.x),p=Math.ceil(o.y);return i(l,f,d-l,p-f,a,u)}},function(t,e){t.exports=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)}},function(t,e,n){var i=n(436);function r(t){if(!(this instanceof r))return new r(t,[".left",".top",".right",".bottom"]);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=v(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],h(r,t.leaf?i(s):s);return r}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,r,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,i(t,o,e,n,s),a.push(e,o,o,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,s,o,a,h=[];e;){for(r=0,s=e.children.length;r<s;r++)o=e.children[r],p(t,a=e.leaf?i(o):o)&&(e.leaf?n.push(o):d(t,a)?this._all(o,n):h.push(o));e=h.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,s,o,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(s=e.children[i],p(t,o=e.leaf?n(s):s)){if(e.leaf||d(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=v([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,h=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=c.pop(),o=!0),a.leaf&&-1!==(r=s(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;o||a.leaf||!d(a,h)?i?(n++,a=i.children[n],o=!1):a=null:(u.push(a),c.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=v(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=v([])).leaf=!1,r.height=i;var h,u,c,l,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(g(t,e,n,d,this.compareMinX),h=e;h<=n;h+=d)for(g(t,h,c=Math.min(h+d-1,n),f,this.compareMinY),u=h;u<=c;u+=f)l=Math.min(u+f-1,c),r.children.push(this._build(t,u,l,i-1));return o(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,s,o,a,h,u,c,f,d,p;i.push(e),!e.leaf&&i.length-1!==n;){for(c=f=1/0,r=0,s=e.children.length;r<s;r++)h=l(o=e.children[r]),d=t,p=o,(u=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-h)<f?(f=u,c=h<c?h:c,a=o):u===f&&h<c&&(c=h,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),h(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=v(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,s,o,h,u,c,f,d,p,v,g,m,y;for(u=c=1/0,i=e;i<=n-e;i++)d=r=a(t,0,i,this.toBBox),p=s=a(t,i,n,this.toBBox),void 0,void 0,void 0,void 0,v=Math.max(d.minX,p.minX),g=Math.max(d.minY,p.minY),m=Math.min(d.maxX,p.maxX),y=Math.min(d.maxY,p.maxY),o=Math.max(0,m-v)*Math.max(0,y-g),h=l(r)+l(s),o<u?(u=o,f=i,c=h<c?h:c):o===u&&h<c&&(c=h,f=i);return f},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,s,o=this.toBBox,u=a(t,0,e,o),c=a(t,n-e,n,o),l=f(u)+f(c);for(r=e;r<n-e;r++)s=t.children[r],h(u,t.leaf?o(s):s),l+=f(u);for(r=n-e-1;r>=e;r--)s=t.children[r],h(c,t.leaf?o(s):s),l+=f(c);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)h(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},t.exports=r},function(t,e,n){var i=n(533),r=n(535),s=n(248);t.exports=function(t,e,n,o,a,h,u){var c=o.left,l=o.top,f=o.right,d=o.bottom,p=n.faceLeft||n.faceRight,v=n.faceTop||n.faceBottom;if(u||(p=!0,v=!0),!p&&!v)return!1;var g=0,m=0,y=0,x=1;if(e.deltaAbsX()>e.deltaAbsY()?y=-1:e.deltaAbsX()<e.deltaAbsY()&&(x=-1),0!==e.deltaX()&&0!==e.deltaY()&&p&&v&&(y=Math.min(Math.abs(e.position.x-f),Math.abs(e.right-c)),x=Math.min(Math.abs(e.position.y-d),Math.abs(e.bottom-l))),y<x){if(p&&0!==(g=i(e,n,c,f,h,u))&&!s(o,e))return!0;v&&(m=r(e,n,l,d,h,u))}else{if(v&&0!==(m=r(e,n,l,d,h,u))&&!s(o,e))return!0;p&&(g=i(e,n,c,f,h,u))}return 0!==g||0!==m}},function(t,e,n){var i=n(534);t.exports=function(t,e,n,r,s,o){var a=0,h=e.faceLeft,u=e.faceRight,c=e.collideLeft,l=e.collideRight;return o||(h=!0,u=!0,c=!0,l=!0),t.deltaX()<0&&l&&t.checkCollision.left?u&&t.x<r&&(a=t.x-r)<-s&&(a=0):t.deltaX()>0&&c&&t.checkCollision.right&&h&&t.right>n&&(a=t.right-n)>s&&(a=0),0!==a&&(t.customSeparateX?t.overlapX=a:i(t,a)),a}},function(t,e){t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x}},function(t,e,n){var i=n(536);t.exports=function(t,e,n,r,s,o){var a=0,h=e.faceTop,u=e.faceBottom,c=e.collideUp,l=e.collideDown;return o||(h=!0,u=!0,c=!0,l=!0),t.deltaY()<0&&l&&t.checkCollision.up?u&&t.y<r&&(a=t.y-r)<-s&&(a=0):t.deltaY()>0&&c&&t.checkCollision.down&&h&&t.bottom>n&&(a=t.bottom-n)>s&&(a=0),0!==a&&(t.customSeparateY?t.overlapY=a:i(t,a)),a}},function(t,e){t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y}},function(t,e,n){var i=n(246),r=n(1386);t.exports=function(t,e,n,s){var o=i(t,e,n,s),a=t.immovable,h=e.immovable;if(n||0===o||a&&h||t.customSeparateX||e.customSeparateX)return 0!==o||t.embedded&&e.embedded;var u=r.Set(t,e,o);return a||h?(a?r.RunImmovableBody1(u):h&&r.RunImmovableBody2(u),!0):u>0||r.Check()}},function(t,e,n){var i=n(247),r=n(1387);t.exports=function(t,e,n,s){var o=i(t,e,n,s),a=t.immovable,h=e.immovable;if(n||0===o||a&&h||t.customSeparateY||e.customSeparateY)return 0!==o||t.embedded&&e.embedded;var u=r.Set(t,e,o);return a||h?(a?r.RunImmovableBody1(u):h&&r.RunImmovableBody2(u),!0):u>0||r.Check()}},function(t,e,n){var i=n(65),r=n(0),s=n(61),o=n(57),a=n(3),h=new r({initialize:function(t,e){var n=e.displayWidth?e.displayWidth:64,i=e.displayHeight?e.displayHeight:64;this.world=t,this.gameObject=e,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new a,this.position=new a(e.x-n*e.originX,e.y-i*e.originY),this.width=n,this.height=i,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new a(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=a.ZERO,this.allowGravity=!1,this.gravity=a.ZERO,this.bounce=a.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.physicsType=s.STATIC_BODY,this._dx=0,this._dy=0},setGameObject:function(t,e){return t&&t!==this.gameObject&&(this.gameObject.body=null,t.body=this,this.gameObject=t),e&&this.updateFromGameObject(),this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;if(!t&&i.frame&&(t=i.frame.realWidth),!e&&i.frame&&(e=i.frame.realHeight),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),n&&i.getCenter){var r=i.displayWidth/2,s=i.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(r-this.halfWidth,s-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var n=this.gameObject;void 0===t&&(t=n.x),void 0===e&&(e=n.y),this.world.staticTree.remove(this),n.setPosition(t,e),n.getTopLeft(this.position),this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?i(this,t,e):o(this,t,e)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(n,i,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=h},function(t,e,n){var i=new(n(0))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},function(t,e,n){var i=new(n(3));t.exports=function(t,e,n,r){var s=n.tilemapLayer,o=s.cullPaddingX,a=s.cullPaddingY,h=s.tilemap.tileToWorldXY(t,e,i,r,s);return h.x>r.worldView.x+s.scaleX*n.tileWidth*(-o-.5)&&h.x<r.worldView.right+s.scaleX*n.tileWidth*(o-.5)&&h.y>r.worldView.y+s.scaleY*n.tileHeight*(-a-1)&&h.y<r.worldView.bottom+s.scaleY*n.tileHeight*(a-.5)}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a){for(var h=i(n,r,s,o,null,a),u=0;u<h.length;u++)h[u]&&h[u].index===t&&(h[u].index=e)}},function(t,e,n){var i=n(10),r=n(140),s=n(77),o=new i;t.exports=function(t,e){var n=t.tilemapLayer.tilemap,i=t.tilemapLayer,a=Math.floor(n.tileWidth*i.scaleX),h=Math.floor(n.tileHeight*i.scaleY),u=s(e.worldView.x-i.x,a,0,!0)-i.cullPaddingX,c=r(e.worldView.right-i.x,a,0,!0)+i.cullPaddingX,l=s(e.worldView.y-i.y,h,0,!0)-i.cullPaddingY,f=r(e.worldView.bottom-i.y,h,0,!0)+i.cullPaddingY;return o.setTo(u,l,c-u,f-l)}},function(t,e,n){var i=n(543),r=n(159);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer,a=i(t,e);return(o.skipCull||1!==o.scrollFactorX||1!==o.scrollFactorY)&&(a.left=0,a.right=t.width,a.top=0,a.bottom=t.height),r(t,a,s,n),n}},function(t,e,n){var i=n(546),r=n(159);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer;if(!o.skipCull&&1===o.scrollFactorX&&1===o.scrollFactorY){var a=i(t,e);r(t,a,s,n)}return n}},function(t,e,n){var i=n(140),r=n(77);t.exports=function(t,e){var n=t.tilemapLayer.tilemap,s=t.tilemapLayer,o=Math.floor(n.tileWidth*s.scaleX),a=Math.floor(n.tileHeight*s.scaleY),h=t.hexSideLength,u=(a-h)/2+h;return{left:r(e.worldView.x-s.x,o,0,!0)-s.cullPaddingX,right:i(e.worldView.right-s.x,o,0,!0)+s.cullPaddingX,top:r(e.worldView.y-s.y,u,0,!0)-s.cullPaddingY,bottom:i(e.worldView.bottom-s.y,u,0,!0)+s.cullPaddingY}}},function(t,e,n){var i=n(541);t.exports=function(t,e,n,r){void 0===n&&(n=[]),void 0===r&&(r=0),n.length=0;var s,o,a,h=t.tilemapLayer,u=t.data,c=t.width,l=t.height,f=c,d=l;if(!h.skipCull)if(0===r){for(o=0;o<d;o++)for(s=0;u[o]&&s<f;s++)if(i(s,o,t,e)){if(!(a=u[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(1===r){for(o=0;o<d;o++)for(s=f;u[o]&&s>=0;s--)if(i(s,o,t,e)){if(!(a=u[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(2===r){for(o=d;o>=0;o--)for(s=0;u[o]&&s<f;s++)if(i(s,o,t,e)){if(!(a=u[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(3===r)for(o=d;o>=0;o--)for(s=f;u[o]&&s>=0;s--)if(i(s,o,t,e)){if(!(a=u[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}return h.tilesDrawn=n.length,h.tilesTotal=c*l,n}},function(t,e,n){var i=n(549),r=n(159);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer;if(!o.skipCull&&1===o.scrollFactorX&&1===o.scrollFactorY){var a=i(t,e);r(t,a,s,n)}return n}},function(t,e,n){var i=n(140),r=n(77);t.exports=function(t,e){var n=t.tilemapLayer.tilemap,s=t.tilemapLayer,o=Math.floor(n.tileWidth*s.scaleX),a=Math.floor(n.tileHeight*s.scaleY);return{left:r(e.worldView.x-s.x,o,0,!0)-s.cullPaddingX,right:i(e.worldView.right-s.x,o,0,!0)+s.cullPaddingX,top:r(e.worldView.y-s.y,a/2,0,!0)-s.cullPaddingY,bottom:i(e.worldView.bottom-s.y,a/2,0,!0)+s.cullPaddingY}}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,h=s.tilemapLayer,u=0,c=0;h&&(r||(r=h.scene.cameras.main),u=h.x+r.scrollX*(1-h.scrollFactorX),o*=h.scaleX,c=h.y+r.scrollY*(1-h.scrollFactorY),a*=h.scaleY);var l=s.hexSideLength,f=u+t*o+e%2*(o/2),d=c+e*((a-l)/2+l);return n.set(f,d)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,h=s.tilemapLayer,u=0,c=0;h&&(r||(r=h.scene.cameras.main),u=h.x+r.scrollX*(1-h.scrollFactorX),o*=h.scaleX,c=h.y+r.scrollY*(1-h.scrollFactorY),a*=h.scaleY);var l=u+o/2*(t-e),f=c+(t+e)*(a/2);return n.set(l,f)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,h=s.tilemapLayer,u=0,c=0;h&&(r||(r=h.scene.cameras.main),u=h.x+r.scrollX*(1-h.scrollFactorX),o*=h.scaleX,c=h.y+r.scrollY*(1-h.scrollFactorY),a*=h.scaleY);var l=u+t*o+e%2*(o/2),f=c+e*(a/2);return n.set(l,f)}},function(t,e,n){var i=n(253),r=n(254),s=n(3);t.exports=function(t,e,n,o,a){return n||(n=new s(0,0)),n.x=i(t,o,a),n.y=r(e,o,a),n}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;r&&(void 0===e&&(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY);var o=r.tilemap.hexSideLength;return s+t*((i-o)/2+o)}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;return r&&(void 0===e&&(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY),s+t*(i/2)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s,o){r||(r=new i);var a=o.baseTileWidth,h=o.baseTileHeight,u=o.tilemapLayer;u&&(s||(s=u.scene.cameras.main),e-=u.y+s.scrollY*(1-u.scrollFactorY),h*=u.scaleY,t-=u.x+s.scrollX*(1-u.scrollFactorX),a*=u.scaleX);var c=o.hexSideLength,l=(h-c)/2+c,f=n?Math.floor(e/l):e/l,d=n?Math.floor((t-f%2*.5*a)/a):(t-f%2*.5*a)/a;return r.set(d,f)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s,o){r||(r=new i);var a=o.baseTileWidth,h=o.baseTileHeight,u=o.tilemapLayer;u&&(s||(s=u.scene.cameras.main),e-=u.y+s.scrollY*(1-u.scrollFactorY),h*=u.scaleY,t-=u.x+s.scrollX*(1-u.scrollFactorX),a*=u.scaleX);var c=n?Math.floor((t/(a/2)+e/(h/2))/2):(t/(a/2)+e/(h/2))/2,l=n?Math.floor((e/(h/2)-t/(a/2))/2):(e/(h/2)-t/(a/2))/2;return r.set(c,l)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s,o){r||(r=new i);var a=o.baseTileWidth,h=o.baseTileHeight,u=o.tilemapLayer;u&&(s||(s=u.scene.cameras.main),e-=u.y+s.scrollY*(1-u.scrollFactorY),h*=u.scaleY,t-=u.x+s.scrollX*(1-u.scrollFactorX),a*=u.scaleX);var c=n?Math.floor(e/(h/2)):e/(h/2),l=n?Math.floor((t+c%2*.5*a)/a):(t+c%2*.5*a)/a;return r.set(l,c)}},function(t,e,n){var i=n(255),r=n(256),s=n(3);t.exports=function(t,e,n,o,a,h){return void 0===n&&(n=!0),o||(o=new s(0,0)),o.x=i(t,n,a,h),o.y=r(e,n,a,h),o}},function(t,e){t.exports=function(t,e,n,i){var r=i.baseTileHeight,s=i.tilemapLayer;s&&(n||(n=s.scene.cameras.main),t-=s.y+n.scrollY*(1-s.scrollFactorY),r*=s.scaleY);var o=i.hexSideLength,a=(r-o)/2+o;return e?Math.floor(t/a):t/a}},function(t,e){t.exports=function(t,e,n,i){var r=i.baseTileHeight,s=i.tilemapLayer;return s&&(n||(n=s.scene.cameras.main),t-=s.y+n.scrollY*(1-s.scrollFactorY),r*=s.scaleY),e?Math.floor(t/(r/2)):t/(r/2)}},function(t,e,n){var i=n(120);t.exports=function(t,e,n){if(i(t,e,n)){var r=n.data[e][t];return null!==r&&r.index>-1}return!1}},function(t,e,n){var i=n(86),r=n(120),s=n(252);t.exports=function(t,e,n,o,a){if(void 0===n&&(n=!0),void 0===o&&(o=!0),!r(t,e,a))return null;var h=a.data[e][t];return h?(a.data[e][t]=n?null:new i(a,-1,t,e,a.tileWidth,a.tileHeight),o&&h&&h.collides&&s(t,e,a),h):null}},function(t,e,n){var i=n(40),r=n(259),s=n(565),o=n(566),a=n(577);t.exports=function(t,e,n,h,u,c){var l;switch(e){case i.ARRAY_2D:l=r(t,n,h,u,c);break;case i.CSV:l=s(t,n,h,u,c);break;case i.TILED_JSON:l=o(t,n,c);break;case i.WELTMEISTER:l=a(t,n,c);break;default:console.warn("Unrecognized tilemap data format: "+e),l=null}return l}},function(t,e,n){var i=n(40),r=n(259);t.exports=function(t,e,n,s,o){var a=e.trim().split("\n").map((function(t){return t.split(",")})),h=r(t,a,n,s,o);return h.format=i.CSV,h}},function(t,e,n){var i=n(567),r=n(568),s=n(29),o=n(40),a=n(258),h=n(122),u=n(569),c=n(570),l=n(573),f=n(575);t.exports=function(t,e,n){var d=new h({width:e.width,height:e.height,name:t,tileWidth:e.tilewidth,tileHeight:e.tileheight,orientation:a(e.orientation),format:o.TILED_JSON,version:e.version,properties:e.properties,renderOrder:e.renderorder,infinite:e.infinite});d.orientation===s.HEXAGONAL&&(d.hexSideLength=e.hexsidelength),d.layers=l(e,n),d.images=u(e);var p=f(e);return d.tilesets=p.tilesets,d.imageCollections=p.imageCollections,d.objects=c(e),d.tiles=r(d),i(d),d}},function(t,e,n){var i=n(17);t.exports=function(t){for(var e,n,r,s,o,a=0;a<t.layers.length;a++){e=t.layers[a],s=null;for(var h=0;h<e.data.length;h++){o=e.data[h];for(var u=0;u<o.length;u++)null===(n=o[u])||n.index<0||(r=t.tiles[n.index][2],s=t.tilesets[r],n.width=s.tileWidth,n.height=s.tileHeight,s.tileProperties&&s.tileProperties[n.index-s.firstgid]&&(n.properties=i(n.properties,s.tileProperties[n.index-s.firstgid])))}}}},function(t,e,n){var i=n(123);t.exports=function(t){var e,n,r=[];for(e=0;e<t.imageCollections.length;e++)for(var s=t.imageCollections[e],o=s.images,a=0;a<o.length;a++){var h=o[a];(n=new i(h.image,h.gid,s.imageWidth,s.imageHeight,0,0)).updateTileData(s.imageWidth,s.imageHeight),t.tilesets.push(n)}for(e=0;e<t.tilesets.length;e++)for(var u=(n=t.tilesets[e]).tileMargin,c=n.tileMargin,l=0,f=0,d=0,p=n.firstgid;p<n.firstgid+n.total&&(r[p]=[u,c,e],u+=n.tileWidth+n.tileSpacing,++l!==n.total)&&(++f!==n.columns||(u=n.tileMargin,c+=n.tileHeight+n.tileSpacing,f=0,++d!==n.rows));p++);return r}},function(t,e,n){var i=n(2),r=n(161);t.exports=function(t){for(var e=[],n=[],s=r(t);s.i<s.layers.length||n.length>0;)if(s.i>=s.layers.length){if(n.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}s=n.pop()}else{var o=s.layers[s.i];if(s.i++,"imagelayer"===o.type){var a=i(o,"offsetx",0)+i(o,"startx",0),h=i(o,"offsety",0)+i(o,"starty",0);e.push({name:s.name+o.name,image:o.image,x:s.x+a+o.x,y:s.y+h+o.y,alpha:s.opacity*o.opacity,visible:s.visible&&o.visible,properties:i(o,"properties",{})})}else if("group"===o.type){var u=r(t,o,s);n.push(s),s=u}}return e}},function(t,e,n){var i=n(2),r=n(260),s=n(572),o=n(161);t.exports=function(t){for(var e=[],n=[],a=o(t);a.i<a.layers.length||n.length>0;)if(a.i>=a.layers.length){if(n.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}a=n.pop()}else{var h=a.layers[a.i];if(a.i++,h.opacity*=a.opacity,h.visible=a.visible&&h.visible,"objectgroup"===h.type){h.name=a.name+h.name;for(var u=a.x+i(h,"startx",0)+i(h,"offsetx",0),c=a.y+i(h,"starty",0)+i(h,"offsety",0),l=[],f=0;f<h.objects.length;f++){var d=r(h.objects[f],u,c);l.push(d)}var p=new s(h);p.objects=l,e.push(p)}else if("group"===h.type){var v=o(t,h,a);n.push(a),a=v}}return e}},function(t,e,n){var i=n(127);t.exports=function(t,e){for(var n={},r=0;r<e.length;r++){var s=e[r];i(t,s)&&(n[s]=t[s])}return n}},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){void 0===t&&(t={}),this.name=r(t,"name","object layer"),this.opacity=r(t,"opacity",1),this.properties=r(t,"properties",{}),this.propertyTypes=r(t,"propertytypes",{}),this.type=r(t,"type","objectgroup"),this.visible=r(t,"visible",!0),this.objects=r(t,"objects",[])}});t.exports=s},function(t,e,n){var i=n(574),r=n(29),s=n(161),o=n(258),a=n(2),h=n(121),u=n(261),c=n(86);t.exports=function(t,e){for(var n=a(t,"infinite",!1),l=[],f=[],d=s(t);d.i<d.layers.length||f.length>0;)if(d.i>=d.layers.length){if(f.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}d=f.pop()}else{var p=d.layers[d.i];if(d.i++,"tilelayer"===p.type)if(p.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+p.name+"'");else{if(p.encoding&&"base64"===p.encoding){if(p.chunks)for(var v=0;v<p.chunks.length;v++)p.chunks[v].data=i(p.chunks[v].data);p.data&&(p.data=i(p.data)),delete p.encoding}var g,m,y,x,b=[],w=0;if(n){var _=a(p,"startx",0)+p.x,T=a(p,"starty",0)+p.y;(g=new h({name:d.name+p.name,x:d.x+a(p,"offsetx",0)+_*t.tilewidth,y:d.y+a(p,"offsety",0)+T*t.tileheight,width:p.width,height:p.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:d.opacity*p.opacity,visible:d.visible&&p.visible,properties:a(p,"properties",[]),orientation:o(t.orientation)})).orientation===r.HEXAGONAL&&(g.hexSideLength=t.hexsidelength);for(var E=0;E<p.height;E++){b.push([null]);for(var S=0;S<p.width;S++)b[E][S]=null}for(E=0,N=p.chunks.length;E<N;E++)for(var C=p.chunks[E],A=C.x-_,I=C.y-T,P=0,R=0,O=C.data.length;R<O;R++){var k=w+A,M=P+I;(m=u(C.data[R])).gid>0?((y=new c(g,m.gid,k,M,t.tilewidth,t.tileheight)).rotation=m.rotation,y.flipX=m.flipped,b[M][k]=y):(x=e?null:new c(g,-1,k,M,t.tilewidth,t.tileheight),b[M][k]=x),++w===C.width&&(P++,w=0)}}else{(g=new h({name:d.name+p.name,x:d.x+a(p,"offsetx",0)+p.x,y:d.y+a(p,"offsety",0)+p.y,width:p.width,height:p.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:d.opacity*p.opacity,visible:d.visible&&p.visible,properties:a(p,"properties",[]),orientation:o(t.orientation)})).orientation===r.HEXAGONAL&&(g.hexSideLength=t.hexsidelength);for(var D=[],L=0,N=p.data.length;L<N;L++)(m=u(p.data[L])).gid>0?((y=new c(g,m.gid,w,b.length,t.tilewidth,t.tileheight)).rotation=m.rotation,y.flipX=m.flipped,D.push(y)):(x=e?null:new c(g,-1,w,b.length,t.tilewidth,t.tileheight),D.push(x)),++w===p.width&&(b.push(D),w=0,D=[])}g.data=b,l.push(g)}else if("group"===p.type){var F=s(t,p,d);f.push(d),d=F}}return l}},function(t,e){t.exports=function(t){for(var e=window.atob(t),n=e.length,i=new Array(n/4),r=0;r<n;r+=4)i[r/4]=(e.charCodeAt(r)|e.charCodeAt(r+1)<<8|e.charCodeAt(r+2)<<16|e.charCodeAt(r+3)<<24)>>>0;return i}},function(t,e,n){var i=n(123),r=n(576),s=n(260),o=n(1450);t.exports=function(t){for(var e,n=[],a=[],h=null,u=0;u<t.tilesets.length;u++){var c=t.tilesets[u];if(c.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(c.image){var l=new i(c.name,c.firstgid,c.tilewidth,c.tileheight,c.margin,c.spacing);if(t.version>1){var f=void 0,d=void 0;if(Array.isArray(c.tiles)){f=f||{},d=d||{};for(var p=0;p<c.tiles.length;p++){var v=c.tiles[p];if(v.properties){var g={};v.properties.forEach((function(t){g[t.name]=t.value})),d[v.id]=g}if(v.objectgroup&&((f[v.id]||(f[v.id]={})).objectgroup=v.objectgroup,v.objectgroup.objects)){var m=v.objectgroup.objects.map((function(t){return s(t)}));f[v.id].objectgroup.objects=m}v.animation&&((f[v.id]||(f[v.id]={})).animation=v.animation),v.type&&((f[v.id]||(f[v.id]={})).type=v.type)}}Array.isArray(c.wangsets)&&(f=f||{},d=d||{},o(c.wangsets,f)),f&&(l.tileData=f,l.tileProperties=d)}else if(c.tileproperties&&(l.tileProperties=c.tileproperties),c.tiles)for(e in l.tileData=c.tiles,l.tileData){var y=l.tileData[e].objectgroup;if(y&&y.objects){var x=y.objects.map((function(t){return s(t)}));l.tileData[e].objectgroup.objects=x}}l.updateTileData(c.imagewidth,c.imageheight),n.push(l)}else{var b=new r(c.name,c.firstgid,c.tilewidth,c.tileheight,c.margin,c.spacing,c.properties),w=0;for(p=0;p<c.tiles.length;p++){var _=(v=c.tiles[p]).image,T=parseInt(v.id,10),E=c.firstgid+T;b.addImage(E,_),w=Math.max(T,w)}b.maxId=w,a.push(b)}h&&(h.lastgid=c.firstgid-1),h=c}return{tilesets:n,imageCollections:a}}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===r&&(r=0),void 0===s&&(s=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|n,this.imageHeight=0|i,this.imageMargin=0|r,this.imageSpacing=0|s,this.properties=o||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e){return this.images.push({gid:t,image:e}),this.total++,this}});t.exports=i},function(t,e,n){var i=n(40),r=n(122),s=n(578),o=n(579);t.exports=function(t,e,n){if(0===e.layer.length)return console.warn("No layers found in the Weltmeister map: "+t),null;for(var a=0,h=0,u=0;u<e.layer.length;u++)e.layer[u].width>a&&(a=e.layer[u].width),e.layer[u].height>h&&(h=e.layer[u].height);var c=new r({width:a,height:h,name:t,tileWidth:e.layer[0].tilesize,tileHeight:e.layer[0].tilesize,format:i.WELTMEISTER});return c.layers=s(e,n),c.tilesets=o(e),c}},function(t,e,n){var i=n(121),r=n(86);t.exports=function(t,e){for(var n=[],s=0;s<t.layer.length;s++){for(var o=t.layer[s],a=new i({name:o.name,width:o.width,height:o.height,tileWidth:o.tilesize,tileHeight:o.tilesize,visible:1===o.visible}),h=[],u=[],c=0;c<o.data.length;c++){for(var l=0;l<o.data[c].length;l++){var f,d=o.data[c][l]-1;f=d>-1?new r(a,d,l,c,o.tilesize,o.tilesize):e?null:new r(a,-1,l,c,o.tilesize,o.tilesize),h.push(f)}u.push(h),h=[]}a.data=u,n.push(a)}return n}},function(t,e,n){var i=n(123);t.exports=function(t){for(var e=[],n=[],r=0;r<t.layer.length;r++){var s=t.layer[r],o=s.tilesetName;""!==o&&-1===n.indexOf(o)&&(n.push(o),e.push(new i(o,0,s.tilesize,s.tilesize,0,0)))}return e}},function(t,e,n){var i=n(0),r=n(36),s=n(40),o=n(2),a=n(121),h=n(29),u=n(362),c=n(75),l=n(74),f=n(86),d=n(251),p=n(581),v=n(123),g=new i({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0,this.hexSideLength=e.hexSideLength;var n=this.orientation;this._convert={WorldToTileXY:d.GetWorldToTileXYFunction(n),WorldToTileX:d.GetWorldToTileXFunction(n),WorldToTileY:d.GetWorldToTileYFunction(n),TileToWorldXY:d.GetTileToWorldXYFunction(n),TileToWorldX:d.GetTileToWorldXFunction(n),TileToWorldY:d.GetTileToWorldYFunction(n)}},createBlankDynamicLayer:function(t,e,n,i,r,s,o,a){return console.warn("createBlankDynamicLayer is deprecated. Use createBlankLayer"),this.createBlankLayer(t,e,n,i,r,s,o,a)},createDynamicLayer:function(t,e,n,i){return console.warn("createDynamicLayer is deprecated. Use createLayer"),this.createLayer(t,e,n,i)},createStaticLayer:function(t,e,n,i){return console.warn("createStaticLayer is deprecated. Use createLayer"),this.createLayer(t,e,n,i)},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"==typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(t,e,n,i,r,o,a){if(void 0===t)return null;if(null==e&&(e=t),!this.scene.sys.textures.exists(e))return console.warn("Invalid Tileset Image: "+e),null;var h=this.scene.sys.textures.get(e),u=this.getTilesetIndex(t);if(null===u&&this.format===s.TILED_JSON)return console.warn("No data found for Tileset: "+t),null;var c=this.tilesets[u];return c?(c.setTileSize(n,i),c.setSpacing(r,o),c.setImage(h),c):(void 0===n&&(n=this.tileWidth),void 0===i&&(i=this.tileHeight),void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),(c=new v(t,a,n,i,r,o)).setImage(h),this.tilesets.push(c),c)},copy:function(t,e,n,i,r,s,o,a){return null!==(a=this.getLayer(a))?(d.Copy(t,e,n,i,r,s,o,a),this):null},createBlankLayer:function(t,e,n,i,r,s,o,h){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.width),void 0===s&&(s=this.height),void 0===o&&(o=this.tileWidth),void 0===h&&(h=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var u,c=new a({name:t,tileWidth:o,tileHeight:h,width:r,height:s,orientation:this.orientation}),l=0;l<s;l++){u=[];for(var d=0;d<r;d++)u.push(new f(c,-1,d,l,o,h,this.tileWidth,this.tileHeight));c.data.push(u)}this.layers.push(c),this.currentLayerIndex=this.layers.length-1;var v=new p(this.scene,this,this.currentLayerIndex,e,n,i);return v.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(v),v},createLayer:function(t,e,n,i){var r=this.getLayerIndex(t);if(null===r)return console.warn("Invalid Tilemap Layer ID: "+t),"string"==typeof t&&console.warn("Valid tilelayer names:\n\t"+this.getTileLayerNames().join(",\n\t")),null;var s=this.layers[r];if(s.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=r,void 0===n&&(n=s.x),void 0===i&&(i=s.y);var o=new p(this.scene,this,r,e,n,i);return o.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(o),o},createFromObjects:function(t,e){var n=[],i=this.getObjectLayer(t);if(!i)return console.warn("createFromObjects: Invalid objectLayerName given: "+t),n;Array.isArray(e)||(e=[e]);for(var s=i.objects,a=0;a<e.length;a++){for(var h,c=e[a],f=o(c,"id",null),d=o(c,"gid",null),p=o(c,"name",null),v=[],g=0;g<s.length;g++)h=s[g],(null===f&&null===d&&null===p||null!==f&&h.id===f||null!==d&&h.gid===d||null!==p&&h.name===p)&&v.push(h);for(var m=o(c,"classType",l),y=o(c,"scene",this.scene),x=o(c,"container",null),b=o(c,"key",null),w=o(c,"frame",null),_=0;_<v.length;_++){h=v[_];var T=new m(y);T.setName(h.name),T.setPosition(h.x,h.y),T.setTexture(b,w),h.width&&(T.displayWidth=h.width),h.height&&(T.displayHeight=h.height);var E={x:T.originX*h.width,y:(T.originY-1)*h.height};if(h.rotation){var S=r(h.rotation);u(E,S),T.rotation=S}if(T.x+=E.x,T.y+=E.y,void 0===h.flippedHorizontal&&void 0===h.flippedVertical||T.setFlip(h.flippedHorizontal,h.flippedVertical),h.visible||(T.visible=!1),Array.isArray(h.properties))h.properties.forEach((function(t){var e=t.name;void 0!==T[e]?T[e]=t.value:T.setData(e,t.value)}));else for(var C in h.properties)void 0!==T[C]?T[C]=h.properties[C]:T.setData(C,h.properties[C]);x?x.add(T):y.add.existing(T),n.push(T)}}return n},createFromTiles:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:d.CreateFromTiles(t,e,n,i,r,s)},fill:function(t,e,n,i,r,s,o){return void 0===s&&(s=!0),null===(o=this.getLayer(o))?null:(d.Fill(t,e,n,i,r,s,o),this)},filterObjects:function(t,e,n){if("string"==typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.filter(e,n)},filterTiles:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:d.FilterTiles(t,e,n,i,r,s,o,a)},findByIndex:function(t,e,n,i){return null===(i=this.getLayer(i))?null:d.FindByIndex(t,e,n,i)},findObject:function(t,e,n){if("string"==typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.find(e,n)||null},findTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:d.FindTile(t,e,n,i,r,s,o,a)},forEachTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:(d.ForEachTile(t,e,n,i,r,s,o,a),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map((function(t){return t.name})):[]},getIndex:function(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return n;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map((function(t){return t.name})):[]},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"==typeof t?this.getLayerIndexByName(t):"number"==typeof t&&t<this.layers.length?t:t instanceof p?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,n,i){return null===(i=this.getLayer(i))?null:d.GetTileAt(t,e,n,i)},getTileAtWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:d.GetTileAtWorldXY(t,e,n,i,r)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map((function(t){return t.name})):[]},getTilesWithin:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:d.GetTilesWithin(t,e,n,i,r,s)},getTilesWithinShape:function(t,e,n,i){return null===(i=this.getLayer(i))?null:d.GetTilesWithinShape(t,e,n,i)},getTilesWithinWorldXY:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:d.GetTilesWithinWorldXY(t,e,n,i,r,s,o)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,n){return null===(n=this.getLayer(n))?null:d.HasTileAt(t,e,n)},hasTileAtWorldXY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:d.HasTileAtWorldXY(t,e,n,i)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,n,i,r){return void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:d.PutTileAt(t,e,n,i,r)},putTileAtWorldXY:function(t,e,n,i,r,s){return void 0===i&&(i=!0),null===(s=this.getLayer(s))?null:d.PutTileAtWorldXY(t,e,n,i,r,s)},putTilesAt:function(t,e,n,i,r){return void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:(d.PutTilesAt(t,e,n,i,r),this)},randomize:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:(d.Randomize(t,e,n,i,r,s),this)},calculateFacesAt:function(t,e,n){return null===(n=this.getLayer(n))?null:(d.CalculateFacesAt(t,e,n),this)},calculateFacesWithin:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(d.CalculateFacesWithin(t,e,n,i,r),this)},removeLayer:function(t){var e=this.getLayerIndex(t);if(null!==e){c(this.layers,e);for(var n=e;n<this.layers.length;n++)this.layers[n].tilemapLayer&&this.layers[n].tilemapLayer.layerIndex--;return this.currentLayerIndex===e&&(this.currentLayerIndex=0),this}return null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).destroy(),c(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=!0);var i=[];Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];i.push(this.removeTileAt(s.x,s.y,!0,n,s.tilemapLayer)),e>-1&&this.putTileAt(e,s.x,s.y,n,s.tilemapLayer)}return i},removeTileAt:function(t,e,n,i,r){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:d.RemoveTileAt(t,e,n,i,r)},removeTileAtWorldXY:function(t,e,n,i,r,s){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(s=this.getLayer(s))?null:d.RemoveTileAtWorldXY(t,e,n,i,r,s)},renderDebug:function(t,e,n){return null===(n=this.getLayer(n))?null:(this.orientation===h.ORTHOGONAL&&d.RenderDebug(t,e,n),this)},renderDebugFull:function(t,e){for(var n=this.layers,i=0;i<n.length;i++)d.RenderDebug(t,e,n[i]);return this},replaceByIndex:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(d.ReplaceByIndex(t,e,n,i,r,s,o),this)},setCollision:function(t,e,n,i,r){return void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),null===(i=this.getLayer(i))?null:(d.SetCollision(t,e,n,i,r),this)},setCollisionBetween:function(t,e,n,i,r){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:(d.SetCollisionBetween(t,e,n,i,r),this)},setCollisionByProperty:function(t,e,n,i){return void 0===e&&(e=!0),void 0===n&&(n=!0),null===(i=this.getLayer(i))?null:(d.SetCollisionByProperty(t,e,n,i),this)},setCollisionByExclusion:function(t,e,n,i){return void 0===e&&(e=!0),void 0===n&&(n=!0),null===(i=this.getLayer(i))?null:(d.SetCollisionByExclusion(t,e,n,i),this)},setCollisionFromCollisionGroup:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionFromCollisionGroup(t,e,n),this)},setTileIndexCallback:function(t,e,n,i){return null===(i=this.getLayer(i))?null:(d.SetTileIndexCallback(t,e,n,i),this)},setTileLocationCallback:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(d.SetTileLocationCallback(t,e,n,i,r,s,o),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var n=0;n<this.layers.length;n++){this.layers[n].baseTileWidth=t,this.layers[n].baseTileHeight=e;for(var i=this.layers[n].data,r=this.layers[n].width,s=this.layers[n].height,o=0;o<s;o++)for(var a=0;a<r;a++){var h=i[o][a];null!==h&&h.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,n){if(null===(n=this.getLayer(n)))return this;n.tileWidth=t,n.tileHeight=e;for(var i=n.data,r=n.width,s=n.height,o=0;o<s;o++)for(var a=0;a<r;a++){var h=i[o][a];null!==h&&h.setSize(t,e)}return this},shuffle:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(d.Shuffle(t,e,n,i,r),this)},swapByIndex:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(d.SwapByIndex(t,e,n,i,r,s,o),this)},tileToWorldX:function(t,e,n){return null===(n=this.getLayer(n))?null:this._convert.TileToWorldX(t,e,n)},tileToWorldY:function(t,e,n){return null===(n=this.getLayer(n))?null:this._convert.TileToWorldY(t,e,n)},tileToWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:this._convert.TileToWorldXY(t,e,n,i,r)},weightedRandomize:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:(d.WeightedRandomize(e,n,i,r,t,s),this)},worldToTileX:function(t,e,n,i){return null===(i=this.getLayer(i))?null:this._convert.WorldToTileX(t,e,n,i)},worldToTileY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:this._convert.WorldToTileY(t,e,n,i)},worldToTileXY:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:this._convert.WorldToTileXY(t,e,n,i,r,s)},destroy:function(){this.removeAllLayers(),this.tilesets.length=0,this.objects.length=0,this.scene=null}});t.exports=g},function(t,e,n){var i=n(0),r=n(11),s=n(15),o=n(251),a=n(1453),h=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Depth,r.Flip,r.GetBounds,r.Origin,r.Pipeline,r.Transform,r.Visible,r.ScrollFactor,a],initialize:function(t,e,n,i,r,a){s.call(this,t,"TilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=n,this.layer=e.layers[n],this.layer.tilemapLayer=this,this.tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=o.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.setTilesets(i),this.setAlpha(this.layer.alpha),this.setPosition(r,a),this.setOrigin(),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline()},setTilesets:function(t){var e=[],n=[],i=this.tilemap;Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];if("string"==typeof s&&(s=i.getTileset(s)),s){n.push(s);for(var o=s.firstgid,a=0;a<s.total;a++)e[o+a]=s}}this.gidMap=e,this.tileset=n},setRenderOrder:function(t){return"string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return o.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,n,i){return o.CalculateFacesWithin(t,e,n,i,this.layer),this},createFromTiles:function(t,e,n,i,r){return o.CreateFromTiles(t,e,n,i,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,n,i,r,s,a){return o.Copy(t,e,n,i,r,s,a,this.layer),this},fill:function(t,e,n,i,r,s){return o.Fill(t,e,n,i,r,s,this.layer),this},filterTiles:function(t,e,n,i,r,s,a){return o.FilterTiles(t,e,n,i,r,s,a,this.layer)},findByIndex:function(t,e,n){return o.FindByIndex(t,e,n,this.layer)},findTile:function(t,e,n,i,r,s,a){return o.FindTile(t,e,n,i,r,s,a,this.layer)},forEachTile:function(t,e,n,i,r,s,a){return o.ForEachTile(t,e,n,i,r,s,a,this.layer),this},getTileAt:function(t,e,n){return o.GetTileAt(t,e,n,this.layer)},getTileAtWorldXY:function(t,e,n,i){return o.GetTileAtWorldXY(t,e,n,i,this.layer)},getTilesWithin:function(t,e,n,i,r){return o.GetTilesWithin(t,e,n,i,r,this.layer)},getTilesWithinShape:function(t,e,n){return o.GetTilesWithinShape(t,e,n,this.layer)},getTilesWithinWorldXY:function(t,e,n,i,r,s){return o.GetTilesWithinWorldXY(t,e,n,i,r,s,this.layer)},hasTileAt:function(t,e){return o.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,n){return o.HasTileAtWorldXY(t,e,n,this.layer)},putTileAt:function(t,e,n,i){return o.PutTileAt(t,e,n,i,this.layer)},putTileAtWorldXY:function(t,e,n,i,r){return o.PutTileAtWorldXY(t,e,n,i,r,this.layer)},putTilesAt:function(t,e,n,i){return o.PutTilesAt(t,e,n,i,this.layer),this},randomize:function(t,e,n,i,r){return o.Randomize(t,e,n,i,r,this.layer),this},removeTileAt:function(t,e,n,i){return o.RemoveTileAt(t,e,n,i,this.layer)},removeTileAtWorldXY:function(t,e,n,i,r){return o.RemoveTileAtWorldXY(t,e,n,i,r,this.layer)},renderDebug:function(t,e){return o.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,n,i,r,s){return o.ReplaceByIndex(t,e,n,i,r,s,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,n,i){return o.SetCollision(t,e,n,this.layer,i),this},setCollisionBetween:function(t,e,n,i){return o.SetCollisionBetween(t,e,n,i,this.layer),this},setCollisionByProperty:function(t,e,n){return o.SetCollisionByProperty(t,e,n,this.layer),this},setCollisionByExclusion:function(t,e,n){return o.SetCollisionByExclusion(t,e,n,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return o.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,n){return o.SetTileIndexCallback(t,e,n,this.layer),this},setTileLocationCallback:function(t,e,n,i,r,s){return o.SetTileLocationCallback(t,e,n,i,r,s,this.layer),this},shuffle:function(t,e,n,i){return o.Shuffle(t,e,n,i,this.layer),this},swapByIndex:function(t,e,n,i,r,s){return o.SwapByIndex(t,e,n,i,r,s,this.layer),this},tileToWorldX:function(t,e){return this.tilemap.tileToWorldX(t,e,this)},tileToWorldY:function(t,e){return this.tilemap.tileToWorldY(t,e,this)},tileToWorldXY:function(t,e,n,i){return this.tilemap.tileToWorldXY(t,e,n,i,this)},weightedRandomize:function(t,e,n,i,r){return o.WeightedRandomize(e,n,i,r,t,this.layer),this},worldToTileX:function(t,e,n){return this.tilemap.worldToTileX(t,e,n,this)},worldToTileY:function(t,e,n){return this.tilemap.worldToTileY(t,e,n,this)},worldToTileXY:function(t,e,n,i,r){return this.tilemap.worldToTileXY(t,e,n,i,r,this)},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],s.prototype.destroy.call(this))}});t.exports=h},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){return this.delay=r(t,"delay",0),this.repeat=r(t,"repeat",0),this.loop=r(t,"loop",!1),this.callback=r(t,"callback",void 0),this.callbackScope=r(t,"callbackScope",this.callback),this.args=r(t,"args",[]),this.timeScale=r(t,"timeScale",1),this.startAt=r(t,"startAt",0),this.paused=r(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/t}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});t.exports=s},function(t,e,n){var i=n(1462);t.exports=function(t){var e,n=[];if(t.hasOwnProperty("props"))for(e in t.props)"_"!==e.substr(0,1)&&n.push({key:e,value:t.props[e]});else for(e in t)-1===i.indexOf(e)&&"_"!==e.substr(0,1)&&n.push({key:e,value:t[e]});return n}},function(t,e,n){var i=n(6);t.exports=function(t){var e=i(t,"tweens",null);return null===e?[]:("function"==typeof e&&(e=e.call()),Array.isArray(e)||(e=[e]),e)}},function(t,e,n){var i=n(265),r=n(13),s=n(99),o=n(81),a=n(162),h=n(6),u=n(264),c=n(266),l=n(268);t.exports=function(t,e,n){void 0===n&&(n=i);var f=h(e,"from",0),d=h(e,"to",1),p=[{value:f}],v=a(e,"delay",n.delay),g=a(e,"duration",n.duration),m=h(e,"easeParams",n.easeParams),y=o(h(e,"ease",n.ease),m),x=a(e,"hold",n.hold),b=a(e,"repeat",n.repeat),w=a(e,"repeatDelay",n.repeatDelay),_=s(e,"yoyo",n.yoyo),T=[],E=u("value",d),S=l(p[0],0,"value",E.getEnd,E.getStart,E.getActive,y,v,g,_,x,b,w,!1,!1);S.start=f,S.current=f,S.to=d,T.push(S);var C=new c(t,T,p);C.offset=r(e,"offset",null),C.completeDelay=r(e,"completeDelay",0),C.loop=Math.round(r(e,"loop",0)),C.loopDelay=Math.round(r(e,"loopDelay",0)),C.paused=s(e,"paused",!1),C.useFrames=s(e,"useFrames",!1);for(var A=h(e,"callbackScope",C),I=[C,null],P=c.TYPES,R=0;R<P.length;R++){var O=P[R],k=h(e,O,!1);if(k){var M=h(e,O+"Scope",A),D=h(e,O+"Params",[]);C.setCallback(O,k,I.concat(D),M)}}return C}},function(t,e,n){var i=n(81),r=n(6),s=n(14);t.exports=function(t,e){void 0===e&&(e={});var n=r(e,"start",0),o=r(e,"ease",null),a=r(e,"grid",null),h=r(e,"from",0),u="first"===h,c="center"===h,l="last"===h,f="number"==typeof h,d=Array.isArray(t),p=d?parseFloat(t[0]):parseFloat(t),v=d?parseFloat(t[1]):0,g=Math.max(p,v);if(d&&(n+=p),a){var m=a[0],y=a[1],x=0,b=0,w=0,_=0,T=[];l?(x=m-1,b=y-1):f?(x=h%m,b=Math.floor(h/m)):c&&(x=(m-1)/2,b=(y-1)/2);for(var E=s.MIN_SAFE_INTEGER,S=0;S<y;S++){T[S]=[];for(var C=0;C<m;C++){w=x-C,_=b-S;var A=Math.sqrt(w*w+_*_);A>E&&(E=A),T[S][C]=A}}}var I=o?i(o):null;return a?function(t,e,i,r){var s,o=0,a=r%m,h=Math.floor(r/m);if(a>=0&&a<m&&h>=0&&h<y&&(o=T[h][a]),d){var u=v-p;s=I?o/E*u*I(o/E):o/E*u}else s=I?o*p*I(o/E):o*p;return s+n}:function(t,e,i,r,s){var o,a,m;return s--,u?o=r:c?o=Math.abs(s/2-r):l?o=s-r:f&&(o=Math.abs(h-r)),d?(m=c?(v-p)/s*(2*o):(v-p)/s*o,a=I?m*I(o/s):m):a=I?s*g*I(o/s):o*p,a+n}}},function(t,e,n){var i=n(78),r=n(265),s=n(13),o=n(99),a=n(81),h=n(162),u=n(263),c=n(584),l=n(6),f=n(588),d=n(163);t.exports=function(t,e){var n=new f(t);n.completeDelay=s(e,"completeDelay",0),n.loop=Math.round(s(e,"loop",0)),n.loopDelay=Math.round(s(e,"loopDelay",0)),n.paused=o(e,"paused",!1),n.useFrames=o(e,"useFrames",!1);var p=l(e,"callbackScope",n),v=[n],g=l(e,"onStart",!1);if(g){var m=l(e,"onStartScope",p),y=l(e,"onStartParams",[]);n.setCallback("onStart",g,v.concat(y),m)}var x=l(e,"onUpdate",!1);if(x){var b=l(e,"onUpdateScope",p),w=l(e,"onUpdateParams",[]);n.setCallback("onUpdate",x,v.concat(w),b)}var _=l(e,"onLoop",!1);if(_){var T=l(e,"onLoopScope",p),E=l(e,"onLoopParams",[]);n.setCallback("onLoop",_,v.concat(E),T)}var S=l(e,"onYoyo",!1);if(S){var C=l(e,"onYoyoScope",p),A=l(e,"onYoyoParams",[]);n.setCallback("onYoyo",S,v.concat(null,A),C)}var I=l(e,"onComplete",!1);if(I){var P=l(e,"onCompleteScope",p),R=l(e,"onCompleteParams",[]);n.setCallback("onComplete",I,v.concat(R),P)}var O=c(e);if(0===O.length)return n.paused=!0,n;var k=i(r);k.targets=u(e);var M=s(e,"totalDuration",0);k.duration=M>0?Math.floor(M/O.length):h(e,"duration",k.duration),k.delay=h(e,"delay",k.delay),k.easeParams=l(e,"easeParams",k.easeParams),k.ease=a(l(e,"ease",k.ease),k.easeParams),k.hold=h(e,"hold",k.hold),k.repeat=h(e,"repeat",k.repeat),k.repeatDelay=h(e,"repeatDelay",k.repeatDelay),k.yoyo=o(e,"yoyo",k.yoyo),k.flipX=o(e,"flipX",k.flipX),k.flipY=o(e,"flipY",k.flipY);for(var D=0;D<O.length;D++)n.queue(d(n,O[D],k));return n}},function(t,e,n){var i=n(0),r=n(9),s=n(267),o=n(163),a=n(100),h=new i({Extends:r,initialize:function(t){r.call(this),this.manager=t,this.isTimeline=!0,this.data=[],this.totalData=0,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=a.PENDING_ADD,this._pausedState=a.PENDING_ADD,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onComplete:null,onLoop:null,onStart:null,onUpdate:null,onYoyo:null},this.callbackScope},dispatchTimelineEvent:function(t,e){this.emit(t,this),e&&e.func.apply(e.scope,e.params)},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===a.ACTIVE},add:function(t){return this.queue(o(this,t))},queue:function(t){return this.isPlaying()||(t.parent=this,t.parentIsTimeline=!0,this.data.push(t),this.totalData=this.data.length),this},hasOffset:function(t){return null!==t.offset},isOffsetAbsolute:function(t){return"number"==typeof t},isOffsetRelative:function(t){if("string"==typeof t){var e=t[0];if("-"===e||"+"===e)return!0}return!1},getRelativeOffset:function(t,e){var n=t[0],i=parseFloat(t.substr(2)),r=e;switch(n){case"+":r+=i;break;case"-":r-=i}return Math.max(0,r)},calcDuration:function(){for(var t=0,e=0,n=0,i=0;i<this.totalData;i++){var r=this.data[i];r.init(),this.hasOffset(r)?this.isOffsetAbsolute(r.offset)?(r.calculatedOffset=r.offset,0===r.offset&&(n=0)):this.isOffsetRelative(r.offset)&&(r.calculatedOffset=this.getRelativeOffset(r.offset,t)):r.calculatedOffset=n,t=r.totalDuration+r.calculatedOffset,e+=r.totalDuration,n+=r.totalDuration}this.duration=e,this.loopCounter=-1===this.loop?999999999999:this.loop,this.loopCounter>0?this.totalDuration=this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.totalDuration=this.duration+this.completeDelay},init:function(){return this.calcDuration(),this.progress=0,this.totalProgress=0,!this.paused||(this.state=a.PAUSED,!1)},resetTweens:function(t){for(var e=0;e<this.totalData;e++)this.data[e].play(t)},setCallback:function(t,e,n,i){return-1!==h.TYPES.indexOf(t)&&(this.callbacks[t]={func:e,scope:i,params:n}),this},makeActive:function(t){return this.manager.makeActive(t)},play:function(){if(this.state!==a.ACTIVE){if(this.paused)return this.paused=!1,void this.manager.makeActive(this);this.resetTweens(!1),this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_START,this.callbacks.onStart)}},nextState:function(){this.loopCounter>0?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweens(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.state=a.LOOP_DELAY):(this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_LOOP,this.callbacks.onLoop))):this.completeDelay>0?(this.state=a.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=a.PENDING_REMOVE,this.dispatchTimelineEvent(s.TIMELINE_COMPLETE,this.callbacks.onComplete))},update:function(t,e){if(this.state!==a.PAUSED){switch(this.useFrames&&(e=1*this.manager.timeScale),e*=this.timeScale,this.elapsed+=e,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=e,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case a.ACTIVE:for(var n=this.totalData,i=0;i<this.totalData;i++)this.data[i].update(t,e)&&n--;this.dispatchTimelineEvent(s.TIMELINE_UPDATE,this.callbacks.onUpdate),0===n&&this.nextState();break;case a.LOOP_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_LOOP,this.callbacks.onLoop));break;case a.COMPLETE_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=a.PENDING_REMOVE,this.dispatchTimelineEvent(s.TIMELINE_COMPLETE,this.callbacks.onComplete))}return this.state===a.PENDING_REMOVE}},stop:function(){this.state=a.PENDING_REMOVE},pause:function(){if(this.state!==a.PAUSED)return this.paused=!0,this._pausedState=this.state,this.state=a.PAUSED,this.emit(s.TIMELINE_PAUSE,this),this},resume:function(){return this.state===a.PAUSED&&(this.paused=!1,this.state=this._pausedState,this.emit(s.TIMELINE_RESUME,this)),this},hasTarget:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].hasTarget(t))return!0;return!1},destroy:function(){for(var t=0;t<this.data.length;t++)this.data[t].stop()}});h.TYPES=["onStart","onUpdate","onLoop","onComplete","onYoyo"],t.exports=h},function(t,e,n){var i=n(87),r=n(41),s=n(32),o=n(2),a=n(63),h={parseBody:function(t,e,n,i){void 0===i&&(i={});for(var a=o(n,"fixtures",[]),h=[],u=0;u<a.length;u++)for(var c=this.parseFixture(a[u]),l=0;l<c.length;l++)h.push(c[l]);var f=s.clone(n,!0);s.extend(f,i,!0),delete f.fixtures,delete f.type;var d=r.create(f);return r.setParts(d,h),r.setPosition(d,{x:t,y:e}),d},parseFixture:function(t){var e,n=s.extend({},!1,t);if(delete n.circle,delete n.vertices,t.circle){var r=o(t.circle,"x"),a=o(t.circle,"y"),h=o(t.circle,"radius");e=[i.circle(r,a,h,n)]}else t.vertices&&(e=this.parseVertices(t.vertices,n));return e},parseVertices:function(t,e){void 0===e&&(e={});for(var n=[],o=0;o<t.length;o++)a.clockwiseSort(t[o]),n.push(r.create(s.extend({position:a.centre(t[o]),vertices:t[o]},e)));return i.flagCoincidentParts(n)}};t.exports=h},function(t,e,n){var i=n(87),r=n(41),s={parseBody:function(t,e,n,s){var o;void 0===s&&(s={});var a=n.vertices;if(1===a.length)s.vertices=a[0],o=r.create(s),i.flagCoincidentParts(o.parts);else{for(var h=[],u=0;u<a.length;u++){var c=r.create({vertices:a[u]});h.push(c)}i.flagCoincidentParts(h),s.parts=h,o=r.create(s)}return o.label=n.label,r.setPosition(o,{x:t,y:e}),o}};t.exports=s},function(t,e,n){var i={};t.exports=i;var r=n(119),s=n(129),o=n(32),a=n(41),h=n(87);i.stack=function(t,e,n,i,s,o,h){for(var u,c=r.create({label:"Stack"}),l=t,f=e,d=0,p=0;p<i;p++){for(var v=0,g=0;g<n;g++){var m=h(l,f,g,p,u,d);if(m){var y=m.bounds.max.y-m.bounds.min.y,x=m.bounds.max.x-m.bounds.min.x;y>v&&(v=y),a.translate(m,{x:.5*x,y:.5*y}),l=m.bounds.max.x+s,r.addBody(c,m),u=m,d+=1}else l+=s}f+=v+o,l=t}return c},i.chain=function(t,e,n,i,a,h){for(var u=t.bodies,c=1;c<u.length;c++){var l=u[c-1],f=u[c],d=l.bounds.max.y-l.bounds.min.y,p=l.bounds.max.x-l.bounds.min.x,v=f.bounds.max.y-f.bounds.min.y,g={bodyA:l,pointA:{x:p*e,y:d*n},bodyB:f,pointB:{x:(f.bounds.max.x-f.bounds.min.x)*i,y:v*a}},m=o.extend(g,h);r.addConstraint(t,s.create(m))}return t.label+=" Chain",t},i.mesh=function(t,e,n,i,a){var h,u,c,l,f,d=t.bodies;for(h=0;h<n;h++){for(u=1;u<e;u++)c=d[u-1+h*e],l=d[u+h*e],r.addConstraint(t,s.create(o.extend({bodyA:c,bodyB:l},a)));if(h>0)for(u=0;u<e;u++)c=d[u+(h-1)*e],l=d[u+h*e],r.addConstraint(t,s.create(o.extend({bodyA:c,bodyB:l},a))),i&&u>0&&(f=d[u-1+(h-1)*e],r.addConstraint(t,s.create(o.extend({bodyA:f,bodyB:l},a)))),i&&u<e-1&&(f=d[u+1+(h-1)*e],r.addConstraint(t,s.create(o.extend({bodyA:f,bodyB:l},a))))}return t.label+=" Mesh",t},i.pyramid=function(t,e,n,r,s,o,h){return i.stack(t,e,n,r,s,o,(function(e,i,o,u,c,l){var f=Math.min(r,Math.ceil(n/2)),d=c?c.bounds.max.x-c.bounds.min.x:0;if(!(u>f||o<(u=f-u)||o>n-1-u))return 1===l&&a.translate(c,{x:(o+(n%2==1?1:-1))*d,y:0}),h(t+(c?o*d:0)+o*s,i,o,u,c,l)}))},i.newtonsCradle=function(t,e,n,i,o){for(var a=r.create({label:"Newtons Cradle"}),u=0;u<n;u++){var c=h.circle(t+u*(1.9*i),e+o,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),l=s.create({pointA:{x:t+u*(1.9*i),y:e},bodyB:c});r.addBody(a,c),r.addConstraint(a,l)}return a},i.car=function(t,e,n,i,o){var u=a.nextGroup(!0),c=.5*-n+20,l=.5*n-20,f=r.create({label:"Car"}),d=h.rectangle(t,e,n,i,{collisionFilter:{group:u},chamfer:{radius:.5*i},density:2e-4}),p=h.circle(t+c,e+0,o,{collisionFilter:{group:u},friction:.8}),v=h.circle(t+l,e+0,o,{collisionFilter:{group:u},friction:.8}),g=s.create({bodyB:d,pointB:{x:c,y:0},bodyA:p,stiffness:1,length:0}),m=s.create({bodyB:d,pointB:{x:l,y:0},bodyA:v,stiffness:1,length:0});return r.addBody(f,d),r.addBody(f,p),r.addBody(f,v),r.addConstraint(f,g),r.addConstraint(f,m),f},i.softBody=function(t,e,n,r,s,a,u,c,l,f){l=o.extend({inertia:1/0},l),f=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},f);var d=i.stack(t,e,n,r,s,a,(function(t,e){return h.circle(t,e,c,l)}));return i.mesh(d,n,r,u,f),d.label="Soft Body",d}},function(t,e,n){var i={};t.exports=i,n(85);var r=n(32);i.pathToVertices=function(t,e){"undefined"==typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,s,o,a,h,u,c,l,f,d,p,v=[],g=0,m=0,y=0;e=e||15;var x=function(t,e,n){var i=n%2==1&&n>1;if(!f||t!=f.x||e!=f.y){f&&i?(d=f.x,p=f.y):(d=0,p=0);var r={x:d+t,y:p+e};!i&&f||(f=r),v.push(r),m=d+t,y=p+e}},b=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":m=t.x,y=t.y;break;case"H":m=t.x;break;case"V":y=t.y}x(m,y,t.pathSegType)}};for(i._svgPathToAbsolute(t),o=t.getTotalLength(),u=[],n=0;n<t.pathSegList.numberOfItems;n+=1)u.push(t.pathSegList.getItem(n));for(c=u.concat();g<o;){if((h=u[t.getPathSegAtLength(g)])!=l){for(;c.length&&c[0]!=h;)b(c.shift());l=h}switch(h.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=t.getPointAtLength(g),x(a.x,a.y,0)}g+=e}for(n=0,s=c.length;n<s;++n)b(c[n]);return v},i._svgPathToAbsolute=function(t){for(var e,n,i,r,s,o,a=t.pathSegList,h=0,u=0,c=a.numberOfItems,l=0;l<c;++l){var f=a.getItem(l),d=f.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(d))"x"in f&&(h=f.x),"y"in f&&(u=f.y);else switch("x1"in f&&(i=h+f.x1),"x2"in f&&(s=h+f.x2),"y1"in f&&(r=u+f.y1),"y2"in f&&(o=u+f.y2),"x"in f&&(h+=f.x),"y"in f&&(u+=f.y),d){case"m":a.replaceItem(t.createSVGPathSegMovetoAbs(h,u),l);break;case"l":a.replaceItem(t.createSVGPathSegLinetoAbs(h,u),l);break;case"h":a.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(h),l);break;case"v":a.replaceItem(t.createSVGPathSegLinetoVerticalAbs(u),l);break;case"c":a.replaceItem(t.createSVGPathSegCurvetoCubicAbs(h,u,i,r,s,o),l);break;case"s":a.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(h,u,s,o),l);break;case"q":a.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(h,u,i,r),l);break;case"t":a.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(h,u),l);break;case"a":a.replaceItem(t.createSVGPathSegArcAbs(h,u,f.r1,f.r2,f.angle,f.largeArcFlag,f.sweepFlag),l);break;case"z":case"Z":h=e,u=n}"M"!=d&&"m"!=d||(e=h,n=u)}}},function(t,e,n){var i=n(87),r=n(41),s=n(0),o=n(249),a=n(9),h=n(2),u=n(127),c=n(63),l=new s({Extends:a,Mixins:[o.Bounce,o.Collision,o.Friction,o.Gravity,o.Mass,o.Sensor,o.Sleep,o.Static],initialize:function(t,e,n){a.call(this),this.tile=e,this.world=t,e.physics.matterBody&&e.physics.matterBody.destroy(),e.physics.matterBody=this;var i=h(n,"body",null),r=h(n,"addToWorld",!0);if(i)this.setBody(i,r);else{var s=e.getCollisionGroup();h(s,"objects",[]).length>0?this.setFromTileCollision(n):this.setFromTileRectangle(n)}},setFromTileRectangle:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);var e=this.tile.getBounds(),n=e.x+e.width/2,r=e.y+e.height/2,s=i.rectangle(n,r,e.width,e.height,t);return this.setBody(s,t.addToWorld),this},setFromTileCollision:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);for(var e=this.tile.tilemapLayer.scaleX,n=this.tile.tilemapLayer.scaleY,s=this.tile.getLeft(),o=this.tile.getTop(),a=this.tile.getCollisionGroup(),l=h(a,"objects",[]),f=[],d=0;d<l.length;d++){var p=l[d],v=s+p.x*e,g=o+p.y*n,m=p.width*e,y=p.height*n,x=null;if(p.rectangle)x=i.rectangle(v+m/2,g+y/2,m,y,t);else if(p.ellipse)x=i.circle(v+m/2,g+y/2,m/2,t);else if(p.polygon||p.polyline){var b=(p.polygon?p.polygon:p.polyline).map((function(t){return{x:t.x*e,y:t.y*n}})),w=c.create(b),_=c.centre(w);v+=_.x,g+=_.y,x=i.fromVertices(v,g,w,t)}x&&f.push(x)}return 1===f.length?this.setBody(f[0],t.addToWorld):f.length>1&&(t.parts=f,this.setBody(r.create(t),t.addToWorld)),this},setBody:function(t,e){return void 0===e&&(e=!0),this.body&&this.removeBody(),this.body=t,this.body.gameObject=this,e&&this.world.add(this.body),this},removeBody:function(){return this.body&&(this.world.remove(this.body),this.body.gameObject=void 0,this.body=void 0),this},destroy:function(){this.removeBody(),this.tile.physics.matterBody=void 0,this.removeAllListeners()}});t.exports=l},function(t,e,n){var i=n(1396);i.Body=n(41),i.Composite=n(119),i.World=n(596),i.Detector=n(273),i.Grid=n(597),i.Pairs=n(598),i.Pair=n(250),i.Query=n(1397),i.Resolver=n(599),i.SAT=n(274),i.Constraint=n(129),i.Common=n(32),i.Engine=n(1398),i.Events=n(166),i.Sleeping=n(165),i.Plugin=n(595),i.Bodies=n(87),i.Composites=n(591),i.Axes=n(271),i.Bounds=n(85),i.Svg=n(592),i.Vector=n(84),i.Vertices=n(63),i.World.add=i.Composite.add,i.World.remove=i.Composite.remove,i.World.addComposite=i.Composite.addComposite,i.World.addBody=i.Composite.addBody,i.World.addConstraint=i.Composite.addConstraint,i.World.clear=i.Composite.clear,t.exports=i},function(t,e,n){var i={};t.exports=i;var r=n(32);i._registry={},i.register=function(t){if(i.isPlugin(t)||r.warn("Plugin.register:",i.toString(t),"does not implement all required fields."),t.name in i._registry){var e=i._registry[t.name],n=i.versionParse(t.version).number,s=i.versionParse(e.version).number;n>s?(r.warn("Plugin.register:",i.toString(e),"was upgraded to",i.toString(t)),i._registry[t.name]=t):n<s?r.warn("Plugin.register:",i.toString(e),"can not be downgraded to",i.toString(t)):t!==e&&r.warn("Plugin.register:",i.toString(t),"is already registered to different plugin object")}else i._registry[t.name]=t;return t},i.resolve=function(t){return i._registry[i.dependencyParse(t).name]},i.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},i.isPlugin=function(t){return t&&t.name&&t.version&&t.install},i.isUsed=function(t,e){return t.used.indexOf(e)>-1},i.isFor=function(t,e){var n=t.for&&i.dependencyParse(t.for);return!t.for||e.name===n.name&&i.versionSatisfies(e.version,n.range)},i.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0!==t.uses.length){for(var n=i.dependencies(t),s=r.topologicalSort(n),o=[],a=0;a<s.length;a+=1)if(s[a]!==t.name){var h=i.resolve(s[a]);h?i.isUsed(t,h.name)||(i.isFor(h,t)||(r.warn("Plugin.use:",i.toString(h),"is for",h.for,"but installed on",i.toString(t)+"."),h._warned=!0),h.install?h.install(t):(r.warn("Plugin.use:",i.toString(h),"does not specify an install function."),h._warned=!0),h._warned?(o.push(" "+i.toString(h)),delete h._warned):o.push(" "+i.toString(h)),t.used.push(h.name)):o.push(" "+s[a])}o.length>0&&!h.silent&&r.info(o.join("  "))}else r.warn("Plugin.use:",i.toString(t),"does not specify any dependencies to install.")},i.dependencies=function(t,e){var n=i.dependencyParse(t),s=n.name;if(!(s in(e=e||{}))){t=i.resolve(t)||t,e[s]=r.map(t.uses||[],(function(e){i.isPlugin(e)&&i.register(e);var s=i.dependencyParse(e),o=i.resolve(e);return o&&!i.versionSatisfies(o.version,s.range)?(r.warn("Plugin.dependencies:",i.toString(o),"does not satisfy",i.toString(s),"used by",i.toString(n)+"."),o._warned=!0,t._warned=!0):o||(r.warn("Plugin.dependencies:",i.toString(e),"used by",i.toString(n),"could not be resolved."),t._warned=!0),s.name}));for(var o=0;o<e[s].length;o+=1)i.dependencies(e[s][o],e);return e}},i.dependencyParse=function(t){return r.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(t)||r.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},i.versionParse=function(t){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(t)||r.warn("Plugin.versionParse:",t,"is not a valid version or range.");var e=t.split("-");t=e[0];var n=isNaN(Number(t[0])),i=n?t.substr(1):t,s=r.map(i.split("."),(function(t){return Number(t)}));return{isRange:n,version:i,range:t,operator:n?t[0]:"",parts:s,prerelease:e[1],number:1e8*s[0]+1e4*s[1]+s[2]}},i.versionSatisfies=function(t,e){e=e||"*";var n=i.versionParse(e),r=n.parts,s=i.versionParse(t),o=s.parts;if(n.isRange){if("*"===n.operator||"*"===t)return!0;if("~"===n.operator)return o[0]===r[0]&&o[1]===r[1]&&o[2]>=r[2];if("^"===n.operator)return r[0]>0?o[0]===r[0]&&s.number>=n.number:r[1]>0?o[1]===r[1]&&o[2]>=r[2]:o[2]===r[2]}return t===e||"*"===t}},function(t,e,n){var i={};t.exports=i;var r=n(119),s=(n(129),n(32));i.create=function(t){var e=r.create();return s.extend(e,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}},t)}},function(t,e,n){var i={};t.exports=i;var r=n(250),s=n(273),o=n(32);i.create=function(t){var e={controller:i,detector:s.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return o.extend(e,t)},i.update=function(t,e,n,r){var s,o,a,h,u,c=n.world,l=t.buckets,f=!1,d=n.metrics;for(d.broadphaseTests=0,s=0;s<e.length;s++){var p=e[s];if((!p.isSleeping||r)&&!(p.bounds.max.x<c.bounds.min.x||p.bounds.min.x>c.bounds.max.x||p.bounds.max.y<c.bounds.min.y||p.bounds.min.y>c.bounds.max.y)){var v=i._getRegion(t,p);if(!p.region||v.id!==p.region.id||r){d.broadphaseTests+=1,p.region&&!r||(p.region=v);var g=i._regionUnion(v,p.region);for(o=g.startCol;o<=g.endCol;o++)for(a=g.startRow;a<=g.endRow;a++){h=l[u=i._getBucketId(o,a)];var m=o>=v.startCol&&o<=v.endCol&&a>=v.startRow&&a<=v.endRow,y=o>=p.region.startCol&&o<=p.region.endCol&&a>=p.region.startRow&&a<=p.region.endRow;!m&&y&&y&&h&&i._bucketRemoveBody(t,h,p),(p.region===v||m&&!y||r)&&(h||(h=i._createBucket(l,u)),i._bucketAddBody(t,h,p))}p.region=v,f=!0}}}f&&(t.pairsList=i._createActivePairsList(t))},i.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},i._regionUnion=function(t,e){var n=Math.min(t.startCol,e.startCol),r=Math.max(t.endCol,e.endCol),s=Math.min(t.startRow,e.startRow),o=Math.max(t.endRow,e.endRow);return i._createRegion(n,r,s,o)},i._getRegion=function(t,e){var n=e.bounds,r=Math.floor(n.min.x/t.bucketWidth),s=Math.floor(n.max.x/t.bucketWidth),o=Math.floor(n.min.y/t.bucketHeight),a=Math.floor(n.max.y/t.bucketHeight);return i._createRegion(r,s,o,a)},i._createRegion=function(t,e,n,i){return{id:t+","+e+","+n+","+i,startCol:t,endCol:e,startRow:n,endRow:i}},i._getBucketId=function(t,e){return"C"+t+"R"+e},i._createBucket=function(t,e){return t[e]=[]},i._bucketAddBody=function(t,e,n){for(var i=0;i<e.length;i++){var s=e[i];if(!(n.id===s.id||n.isStatic&&s.isStatic)){var o=r.id(n,s),a=t.pairs[o];a?a[2]+=1:t.pairs[o]=[n,s,1]}}e.push(n)},i._bucketRemoveBody=function(t,e,n){e.splice(e.indexOf(n),1);for(var i=0;i<e.length;i++){var s=e[i],o=r.id(n,s),a=t.pairs[o];a&&(a[2]-=1)}},i._createActivePairsList=function(t){var e,n,i=[];e=o.keys(t.pairs);for(var r=0;r<e.length;r++)(n=t.pairs[e[r]])[2]>0?i.push(n):delete t.pairs[e[r]];return i}},function(t,e,n){var i={};t.exports=i;var r=n(250),s=n(32);i._pairMaxIdleLife=1e3,i.create=function(t){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},i.update=function(t,e,n){var i,s,o,a,h=t.list,u=t.table,c=t.collisionStart,l=t.collisionEnd,f=t.collisionActive;for(c.length=0,l.length=0,f.length=0,a=0;a<h.length;a++)h[a].confirmedActive=!1;for(a=0;a<e.length;a++)(i=e[a]).collided&&((o=u[s=r.id(i.bodyA,i.bodyB)])?(o.isActive?f.push(o):c.push(o),r.update(o,i,n),o.confirmedActive=!0):(o=r.create(i,n),u[s]=o,c.push(o),h.push(o)));for(a=0;a<h.length;a++)(o=h[a]).isActive&&!o.confirmedActive&&(r.setActive(o,!1,n),l.push(o))},i.removeOld=function(t,e){var n,r,s,o,a=t.list,h=t.table,u=[];for(o=0;o<a.length;o++)(r=(n=a[o]).collision).bodyA.isSleeping||r.bodyB.isSleeping?n.timeUpdated=e:e-n.timeUpdated>i._pairMaxIdleLife&&u.push(o);for(o=0;o<u.length;o++)delete h[(n=a[s=u[o]-o]).id],a.splice(s,1)},i.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}},function(t,e,n){var i={};t.exports=i;var r=n(63),s=n(84),o=n(32),a=n(85);i._restingThresh=4,i._restingThreshTangent=6,i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i.preSolvePosition=function(t){var e,n,i;for(e=0;e<t.length;e++)(n=t[e]).isActive&&(i=n.activeContacts.length,n.collision.parentA.totalContacts+=i,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(t,e,n){var r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x,b=n*i._positionDampen;for(r=0;r<e.length;r++){var w=e[r];w.previousPositionImpulse.x=w.positionImpulse.x,w.previousPositionImpulse.y=w.positionImpulse.y}for(r=0;r<t.length;r++)(a=t[r]).isActive&&!a.isSensor&&(u=(h=a.collision).parentA,c=h.parentB,l=h.normal,p=u.previousPositionImpulse,v=c.previousPositionImpulse,d=h.penetration,m=v.x-p.x+d.x,y=v.y-p.y+d.y,f=(s=l.x)*m+(o=l.y)*y,a.separation=f,x=(f-a.slop)*b,(u.isStatic||c.isStatic)&&(x*=2),u.isStatic||u.isSleeping||(g=x/u.totalContacts,u.positionImpulse.x+=s*g,u.positionImpulse.y+=o*g),c.isStatic||c.isSleeping||(g=x/c.totalContacts,c.positionImpulse.x-=s*g,c.positionImpulse.y-=o*g))},i.postSolvePosition=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.totalContacts=0,0!==n.positionImpulse.x||0!==n.positionImpulse.y){for(var o=0;o<n.parts.length;o++){var h=n.parts[o];r.translate(h.vertices,n.positionImpulse),a.update(h.bounds,h.vertices,n.velocity),h.position.x+=n.positionImpulse.x,h.position.y+=n.positionImpulse.y}n.positionPrev.x+=n.positionImpulse.x,n.positionPrev.y+=n.positionImpulse.y,s.dot(n.positionImpulse,n.velocity)<0?(n.positionImpulse.x=0,n.positionImpulse.y=0):(n.positionImpulse.x*=i._positionWarming,n.positionImpulse.y*=i._positionWarming)}}},i.preSolveVelocity=function(t){var e,n,i,r,o,a,h,u,c,l,f,d,p,v,g=s._temp[0],m=s._temp[1];for(e=0;e<t.length;e++)if((i=t[e]).isActive&&!i.isSensor)for(r=i.activeContacts,a=(o=i.collision).parentA,h=o.parentB,u=o.normal,c=o.tangent,n=0;n<r.length;n++)f=(l=r[n]).vertex,d=l.normalImpulse,p=l.tangentImpulse,0===d&&0===p||(g.x=u.x*d+c.x*p,g.y=u.y*d+c.y*p,a.isStatic||a.isSleeping||(v=s.sub(f,a.position,m),a.positionPrev.x+=g.x*a.inverseMass,a.positionPrev.y+=g.y*a.inverseMass,a.anglePrev+=s.cross(v,g)*a.inverseInertia),h.isStatic||h.isSleeping||(v=s.sub(f,h.position,m),h.positionPrev.x-=g.x*h.inverseMass,h.positionPrev.y-=g.y*h.inverseMass,h.anglePrev-=s.cross(v,g)*h.inverseInertia))},i.solveVelocity=function(t,e){for(var n=e*e,r=s._temp[0],a=s._temp[1],h=s._temp[2],u=s._temp[3],c=s._temp[4],l=s._temp[5],f=0;f<t.length;f++){var d=t[f];if(d.isActive&&!d.isSensor){var p=d.collision,v=p.parentA,g=p.parentB,m=p.normal,y=p.tangent,x=d.activeContacts,b=1/x.length;v.velocity.x=v.position.x-v.positionPrev.x,v.velocity.y=v.position.y-v.positionPrev.y,g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,v.angularVelocity=v.angle-v.anglePrev,g.angularVelocity=g.angle-g.anglePrev;for(var w=0;w<x.length;w++){var _=x[w],T=_.vertex,E=s.sub(T,v.position,a),S=s.sub(T,g.position,h),C=s.add(v.velocity,s.mult(s.perp(E),v.angularVelocity),u),A=s.add(g.velocity,s.mult(s.perp(S),g.angularVelocity),c),I=s.sub(C,A,l),P=s.dot(m,I),R=s.dot(y,I),O=Math.abs(R),k=o.sign(R),M=(1+d.restitution)*P,D=o.clamp(d.separation+P,0,1)*i._frictionNormalMultiplier,L=R,N=1/0;O>d.friction*d.frictionStatic*D*n&&(N=O,L=o.clamp(d.friction*k*n,-N,N));var F=s.cross(E,m),B=s.cross(S,m),U=b/(v.inverseMass+g.inverseMass+v.inverseInertia*F*F+g.inverseInertia*B*B);if(M*=U,L*=U,P<0&&P*P>i._restingThresh*n)_.normalImpulse=0;else{var V=_.normalImpulse;_.normalImpulse=Math.min(_.normalImpulse+M,0),M=_.normalImpulse-V}if(R*R>i._restingThreshTangent*n)_.tangentImpulse=0;else{var Y=_.tangentImpulse;_.tangentImpulse=o.clamp(_.tangentImpulse+L,-N,N),L=_.tangentImpulse-Y}r.x=m.x*M+y.x*L,r.y=m.y*M+y.y*L,v.isStatic||v.isSleeping||(v.positionPrev.x+=r.x*v.inverseMass,v.positionPrev.y+=r.y*v.inverseMass,v.anglePrev+=s.cross(E,r)*v.inverseInertia),g.isStatic||g.isSleeping||(g.positionPrev.x-=r.x*g.inverseMass,g.positionPrev.y-=r.y*g.inverseMass,g.anglePrev-=s.cross(S,r)*g.inverseInertia)}}}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(276);t.exports=function(t,e,n,r){for(var s=t[0],o=1;o<t.length;o++){var a=t[o];i(a,s,e,n,r),s=a}return t}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"angle",e,n,r,s)}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];e.call(n,r)}return t}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=n;i<t.length;i++){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=n;i<t.length;i++){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},function(t,e,n){var i=n(289),r=n(124),s=n(2),o=n(1),a=new(n(130))({sys:{queueDepthSort:o,events:{once:o}}},0,0,1,1);t.exports=function(t,e){void 0===e&&(e={});var n=e.hasOwnProperty("width"),o=e.hasOwnProperty("height"),h=s(e,"width",-1),u=s(e,"height",-1),c=s(e,"cellWidth",1),l=s(e,"cellHeight",c),f=s(e,"position",r.TOP_LEFT),d=s(e,"x",0),p=s(e,"y",0),v=0,g=0,m=h*c,y=u*l;a.setPosition(d,p),a.setSize(c,l);for(var x=0;x<t.length;x++)if(i(t[x],a,f),n&&-1===h)a.x+=c;else if(o&&-1===u)a.y+=l;else if(o&&!n){if(g+=l,a.y+=l,g===y&&(g=0,v+=c,a.y=p,a.x+=c,v===m))break}else if(v+=c,a.x+=c,v===m&&(v=0,g+=l,a.x=d,a.y+=l,g===y))break;return t}},function(t,e,n){var i=n(18),r={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,r){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(r,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,this._alphaBR=e,0===e?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);this._alphaTL=e,0!==e&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);this._alphaTR=e,0!==e&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);this._alphaBL=e,0!==e&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);this._alphaBR=e,0!==e&&(this.renderFlags|=2)}}};t.exports=r},function(t,e){t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},function(t,e,n){var i=n(10),r=n(308),s=n(3),o={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&r(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t){return void 0===t&&(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,t},getTopLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,r,s,o,a,h,u;if(void 0===t&&(t=new i),this.parentContainer){var c=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(t),c.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),c.transformPoint(t.x,t.y,t),r=t.x,s=t.y,this.getBottomLeft(t),c.transformPoint(t.x,t.y,t),o=t.x,a=t.y,this.getBottomRight(t),c.transformPoint(t.x,t.y,t),h=t.x,u=t.y}else this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),r=t.x,s=t.y,this.getBottomLeft(t),o=t.x,a=t.y,this.getBottomRight(t),h=t.x,u=t.y;return t.x=Math.min(e,r,o,h),t.y=Math.min(n,s,a,u),t.width=Math.max(e,r,o,h)-t.x,t.height=Math.max(n,s,a,u)-t.y,t}};t.exports=o},function(t,e){t.exports="blur"},function(t,e){t.exports="boot"},function(t,e){t.exports="contextlost"},function(t,e){t.exports="contextrestored"},function(t,e){t.exports="destroy"},function(t,e){t.exports="focus"},function(t,e){t.exports="hidden"},function(t,e){t.exports="pause"},function(t,e){t.exports="postrender"},function(t,e){t.exports="poststep"},function(t,e){t.exports="prerender"},function(t,e){t.exports="prestep"},function(t,e){t.exports="ready"},function(t,e){t.exports="resume"},function(t,e){t.exports="step"},function(t,e){t.exports="visible"},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="render"},function(t,e){t.exports="resize"},function(t,e){t.exports={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}},function(t,e,n){var i=n(36),r=n(99),s=n(6),o=n(100),a=n(3),h={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:o.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"==typeof t&&(t={duration:t}),t.from=s(t,"from",0),t.to=s(t,"to",1);var h=r(t,"positionOnPath",!1);this.rotateToPath=r(t,"rotateToPath",!1),this.pathRotationOffset=s(t,"rotationOffset",0);var u=s(t,"startAt",e);if(u&&(t.onStart=function(t){var e=t.data[0];e.progress=u,e.elapsed=e.duration*u;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.target[e.key]=e.current}),this.pathOffset||(this.pathOffset=new a(this.x,this.y)),this.pathVector||(this.pathVector=new a),this.pathDelta||(this.pathDelta=new a),this.pathDelta.reset(),this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=o.PLAYING_FORWARD,this.rotateToPath){var c=this.path.getPoint(.1);this.rotation=Math.atan2(c.y-this.y,c.x-this.x)+i(this.pathRotationOffset)}return this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t){var e=t.data[0],n=this.pathDelta,r=this.pathVector;if(n.copy(r).negate(),e.state===o.COMPLETE)return this.path.getPoint(1,r),n.add(r),r.add(this.pathOffset),void this.setPosition(r.x,r.y);if(e.state!==o.PLAYING_FORWARD&&e.state!==o.PLAYING_BACKWARD)return;this.path.getPoint(t.getValue(),r),n.add(r),r.add(this.pathOffset);var s=this.x,a=this.y;this.setPosition(r.x,r.y);var h=this.x-s,u=this.y-a;if(0===h&&0===u)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(u,h)+i(this.pathRotationOffset))}}};t.exports=h},function(t,e){var n={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){return void 0===t&&(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=n},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,n,i){return void 0===t&&(t=16777215),void 0===e&&(e=t,n=t,i=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=n,this.tintBottomRight=i,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tint:{set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}},function(t,e){t.exports="changedata"},function(t,e){t.exports="changedata-"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedata"},function(t,e){t.exports="setdata"},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="complete"},function(t,e){t.exports="created"},function(t,e){t.exports="error"},function(t,e){t.exports="loop"},function(t,e){t.exports="play"},function(t,e){t.exports="seeked"},function(t,e){t.exports="seeking"},function(t,e){t.exports="stop"},function(t,e){t.exports="timeout"},function(t,e){t.exports="unlocked"},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="boot"},function(t,e){t.exports="create"},function(t,e){t.exports="destroy"},function(t,e){t.exports="pause"},function(t,e){t.exports="postupdate"},function(t,e){t.exports="prerender"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="ready"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="render"},function(t,e){t.exports="resume"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="sleep"},function(t,e){t.exports="start"},function(t,e){t.exports="transitioncomplete"},function(t,e){t.exports="transitioninit"},function(t,e){t.exports="transitionout"},function(t,e){t.exports="transitionstart"},function(t,e){t.exports="transitionwake"},function(t,e){t.exports="update"},function(t,e){t.exports="wake"},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=0;o<t.length;o++)t[o].x=e.x+e.radius*Math.cos(r),t[o].y=e.y+e.radius*Math.sin(r),r+=s;return t}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=e.width/2,a=e.height/2,h=0;h<t.length;h++)t[h].x=e.x+o*Math.cos(r),t[h].y=e.y+a*Math.sin(r),r+=s;return t}},function(t,e,n){var i=n(172);t.exports=function(t,e){for(var n=i(e,t.length),r=0;r<t.length;r++){var s=t[r],o=n[r];s.x=o.x,s.y=o.y}return t}},function(t,e,n){var i=n(316),r=n(178),s=n(179);t.exports=function(t,e,n){void 0===n&&(n=0);var o=i(e,!1,t.length);n>0?r(o,n):n<0&&s(o,Math.abs(n));for(var a=0;a<t.length;a++)t[a].x=o[a].x,t[a].y=o[a].y;return t}},function(t,e,n){var i=n(317);t.exports=function(t,e,n){var r=i({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},n),s=i({x1:e.x2,y1:e.y2,x2:e.x3,y2:e.y3},n),o=i({x1:e.x3,y1:e.y3,x2:e.x1,y2:e.y1},n);r.pop(),s.pop(),o.pop();for(var a=(r=r.concat(s,o)).length/t.length,h=0,u=0;u<t.length;u++){var c=t[u],l=r[Math.floor(h)];c.x=l.x,c.y=l.y,h+=a}return t}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];r.anims&&r.anims.play(e,n)}return t}},function(t,e,n){var i=n(170);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(180);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(173);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(174);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(181);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},function(t,e,n){var i=n(182),r=n(50);t.exports=function(t,e,n){for(var s=e.x,o=e.y,a=0;a<t.length;a++){var h=t[a];i(h,s,o,n,Math.max(1,r(h.x,h.y,s,o)))}return t}},function(t,e,n){var i=n(182);t.exports=function(t,e,n,r){var s=e.x,o=e.y;if(0===r)return t;for(var a=0;a<t.length;a++)i(t[a],s,o,n,r);return t}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},function(t,e,n){var i=n(46);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r){return i(t,"blendMode",e,0,n,r)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"depth",e,n,r,s)}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++)t[i].setInteractive(e,n);return t}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"originX",e,r,o,a),i(t,"originY",n,s,o,a),t.forEach((function(t){t.updateDisplayOrigin()})),t}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"scrollFactorX",e,r,o,a),i(t,"scrollFactorY",n,s,o,a)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"scrollFactorX",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"scrollFactorY",e,n,r,s)}},function(t,e){t.exports=function(t,e,n,i,r){for(var s=0;s<t.length;s++)t[s].setTint(e,n,i,r);return t}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r){return i(t,"visible",e,0,n,r)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s,o,a){return null==n&&(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s){var o,a,h,u,c,l;if(void 0===r&&(r=0),void 0===s&&(s=new i),t.length>1)if(0===r){var f=t.length-1;for(o=t[f].x,a=t[f].y,h=f-1;h>=0;h--)u=(l=t[h]).x,c=l.y,l.x=o,l.y=a,o=u,a=c;t[f].x=e,t[f].y=n}else{for(o=t[0].x,a=t[0].y,h=1;h<t.length;h++)u=(l=t[h]).x,c=l.y,l.x=o,l.y=a,o=u,a=c;t[0].x=e,t[0].y=n}else o=t[0].x,a=t[0].y,t[0].x=e,t[0].y=n;return s.x=o,s.y=a,s}},function(t,e,n){var i=n(132);t.exports=function(t){return i(t)}},function(t,e,n){var i=n(183);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},function(t,e,n){var i=n(184);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},function(t,e){t.exports=function(t,e,n,i,r){void 0===r&&(r=!1);var s,o=Math.abs(i-n)/t.length;if(r)for(s=0;s<t.length;s++)t[s][e]+=s*o+n;else for(s=0;s<t.length;s++)t[s][e]=s*o+n;return t}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}},function(t,e,n){var i=n(68);t.exports=function(t,e,n){void 0===n&&(n=0);for(var r=0;r<t.length;r++){var s=t[r];s.x=i(s.x,e.left-n,e.right+n),s.y=i(s.y,e.top-n,e.bottom+n)}return t}},function(t,e,n){t.exports={Animation:n(185),AnimationFrame:n(319),AnimationManager:n(321),AnimationState:n(164),Events:n(133)}},function(t,e){t.exports="add"},function(t,e){t.exports="animationcomplete"},function(t,e){t.exports="animationcomplete-"},function(t,e){t.exports="animationrepeat"},function(t,e){t.exports="animationrestart"},function(t,e){t.exports="animationstart"},function(t,e){t.exports="animationstop"},function(t,e){t.exports="animationupdate"},function(t,e){t.exports="pauseall"},function(t,e){t.exports="remove"},function(t,e){t.exports="resumeall"},function(t,e,n){t.exports={BaseCache:n(323),CacheManager:n(325),Events:n(324)}},function(t,e){t.exports="add"},function(t,e){t.exports="remove"},function(t,e,n){t.exports={Controls:n(739),Scene2D:n(742)}},function(t,e,n){t.exports={FixedKeyControl:n(740),SmoothedKeyControl:n(741)}},function(t,e,n){var i=n(0),r=n(6),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.minZoom=r(t,"minZoom",.001),this.maxZoom=r(t,"maxZoom",1e3),this.speedX=0,this.speedY=0;var e=r(t,"speed",null);"number"==typeof e?(this.speedX=e,this.speedY=e):(this.speedX=r(t,"speed.x",0),this.speedY=r(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<this.minZoom&&(e.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed,e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},function(t,e,n){var i=n(0),r=n(6),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.minZoom=r(t,"minZoom",.001),this.maxZoom=r(t,"maxZoom",1e3),this.accelX=0,this.accelY=0;var e=r(t,"acceleration",null);"number"==typeof e?(this.accelX=e,this.accelY=e):(this.accelX=r(t,"acceleration.x",0),this.accelY=r(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=r(t,"drag",null);"number"==typeof n?(this.dragX=n,this.dragY=n):(this.dragX=r(t,"drag.x",0),this.dragY=r(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var i=r(t,"maxSpeed",null);"number"==typeof i?(this.maxSpeedX=i,this.maxSpeedY=i):(this.maxSpeedX=r(t,"maxSpeed.x",0),this.maxSpeedY=r(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<this.minZoom?e.zoom=this.minZoom:e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},function(t,e,n){t.exports={Camera:n(326),BaseCamera:n(134),CameraManager:n(799),Effects:n(333),Events:n(37)}},function(t,e){t.exports="cameradestroy"},function(t,e){t.exports="camerafadeincomplete"},function(t,e){t.exports="camerafadeinstart"},function(t,e){t.exports="camerafadeoutcomplete"},function(t,e){t.exports="camerafadeoutstart"},function(t,e){t.exports="cameraflashcomplete"},function(t,e){t.exports="cameraflashstart"},function(t,e){t.exports="followupdate"},function(t,e){t.exports="camerapancomplete"},function(t,e){t.exports="camerapanstart"},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="camerarotatecomplete"},function(t,e){t.exports="camerarotatestart"},function(t,e){t.exports="camerashakecomplete"},function(t,e){t.exports="camerashakestart"},function(t,e){t.exports="camerazoomcomplete"},function(t,e){t.exports="camerazoomstart"},function(t,e,n){var i=n(18),r=n(0),s=n(37),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,o,a,h){if(void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===h&&(h=this.camera.scene),!o&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=i,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=h;var u=t?s.FADE_OUT_START:s.FADE_IN_START;return this.camera.emit(u,this.camera,this,e,n,i,r),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var n=this.camera,i=this.red/255,r=this.green/255,s=this.blue/255;return t.drawFillRect(n.x,n.y,n.width,n.height,e(s,r,i,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?s.FADE_OUT_COMPLETE:s.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},function(t,e,n){var i=n(18),r=n(0),s=n(37),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,o,a){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===i&&(i=255),void 0===r&&(r=!1),void 0===o&&(o=null),void 0===a&&(a=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=i,this.alpha=1,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=a,this.camera.emit(s.FLASH_START,this.camera,this,t,e,n,i)),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=1-this.progress:this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var n=this.camera,i=this.red/255,r=this.green/255,s=this.blue/255;return t.drawFillRect(n.x,n.y,n.width,n.height,e(s,r,i,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},function(t,e,n){var i=n(18),r=n(0),s=n(135),o=n(37),a=n(3),h=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new a,this.current=new a,this.destination=new a,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,a,h){void 0===n&&(n=1e3),void 0===i&&(i=s.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===h&&(h=this.camera.scene);var u=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=n,this.progress=0,this.source.set(u.scrollX,u.scrollY),this.destination.set(t,e),u.getScroll(t,e,this.current),"string"==typeof i&&s.hasOwnProperty(i)?this.ease=s[i]:"function"==typeof i&&(this.ease=i),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=h,this.camera.emit(o.PAN_START,this.camera,this,n,t,e)),u},update:function(t,e){if(this.isRunning){this._elapsed+=e;var n=i(this._elapsed/this.duration,0,1);this.progress=n;var r=this.camera;if(this._elapsed<this.duration){var s=this.ease(n);r.getScroll(this.destination.x,this.destination.y,this.current);var o=this.source.x+(this.current.x-this.source.x)*s,a=this.source.y+(this.current.y-this.source.y)*s;r.setScroll(o,a),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,o,a)}else r.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,r.scrollX,r.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=h},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}},function(t,e){t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},function(t,e){t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},function(t,e){t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},function(t,e){t.exports=function(t){return 1-Math.sqrt(1-t*t)}},function(t,e){t.exports=function(t){return Math.sqrt(1- --t*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},function(t,e){t.exports=function(t){return t*t*t}},function(t,e){t.exports=function(t){return--t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},function(t,e){t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},function(t,e){t.exports=function(t){return 1-Math.pow(2,-10*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t){return t*t}},function(t,e){t.exports=function(t){return t*(2-t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},function(t,e){t.exports=function(t){return t*t*t*t}},function(t,e){t.exports=function(t){return 1- --t*t*t*t}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},function(t,e){t.exports=function(t){return t*t*t*t*t}},function(t,e){t.exports=function(t){return--t*t*t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}},function(t,e,n){var i=n(18),r=n(0),s=n(37),o=n(3),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new o,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"==typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=i,this._onUpdateScope=r,this.camera.emit(s.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(t,e){if(this.isRunning)if(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,r=this.camera.width,s=this.camera.height,o=this.camera.zoom;this._offsetX=(Math.random()*n.x*r*2-n.x*r)*o,this._offsetY=(Math.random()*n.y*s*2-n.y*s)*o,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});t.exports=a},function(t,e,n){var i=n(18),r=n(0),s=n(37),o=n(135),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,n,i,r,a,h){void 0===n&&(n=1e3),void 0===i&&(i=o.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===h&&(h=this.camera.scene),void 0===e&&(e=!1),this.shortestPath=e;var u=t;t<0?(u=-1*t,this.clockwise=!1):this.clockwise=!0;var c=360*Math.PI/180;u-=Math.floor(u/c)*c;var l=this.camera;if(!r&&this.isRunning)return l;if(this.isRunning=!0,this.duration=n,this.progress=0,this.source=l.rotation,this.destination=u,"string"==typeof i&&o.hasOwnProperty(i)?this.ease=o[i]:"function"==typeof i&&(this.ease=i),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=h,this.shortestPath){var f,d;(f=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+c)-this.source)<(d=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+c)-this.destination)?this.clockwise=!0:f>d&&(this.clockwise=!1)}return this.camera.emit(s.ROTATE_START,this.camera,this,n,u),l},update:function(t,e){if(this.isRunning){this._elapsed+=e;var n=i(this._elapsed/this.duration,0,1);this.progress=n;var r=this.camera;if(this._elapsed<this.duration){var s=this.ease(n);this.current=r.rotation;var o,a=360*Math.PI/180,h=this.destination,u=this.current;!1===this.clockwise&&(h=this.current,u=this.destination),o=h>=u?Math.abs(h-u):Math.abs(h+a)-u;var c;c=this.clockwise?r.rotation+o*s:r.rotation-o*s,r.rotation=c,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,c)}else r.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=a},function(t,e,n){var i=n(18),r=n(0),s=n(135),o=n(37),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,a){void 0===e&&(e=1e3),void 0===n&&(n=s.Linear),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===a&&(a=this.camera.scene);var h=this.camera;return!i&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=h.zoom,this.destination=t,"string"==typeof n&&s.hasOwnProperty(n)?this.ease=s[n]:"function"==typeof n&&(this.ease=n),this._elapsed=0,this._onUpdate=r,this._onUpdateScope=a,this.camera.emit(o.ZOOM_START,this.camera,this,e,t)),h},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=a},function(t,e,n){var i=n(326),r=n(0),s=n(2),o=n(24),a=n(57),h=n(104),u=n(20),c=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.start,this)},boot:function(){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new i(0,0,t.scale.width,t.scale.height).setScene(this.scene),t.game.scale.on(h.RESIZE,this.onResize,this),this.systems.events.once(u.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(u.UPDATE,this.update,this),e.once(u.SHUTDOWN,this.shutdown,this)},add:function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===r&&(r=this.scene.sys.scale.height),void 0===s&&(s=!1),void 0===o&&(o="");var a=new i(t,e,n,r);return a.setName(o),a.setScene(this.scene),a.setRoundPixels(this.roundPixels),a.id=this.getNextID(),this.cameras.push(a),s&&(this.main=a),a},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,n=0;n<32;n++){for(var i=!1,r=0;r<t.length;r++){var s=t[r];s&&s.id===e&&(i=!0)}if(!i)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,n=this.cameras,i=0;i<n.length;i++){var r=n[i];(!t||t&&r.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,i=0;i<t.length;i++){var r=t[i],o=s(r,"x",0),a=s(r,"y",0),h=s(r,"width",e),u=s(r,"height",n),c=this.add(o,a,h,u);c.name=s(r,"name",""),c.zoom=s(r,"zoom",1),c.rotation=s(r,"rotation",0),c.scrollX=s(r,"scrollX",0),c.scrollY=s(r,"scrollY",0),c.roundPixels=s(r,"roundPixels",!1),c.visible=s(r,"visible",!0);var l=s(r,"backgroundColor",!1);l&&c.setBackgroundColor(l);var f=s(r,"bounds",null);if(f){var d=s(f,"x",0),p=s(f,"y",0),v=s(f,"width",e),g=s(f,"height",n);c.setBounds(d,p,v,g)}}return this},getCamera:function(t){for(var e=this.cameras,n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,n=t.x,i=t.y,r=[],s=0;s<e.length;s++){var o=e[s];o.visible&&o.inputEnabled&&a(o,n,i)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0,i=this.cameras,r=0;r<t.length;r++){var s=i.indexOf(t[r]);-1!==s&&(e?i[s].destroy():i[s].renderList=[],i.splice(s,1),n++)}return!this.main&&i[0]&&(this.main=i[0]),n},render:function(t,e){for(var n=this.scene,i=this.cameras,r=0;r<this.cameras.length;r++){var s=i[r];if(s.visible&&s.alpha>0){s.preRender();var o=this.getVisibleChildren(e.getChildren(),s);t.render(n,o,s)}}},getVisibleChildren:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];r.willRender(e)&&n.push(r)}return n},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].update(t,e)},onResize:function(t,e,n,i,r){for(var s=0;s<this.cameras.length;s++){var o=this.cameras[s];0===o._x&&0===o._y&&o._width===i&&o._height===r&&o.setSize(e.width,e.height)}},resize:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(u.UPDATE,this.update,this),e.off(u.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.scene.sys.events.off(u.START,this.start,this),this.scene=null,this.systems=null}});o.register("CameraManager",c,"cameras"),t.exports=c},function(t,e){t.exports="enterfullscreen"},function(t,e){t.exports="fullscreenfailed"},function(t,e){t.exports="fullscreenunsupported"},function(t,e){t.exports="leavefullscreen"},function(t,e){t.exports="orientationchange"},function(t,e){t.exports="resize"},function(t,e,n){t.exports={Config:n(346),CreateRenderer:n(366),DebugHeader:n(384),Events:n(22),TimeStep:n(385),VisibilityHandler:n(387)}},function(t,e){var n,i,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var h,u=[],c=!1,l=-1;function f(){c&&h&&(c=!1,h.length?u=h.concat(u):l=-1,u.length&&d())}function d(){if(!c){var t=a(f);c=!0;for(var e=u.length;e;){for(h=u,u=[];++l<e;)h&&h[l].run();l=-1,e=u.length}h=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){var i=n(137),r={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};t.exports=("function"==typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(r.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(r.mspointer=!0),navigator.getGamepads&&(r.gamepads=!0),"onwheel"in window||i.ie&&"WheelEvent"in window?r.wheelEvent="wheel":"onmousewheel"in window?r.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(r.wheelEvent="DOMMouseScroll")),r)},function(t,e,n){var i=n(137),r={audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};t.exports=function(){if("function"==typeof importScripts)return r;r.audioData=!!window.Audio,r.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var t=document.createElement("audio"),e=!!t.canPlayType;try{if(e&&(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(r.ogg=!0),(t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||t.canPlayType("audio/opus;").replace(/^no$/,""))&&(r.opus=!0),t.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(r.mp3=!0),t.canPlayType("audio/wav").replace(/^no$/,"")&&(r.wav=!0),(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;").replace(/^no$/,""))&&(r.m4a=!0),t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(r.webm=!0),""!==t.canPlayType('audio/mp4;codecs="ec-3"')))if(i.edge)r.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var n=parseInt(RegExp.$1,10),s=parseInt(RegExp.$2,10);(10===n&&s>=11||n>10)&&(r.dolby=!0)}}catch(t){}return r}()},function(t,e){var n={h264:!1,hls:!1,mp4:!1,ogg:!1,vp9:!1,webm:!1};t.exports=function(){if("function"==typeof importScripts)return n;var t=document.createElement("video"),e=!!t.canPlayType;try{e&&(t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(n.ogg=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(n.h264=!0,n.mp4=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(n.webm=!0),t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(n.vp9=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(n.hls=!0))}catch(t){}return n}()},function(t,e){var n={available:!1,cancel:"",keyboard:!1,request:""};t.exports=function(){if("function"==typeof importScripts)return n;var t,e="Fullscreen",i="FullScreen",r=["request"+e,"request"+i,"webkitRequest"+e,"webkitRequest"+i,"msRequest"+e,"msRequest"+i,"mozRequest"+i,"mozRequest"+e];for(t=0;t<r.length;t++)if(document.documentElement[r[t]]){n.available=!0,n.request=r[t];break}var s=["cancel"+i,"exit"+e,"webkitCancel"+i,"webkitExit"+e,"msCancel"+i,"msExit"+e,"mozCancel"+i,"mozExit"+e];if(n.available)for(t=0;t<s.length;t++)if(document[s[t]]){n.cancel=s[t];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(n.keyboard=!0),Object.defineProperty(n,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),n}()},function(t,e,n){t.exports={Between:n(349),BetweenPoints:n(350),BetweenPointsY:n(813),BetweenY:n(814),CounterClockwise:n(815),Normalize:n(351),Random:n(816),RandomDegrees:n(817),Reverse:n(818),RotateTo:n(819),ShortestBetween:n(820),Wrap:n(269),WrapDegrees:n(270)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},function(t,e,n){var i=n(14);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},function(t,e,n){var i=n(138);t.exports=function(){return i(-Math.PI,Math.PI)}},function(t,e,n){var i=n(138);t.exports=function(){return i(-180,180)}},function(t,e,n){var i=n(351);t.exports=function(t){return i(t+Math.PI)}},function(t,e,n){var i=n(14);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),e>t?t+=n:e<t&&(t-=n))),t}},function(t,e){t.exports=function(t,e){var n=e-t;return 0===n?0:n-360*Math.floor((n- -180)/360)}},function(t,e,n){t.exports={Between:n(50),BetweenPoints:n(352),BetweenPointsSquared:n(822),Chebyshev:n(823),Power:n(824),Snake:n(825),Squared:n(353)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},function(t,e){t.exports=function(t,e,n,i){return Math.max(Math.abs(t-n),Math.abs(e-i))}},function(t,e){t.exports=function(t,e,n,i,r){return void 0===r&&(r=2),Math.sqrt(Math.pow(n-t,r)+Math.pow(i-e,r))}},function(t,e){t.exports=function(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}},function(t,e,n){t.exports={Back:n(334),Bounce:n(335),Circular:n(336),Cubic:n(337),Elastic:n(338),Expo:n(339),Linear:n(340),Quadratic:n(341),Quartic:n(342),Quintic:n(343),Sine:n(344),Stepped:n(345)}},function(t,e,n){t.exports={Ceil:n(828),Equal:n(125),Floor:n(829),GreaterThan:n(354),LessThan:n(355)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},function(t,e,n){t.exports={Bezier:n(831),CatmullRom:n(832),CubicBezier:n(358),Linear:n(833),QuadraticBezier:n(359),SmoothStep:n(360),SmootherStep:n(834)}},function(t,e,n){var i=n(356);t.exports=function(t,e){for(var n=0,r=t.length-1,s=0;s<=r;s++)n+=Math.pow(1-e,r-s)*Math.pow(e,s)*t[s]*i(r,s);return n}},function(t,e,n){var i=n(194);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return t[0]===t[n]?(e<0&&(s=Math.floor(r=n*(1+e))),i(r-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(i(-r,t[0],t[0],t[1],t[1])-t[0]):e>1?t[n]-(i(r-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(r-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}},function(t,e,n){var i=n(136);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return e<0?i(t[0],t[1],r):e>1?i(t[n],t[n-1],n-r):i(t[s],t[s+1>n?n:s+1],r-s)}},function(t,e,n){var i=n(183);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){t.exports={GetNext:n(361),IsSize:n(139),IsValue:n(836)}},function(t,e){t.exports=function(t){return t>0&&0==(t&t-1)}},function(t,e,n){t.exports={Ceil:n(140),Floor:n(77),To:n(838)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return this.n=n,2.3283064365386963e-10*(n>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},function(t,e){t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},function(t,e){t.exports=function(t,e){return Math.abs(t-e)}},function(t,e,n){var i=n(18),r=n(0),s=n(69),o=n(1),a=new s,h=new r({initialize:function t(e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=t.DefaultOrder),this._x=e,this._y=n,this._z=i,this._order=r,this.onChangeCallback=o},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,n,i){return void 0===i&&(i=this._order),this._x=t,this._y=e,this._z=n,this._order=i,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,n){return void 0===e&&(e=this._order),void 0===n&&(n=!1),a.fromQuat(t),this.setFromRotationMatrix(a,e,n)},setFromRotationMatrix:function(t,e,n){void 0===e&&(e=this._order),void 0===n&&(n=!1);var r=t.val,s=r[0],o=r[4],a=r[8],h=r[1],u=r[5],c=r[9],l=r[2],f=r[6],d=r[10],p=0,v=0,g=0,m=.99999;switch(e){case"XYZ":v=Math.asin(i(a,-1,1)),Math.abs(a)<m?(p=Math.atan2(-c,d),g=Math.atan2(-o,s)):p=Math.atan2(f,u);break;case"YXZ":p=Math.asin(-i(c,-1,1)),Math.abs(c)<m?(v=Math.atan2(a,d),g=Math.atan2(h,u)):v=Math.atan2(-l,s);break;case"ZXY":p=Math.asin(i(f,-1,1)),Math.abs(f)<m?(v=Math.atan2(-l,d),g=Math.atan2(-o,u)):g=Math.atan2(h,s);break;case"ZYX":v=Math.asin(-i(l,-1,1)),Math.abs(l)<m?(p=Math.atan2(f,d),g=Math.atan2(h,s)):g=Math.atan2(-o,u);break;case"YZX":g=Math.asin(i(h,-1,1)),Math.abs(h)<m?(p=Math.atan2(-c,u),v=Math.atan2(-l,s)):v=Math.atan2(a,d);break;case"XZY":g=Math.asin(-i(o,-1,1)),Math.abs(o)<m?(p=Math.atan2(f,u),v=Math.atan2(a,s)):p=Math.atan2(-c,d)}return this._x=p,this._y=v,this._z=g,this._order=e,n&&this.onChangeCallback(this),this}});h.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],h.DefaultOrder="XYZ",t.exports=h},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},function(t,e){t.exports=function(t,e){return t/e/1e3}},function(t,e){t.exports=function(t){return t==parseFloat(t)?!(t%2):void 0}},function(t,e){t.exports=function(t){return t===parseFloat(t)?!(t%2):void 0}},function(t,e){t.exports=function(t,e,n){return Math.min(t+e,n)}},function(t,e){t.exports=function(t,e,n){return Math.max(t-e,n)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var r=(t-e)/(n-e);return r>1?void 0!==i?(r=(i-t)/(i-n))<0&&(r=0):r=1:r<0&&(r=0),r}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,r=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*r,t.y=Math.sin(n)*r,t.z=i*e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},function(t,e){t.exports=function(t,e,n,i,r){return t.x=e+r*Math.cos(i),t.y=n+r*Math.sin(i),t}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var r=[],s=[],o=0;o<t;o++)e+=(n-=e*i)*i,r[o]=n,s[o]=e;return{sin:s,cos:r,length:t}}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r){void 0===r&&(r=new i);var s=0,o=0;return t>0&&t<=e*n&&(s=t>e-1?t-(o=Math.floor(t/e))*e:t,r.set(s,o)),r}},function(t,e){t.exports=function(t,e,n){return Math.abs(t-e)<=n}},function(t,e,n){var i=n(39),r=n(69),s=n(365),o=new r,a=new s,h=new i;t.exports=function(t,e,n){return a.setAxisAngle(e,n),o.fromRotationTranslation(a,h.set(0,0,0)),t.transformMat4(o)}},function(t,e){t.exports="addtexture"},function(t,e){t.exports="onerror"},function(t,e){t.exports="onload"},function(t,e){t.exports="ready"},function(t,e){t.exports="removetexture"},function(t,e){t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","","precision mediump float;","","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    float alpha = mainColor.a;","","    if (!uInvertMaskAlpha)","    {","        alpha *= (maskColor.a);","    }","    else","    {","        alpha *= (1.0 - maskColor.a);","    }","","    gl_FragColor = vec4(mainColor.rgb * alpha, alpha);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","","precision mediump float;","","attribute vec2 inPosition;","","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}",""].join("\n")},function(t,e){t.exports="pipelineafterflush"},function(t,e){t.exports="pipelinebeforeflush"},function(t,e){t.exports="pipelinebind"},function(t,e){t.exports="pipelineboot"},function(t,e){t.exports="pipelinedestroy"},function(t,e){t.exports="pipelinerebind"},function(t,e){t.exports="pipelineresize"},function(t,e){t.exports=["#define SHADER_NAME PHASER_GRAPHICS_FS","","precision mediump float;","","varying vec4 outColor;","","void main ()","{","    gl_FragColor = vec4(outColor.bgr * outColor.a, outColor.a);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_GRAPHICS_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec4 inColor;","","varying vec4 outColor;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outColor = inColor;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_LIGHT_FS","","precision mediump float;","","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","","const int kMaxLights = %LIGHT_COUNT%;","","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","","varying vec2 outTexCoord;","varying vec4 outTint;","","void main()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 color = texture2D(uMainSampler, outTexCoord) * vec4(outTint.bgr * outTint.a, outTint.a);","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","","    for (int index = 0; index < kMaxLights; ++index)","    {","        Light light = uLights[index];","        vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","        vec3 lightNormal = normalize(lightDir);","        float distToSurf = length(lightDir) * uCamera.w;","        float diffuseFactor = max(dot(normal, lightNormal), 0.0);","        float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","        float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","        vec3 diffuse = light.color * diffuseFactor;","        finalColor += (attenuation * diffuse) * light.intensity;","    }","","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_MULTI_FS","","precision mediump float;","","uniform sampler2D uMainSampler[%count%];","","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    vec4 texture;","","    %forloop%","","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","","    //  Multiply texture tint","    vec4 color = texture * texel;","","    if (outTintEffect == 1.0)","    {","        //  Solid color + texture alpha","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        //  Solid color, no texture","        color = texel;","    }","","    gl_FragColor = color;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_MULTI_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_FS","","precision mediump float;","","uniform vec2 uResolution;","uniform float uCameraZoom;","","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","","    float distToSurf = length(center - gl_FragCoord.xy);","","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_SINGLE_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","","    //  Multiply texture tint","    vec4 color = texture * texel;","","    if (outTintEffect == 1.0)","    {","        //  Solid color + texture alpha","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        //  Solid color, no texture","        color = texel;","    }","","    gl_FragColor = color;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_SINGLE_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_ADD_BLEND_FS","","precision mediump float;","","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","","    gl_FragColor = frame1 + frame2 * uStrength;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_COLORMATRIX_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","","        return;","    }","","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","","    vec4 result;","","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","","    rgb *= result.a;","","    gl_FragColor = vec4(rgb, result.a);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_COPY_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","uniform float uBrightness;","","varying vec2 outTexCoord;","","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","","precision mediump float;","","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","","varying vec2 outTexCoord;","","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}",""].join("\n")},function(t,e,n){t.exports={GenerateTexture:n(388),Palettes:n(888)}},function(t,e,n){t.exports={ARNE16:n(389),C64:n(889),CGA:n(890),JMP:n(891),MSX:n(892)}},function(t,e){t.exports={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}},function(t,e){t.exports={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}},function(t,e){t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}},function(t,e){t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}},function(t,e,n){t.exports={Path:n(894),MoveTo:n(393),CubicBezier:n(390),Curve:n(94),Ellipse:n(391),Line:n(392),QuadraticBezier:n(394),Spline:n(395)}},function(t,e,n){var i=n(0),r=n(390),s=n(391),o=n(5),a=n(392),h=n(393),u=n(394),c=n(10),l=n(395),f=n(3),d=n(14),p=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new f,this._tmpVec2A=new f,this._tmpVec2B=new f,"object"==typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,n){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,n)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new a(e,t)),this},cubicBezierTo:function(t,e,n,i,s,o){var a,h,u,c=this.getEndPoint();return t instanceof f?(a=t,h=e,u=n):(a=new f(n,i),h=new f(s,o),u=new f(t,e)),this.add(new r(c,a,h,u))},quadraticBezierTo:function(t,e,n,i){var r,s,o=this.getEndPoint();return t instanceof f?(r=t,s=e):(r=new f(n,i),s=new f(t,e)),this.add(new u(o,r,s))},draw:function(t,e){for(var n=0;n<this.curves.length;n++){var i=this.curves[n];i.active&&i.draw(t,e)}return t},ellipseTo:function(t,e,n,i,r,o){var a=new s(0,0,t,e,n,i,r,o),h=this.getEndPoint(this._tmpVec2A),u=a.getStartPoint(this._tmpVec2B);return h.subtract(u),a.x=h.x,a.y=h.y,this.add(a)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var e=0;e<t.curves.length;e++){var n=t.curves[e];switch(n.type){case"LineCurve":this.add(a.fromJSON(n));break;case"EllipseCurve":this.add(s.fromJSON(n));break;case"SplineCurve":this.add(l.fromJSON(n));break;case"CubicBezierCurve":this.add(r.fromJSON(n));break;case"QuadraticBezierCurve":this.add(u.fromJSON(n))}}return this},getBounds:function(t,e){void 0===t&&(t=new c),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var n=new c,i=d.MIN_SAFE_INTEGER,r=d.MIN_SAFE_INTEGER,s=0;s<this.curves.length;s++){var o=this.curves[s];o.active&&(o.getBounds(n,e),t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),i=Math.max(i,n.right),r=Math.max(r,n.bottom))}return t.right=i,t.bottom=r,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0;n<this.curves.length;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getEndPoint:function(t){return void 0===t&&(t=new f),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new f);for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var s=i[r]-n,o=this.curves[r],a=o.getLength(),h=0===a?0:1-s/a;return o.getPointAt(h,e)}r++}return null},getPoints:function(t){void 0===t&&(t=12);for(var e,n=[],i=0;i<this.curves.length;i++){var r=this.curves[i];if(r.active)for(var s=r.getResolution(t),o=r.getPoints(s),a=0;a<o.length;a++){var h=o[a];e&&e.equals(h)||(n.push(h),e=h)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},getRandomPoint:function(t){return void 0===t&&(t=new f),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new f),t.copy(this.startPoint)},getTangent:function(t,e){void 0===e&&(e=new f);for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var s=i[r]-n,o=this.curves[r],a=o.getLength(),h=0===a?0:1-s/a;return o.getTangentAt(h,e)}r++}return null},lineTo:function(t,e){t instanceof f?this._tmpVec2B.copy(t):this._tmpVec2B.set(t,e);var n=this.getEndPoint(this._tmpVec2A);return this.add(new a([n.x,n.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new l(t))},moveTo:function(t,e){return t instanceof f?this.add(new h(t.x,t.y)):this.add(new h(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});o.register("path",(function(t,e){return new p(t,e)})),t.exports=p},function(t,e,n){t.exports={DataManager:n(101),DataManagerPlugin:n(896),Events:n(315)}},function(t,e,n){var i=n(0),r=n(101),s=n(24),o=n(20),a=new i({Extends:r,initialize:function(t){r.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(o.DESTROY,this.destroy,this)},start:function(){this.events.once(o.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){r.prototype.destroy.call(this),this.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("DataManagerPlugin",a,"data"),t.exports=a},function(t,e,n){t.exports={Align:n(898),BaseShader:n(396),Bounds:n(901),Canvas:n(905),Color:n(397),ColorMatrix:n(198),Masks:n(915),RGB:n(200)}},function(t,e,n){var i=n(124),r=n(17),s={In:n(899),To:n(900)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={BottomCenter:n(290),BottomLeft:n(291),BottomRight:n(292),Center:n(293),LeftCenter:n(295),QuickSet:n(289),RightCenter:n(296),TopCenter:n(297),TopLeft:n(298),TopRight:n(299)}},function(t,e,n){t.exports={BottomCenter:n(277),BottomLeft:n(278),BottomRight:n(279),LeftBottom:n(280),LeftCenter:n(281),LeftTop:n(282),QuickSet:n(276),RightBottom:n(283),RightCenter:n(284),RightTop:n(285),TopCenter:n(286),TopLeft:n(287),TopRight:n(288)}},function(t,e,n){t.exports={CenterOn:n(294),GetBottom:n(42),GetBounds:n(902),GetCenterX:n(88),GetCenterY:n(90),GetLeft:n(43),GetOffsetX:n(903),GetOffsetY:n(904),GetRight:n(44),GetTop:n(45),SetBottom:n(55),SetCenterX:n(89),SetCenterY:n(91),SetLeft:n(53),SetRight:n(54),SetTop:n(52)}},function(t,e,n){var i=n(42),r=n(43),s=n(44),o=n(45);t.exports=function(t,e){void 0===e&&(e={});var n=r(t),a=o(t);return e.x=n,e.y=a,e.width=s(t)-n,e.height=i(t)-a,e}},function(t,e){t.exports=function(t){return t.width*t.originX}},function(t,e){t.exports=function(t){return t.height*t.originY}},function(t,e,n){t.exports={CanvasInterpolation:n(367),CanvasPool:n(31),Smoothing:n(192),TouchAction:n(906),UserSelect:n(907)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e="none"),["-webkit-","-khtml-","-moz-","-ms-",""].forEach((function(n){t.style[n+"user-select"]=e})),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t}},function(t,e,n){var i=n(103);t.exports=function(t){void 0===t&&(t=1024);var e,n=[],r=255,s=255,o=0,a=0;for(e=0;e<=r;e++)n.push({r:s,g:e,b:a,color:i(s,e,a)});for(o=255,e=r;e>=0;e--)n.push({r:e,g:o,b:a,color:i(e,o,a)});for(s=0,e=0;e<=r;e++,o--)n.push({r:s,g:o,b:e,color:i(s,o,e)});for(o=0,a=255,e=0;e<=r;e++,a--,s++)n.push({r:s,g:o,b:a,color:i(s,o,a)});if(1024===t)return n;var h=[],u=0,c=1024/t;for(e=0;e<t;e++)h.push(n[Math.floor(u)]),u+=c;return h}},function(t,e){t.exports=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}},function(t,e,n){var i=n(38),r=n(399);t.exports=function(t,e,n){var s=n,o=n,a=n;if(0!==e){var h=n<.5?n*(1+e):n+e-n*e,u=2*n-h;s=r(u,h,t+1/3),o=r(u,h,t),a=r(u,h,t-1/3)}return(new i).setGLTo(s,o,a,1)}},function(t,e,n){var i=n(188);t.exports=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var n=[],r=0;r<=359;r++)n.push(i(r/359,t,e));return n}},function(t,e,n){var i=n(136),r=function(t,e,n,r,s,o,a,h){void 0===a&&(a=100),void 0===h&&(h=0);var u=h/a;return{r:i(t,r,u),g:i(e,s,u),b:i(n,o,u)}};t.exports={RGBWithRGB:r,ColorWithRGB:function(t,e,n,i,s,o){return void 0===s&&(s=100),void 0===o&&(o=0),r(t.r,t.g,t.b,e,n,i,s,o)},ColorWithColor:function(t,e,n,i){return void 0===n&&(n=100),void 0===i&&(i=0),r(t.r,t.g,t.b,e.r,e.g,e.b,n,i)}}},function(t,e,n){var i=n(195),r=n(38);t.exports=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=255),new r(i(t,e),i(t,e),i(t,e))}},function(t,e,n){var i=n(398);t.exports=function(t,e,n,r,s){return void 0===r&&(r=255),void 0===s&&(s="#"),"#"===s?"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1):"0x"+i(r)+i(t)+i(e)+i(n)}},function(t,e,n){t.exports={BitmapMask:n(310),GeometryMask:n(311)}},function(t,e,n){var i={AddToDOM:n(143),DOMContentLoaded:n(400),GetInnerHeight:n(401),GetScreenOrientation:n(402),GetTarget:n(407),ParseXML:n(408),RemoveFromDOM:n(202),RequestAnimationFrame:n(386)};t.exports=i},function(t,e,n){t.exports={EventEmitter:n(918)}},function(t,e,n){var i=n(0),r=n(9),s=n(24),o=new i({Extends:r,initialize:function(){r.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});s.register("EventEmitter",o,"events"),t.exports=o},function(t,e,n){var i=n(143),r=n(321),s=n(325),o=n(31),a=n(0),h=n(346),u=n(920),c=n(366),l=n(101),f=n(384),d=n(347),p=n(400),v=n(9),g=n(22),m=n(409),y=n(24),x=n(414),b=n(415),w=n(417),_=n(106),T=n(422),E=n(385),S=n(387),C=n(426),A=new a({initialize:function(t){this.config=new h(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new v,this.anims=new r(this),this.textures=new T(this),this.cache=new s(this),this.registry=new l(this),this.input=new m(this,this.config),this.scene=new w(this,this.config.sceneConfig),this.device=d,this.scale=new b(this,this.config),this.sound=null,this.sound=C.create(this),this.loop=new E(this,this.config.fps),this.plugins=new x(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,p(this.boot.bind(this))},boot:function(){y.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),c(this),u(this),f(this),i(this.canvas,this.config.parent),this.textures.once(_.READY,this.texturesReady,this),this.events.emit(g.BOOT)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(g.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),S(this);var t=this.events;t.on(g.HIDDEN,this.onHidden,this),t.on(g.VISIBLE,this.onVisible,this),t.on(g.BLUR,this.onBlur,this),t.on(g.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e);var i=this.renderer;i.preRender(),n.emit(g.PRE_RENDER,i,t,e),this.scene.render(i),i.postRender(),n.emit(g.POST_RENDER,i,t,e)},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e),n.emit(g.PRE_RENDER),n.emit(g.POST_RENDER)},onHidden:function(){this.loop.pause(),this.events.emit(g.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(g.RESUME)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(g.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(o.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});t.exports=A},function(t,e,n){var i=n(143);t.exports=function(t){var e=t.config;if(e.parent&&e.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+t.scale.width+"px;","height: "+t.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: none;","transform: scale(1);","transform-origin: left top;"].join(" "),t.domContainer=n,i(n,e.parent)}}},function(t,e){t.exports="boot"},function(t,e){t.exports="destroy"},function(t,e){t.exports="dragend"},function(t,e){t.exports="dragenter"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragleave"},function(t,e){t.exports="dragover"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="drop"},function(t,e){t.exports="gameout"},function(t,e){t.exports="gameover"},function(t,e){t.exports="gameobjectdown"},function(t,e){t.exports="dragend"},function(t,e){t.exports="dragenter"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragleave"},function(t,e){t.exports="dragover"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="drop"},function(t,e){t.exports="gameobjectmove"},function(t,e){t.exports="gameobjectout"},function(t,e){t.exports="gameobjectover"},function(t,e){t.exports="pointerdown"},function(t,e){t.exports="pointermove"},function(t,e){t.exports="pointerout"},function(t,e){t.exports="pointerover"},function(t,e){t.exports="pointerup"},function(t,e){t.exports="wheel"},function(t,e){t.exports="gameobjectup"},function(t,e){t.exports="gameobjectwheel"},function(t,e){t.exports="boot"},function(t,e){t.exports="process"},function(t,e){t.exports="update"},function(t,e){t.exports="pointerdown"},function(t,e){t.exports="pointerdownoutside"},function(t,e){t.exports="pointermove"},function(t,e){t.exports="pointerout"},function(t,e){t.exports="pointerover"},function(t,e){t.exports="pointerup"},function(t,e){t.exports="pointerupoutside"},function(t,e){t.exports="wheel"},function(t,e){t.exports="pointerlockchange"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="start"},function(t,e){t.exports="update"},function(t,e){t.exports="addfile"},function(t,e){t.exports="complete"},function(t,e){t.exports="filecomplete"},function(t,e){t.exports="filecomplete-"},function(t,e){t.exports="loaderror"},function(t,e){t.exports="load"},function(t,e){t.exports="fileprogress"},function(t,e){t.exports="postprocess"},function(t,e){t.exports="progress"},function(t,e){t.exports="start"},function(t,e,n){t.exports={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"}},function(t,e){t.exports=function(t,e,n){if(n.getElementsByTagName("TextureAtlas")){var i=t.source[e];t.add("__BASE",e,0,0,i.width,i.height);for(var r,s=n.getElementsByTagName("SubTexture"),o=0;o<s.length;o++){var a=s[o].attributes,h=a.name.value,u=parseInt(a.x.value,10),c=parseInt(a.y.value,10),l=parseInt(a.width.value,10),f=parseInt(a.height.value,10);if(r=t.add(h,e,u,c,l,f),a.frameX){var d=Math.abs(parseInt(a.frameX.value,10)),p=Math.abs(parseInt(a.frameY.value,10)),v=parseInt(a.frameWidth.value,10),g=parseInt(a.frameHeight.value,10);r.setTrim(l,f,d,p,v,g)}}return t}console.warn("Invalid Texture Atlas XML given")}},function(t,e){t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},function(t,e){t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},function(t,e,n){var i=n(78);t.exports=function(t,e,n){if(n.frames||n.textures){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);for(var s,o=Array.isArray(n.textures)?n.textures[e].frames:n.frames,a=0;a<o.length;a++){var h=o[a];s=t.add(h.filename,e,h.frame.x,h.frame.y,h.frame.w,h.frame.h),h.trimmed&&s.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(s.rotated=!0,s.updateUVsInverted());var u=h.anchor||h.pivot;u&&(s.customPivot=!0,s.pivotX=u.x,s.pivotY=u.y),s.customData=i(h)}for(var c in n)"frames"!==c&&(Array.isArray(n[c])?t.customData[c]=n[c].slice(0):t.customData[c]=n[c]);return t}console.warn("Invalid Texture Atlas JSON Array")}},function(t,e,n){var i=n(78);t.exports=function(t,e,n){if(n.frames){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);var s,o=n.frames;for(var a in o)if(o.hasOwnProperty(a)){var h=o[a];s=t.add(a,e,h.frame.x,h.frame.y,h.frame.w,h.frame.h),h.trimmed&&s.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(s.rotated=!0,s.updateUVsInverted());var u=h.anchor||h.pivot;u&&(s.customPivot=!0,s.pivotX=u.x,s.pivotY=u.y),s.customData=i(h)}for(var c in n)"frames"!==c&&(Array.isArray(n[c])?t.customData[c]=n[c].slice(0):t.customData[c]=n[c]);return t}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r,s,o,a){var h=i(a,"frameWidth",null),u=i(a,"frameHeight",h);if(null===h)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var c=t.source[e];t.add("__BASE",e,0,0,c.width,c.height);var l=i(a,"startFrame",0),f=i(a,"endFrame",-1),d=i(a,"margin",0),p=i(a,"spacing",0),v=Math.floor((s-d+p)/(h+p))*Math.floor((o-d+p)/(u+p));0===v&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",t.key),(l>v||l<-v)&&(l=0),l<0&&(l=v+l),-1!==f&&(v=l+(f+1));for(var g=d,m=d,y=0,x=0,b=0;b<v;b++){y=0,x=0;var w=g+h,_=m+u;w>s&&(y=w-s),_>o&&(x=_-o),t.add(b,e,n+g,r+m,h-y,u-x),(g+=h+p)+h>s&&(g=d,m+=u+p)}return t}},function(t,e,n){var i=n(2);t.exports=function(t,e,n){var r=i(n,"frameWidth",null),s=i(n,"frameHeight",r);if(!r)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var o=t.source[0];t.add("__BASE",0,0,0,o.width,o.height);var a,h=i(n,"startFrame",0),u=i(n,"endFrame",-1),c=i(n,"margin",0),l=i(n,"spacing",0),f=e.cutX,d=e.cutY,p=e.cutWidth,v=e.cutHeight,g=e.realWidth,m=e.realHeight,y=Math.floor((g-c+l)/(r+l)),x=Math.floor((m-c+l)/(s+l)),b=y*x,w=e.x,_=r-w,T=r-(g-p-w),E=e.y,S=s-E,C=s-(m-v-E);(h>b||h<-b)&&(h=0),h<0&&(h=b+h),-1!==u&&(b=h+(u+1));for(var A=c,I=c,P=0,R=e.sourceIndex,O=0;O<x;O++){for(var k=0===O,M=O===x-1,D=0;D<y;D++){var L=0===D,N=D===y-1;if(a=t.add(P,R,f+A,d+I,r,s),L||k||N||M){var F=L?w:0,B=k?E:0,U=0,V=0;L&&(U+=r-_),N&&(U+=r-T),k&&(V+=s-S),M&&(V+=s-C);var Y=r-U,z=s-V;a.cutWidth=Y,a.cutHeight=z,a.setTrim(r,s,F,B,Y,z)}A+=l,A+=L?_:N?T:r,P++}A=c,I+=l,I+=k?S:M?C:s}return t}},function(t,e){var n=0,i=function(t,e,i,r){var s=n-r.y-r.height;t.add(i,e,r.x,s,r.width,r.height)};t.exports=function(t,e,r){var s=t.source[e];t.add("__BASE",e,0,0,s.width,s.height),n=s.height;for(var o=r.split("\n"),a=/^[ ]*(- )*(\w+)+[: ]+(.*)/,h="",u="",c={x:0,y:0,width:0,height:0},l=0;l<o.length;l++){var f=o[l].match(a);if(f){var d="- "===f[1],p=f[2],v=f[3];if(d&&(u!==h&&(i(t,e,u,c),h=u),c={x:0,y:0,width:0,height:0}),"name"!==p)switch(p){case"x":case"y":case"width":case"height":c[p]=parseInt(v,10)}else u=v}}return u!==h&&i(t,e,u,c),t}},function(t,e){t.exports="complete"},function(t,e){t.exports="decoded"},function(t,e){t.exports="decodedall"},function(t,e){t.exports="destroy"},function(t,e){t.exports="detune"},function(t,e){t.exports="detune"},function(t,e){t.exports="mute"},function(t,e){t.exports="rate"},function(t,e){t.exports="volume"},function(t,e){t.exports="loop"},function(t,e){t.exports="looped"},function(t,e){t.exports="mute"},function(t,e){t.exports="pan"},function(t,e){t.exports="pauseall"},function(t,e){t.exports="pause"},function(t,e){t.exports="play"},function(t,e){t.exports="rate"},function(t,e){t.exports="resumeall"},function(t,e){t.exports="resume"},function(t,e){t.exports="seek"},function(t,e){t.exports="stopall"},function(t,e){t.exports="stop"},function(t,e){t.exports="unlocked"},function(t,e){t.exports="volume"},function(t,e,n){var i={Events:n(76),DisplayList:n(1011),GameObjectCreator:n(16),GameObjectFactory:n(5),UpdateList:n(1037),Components:n(11),GetCalcMatrix:n(19),BuildGameObject:n(28),BuildGameObjectAnimation:n(439),GameObject:n(15),BitmapText:n(149),Blitter:n(213),Bob:n(440),Container:n(214),DOMElement:n(442),DynamicBitmapText:n(215),Extern:n(444),Graphics:n(216),Group:n(113),Image:n(126),Layer:n(219),Particles:n(1071),PathFollower:n(457),RenderTexture:n(221),RetroFont:n(1079),Rope:n(223),Sprite:n(74),Text:n(224),GetTextSize:n(458),MeasureText:n(460),TextStyle:n(459),TileSprite:n(225),Zone:n(130),Video:n(226),Shape:n(34),Arc:n(461),Curve:n(462),Ellipse:n(463),Grid:n(464),IsoBox:n(465),IsoTriangle:n(466),Line:n(467),Polygon:n(468),Rectangle:n(473),Star:n(474),Triangle:n(475),Factories:{Blitter:n(1127),Container:n(1128),DOMElement:n(1129),DynamicBitmapText:n(1130),Extern:n(1131),Graphics:n(1132),Group:n(1133),Image:n(1134),Layer:n(1135),Particles:n(1136),PathFollower:n(1137),RenderTexture:n(1138),Rope:n(1139),Sprite:n(1140),StaticBitmapText:n(1141),Text:n(1142),TileSprite:n(1143),Zone:n(1144),Video:n(1145),Arc:n(1146),Curve:n(1147),Ellipse:n(1148),Grid:n(1149),IsoBox:n(1150),IsoTriangle:n(1151),Line:n(1152),Polygon:n(1153),Rectangle:n(1154),Star:n(1155),Triangle:n(1156)},Creators:{Blitter:n(1157),Container:n(1158),DynamicBitmapText:n(1159),Graphics:n(1160),Group:n(1161),Image:n(1162),Layer:n(1163),Particles:n(1164),RenderTexture:n(1165),Rope:n(1166),Sprite:n(1167),StaticBitmapText:n(1168),Text:n(1169),TileSprite:n(1170),Zone:n(1171),Video:n(1172)}};i.Shader=n(229),i.Mesh=n(230),i.PointLight=n(151),i.Factories.Shader=n(1181),i.Factories.Mesh=n(1182),i.Factories.PointLight=n(1183),i.Creators.Shader=n(1184),i.Creators.Mesh=n(1185),i.Creators.PointLight=n(1186),i.Light=n(481),i.LightsManager=n(482),i.LightsPlugin=n(1187),t.exports=i},function(t,e,n){var i=n(0),r=n(110),s=n(24),o=n(76),a=n(20),h=n(80),u=new i({Extends:r,initialize:function(t){r.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(a.BOOT,this.boot,this),this.events.on(a.START,this.start,this)},boot:function(){this.events.once(a.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(o.ADDED_TO_SCENE,t,this.scene),this.events.emit(a.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(o.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(a.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(a.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(h(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list,e=t.length;e--;)t[e].destroy(!0);t.length=0,this.events.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(a.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});s.register("DisplayList",u,"displayList"),t.exports=u},function(t,e,n){t.exports={CheckMatrix:n(209),MatrixToString:n(1013),ReverseColumns:n(1014),ReverseRows:n(1015),Rotate180:n(1016),RotateLeft:n(1017),RotateMatrix:n(148),RotateRight:n(1018),Translate:n(1019),TransposeMatrix:n(435)}},function(t,e,n){var i=n(186),r=n(209);t.exports=function(t){var e="";if(!r(t))return e;for(var n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++){var o=t[n][s].toString();e+="undefined"!==o?i(o,2):"?",s<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var a=0;a<t[n].length;a++)e+="---",a<t[n].length-1&&(e+="+");e+="\n"}}return e}},function(t,e){t.exports=function(t){return t.reverse()}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t}},function(t,e,n){var i=n(148);t.exports=function(t){return i(t,180)}},function(t,e,n){var i=n(148);t.exports=function(t){return i(t,90)}},function(t,e,n){var i=n(148);t.exports=function(t){return i(t,-90)}},function(t,e,n){var i=n(178),r=n(179);t.exports=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),0!==n&&(n<0?i(t,Math.abs(n)):r(t,n)),0!==e)for(var s=0;s<t.length;s++){var o=t[s];e<0?i(o,Math.abs(e)):r(o,e)}return t}},function(t,e){t.exports=function(t,e,n,i,r){if(void 0===r&&(r=t),n>0){var s=n-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),i&&i.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.splice(o,1),o--;if(0===(o=e.length))return null;n>0&&o>s&&(e.splice(s),o=s);for(var a=0;a<o;a++){var h=e[a];t.push(h),i&&i.call(r,h)}return e}},function(t,e){t.exports=function(t,e,n,i,r,s){if(void 0===n&&(n=0),void 0===s&&(s=t),i>0){var o=i-t.length;if(o<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(n,0,e),r&&r.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.pop(),a--;if(0===(a=e.length))return null;i>0&&a>o&&(e.splice(o),a=o);for(var h=a-1;h>=0;h--){var u=e[h];t.splice(n,0,u),r&&r.call(s,u)}return e}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n<t.length&&(t.splice(n,1),t.push(e)),e}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=0;if(i(t,r,s))for(var a=r;a<s;a++)t[a][e]===n&&o++;return o}},function(t,e){t.exports=function(t,e,n){var i,r=[null];for(i=3;i<arguments.length;i++)r.push(arguments[i]);for(i=0;i<t.length;i++)r[0]=t[i],e.apply(n,r);return t}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s)){var o,a=[null];for(o=5;o<arguments.length;o++)a.push(arguments[o]);for(o=r;o<s;o++)a[0]=t[o],e.apply(n,a)}return t}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);if(n>0){var i=t[n-1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},function(t,e){t.exports=function(t,e,n){var i=t.indexOf(e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(t.splice(i,1),t.splice(n,0,e)),e}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);if(-1!==n&&n<t.length-1){var i=t[n+1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},function(t,e,n){var i=n(363);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var r=[],s=Math.max(i((e-t)/(n||1)),0),o=0;o<s;o++)r.push(t),t+=n;return r}},function(t,e,n){var i=n(75);t.exports=function(t,e,n,r){if(void 0===r&&(r=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var s=i(t,e);return n&&n.call(r,s),s}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===s&&(s=t),i(t,e,n)){var o=n-e,a=t.splice(e,o);if(r)for(var h=0;h<a.length;h++){var u=a[h];r.call(s,u)}return a}return[]}},function(t,e,n){var i=n(75);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r=e+Math.floor(Math.random()*n);return i(t,r)}},function(t,e){t.exports=function(t,e,n){var i=t.indexOf(e),r=t.indexOf(n);return-1!==i&&-1===r&&(t[i]=n,!0)}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n>0&&(t.splice(n,1),t.unshift(e)),e}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];a.hasOwnProperty(e)&&(a[e]=n)}return t}},function(t,e){t.exports=function(t,e,n){if(e!==n){var i=t.indexOf(e),r=t.indexOf(n);if(i<0||r<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[r]=e,t}}},function(t,e,n){var i=n(0),r=n(211),s=n(24),o=n(20),a=new i({Extends:r,initialize:function(t){r.call(this),this.checkQueue=!0,this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.systems.events.once(o.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(o.PRE_UPDATE,this.update,this),t.on(o.UPDATE,this.sceneUpdate,this),t.once(o.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var n=this._active,i=n.length,r=0;r<i;r++){var s=n[r];s.active&&s.preUpdate.call(s,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(o.PRE_UPDATE,this.preUpdate,this),e.off(o.UPDATE,this.sceneUpdate,this),e.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("UpdateList",a,"updateList"),t.exports=a},function(t,e){t.exports="add"},function(t,e){t.exports="remove"},function(t,e){t.exports=function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i)return{local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var r,s,o,a=t.text,h=a.length,u=t.maxWidth,c=t.wordWrapCharCode,l=Number.MAX_VALUE,f=Number.MAX_VALUE,d=0,p=0,v=t.fontData.chars,g=t.fontData.lineHeight,m=t.letterSpacing,y=0,x=0,b=0,w=null,_=t._align,T=0,E=0,S=t.fontSize/t.fontData.size,C=S*t.scaleX,A=S*t.scaleY,I=null,P=0,R=[],O=Number.MAX_VALUE,k=0,M=0,D=0,L=[],N=[],F=null;if(u>0){for(r=0;r<h;r++)if(10!==(b=a.charCodeAt(r))){if(w=v[b]){if(null!==I)var B=w.kerning[P];b===c?null!==F&&(L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A,cr:!1}),F=null):(null===F&&(F={word:"",i:r,x:y,y:x,w:0,h:g,cr:!1}),F.word=F.word.concat(a[r]),F.w+=w.xOffset+w.xAdvance+(void 0!==B?B:0)),y+=w.xAdvance+m,I=w,P=b}}else null!==F&&(L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A,cr:!0}),F=null),y=0,x+=g,I=null;var U;null!==F&&L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A,cr:!1}),y=0,x=0,I=null,P=0;var V=0,Y=[];for(r=0;r<L.length;r++){var z=L[r],X=z.x,G=z.x+z.w;U&&(V=X-(X-(U.x+U.w)+U.w),U=null),X-V>u||G-V>u?(Y.push(z.i-1),z.cr?(Y.push(z.i+z.word.length),V=0,U=null):U=z):z.cr&&(Y.push(z.i+z.word.length),V=0,U=null)}for(r=Y.length-1;r>=0;r--)s=a,o=Y[r],"\n",a=s.substr(0,o)+"\n"+s.substr(o+1);i.wrappedText=a,h=a.length,L=[],F=null}var j=0;for(r=0;r<h;r++)if(10!==(b=a.charCodeAt(r))){if(w=v[b]){if(T=y,E=x,null!==I){var W=w.kerning[P];T+=void 0!==W?W:0}l>T&&(l=T),f>E&&(f=E);var H=T+w.xAdvance,q=E+g;d<H&&(d=H),p<q&&(p=q);var K=w.xOffset+w.xAdvance+(void 0!==W?W:0);b===c?null!==F&&(L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A}),F=null):(null===F&&(F={word:"",i:j,x:y,y:x,w:0,h:g}),F.word=F.word.concat(a[r]),F.w+=K),N.push({i:j,char:a[r],code:b,x:(w.xOffset+y)*S,y:(w.yOffset+x)*S,w:w.width*S,h:w.height*S,t:x*S,r:H*S,b:g*S,line:M,glyph:w}),y+=w.xAdvance+m,I=w,P=b,D=H*S,j++}}else null!==F&&(L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A}),F=null),y=0,x+=g,I=null,R[M]=D,D>k&&(k=D),D<O&&(O=D),M++,D=0;if(null!==F&&L.push({word:F.word,i:F.i,x:F.x*C,y:F.y*A,w:F.w*C,h:F.h*A}),R[M]=D,D>k&&(k=D),D<O&&(O=D),_>0)for(var Q=0;Q<N.length;Q++){var Z=N[Q];if(1===_){var J=(k-R[Z.line])/2;Z.x+=J,Z.r+=J}else if(2===_){var $=k-R[Z.line];Z.x+=$,Z.r+=$}}var tt=i.local,et=i.global,nt=i.lines;return tt.x=l*S,tt.y=f*S,tt.width=d*S,tt.height=p*S,et.x=t.x-t._displayOriginX+l*C,et.y=t.y-t._displayOriginY+f*A,et.width=d*C,et.height=p*A,nt.shortest=O,nt.longest=k,nt.lengths=R,e&&(tt.x=Math.ceil(tt.x),tt.y=Math.ceil(tt.y),tt.width=Math.ceil(tt.width),tt.height=Math.ceil(tt.height),et.x=Math.ceil(et.x),et.y=Math.ceil(et.y),et.width=Math.ceil(et.width),et.height=Math.ceil(et.height),nt.shortest=Math.ceil(O),nt.longest=Math.ceil(k)),n&&(t._displayOriginX=t.originX*tt.width,t._displayOriginY=t.originY*tt.height,et.x=t.x-t._displayOriginX*t.scaleX,et.y=t.y-t._displayOriginY*t.scaleY,e&&(et.x=Math.ceil(et.x),et.y=Math.ceil(et.y))),i.words=L,i.characters=N,i.lines.height=g,i.scale=S,i.scaleX=t.scaleX,i.scaleY=t.scaleY,i}},function(t,e,n){var i=n(212);t.exports=function(t,e,n,r,s,o,a){var h=t.sys.textures.get(n),u=h.get(r),c=t.sys.cache.xml.get(s);if(u&&c){var l=i(c,u,o,a,h);return t.sys.cache.bitmapFont.add(e,{data:l,texture:n,frame:r}),!0}return!1}},function(t,e,n){var i=n(1),r=n(1);i=n(1043),r=n(1045),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(1044),r=n(19),s=n(12);t.exports=function(t,e,n,o){if(0!==e._text.length){n.addToRenderList(e);var a,h,u,c=t.pipelines.set(e.pipeline,e),l=r(e,n,o).calc,f=n.roundPixels,d=n.alpha,p=e.charColors,v=e.tintFill,g=s.getTintAppendFloatAlpha,m=g(e.tintTopLeft,d*e._alphaTL),y=g(e.tintTopRight,d*e._alphaTR),x=g(e.tintBottomLeft,d*e._alphaBL),b=g(e.tintBottomRight,d*e._alphaBR),w=e.frame.glTexture,_=c.setGameObject(e),T=e.getTextBounds(!1).characters,E=e.dropShadowX,S=e.dropShadowY,C=0!==E||0!==S;if(t.pipelines.preBatch(e),C){var A=e.dropShadowColor,I=e.dropShadowAlpha,P=g(A,d*I*e._alphaTL),R=g(A,d*I*e._alphaTR),O=g(A,d*I*e._alphaBL),k=g(A,d*I*e._alphaBR);for(a=0;a<T.length;a++)u=(h=T[a]).glyph,32!==h.code&&0!==u.width&&0!==u.height&&i(c,e,h,u,E,S,l,f,P,R,O,k,1,w,_)}for(a=0;a<T.length;a++)if(u=(h=T[a]).glyph,32!==h.code&&0!==u.width&&0!==u.height)if(p[h.i]){var M=p[h.i],D=M.tintEffect,L=g(M.tintTL,d*e._alphaTL),N=g(M.tintTR,d*e._alphaTR),F=g(M.tintBL,d*e._alphaBL),B=g(M.tintBR,d*e._alphaBR);i(c,e,h,u,0,0,l,f,L,N,F,B,D,w,_)}else i(c,e,h,u,0,0,l,f,m,y,x,b,v,w,_);t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i,r,s,o,a,h,u,c,l,f,d,p){var v=n.x-e.displayOriginX+r,g=n.y-e.displayOriginY+s,m=v+n.w,y=g+n.h,x=o.getXRound(v,g,a),b=o.getYRound(v,g,a),w=o.getXRound(v,y,a),_=o.getYRound(v,y,a),T=o.getXRound(m,y,a),E=o.getYRound(m,y,a),S=o.getXRound(m,g,a),C=o.getYRound(m,g,a);t.batchQuad(e,x,b,w,_,T,E,S,C,i.u0,i.v0,i.u1,i.v1,h,u,c,l,f,d,p)}},function(t,e,n){var i=n(30);t.exports=function(t,e,n,r){var s=e._text,o=s.length,a=t.currentContext;if(0!==o&&i(t,a,e,n,r)){n.addToRenderList(e);var h=e.texture.frames.__BASE,u=e.fontData.chars,c=e.fontData.lineHeight,l=e._letterSpacing,f=0,d=0,p=0,v=null,g=0,m=0,y=0,x=0,b=0,w=0,_=null,T=0,E=h.source.image,S=h.cutX,C=h.cutY,A=e._fontSize/e.fontData.size,I=e._align,P=0,R=0,O=e.getTextBounds(!1);e.maxWidth>0&&(o=(s=O.wrappedText).length);var k=e._bounds.lines;1===I?R=(k.longest-k.lengths[0])/2:2===I&&(R=k.longest-k.lengths[0]),a.translate(-e.displayOriginX,-e.displayOriginY);for(var M=n.roundPixels,D=0;D<o;D++)if(10!==(p=s.charCodeAt(D))){if(v=u[p]){if(g=S+v.x,m=C+v.y,y=v.width,x=v.height,b=v.xOffset+f,w=v.yOffset+d,null!==_){var L=v.kerning[T];b+=void 0!==L?L:0}b*=A,w*=A,b+=R,f+=v.xAdvance+l,_=v,T=p,0!==y&&0!==x&&32!==p&&(M&&(b=Math.round(b),w=Math.round(w)),a.save(),a.translate(b,w),a.scale(A,A),a.drawImage(E,g,m,y,x,0,0,y,x),a.restore())}}else P++,1===I?R=(k.longest-k.lengths[P])/2:2===I&&(R=k.longest-k.lengths[P]),f=0,d+=c,_=null;a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1047),r=n(1048),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(25),r=n(12),s=new i;t.exports=function(t,e,n,i){var o=e.getRenderList();if(0!==o.length){var a=n.alpha*e.alpha;if(0!==a){n.addToRenderList(e);var h=t.pipelines.set(this.pipeline,e),u=n.scrollX*e.scrollFactorX,c=n.scrollY*e.scrollFactorY,l=s.copyFrom(n.matrix);i&&(l.multiplyWithOffset(i,-u,-c),u=0,c=0);var f=e.x-u,d=e.y-c,p=-1,v=n.roundPixels;t.pipelines.preBatch(e);for(var g=0;g<o.length;g++){var m=o[g],y=m.frame,x=m.alpha*a;if(0!==x){var b=y.width,w=y.height,_=f+m.x+y.x,T=d+m.y+y.y;m.flipX&&(b*=-1,_+=y.width),m.flipY&&(w*=-1,T+=y.height);var E=_+b,S=T+w,C=l.getX(_,T),A=l.getY(_,T),I=l.getX(E,S),P=l.getY(E,S),R=r.getTintAppendFloatAlpha(m.tint,x);if(y.sourceIndex!==p){var O=h.setGameObject(e,y);p=y.sourceIndex}v&&(C=Math.round(C),A=Math.round(A),I=Math.round(I),P=Math.round(P)),h.batchQuad(e,C,A,C,P,I,P,I,A,y.u0,y.v0,y.u1,y.v1,R,R,R,R,!1,y.glTexture,O)&&(p=-1)}}t.pipelines.postBatch(e)}}}},function(t,e){t.exports=function(t,e,n,i){var r=e.getRenderList();if(0!==r.length){var s=t.currentContext,o=n.alpha*e.alpha;if(0!==o){n.addToRenderList(e),s.globalCompositeOperation=t.blendModes[e.blendMode],s.imageSmoothingEnabled=!(!t.antialias||e.frame.source.scaleMode);var a=e.x-n.scrollX*e.scrollFactorX,h=e.y-n.scrollY*e.scrollFactorY;s.save(),i&&i.copyToContext(s);for(var u=n.roundPixels,c=0;c<r.length;c++){var l=r[c],f=l.flipX||l.flipY,d=l.frame,p=d.canvasData,v=d.x,g=d.y,m=1,y=1,x=l.alpha*o;0!==x&&(s.globalAlpha=x,f?(l.flipX&&(m=-1,v-=p.width),l.flipY&&(y=-1,g-=p.height),s.save(),s.translate(l.x+a,l.y+h),s.scale(m,y),s.drawImage(d.source.image,p.x,p.y,p.width,p.height,v,g,p.width,p.height),s.restore()):(u&&(v=Math.round(v),g=Math.round(g)),s.drawImage(d.source.image,p.x,p.y,p.width,p.height,v+l.x+a,g+l.y+h,p.width,p.height)))}s.restore()}}}},function(t,e,n){var i=n(1),r=n(1);i=n(1050),r=n(1051),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i){var r=e.list,s=r.length;if(0!==s){n.addToRenderList(e);var o=e.localTransform;i?(o.loadIdentity(),o.multiply(i),o.translate(e.x,e.y),o.rotate(e.rotation),o.scale(e.scaleX,e.scaleY)):o.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var a=-1!==e.blendMode;a||t.setBlendMode(0);for(var h=e.alpha,u=e.scrollFactorX,c=e.scrollFactorY,l=0;l<s;l++){var f=r[l];if(f.willRender(n)){var d,p,v,g;if(void 0!==f.alphaTopLeft)d=f.alphaTopLeft,p=f.alphaTopRight,v=f.alphaBottomLeft,g=f.alphaBottomRight;else{var m=f.alpha;d=m,p=m,v=m,g=m}var y=f.scrollFactorX,x=f.scrollFactorY;a||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode);var b=f.mask;b&&b.preRenderWebGL(t,f,n);var w=f.type;w!==t.currentType&&(t.newType=!0,t.currentType=w),t.nextTypeMatch=l<s-1&&r[l+1].type===t.currentType,f.setScrollFactor(y*u,x*c),f.setAlpha(d*h,p*h,v*h,g*h),f.renderWebGL(t,f,n,o),f.setAlpha(d,p,v,g),f.setScrollFactor(y,x),b&&b.postRenderWebGL(t,n),t.newType=!1}}t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){var r=e.list;if(0!==r.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var o=-1!==e.blendMode;o||t.setBlendMode(0);var a=e._alpha,h=e.scrollFactorX,u=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var c=0;c<r.length;c++){var l=r[c];if(l.willRender(n)){var f=l.alpha,d=l.scrollFactorX,p=l.scrollFactorY;o||l.blendMode===t.currentBlendMode||t.setBlendMode(l.blendMode),l.setScrollFactor(d*h,p*u),l.setAlpha(f*a),l.renderCanvas(t,l,n,s),l.setAlpha(f),l.setScrollFactor(d,p)}}e.mask&&e.mask.postRenderCanvas(t)}}},function(t,e,n){var i=n(1),r=n(1);i=n(443),r=n(443),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]},function(t,e,n){var i=n(1),r=n(1);i=n(1055),r=n(1056),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(25),s=n(12),o=new r;t.exports=function(t,e,n,r){var a=e.text,h=a.length;if(0!==h){n.addToRenderList(e);var u=t.pipelines.set(e.pipeline,e),c=i(e,n,r),l=c.sprite,f=c.calc,d=o,p=e.cropWidth>0||e.cropHeight>0;p&&(u.flush(),t.pushScissor(f.tx,f.ty,e.cropWidth*f.scaleX,e.cropHeight*f.scaleY));var v,g,m=e.frame.glTexture,y=e.tintFill,x=s.getTintAppendFloatAlpha(e.tintTopLeft,n.alpha*e._alphaTL),b=s.getTintAppendFloatAlpha(e.tintTopRight,n.alpha*e._alphaTR),w=s.getTintAppendFloatAlpha(e.tintBottomLeft,n.alpha*e._alphaBL),_=s.getTintAppendFloatAlpha(e.tintBottomRight,n.alpha*e._alphaBR),T=u.setGameObject(e),E=0,S=0,C=0,A=0,I=e.letterSpacing,P=0,R=0,O=e.scrollX,k=e.scrollY,M=e.fontData,D=M.chars,L=M.lineHeight,N=e.fontSize/M.size,F=0,B=e._align,U=0,V=0,Y=e.getTextBounds(!1);e.maxWidth>0&&(h=(a=Y.wrappedText).length);var z=e._bounds.lines;1===B?V=(z.longest-z.lengths[0])/2:2===B&&(V=z.longest-z.lengths[0]);var X=n.roundPixels,G=e.displayCallback,j=e.callbackData;t.pipelines.preBatch(e);for(var W=0;W<h;W++)if(10!==(C=a.charCodeAt(W))){if(v=D[C]){P=v.width,R=v.height;var H=v.xOffset+E-O,q=v.yOffset+S-k;if(null!==g){var K=v.kerning[A];H+=void 0!==K?K:0}if(E+=v.xAdvance+I,g=v,A=C,0!==P&&0!==R&&32!==C){if(N=e.fontSize/e.fontData.size,F=0,G){j.color=0,j.tint.topLeft=x,j.tint.topRight=b,j.tint.bottomLeft=w,j.tint.bottomRight=_,j.index=W,j.charCode=C,j.x=H,j.y=q,j.scale=N,j.rotation=F,j.data=v.data;var Q=G(j);H=Q.x,q=Q.y,N=Q.scale,F=Q.rotation,Q.color?(x=Q.color,b=Q.color,w=Q.color,_=Q.color):(x=Q.tint.topLeft,b=Q.tint.topRight,w=Q.tint.bottomLeft,_=Q.tint.bottomRight),x=s.getTintAppendFloatAlpha(x,n.alpha*e._alphaTL),b=s.getTintAppendFloatAlpha(b,n.alpha*e._alphaTR),w=s.getTintAppendFloatAlpha(w,n.alpha*e._alphaBL),_=s.getTintAppendFloatAlpha(_,n.alpha*e._alphaBR)}H*=N,q*=N,H-=e.displayOriginX,q-=e.displayOriginY,H+=V,d.applyITRS(H,q,F,N,N),f.multiply(d,l);var Z=v.u0,J=v.v0,$=v.u1,tt=v.v1,et=P,nt=R,it=l.e,rt=l.f,st=nt*l.c+l.e,ot=nt*l.d+l.f,at=et*l.a+nt*l.c+l.e,ht=et*l.b+nt*l.d+l.f,ut=et*l.a+l.e,ct=et*l.b+l.f;X&&(it=Math.round(it),rt=Math.round(rt),st=Math.round(st),ot=Math.round(ot),at=Math.round(at),ht=Math.round(ht),ut=Math.round(ut),ct=Math.round(ct)),u.batchQuad(e,it,rt,st,ot,at,ht,ut,ct,Z,J,$,tt,x,b,w,_,y,m,T)}}}else U++,1===B?V=(z.longest-z.lengths[U])/2:2===B&&(V=z.longest-z.lengths[U]),E=0,S+=L,g=null;p&&(u.flush(),t.popScissor()),t.pipelines.postBatch(e)}}},function(t,e,n){var i=n(30);t.exports=function(t,e,n,r){var s=e._text,o=s.length,a=t.currentContext;if(0!==o&&i(t,a,e,n,r)){n.addToRenderList(e);var h=e.frame,u=e.displayCallback,c=e.callbackData,l=e.fontData.chars,f=e.fontData.lineHeight,d=e._letterSpacing,p=0,v=0,g=0,m=null,y=0,x=0,b=0,w=0,_=0,T=0,E=null,S=0,C=e.frame.source.image,A=h.cutX,I=h.cutY,P=0,R=0,O=e._fontSize/e.fontData.size,k=e._align,M=0,D=0;e.getTextBounds(!1);var L=e._bounds.lines;1===k?D=(L.longest-L.lengths[0])/2:2===k&&(D=L.longest-L.lengths[0]),a.translate(-e.displayOriginX,-e.displayOriginY);var N=n.roundPixels;e.cropWidth>0&&e.cropHeight>0&&(a.beginPath(),a.rect(0,0,e.cropWidth,e.cropHeight),a.clip());for(var F=0;F<o;F++)if(R=O,P=0,10!==(g=s.charCodeAt(F))){if(m=l[g]){if(y=A+m.x,x=I+m.y,b=m.width,w=m.height,_=m.xOffset+p-e.scrollX,T=m.yOffset+v-e.scrollY,null!==E){var B=m.kerning[S];_+=void 0!==B?B:0}if(u){c.index=F,c.charCode=g,c.x=_,c.y=T,c.scale=R,c.rotation=P,c.data=m.data;var U=u(c);_=U.x,T=U.y,R=U.scale,P=U.rotation}_*=R,T*=R,_+=D,p+=m.xAdvance+d,E=m,S=g,0!==b&&0!==w&&32!==g&&(N&&(_=Math.round(_),T=Math.round(T)),a.save(),a.translate(_,T),a.rotate(P),a.scale(R,R),a.drawImage(C,y,x,b,w,0,0,b,w),a.restore())}}else M++,1===k?D=(L.longest-L.lengths[M])/2:2===k&&(D=L.longest-L.lengths[M]),p=0,v+=f,E=null;a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1058),r=n(1059),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r){t.pipelines.clear();var s=i(e,n,r).calc;e.render.call(e,t,n,s),t.pipelines.rebind()}},function(t,e){},function(t,e,n){var i=n(1),r=n(1);i=n(1061),n(448),r=n(448),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(217),r=n(19),s=n(25),o=n(12),a=function(t,e,n){this.x=t,this.y=e,this.width=n},h=function(t,e,n){this.points=[],this.pointsLength=1,this.points[0]=new a(t,e,n)},u=[],c=new s;t.exports=function(t,e,n,s){if(0!==e.commandBuffer.length){n.addToRenderList(e);var l=t.pipelines.set(e.pipeline,e);t.pipelines.preBatch(e);for(var f=r(e,n,s).calc,d=c.loadIdentity(),p=e.commandBuffer,v=n.alpha*e.alpha,g=1,m=l.fillTint,y=l.strokeTint,x=0,b=0,w=0,_=2*Math.PI,T=[],E=0,S=!0,C=null,A=o.getTintAppendFloatAlpha,I=0;I<p.length;I++)switch(p[I]){case i.BEGIN_PATH:T.length=0,C=null,S=!0;break;case i.CLOSE_PATH:S=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case i.FILL_PATH:for(E=0;E<T.length;E++)l.batchFillPath(T[E].points,d,f);break;case i.STROKE_PATH:for(E=0;E<T.length;E++)l.batchStrokePath(T[E].points,g,S,d,f);break;case i.LINE_STYLE:g=p[++I];var P=A(p[++I],p[++I]*v);y.TL=P,y.TR=P,y.BL=P,y.BR=P;break;case i.FILL_STYLE:var R=A(p[++I],p[++I]*v);m.TL=R,m.TR=R,m.BL=R,m.BR=R;break;case i.GRADIENT_FILL_STYLE:var O=p[++I]*v,k=p[++I]*v,M=p[++I]*v,D=p[++I]*v;m.TL=A(p[++I],O),m.TR=A(p[++I],k),m.BL=A(p[++I],M),m.BR=A(p[++I],D);break;case i.GRADIENT_LINE_STYLE:g=p[++I];var L=p[++I]*v;y.TL=A(p[++I],L),y.TR=A(p[++I],L),y.BL=A(p[++I],L),y.BR=A(p[++I],L);break;case i.ARC:var N=0,F=p[++I],B=p[++I],U=p[++I],V=p[++I],Y=p[++I],z=p[++I],X=p[++I];for(Y-=V,z?Y<-_?Y=-_:Y>0&&(Y=Y%_-_):Y>_?Y=_:Y<0&&(Y=_+Y%_),null===C&&(C=new h(F+Math.cos(V)*U,B+Math.sin(V)*U,g),T.push(C),N+=.01);N<1+X;)w=Y*N+V,x=F+Math.cos(w)*U,b=B+Math.sin(w)*U,C.points.push(new a(x,b,g)),N+=.01;w=Y+V,x=F+Math.cos(w)*U,b=B+Math.sin(w)*U,C.points.push(new a(x,b,g));break;case i.FILL_RECT:l.batchFillRect(p[++I],p[++I],p[++I],p[++I],d,f);break;case i.FILL_TRIANGLE:l.batchFillTriangle(p[++I],p[++I],p[++I],p[++I],p[++I],p[++I],d,f);break;case i.STROKE_TRIANGLE:l.batchStrokeTriangle(p[++I],p[++I],p[++I],p[++I],p[++I],p[++I],g,d,f);break;case i.LINE_TO:null!==C?C.points.push(new a(p[++I],p[++I],g)):(C=new h(p[++I],p[++I],g),T.push(C));break;case i.MOVE_TO:C=new h(p[++I],p[++I],g),T.push(C);break;case i.SAVE:u.push(d.copyToArray());break;case i.RESTORE:d.copyFromArray(u.pop());break;case i.TRANSLATE:F=p[++I],B=p[++I],d.translate(F,B);break;case i.SCALE:F=p[++I],B=p[++I],d.scale(F,B);break;case i.ROTATE:d.rotate(p[++I])}t.pipelines.postBatch(e)}}},function(t,e,n){var i=n(1),r=n(1);i=n(1063),r=n(1064),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i){n.addToRenderList(e),e.pipeline.batchSprite(e,n,i)}},function(t,e){t.exports=function(t,e,n,i){n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},function(t,e,n){var i=n(1),r=n(1);i=n(1066),r=n(1067),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i){n.addToRenderList(e),this.pipeline.batchSprite(e,n,i)}},function(t,e){t.exports=function(t,e,n,i){n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},function(t,e,n){var i=n(1),r=n(1);i=n(1069),r=n(1070),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n){var i=e.list,r=i.length;if(0!==r){e.depthSort(),t.pipelines.preBatch(e);var s=-1!==e.blendMode;s||t.setBlendMode(0);for(var o=e.alpha,a=0;a<r;a++){var h=i[a];if(h.willRender(n)){var u,c,l,f;if(void 0!==h.alphaTopLeft)u=h.alphaTopLeft,c=h.alphaTopRight,l=h.alphaBottomLeft,f=h.alphaBottomRight;else{var d=h.alpha;u=d,c=d,l=d,f=d}s||h.blendMode===t.currentBlendMode||t.setBlendMode(h.blendMode);var p=h.mask;p&&p.preRenderWebGL(t,h,n);var v=h.type;v!==t.currentType&&(t.newType=!0,t.currentType=v),t.nextTypeMatch=a<r-1&&i[a+1].type===t.currentType,h.setAlpha(u*o,c*o,l*o,f*o),h.renderWebGL(t,h,n),h.setAlpha(u,c,l,f),p&&p.postRenderWebGL(t,n),t.newType=!1}}t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n){var i=e.list;if(0!==i.length){e.depthSort();var r=-1!==e.blendMode;r||t.setBlendMode(0);var s=e._alpha;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var o=0;o<i.length;o++){var a=i[o];if(a.willRender(n)){var h=a.alpha;r||a.blendMode===t.currentBlendMode||t.setBlendMode(a.blendMode),a.setAlpha(h*s),a.renderCanvas(t,a,n),a.setAlpha(h)}}e.mask&&e.mask.postRenderCanvas(t)}}},function(t,e,n){t.exports={EmitterOp:n(449),GravityWell:n(450),Particle:n(451),ParticleEmitter:n(452),ParticleEmitterManager:n(220),Zones:n(1075)}},function(t,e,n){var i=n(1),r=n(1);i=n(1073),r=n(1074),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(25),r=n(12),s=new i,o=new i,a=new i,h=new i;t.exports=function(t,e,n,i){var u=e.emitters.list,c=u.length;if(0!==c){var l=t.pipelines.set(e.pipeline),f=s,d=o,p=a,v=h;i?(v.loadIdentity(),v.multiply(i),v.translate(e.x,e.y),v.rotate(e.rotation),v.scale(e.scaleX,e.scaleY)):v.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var g=n.roundPixels,m=e.defaultFrame.glTexture,y=r.getTintAppendFloatAlpha,x=l.setGameObject(e,e.defaultFrame);t.pipelines.preBatch(e);for(var b=0;b<c;b++){var w=u[b],_=w.alive,T=_.length;if(w.visible&&0!==T){n.addToRenderList(w);var E=w.scrollFactorX,S=w.scrollFactorY;t.setBlendMode(w.blendMode),w.mask&&(w.mask.preRenderWebGL(t,w,n),t.pipelines.set(e.pipeline));for(var C=0;C<T;C++){var A=_[C],I=A.alpha*n.alpha;if(!(I<=0)){p.applyITRS(A.x,A.y,A.rotation,A.scaleX,A.scaleY),f.copyFrom(n.matrix),f.multiplyWithOffset(v,-n.scrollX*E,-n.scrollY*S),p.e=A.x,p.f=A.y,f.multiply(p,d);var P=A.frame,R=-P.halfWidth,O=-P.halfHeight,k=R+P.width,M=O+P.height,D=d.getXRound(R,O,g),L=d.getYRound(R,O,g),N=d.getXRound(R,M,g),F=d.getYRound(R,M,g),B=d.getXRound(k,M,g),U=d.getYRound(k,M,g),V=d.getXRound(k,O,g),Y=d.getYRound(k,O,g),z=y(A.tint,I);l.batchQuad(w,D,L,N,F,B,U,V,Y,P.u0,P.v0,P.u1,P.v1,z,z,z,z,0,m,x)}}w.mask&&w.mask.postRenderWebGL(t,n)}}t.pipelines.postBatch(e)}}},function(t,e,n){var i=n(25),r=new i,s=new i,o=new i,a=new i;t.exports=function(t,e,n,i){var h=e.emitters.list,u=h.length;if(0!==u){var c=r.copyFrom(n.matrix),l=s,f=o,d=a;i?(d.loadIdentity(),d.multiply(i),d.translate(e.x,e.y),d.rotate(e.rotation),d.scale(e.scaleX,e.scaleY)):d.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);for(var p=t.currentContext,v=n.roundPixels,g=0;g<u;g++){var m=h[g],y=m.alive,x=y.length;if(m.visible&&0!==x){n.addToRenderList(m);var b=m.scrollFactorX,w=m.scrollFactorY;p.save(),p.globalCompositeOperation=t.blendModes[m.blendMode];for(var _=0;_<x;_++){var T=y[_],E=T.alpha*n.alpha;if(!(E<=0)){f.applyITRS(T.x,T.y,T.rotation,T.scaleX,T.scaleY),c.copyFrom(n.matrix),c.multiplyWithOffset(d,-n.scrollX*b,-n.scrollY*w),f.e=T.x,f.f=T.y,c.multiply(f,l);var S=T.frame,C=S.canvasData,A=-S.halfWidth,I=-S.halfHeight;p.globalAlpha=E,p.save(),l.setToContext(p),v&&(A=Math.round(A),I=Math.round(I)),p.imageSmoothingEnabled=!(!t.antialias||S.source.scaleMode),p.drawImage(S.source.image,C.x,C.y,C.width,C.height,A,I,C.width,C.height),p.restore()}}p.restore()}}}}},function(t,e,n){t.exports={DeathZone:n(453),EdgeZone:n(454),RandomZone:n(456)}},function(t,e,n){var i=n(1),r=n(1);i=n(1077),r=n(1078),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,r){n.addToRenderList(e);var s=n.alpha,o=e.renderTarget,a=o.width,h=o.height,u=i.getTintAppendFloatAlpha,c=t.pipelines.set(e.pipeline),l=c.setTexture2D(o.texture);t.pipelines.preBatch(e),c.batchTexture(e,o.texture,a,h,e.x,e.y,a,h,e.scaleX,e.scaleY,e.rotation,e.flipX,!e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,a,h,u(e.tintTopLeft,s*e._alphaTL),u(e.tintTopRight,s*e._alphaTR),u(e.tintBottomLeft,s*e._alphaBL),u(e.tintBottomRight,s*e._alphaBR),e.tintFill,0,0,n,r,!0,l),t.resetTextures(),t.pipelines.postBatch(e)}},function(t,e){t.exports=function(t,e,n,i){n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},function(t,e,n){var i=n(1080),r=n(17),s={Parse:n(1081)};s=r(!1,s,i),t.exports=s},function(t,e){t.exports={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}},function(t,e,n){var i=n(6);t.exports=function(t,e){var n=e.width,r=e.height,s=Math.floor(n/2),o=Math.floor(r/2),a=i(e,"chars","");if(""!==a){var h=i(e,"image",""),u=t.sys.textures.getFrame(h),c=u.cutX,l=u.cutY,f=u.source.width,d=u.source.height,p=i(e,"offset.x",0),v=i(e,"offset.y",0),g=i(e,"spacing.x",0),m=i(e,"spacing.y",0),y=i(e,"lineSpacing",0),x=i(e,"charsPerRow",null);null===x&&(x=f/n)>a.length&&(x=a.length);for(var b=p,w=v,_={retroFont:!0,font:h,size:n,lineHeight:r+y,chars:{}},T=0,E=0;E<a.length;E++){var S=a.charCodeAt(E),C=(c+b)/f,A=(l+w)/d,I=(c+b+n)/f,P=(l+w+r)/d;_.chars[S]={x:b,y:w,width:n,height:r,centerX:s,centerY:o,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{},u0:C,v0:A,u1:I,v1:P},++T===x?(T=0,b=p,w+=r+m):b+=n+g}return{data:_,frame:null,texture:h}}}},function(t,e,n){var i=n(1),r=n(1);i=n(1083),r=n(1084),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(12);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline,e),a=i(e,n,s).calc,h=e.vertices,u=e.uv,c=e.colors,l=e.alphas,f=e.alpha,d=r.getTintAppendFloatAlpha,p=n.roundPixels,v=h.length,g=Math.floor(.5*v);o.flush(),t.pipelines.preBatch(e);var m=o.setGameObject(e),y=o.vertexViewF32,x=o.vertexViewU32,b=o.vertexCount*o.currentShader.vertexComponentCount-1,w=0,_=e.tintFill;e.dirty&&e.updateVertices();for(var T=e.debugCallback,E=[],S=0;S<v;S+=2){var C=h[S+0],A=h[S+1],I=C*a.a+A*a.c+a.e,P=C*a.b+A*a.d+a.f;p&&(I=Math.round(I),P=Math.round(P)),y[++b]=I,y[++b]=P,y[++b]=u[S+0],y[++b]=u[S+1],y[++b]=m,y[++b]=_,x[++b]=d(c[w],n.alpha*(l[w]*f)),w++,T&&(E[S+0]=I,E[S+1]=P)}T&&T.call(e,e,v,E),o.vertexCount+=g,t.pipelines.postBatch(e)}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(1),r=n(1);i=n(1086),r=n(1087),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,r){if(0!==e.width&&0!==e.height){n.addToRenderList(e);var s=e.frame,o=s.width,a=s.height,h=i.getTintAppendFloatAlpha,u=t.pipelines.set(e.pipeline,e),c=u.setTexture2D(s.glTexture,e);t.pipelines.preBatch(e),u.batchTexture(e,s.glTexture,o,a,e.x,e.y,o/e.style.resolution,a/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,o,a,h(e.tintTopLeft,n.alpha*e._alphaTL),h(e.tintTopRight,n.alpha*e._alphaTR),h(e.tintBottomLeft,n.alpha*e._alphaBL),h(e.tintBottomRight,n.alpha*e._alphaBR),e.tintFill,0,0,n,r,!1,c),t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){0!==e.width&&0!==e.height&&(n.addToRenderList(e),t.batchSprite(e,e.frame,n,i))}},function(t,e,n){var i=n(1),r=n(1);i=n(1089),r=n(1090),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,r){e.updateCanvas();var s=e.width,o=e.height;if(0!==s&&0!==o){n.addToRenderList(e),t.pipelines.preBatch(e);var a=i.getTintAppendFloatAlpha,h=t.pipelines.set(e.pipeline,e),u=h.setTexture2D(e.fillPattern,e);h.batchTexture(e,e.fillPattern,e.displayFrame.width*e.tileScaleX,e.displayFrame.height*e.tileScaleY,e.x,e.y,s,o,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.originX*s,e.originY*o,0,0,s,o,a(e.tintTopLeft,n.alpha*e._alphaTL),a(e.tintTopRight,n.alpha*e._alphaTR),a(e.tintBottomLeft,n.alpha*e._alphaBL),a(e.tintBottomRight,n.alpha*e._alphaBR),e.tintFill,e.tilePositionX%e.displayFrame.width/e.displayFrame.width,e.tilePositionY%e.displayFrame.height/e.displayFrame.height,n,r,!1,u),t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){e.updateCanvas(),n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},function(t,e,n){var i=n(1),r=n(1);i=n(1092),r=n(1093),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i){e.videoTexture&&(n.addToRenderList(e),e.pipeline.batchSprite(e,n,i))}},function(t,e){t.exports=function(t,e,n,i){e.videoTexture&&(n.addToRenderList(e),t.batchSprite(e,e.frame,n,i))}},function(t,e,n){var i=n(1),r=n(1);i=n(1095),r=n(1096),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(114),s=n(82);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=i(e,n,o),u=a.calcMatrix.copyFrom(h.calc),c=e._displayOriginX,l=e._displayOriginY,f=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&r(a,u,e,f,c,l),e.isStroked&&s(a,e,f,c,l),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(36),r=n(48),s=n(59),o=n(30);t.exports=function(t,e,n,a){n.addToRenderList(e);var h=t.currentContext;if(o(t,h,e,n,a)){var u=e.radius;h.beginPath(),h.arc(u-e.originX*(2*u),u-e.originY*(2*u),u,i(e._startAngle),i(e._endAngle),e.anticlockwise),e.closePath&&h.closePath(),e.isFilled&&(r(h,e),h.fill()),e.isStroked&&(s(h,e),h.stroke()),h.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1098),r=n(1099),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(114),r=n(19),s=n(82);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=r(e,n,o),u=a.calcMatrix.copyFrom(h.calc),c=e._displayOriginX+e._curveBounds.x,l=e._displayOriginY+e._curveBounds.y,f=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,u,e,f,c,l),e.isStroked&&s(a,e,f,c,l),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX+e._curveBounds.x,u=e._displayOriginY+e._curveBounds.y,c=e.pathData,l=c.length-1,f=c[0]-h,d=c[1]-u;a.beginPath(),a.moveTo(f,d),e.closePath||(l-=2);for(var p=2;p<l;p+=2){var v=c[p]-h,g=c[p+1]-u;a.lineTo(v,g)}e.closePath&&a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1101),r=n(1102),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(114),r=n(19),s=n(82);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=r(e,n,o),u=a.calcMatrix.copyFrom(h.calc),c=e._displayOriginX,l=e._displayOriginY,f=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,u,e,f,c,l),e.isStroked&&s(a,e,f,c,l),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX,u=e._displayOriginY,c=e.pathData,l=c.length-1,f=c[0]-h,d=c[1]-u;a.beginPath(),a.moveTo(f,d),e.closePath||(l-=2);for(var p=2;p<l;p+=2){var v=c[p]-h,g=c[p+1]-u;a.lineTo(v,g)}a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1104),r=n(1105),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(12);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s);o.calcMatrix.copyFrom(a.calc).translate(-e._displayOriginX,-e._displayOriginY);var h,u,c=n.alpha*e.alpha,l=e.width,f=e.height,d=e.cellWidth,p=e.cellHeight,v=Math.ceil(l/d),g=Math.ceil(f/p),m=d,y=p,x=d-(v*d-l),b=p-(g*p-f),w=e.showCells,_=e.showAltCells,T=e.showOutline,E=0,S=0,C=0,A=0,I=0;if(T&&(m--,y--,x===d&&x--,b===p&&b--),t.pipelines.preBatch(e),w&&e.fillAlpha>0)for(h=o.fillTint,u=r.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*c),h.TL=u,h.TR=u,h.BL=u,h.BR=u,S=0;S<g;S++)for(_&&(C=S%2),E=0;E<v;E++)_&&C?C=0:(C++,A=E<v-1?m:x,I=S<g-1?y:b,o.batchFillRect(E*d,S*p,A,I));if(_&&e.altFillAlpha>0)for(h=o.fillTint,u=r.getTintAppendFloatAlpha(e.altFillColor,e.altFillAlpha*c),h.TL=u,h.TR=u,h.BL=u,h.BR=u,S=0;S<g;S++)for(_&&(C=S%2),E=0;E<v;E++)!_||C?(C=0,A=E<v-1?m:x,I=S<g-1?y:b,o.batchFillRect(E*d,S*p,A,I)):C=1;if(T&&e.outlineFillAlpha>0){var P=o.strokeTint,R=r.getTintAppendFloatAlpha(e.outlineFillColor,e.outlineFillAlpha*c);for(P.TL=R,P.TR=R,P.BL=R,P.BR=R,E=1;E<v;E++){var O=E*d;o.batchLine(O,0,O,f,1,1,1,0,!1)}for(S=1;S<g;S++){var k=S*p;o.batchLine(0,k,l,k,1,1,1,0,!1)}}t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=-e._displayOriginX,u=-e._displayOriginY,c=n.alpha*e.alpha,l=e.width,f=e.height,d=e.cellWidth,p=e.cellHeight,v=Math.ceil(l/d),g=Math.ceil(f/p),m=d,y=p,x=d-(v*d-l),b=p-(g*p-f),w=e.showCells,_=e.showAltCells,T=e.showOutline,E=0,S=0,C=0,A=0,I=0;if(T&&(m--,y--,x===d&&x--,b===p&&b--),w&&e.fillAlpha>0)for(i(a,e),S=0;S<g;S++)for(_&&(C=S%2),E=0;E<v;E++)_&&C?C=0:(C++,A=E<v-1?m:x,I=S<g-1?y:b,a.fillRect(h+E*d,u+S*p,A,I));if(_&&e.altFillAlpha>0)for(i(a,e,e.altFillColor,e.altFillAlpha*c),S=0;S<g;S++)for(_&&(C=S%2),E=0;E<v;E++)!_||C?(C=0,A=E<v-1?m:x,I=S<g-1?y:b,a.fillRect(h+E*d,u+S*p,A,I)):C=1;if(T&&e.outlineFillAlpha>0){for(r(a,e,e.outlineFillColor,e.outlineFillAlpha*c),E=1;E<v;E++){var P=E*d;a.beginPath(),a.moveTo(P+h,u),a.lineTo(P+h,f+u),a.stroke()}for(S=1;S<g;S++){var R=S*p;a.beginPath(),a.moveTo(h,R+u),a.lineTo(h+l,R+u),a.stroke()}}a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1107),r=n(1108),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(12);t.exports=function(t,e,n,s){n.addToRenderList(e);var o,a,h,u,c,l,f,d,p,v=t.pipelines.set(e.pipeline),g=i(e,n,s),m=v.calcMatrix.copyFrom(g.calc),y=e.width,x=e.height,b=y/2,w=y/e.projection,_=n.alpha*e.alpha;e.isFilled&&(t.pipelines.preBatch(e),e.showTop&&(o=r.getTintAppendFloatAlpha(e.fillTop,_),a=m.getX(-b,-x),h=m.getY(-b,-x),u=m.getX(0,-w-x),c=m.getY(0,-w-x),l=m.getX(b,-x),f=m.getY(b,-x),d=m.getX(0,w-x),p=m.getY(0,w-x),v.batchQuad(a,h,u,c,l,f,d,p,o,o,o,o)),e.showLeft&&(o=r.getTintAppendFloatAlpha(e.fillLeft,_),a=m.getX(-b,0),h=m.getY(-b,0),u=m.getX(0,w),c=m.getY(0,w),l=m.getX(0,w-x),f=m.getY(0,w-x),d=m.getX(-b,-x),p=m.getY(-b,-x),v.batchQuad(a,h,u,c,l,f,d,p,o,o,o,o)),e.showRight&&(o=r.getTintAppendFloatAlpha(e.fillRight,_),a=m.getX(b,0),h=m.getY(b,0),u=m.getX(0,w),c=m.getY(0,w),l=m.getX(0,w-x),f=m.getY(0,w-x),d=m.getX(b,-x),p=m.getY(b,-x),v.batchQuad(a,h,u,c,l,f,d,p,o,o,o,o)),t.pipelines.postBatch(e))}},function(t,e,n){var i=n(48),r=n(30);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)&&e.isFilled){var a=e.width,h=e.height,u=a/2,c=a/e.projection;e.showTop&&(i(o,e,e.fillTop),o.beginPath(),o.moveTo(-u,-h),o.lineTo(0,-c-h),o.lineTo(u,-h),o.lineTo(u,-1),o.lineTo(0,c-1),o.lineTo(-u,-1),o.lineTo(-u,-h),o.fill()),e.showLeft&&(i(o,e,e.fillLeft),o.beginPath(),o.moveTo(-u,0),o.lineTo(0,c),o.lineTo(0,c-h),o.lineTo(-u,-h),o.lineTo(-u,0),o.fill()),e.showRight&&(i(o,e,e.fillRight),o.beginPath(),o.moveTo(u,0),o.lineTo(0,c),o.lineTo(0,c-h),o.lineTo(u,-h),o.lineTo(u,0),o.fill()),o.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1110),r=n(1111),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(12);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s),h=o.calcMatrix.copyFrom(a.calc),u=e.width,c=e.height,l=u/2,f=u/e.projection,d=e.isReversed,p=n.alpha*e.alpha;if(e.isFilled){var v,g,m,y,x,b,w;if(t.pipelines.preBatch(e),e.showTop&&d){v=r.getTintAppendFloatAlpha(e.fillTop,p),g=h.getX(-l,-c),m=h.getY(-l,-c),y=h.getX(0,-f-c),x=h.getY(0,-f-c),b=h.getX(l,-c),w=h.getY(l,-c);var _=h.getX(0,f-c),T=h.getY(0,f-c);o.batchQuad(g,m,y,x,b,w,_,T,v,v,v,v)}e.showLeft&&(v=r.getTintAppendFloatAlpha(e.fillLeft,p),d?(g=h.getX(-l,-c),m=h.getY(-l,-c),y=h.getX(0,f),x=h.getY(0,f),b=h.getX(0,f-c),w=h.getY(0,f-c)):(g=h.getX(-l,0),m=h.getY(-l,0),y=h.getX(0,f),x=h.getY(0,f),b=h.getX(0,f-c),w=h.getY(0,f-c)),o.batchTri(g,m,y,x,b,w,v,v,v)),e.showRight&&(v=r.getTintAppendFloatAlpha(e.fillRight,p),d?(g=h.getX(l,-c),m=h.getY(l,-c),y=h.getX(0,f),x=h.getY(0,f),b=h.getX(0,f-c),w=h.getY(0,f-c)):(g=h.getX(l,0),m=h.getY(l,0),y=h.getX(0,f),x=h.getY(0,f),b=h.getX(0,f-c),w=h.getY(0,f-c)),o.batchTri(g,m,y,x,b,w,v,v,v)),t.pipelines.postBatch(e)}}},function(t,e,n){var i=n(48),r=n(30);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)&&e.isFilled){var a=e.width,h=e.height,u=a/2,c=a/e.projection,l=e.isReversed;e.showTop&&l&&(i(o,e,e.fillTop),o.beginPath(),o.moveTo(-u,-h),o.lineTo(0,-c-h),o.lineTo(u,-h),o.lineTo(0,c-h),o.fill()),e.showLeft&&(i(o,e,e.fillLeft),o.beginPath(),l?(o.moveTo(-u,-h),o.lineTo(0,c),o.lineTo(0,c-h)):(o.moveTo(-u,0),o.lineTo(0,c),o.lineTo(0,c-h)),o.fill()),e.showRight&&(i(o,e,e.fillRight),o.beginPath(),l?(o.moveTo(u,-h),o.lineTo(0,c),o.lineTo(0,c-h)):(o.moveTo(u,0),o.lineTo(0,c),o.lineTo(0,c-h)),o.fill()),o.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1113),r=n(1114),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(12);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s);o.calcMatrix.copyFrom(a.calc);var h=e._displayOriginX,u=e._displayOriginY,c=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isStroked){var l=o.strokeTint,f=r.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*c);l.TL=f,l.TR=f,l.BL=f,l.BR=f;var d=e._startWidth,p=e._endWidth;o.batchLine(e.geom.x1-h,e.geom.y1-u,e.geom.x2-h,e.geom.y2-u,d,p,1,0,!1,a.sprite,a.camera)}t.pipelines.postBatch(e)}},function(t,e,n){var i=n(59),r=n(30);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)){var a=e._displayOriginX,h=e._displayOriginY;e.isStroked&&(i(o,e),o.beginPath(),o.moveTo(e.geom.x1-a,e.geom.y1-h),o.lineTo(e.geom.x2-a,e.geom.y2-h),o.stroke()),o.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1116),r=n(1117),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(114),r=n(19),s=n(82);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=r(e,n,o),u=a.calcMatrix.copyFrom(h.calc),c=e._displayOriginX,l=e._displayOriginY,f=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,u,e,f,c,l),e.isStroked&&s(a,e,f,c,l),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX,u=e._displayOriginY,c=e.pathData,l=c.length-1,f=c[0]-h,d=c[1]-u;a.beginPath(),a.moveTo(f,d),e.closePath||(l-=2);for(var p=2;p<l;p+=2){var v=c[p]-h,g=c[p+1]-u;a.lineTo(v,g)}a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1119),r=n(1120),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(82),s=n(12);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=i(e,n,o);a.calcMatrix.copyFrom(h.calc);var u=e._displayOriginX,c=e._displayOriginY,l=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isFilled){var f=a.fillTint,d=s.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*l);f.TL=d,f.TR=d,f.BL=d,f.BR=d,a.batchFillRect(-u,-c,e.width,e.height)}e.isStroked&&r(a,e,l,u,c),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX,u=e._displayOriginY;e.isFilled&&(i(a,e),a.fillRect(-h,-u,e.width,e.height)),e.isStroked&&(r(a,e),a.beginPath(),a.rect(-h,-u,e.width,e.height),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1122),r=n(1123),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(114),r=n(19),s=n(82);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=r(e,n,o),u=a.calcMatrix.copyFrom(h.calc),c=e._displayOriginX,l=e._displayOriginY,f=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,u,e,f,c,l),e.isStroked&&s(a,e,f,c,l),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX,u=e._displayOriginY,c=e.pathData,l=c.length-1,f=c[0]-h,d=c[1]-u;a.beginPath(),a.moveTo(f,d),e.closePath||(l-=2);for(var p=2;p<l;p+=2){var v=c[p]-h,g=c[p+1]-u;a.lineTo(v,g)}a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1125),r=n(1126),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19),r=n(82),s=n(12);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),h=i(e,n,o);a.calcMatrix.copyFrom(h.calc);var u=e._displayOriginX,c=e._displayOriginY,l=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isFilled){var f=a.fillTint,d=s.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*l);f.TL=d,f.TR=d,f.BL=d,f.BR=d;var p=e.geom.x1-u,v=e.geom.y1-c,g=e.geom.x2-u,m=e.geom.y2-c,y=e.geom.x3-u,x=e.geom.y3-c;a.batchFillTriangle(p,v,g,m,y,x,h.sprite,h.camera)}e.isStroked&&r(a,e,l,u,c),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(48),r=n(59),s=n(30);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var h=e._displayOriginX,u=e._displayOriginY,c=e.geom.x1-h,l=e.geom.y1-u,f=e.geom.x2-h,d=e.geom.y2-u,p=e.geom.x3-h,v=e.geom.y3-u;a.beginPath(),a.moveTo(c,l),a.lineTo(f,d),a.lineTo(p,v),a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},function(t,e,n){var i=n(213);n(5).register("blitter",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},function(t,e,n){var i=n(214);n(5).register("container",(function(t,e,n){return this.displayList.add(new i(this.scene,t,e,n))}))},function(t,e,n){var i=n(442);n(5).register("dom",(function(t,e,n,r,s){var o=new i(this.scene,t,e,n,r,s);return this.displayList.add(o),o}))},function(t,e,n){var i=n(215);n(5).register("dynamicBitmapText",(function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,r,s))}))},function(t,e,n){var i=n(444);n(5).register("extern",(function(){var t=new i(this.scene);return this.displayList.add(t),t}))},function(t,e,n){var i=n(216);n(5).register("graphics",(function(t){return this.displayList.add(new i(this.scene,t))}))},function(t,e,n){var i=n(113);n(5).register("group",(function(t,e){return this.updateList.add(new i(this.scene,t,e))}))},function(t,e,n){var i=n(126);n(5).register("image",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},function(t,e,n){var i=n(219);n(5).register("layer",(function(t){return this.displayList.add(new i(this.scene,t))}))},function(t,e,n){var i=n(5),r=n(220);i.register("particles",(function(t,e,n){return this.displayList.add(new r(this.scene,t,e,n))}))},function(t,e,n){var i=n(5),r=n(457);i.register("follower",(function(t,e,n,i,s){var o=new r(this.scene,t,e,n,i,s);return this.displayList.add(o),this.updateList.add(o),o}))},function(t,e,n){var i=n(5),r=n(221);i.register("renderTexture",(function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))}))},function(t,e,n){var i=n(223);n(5).register("rope",(function(t,e,n,r,s,o,a,h){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,h))}))},function(t,e,n){var i=n(5),r=n(74);i.register("sprite",(function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.displayList.add(s),s}))},function(t,e,n){var i=n(149);n(5).register("bitmapText",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},function(t,e,n){var i=n(224);n(5).register("text",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},function(t,e,n){var i=n(225);n(5).register("tileSprite",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},function(t,e,n){var i=n(130);n(5).register("zone",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},function(t,e,n){var i=n(226);n(5).register("video",(function(t,e,n){return this.displayList.add(new i(this.scene,t,e,n))}))},function(t,e,n){var i=n(461),r=n(5);r.register("arc",(function(t,e,n,r,s,o,a,h){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,h))})),r.register("circle",(function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,0,360,!1,r,s))}))},function(t,e,n){var i=n(5),r=n(462);i.register("curve",(function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))}))},function(t,e,n){var i=n(463);n(5).register("ellipse",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},function(t,e,n){var i=n(5),r=n(464);i.register("grid",(function(t,e,n,i,s,o,a,h,u,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,h,u,c))}))},function(t,e,n){var i=n(5),r=n(465);i.register("isobox",(function(t,e,n,i,s,o,a){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a))}))},function(t,e,n){var i=n(5),r=n(466);i.register("isotriangle",(function(t,e,n,i,s,o,a,h){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,h))}))},function(t,e,n){var i=n(5),r=n(467);i.register("line",(function(t,e,n,i,s,o,a,h){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,h))}))},function(t,e,n){var i=n(5),r=n(468);i.register("polygon",(function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))}))},function(t,e,n){var i=n(5),r=n(473);i.register("rectangle",(function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))}))},function(t,e,n){var i=n(474);n(5).register("star",(function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))}))},function(t,e,n){var i=n(5),r=n(475);i.register("triangle",(function(t,e,n,i,s,o,a,h,u,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,h,u,c))}))},function(t,e,n){var i=n(213),r=n(28),s=n(16),o=n(13);s.register("blitter",(function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),a=new i(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),r(this.scene,a,t),a}))},function(t,e,n){var i=n(28),r=n(214),s=n(16),o=n(13);s.register("container",(function(t,e){void 0===t&&(t={});var n=o(t,"x",0),s=o(t,"y",0),a=o(t,"children",null),h=new r(this.scene,n,s,a);return void 0!==e&&(t.add=e),i(this.scene,h,t),h}))},function(t,e,n){var i=n(215),r=n(28),s=n(16),o=n(13);s.register("dynamicBitmapText",(function(t,e){void 0===t&&(t={});var n=o(t,"font",""),s=o(t,"text",""),a=o(t,"size",!1),h=new i(this.scene,0,0,n,s,a);return void 0!==e&&(t.add=e),r(this.scene,h,t),h}))},function(t,e,n){var i=n(16),r=n(216);i.register("graphics",(function(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var n=new r(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n}))},function(t,e,n){var i=n(16),r=n(113);i.register("group",(function(t){return new r(this.scene,null,t)}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(126);r.register("image",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),a=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,a,t),a}))},function(t,e,n){var i=n(28),r=n(219),s=n(16),o=n(13);s.register("layer",(function(t,e){void 0===t&&(t={});var n=o(t,"children",null),s=new r(this.scene,n);return void 0!==e&&(t.add=e),i(this.scene,s,t),s}))},function(t,e,n){var i=n(16),r=n(13),s=n(2),o=n(220);i.register("particles",(function(t,e){void 0===t&&(t={});var n=r(t,"key",null),i=r(t,"frame",null),a=s(t,"emitters",null),h=new o(this.scene,n,i,a);return void 0!==e&&(t.add=e),s(t,"add",!1)?this.displayList.add(h):this.updateList.add(h),h}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(221);r.register("renderTexture",(function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",32),h=s(t,"height",32),u=s(t,"key",void 0),c=s(t,"frame",void 0),l=new o(this.scene,n,r,a,h,u,c);return void 0!==e&&(t.add=e),i(this.scene,l,t),l}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(6),a=n(223);r.register("rope",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),h=s(t,"horizontal",!0),u=o(t,"points",void 0),c=o(t,"colors",void 0),l=o(t,"alphas",void 0),f=new a(this.scene,0,0,n,r,u,h,c,l);return void 0!==e&&(t.add=e),i(this.scene,f,t),t.add||this.updateList.add(f),f}))},function(t,e,n){var i=n(28),r=n(439),s=n(16),o=n(13),a=n(74);s.register("sprite",(function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),h=new a(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),i(this.scene,h,t),r(h,t),h}))},function(t,e,n){var i=n(149),r=n(28),s=n(16),o=n(13),a=n(6);s.register("bitmapText",(function(t,e){void 0===t&&(t={});var n=a(t,"font",""),s=o(t,"text",""),h=o(t,"size",!1),u=a(t,"align",0),c=new i(this.scene,0,0,n,s,h,u);return void 0!==e&&(t.add=e),r(this.scene,c,t),c}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(224);r.register("text",(function(t,e){void 0===t&&(t={});var n=s(t,"text",""),r=s(t,"style",null),a=s(t,"padding",null);null!==a&&(r.padding=a);var h=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,h,t),h.autoRound=s(t,"autoRound",!0),h.resolution=s(t,"resolution",1),h}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(225);r.register("tileSprite",(function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",512),h=s(t,"height",512),u=s(t,"key",""),c=s(t,"frame",""),l=new o(this.scene,n,r,a,h,u,c);return void 0!==e&&(t.add=e),i(this.scene,l,t),l}))},function(t,e,n){var i=n(16),r=n(13),s=n(130);i.register("zone",(function(t){var e=r(t,"x",0),n=r(t,"y",0),i=r(t,"width",1),o=r(t,"height",i);return new s(this.scene,e,n,i,o)}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(226);r.register("video",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=new o(this.scene,0,0,n);return void 0!==e&&(t.add=e),i(this.scene,r,t),t.add||this.updateList.add(r),r}))},function(t,e,n){var i=n(1),r=n(1);i=n(1174),r=n(1175),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r){if(e.shader){if(n.addToRenderList(e),t.pipelines.clear(),e.renderToTexture)e.load(),e.flush();else{var s=i(e,n,r).calc;t.width===e._rendererWidth&&t.height===e._rendererHeight||e.projOrtho(0,t.width,t.height,0),e.load(s.matrix),e.flush()}t.pipelines.rebind()}}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(1),r=n(1);i=n(1177),r=n(1178),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r){var s=e.faces,o=s.length;if(0!==o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline,e),h=i(e,n,r).calc,u=a.setGameObject(e),c=a.vertexViewF32,l=a.vertexViewU32,f=a.vertexCount*a.currentShader.vertexComponentCount-1,d=e.tintFill,p=[],v=e.debugCallback,g=h.a,m=h.b,y=h.c,x=h.d,b=h.e,w=h.f,_=e.viewPosition.z,T=e.hideCCW,E=n.roundPixels,S=n.alpha*e.alpha,C=0;t.pipelines.preBatch(e);for(var A=0;A<o;A++){var I=s[A];I.isInView(n,T,_,S,g,m,y,x,b,w,E)&&(a.shouldFlush(3)&&(a.flush(),f=0),f=I.load(c,l,f,u,d),C++,a.vertexCount+=3,v&&p.push(I))}e.totalFrame+=C,v&&v.call(e,e,p),t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(1),r=n(1);i=n(1180),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r){n.addToRenderList(e);var s=t.pipelines.set(e.pipeline),o=i(e,n,r).calc,a=e.width,h=e.height,u=-e._radius,c=-e._radius,l=u+a,f=c+h,d=o.getX(0,0),p=o.getY(0,0),v=o.getX(u,c),g=o.getY(u,c),m=o.getX(u,f),y=o.getY(u,f),x=o.getX(l,f),b=o.getY(l,f),w=o.getX(l,c),_=o.getY(l,c);t.pipelines.preBatch(e),s.batchPointLight(e,n,v,g,m,y,x,b,w,_,d,p),t.pipelines.postBatch(e)}},function(t,e,n){var i=n(229);n(5).register("shader",(function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))}))},function(t,e,n){var i=n(230);n(5).register("mesh",(function(t,e,n,r,s,o,a,h,u,c,l){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,h,u,c,l))}))},function(t,e,n){var i=n(5),r=n(151);i.register("pointlight",(function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(229);r.register("shader",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"x",0),a=s(t,"y",0),h=s(t,"width",128),u=s(t,"height",128),c=new o(this.scene,n,r,a,h,u);return void 0!==e&&(t.add=e),i(this.scene,c,t),c}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(6),a=n(230);r.register("mesh",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),h=o(t,"vertices",[]),u=o(t,"uvs",[]),c=o(t,"indicies",[]),l=o(t,"containsZ",!1),f=o(t,"normals",[]),d=o(t,"colors",16777215),p=o(t,"alphas",1),v=new a(this.scene,0,0,n,r,h,u,c,l,f,d,p);return void 0!==e&&(t.add=e),i(this.scene,v,t),v}))},function(t,e,n){var i=n(28),r=n(16),s=n(13),o=n(151);r.register("pointlight",(function(t,e){void 0===t&&(t={});var n=s(t,"color",16777215),r=s(t,"radius",128),a=s(t,"intensity",1),h=s(t,"attenuation",.1),u=new o(this.scene,0,0,n,r,a,h);return void 0!==e&&(t.add=e),i(this.scene,u,t),u}))},function(t,e,n){var i=n(0),r=n(482),s=n(24),o=n(20),a=new i({Extends:r,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(o.BOOT,this.boot,this),r.call(this)},boot:function(){var t=this.systems.events;t.on(o.SHUTDOWN,this.shutdown,this),t.on(o.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});s.register("LightsPlugin",a,"lights"),t.exports=a},function(t,e,n){var i=n(64);i.Area=n(1189),i.Circumference=n(302),i.CircumferencePoint=n(169),i.Clone=n(1190),i.Contains=n(65),i.ContainsPoint=n(1191),i.ContainsRect=n(1192),i.CopyFrom=n(1193),i.Equals=n(1194),i.GetBounds=n(1195),i.GetPoint=n(300),i.GetPoints=n(301),i.Offset=n(1196),i.OffsetPoint=n(1197),i.Random=n(170),t.exports=i},function(t,e){t.exports=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}},function(t,e,n){var i=n(64);t.exports=function(t){return new i(t.x,t.y,t.radius)}},function(t,e,n){var i=n(65);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e,n){var i=n(65);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.radius)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}},function(t,e,n){var i=n(10);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.diameter,e.height=t.diameter,e}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e,n){var i=n(111);i.Area=n(1199),i.Circumference=n(447),i.CircumferencePoint=n(218),i.Clone=n(1200),i.Contains=n(112),i.ContainsPoint=n(1201),i.ContainsRect=n(1202),i.CopyFrom=n(1203),i.Equals=n(1204),i.GetBounds=n(1205),i.GetPoint=n(445),i.GetPoints=n(446),i.Offset=n(1206),i.OffsetPoint=n(1207),i.Random=n(180),t.exports=i},function(t,e){t.exports=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}},function(t,e,n){var i=n(111);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},function(t,e,n){var i=n(112);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e,n){var i=n(112);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},function(t,e,n){var i=n(10);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.width,e.height=t.height,e}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e,n){var i=n(4),r=n(231);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a,h,u=t.x,c=t.y,l=t.radius,f=e.x,d=e.y,p=e.radius;if(c===d)0==(a=(o=-2*d)*o-4*(s=1)*(f*f+(h=(p*p-l*l-f*f+u*u)/(2*(u-f)))*h-2*f*h+d*d-p*p))?n.push(new i(h,-o/(2*s))):a>0&&(n.push(new i(h,(-o+Math.sqrt(a))/(2*s))),n.push(new i(h,(-o-Math.sqrt(a))/(2*s))));else{var v=(u-f)/(c-d),g=(p*p-l*l-f*f+u*u-d*d+c*c)/(2*(c-d));0==(a=(o=2*c*v-2*g*v-2*u)*o-4*(s=v*v+1)*(u*u+c*c+g*g-l*l-2*c*g))?(h=-o/(2*s),n.push(new i(h,g-h*v))):a>0&&(h=(-o+Math.sqrt(a))/(2*s),n.push(new i(h,g-h*v)),h=(-o-Math.sqrt(a))/(2*s),n.push(new i(h,g-h*v)))}}return n}},function(t,e,n){var i=n(232),r=n(152);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC(),h=e.getLineD();i(s,t,n),i(o,t,n),i(a,t,n),i(h,t,n)}return n}},function(t,e,n){var i=n(141),r=n(487),s=new(n(47));function o(t,e,n,o,a){var h=Math.cos(t),u=Math.sin(t);s.setTo(e,n,e+h,n+u);var c=r(s,o);c&&a.push(new i(c.x,c.y,t,c.w))}function a(t,e){return t.z-e.z}t.exports=function(t,e,n){Array.isArray(n)||(n=[n]);for(var i=[],r=[],s=0;s<n.length;s++)for(var h=n[s].points,u=0;u<h.length;u++){var c=Math.atan2(h[u].y-e,h[u].x-t);-1===r.indexOf(c)&&(o(c,t,e,n,i),o(c-1e-5,t,e,n,i),o(c+1e-5,t,e,n,i),r.push(c))}return i.sort(a)}},function(t,e,n){var i=n(10),r=n(117);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)&&(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y),n}},function(t,e,n){var i=n(234),r=n(117);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC(),h=t.getLineD();i(s,e,n),i(o,e,n),i(a,e,n),i(h,e,n)}return n}},function(t,e,n){var i=n(489),r=n(234);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(s,t,n),r(o,t,n),r(a,t,n)}return n}},function(t,e,n){var i=n(232),r=n(491);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();i(s,e,n),i(o,e,n),i(a,e,n)}return n}},function(t,e,n){var i=n(494),r=n(492);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(t,s,n),r(t,o,n),r(t,a,n)}return n}},function(t,e,n){var i=n(496);t.exports=function(t,e){if(!i(t,e))return!1;var n=Math.min(e.x1,e.x2),r=Math.max(e.x1,e.x2),s=Math.min(e.y1,e.y2),o=Math.max(e.y1,e.y2);return t.x>=n&&t.x<=r&&t.y>=s&&t.y<=o}},function(t,e){t.exports=function(t,e,n,i,r,s){return void 0===s&&(s=0),!(e>t.right+s||n<t.left-s||i>t.bottom+s||r<t.top-s)}},function(t,e,n){var i=n(47);i.Angle=n(97),i.BresenhamPoints=n(317),i.CenterOn=n(1219),i.Clone=n(1220),i.CopyFrom=n(1221),i.Equals=n(1222),i.Extend=n(1223),i.GetEasedPoints=n(1224),i.GetMidPoint=n(1225),i.GetNearestPoint=n(1226),i.GetNormal=n(1227),i.GetPoint=n(307),i.GetPoints=n(172),i.GetShortestDistance=n(1228),i.Height=n(1229),i.Length=n(66),i.NormalAngle=n(497),i.NormalX=n(1230),i.NormalY=n(1231),i.Offset=n(1232),i.PerpSlope=n(1233),i.Random=n(173),i.ReflectAngle=n(1234),i.Rotate=n(1235),i.RotateAroundPoint=n(1236),i.RotateAroundXY=n(236),i.SetToAngle=n(1237),i.Slope=n(1238),i.Width=n(1239),t.exports=i},function(t,e){t.exports=function(t,e,n){var i=e-(t.x1+t.x2)/2,r=n-(t.y1+t.y2)/2;return t.x1+=i,t.y1+=r,t.x2+=i,t.y2+=r,t}},function(t,e,n){var i=n(47);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}},function(t,e){t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}},function(t,e,n){var i=n(66);t.exports=function(t,e,n){void 0===n&&(n=e);var r=i(t),s=t.x2-t.x1,o=t.y2-t.y1;return e&&(t.x1=t.x1-s/r*e,t.y1=t.y1-o/r*e),n&&(t.x2=t.x2+s/r*n,t.y2=t.y2+o/r*n),t}},function(t,e,n){var i=n(352),r=n(81),s=n(4);t.exports=function(t,e,n,o,a){void 0===o&&(o=0),void 0===a&&(a=[]);var h,u,c=[],l=t.x1,f=t.y1,d=t.x2-l,p=t.y2-f,v=r(e,a),g=n-1;for(h=0;h<g;h++)u=v(h/g),c.push(new s(l+d*u,f+p*u));if(u=v(1),c.push(new s(l+d*u,f+p*u)),o>0){var m=c[0],y=[m];for(h=1;h<c.length-1;h++){var x=c[h];i(m,x)>=o&&(y.push(x),m=x)}var b=c[c.length-1];return i(m,b)<o&&y.pop(),y.push(b),y}return c}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2)/2,e.y=(t.y1+t.y2)/2,e}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x1,s=t.y1,o=t.x2,a=t.y2,h=(o-r)*(o-r)+(a-s)*(a-s);if(0===h)return n;var u=((e.x-r)*(o-r)+(e.y-s)*(a-s))/h;return n.x=r+u*(o-r),n.y=s+u*(a-s),n}},function(t,e,n){var i=n(14),r=n(97),s=n(4);t.exports=function(t,e){void 0===e&&(e=new s);var n=r(t)-i.TAU;return e.x=Math.cos(n),e.y=Math.sin(n),e}},function(t,e){t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=(r-n)*(r-n)+(s-i)*(s-i);if(0===o)return!1;var a=((i-e.y)*(r-n)-(n-e.x)*(s-i))/o;return Math.abs(a)*Math.sqrt(o)}},function(t,e){t.exports=function(t){return Math.abs(t.y1-t.y2)}},function(t,e,n){var i=n(14),r=n(97);t.exports=function(t){return Math.cos(r(t)-i.TAU)}},function(t,e,n){var i=n(14),r=n(97);t.exports=function(t){return Math.sin(r(t)-i.TAU)}},function(t,e){t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t}},function(t,e){t.exports=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}},function(t,e,n){var i=n(97),r=n(497);t.exports=function(t,e){return 2*r(e)-Math.PI-i(t)}},function(t,e,n){var i=n(236);t.exports=function(t,e){var n=(t.x1+t.x2)/2,r=(t.y1+t.y2)/2;return i(t,n,r,e)}},function(t,e,n){var i=n(236);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},function(t,e){t.exports=function(t,e,n,i,r){return t.x1=e,t.y1=n,t.x2=e+Math.cos(i)*r,t.y2=n+Math.sin(i)*r,t}},function(t,e){t.exports=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}},function(t,e){t.exports=function(t){return Math.abs(t.x1-t.x2)}},function(t,e,n){var i={Face:n(116),GenerateGridVerts:n(1241),GenerateObjVerts:n(480),GenerateVerts:n(479),ParseObj:n(498),ParseObjMaterial:n(499),RotateFace:n(1242),Vertex:n(118)};t.exports=i},function(t,e,n){var i=n(116),r=n(2),s=n(69),o=n(39),a=n(118),h=new o,u=new o,c=new s;t.exports=function(t){var e=r(t,"mesh"),n=r(t,"texture",null),s=r(t,"frame"),o=r(t,"width",1),l=r(t,"height",o),f=r(t,"widthSegments",1),d=r(t,"heightSegments",f),p=r(t,"x",0),v=r(t,"y",0),g=r(t,"z",0),m=r(t,"rotateX",0),y=r(t,"rotateY",0),x=r(t,"rotateZ",0),b=r(t,"zIsUp",!0),w=r(t,"isOrtho",!!e&&e.dirtyCache[11]),_=r(t,"colors",[16777215]),T=r(t,"alphas",[1]),E=r(t,"tile",!1),S=r(t,"flipY",!1),C=r(t,"width",null),A={faces:[],verts:[]};if(h.set(p,v,g),u.set(m,y,x),c.fromRotationXYTranslation(u,h,b),!n&&e)n=e.texture;else{if(!e||"string"!=typeof n)return A;n=e.scene.sys.textures.get(n)}var I=n.get(s);!C&&w&&n&&e&&(o=I.width/e.height,l=I.height/e.height);var P,R,O=o/2,k=l/2,M=Math.floor(f),D=Math.floor(d),L=M+1,N=D+1,F=o/M,B=l/D,U=[],V=[],Y=0,z=1,X=0,G=1;I&&(Y=I.u0,z=I.u1,S?(X=I.v1,G=I.v0):(X=I.v0,G=I.v1));var j=z-Y,W=G-X;for(R=0;R<N;R++){var H=R*B-k;for(P=0;P<L;P++){var q=P*F-O;V.push(q,-H);var K=Y+j*(P/M),Q=X+W*(R/D);U.push(K,Q)}}Array.isArray(_)||(_=[_]),Array.isArray(T)||(T=[T]);var Z=0,J=0;for(R=0;R<D;R++)for(P=0;P<M;P++){var $=2*(P+L*R),tt=2*(P+L*(R+1)),et=2*(P+1+L*(R+1)),nt=2*(P+1+L*R),it=_[J],rt=T[Z],st=new a(V[$],V[$+1],0,U[$],U[$+1],it,rt).transformMat4(c),ot=new a(V[tt],V[tt+1],0,U[tt],U[tt+1],it,rt).transformMat4(c),at=new a(V[nt],V[nt+1],0,U[nt],U[nt+1],it,rt).transformMat4(c),ht=new a(V[tt],V[tt+1],0,U[tt],U[tt+1],it,rt).transformMat4(c),ut=new a(V[et],V[et+1],0,U[et],U[et+1],it,rt).transformMat4(c),ct=new a(V[nt],V[nt+1],0,U[nt],U[nt+1],it,rt).transformMat4(c);E&&(st.setUVs(Y,G),ot.setUVs(Y,X),at.setUVs(z,G),ht.setUVs(Y,X),ut.setUVs(z,X),ct.setUVs(z,G)),++J===_.length&&(J=0),++Z===T.length&&(Z=0),A.verts.push(st,ot,at,ht,ut,ct),A.faces.push(new i(st,ot,at),new i(ht,ut,ct))}return e&&(e.faces=e.faces.concat(A.faces),e.vertices=e.vertices.concat(A.verts)),A}},function(t,e){t.exports=function(t,e,n,i){var r,s;if(void 0===n&&void 0===i){var o=t.getInCenter();r=o.x,s=o.y}var a=Math.cos(e),h=Math.sin(e),u=t.vertex1,c=t.vertex2,l=t.vertex3,f=u.x-r,d=u.y-s;u.set(f*a-d*h+r,f*h+d*a+s),f=c.x-r,d=c.y-s,c.set(f*a-d*h+r,f*h+d*a+s),f=l.x-r,d=l.y-s,l.set(f*a-d*h+r,f*h+d*a+s)}},function(t,e,n){var i=n(4);i.Ceil=n(1244),i.Clone=n(1245),i.CopyFrom=n(1246),i.Equals=n(1247),i.Floor=n(1248),i.GetCentroid=n(1249),i.GetMagnitude=n(500),i.GetMagnitudeSq=n(501),i.GetRectangleFromPoints=n(1250),i.Interpolate=n(1251),i.Invert=n(1252),i.Negative=n(1253),i.Project=n(1254),i.ProjectUnit=n(1255),i.SetMagnitude=n(1256),t.exports=i},function(t,e){t.exports=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}},function(t,e,n){var i=n(4);t.exports=function(t){return new i(t.x,t.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y}},function(t,e){t.exports=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}},function(t,e,n){var i=n(4);t.exports=function(t,e){if(void 0===e&&(e=new i),!Array.isArray(t))throw new Error("GetCentroid points argument must be an array");var n=t.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)e.x=t[0].x,e.y=t[0].y;else{for(var r=0;r<n;r++)e.x+=t[r].x,e.y+=t[r].y;e.x/=n,e.y/=n}return e}},function(t,e,n){var i=n(10);t.exports=function(t,e){void 0===e&&(e=new i);for(var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=0;a<t.length;a++){var h=t[a];h.x>n&&(n=h.x),h.x<r&&(r=h.x),h.y>s&&(s=h.y),h.y<o&&(o=h.y)}return e.x=r,e.y=o,e.width=n-r,e.height=s-o,e}},function(t,e,n){var i=n(4);t.exports=function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=new i),r.x=t.x+(e.x-t.x)*n,r.y=t.y+(e.y-t.y)*n,r}},function(t,e){t.exports=function(t){return t.setTo(t.y,t.x)}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.setTo(-t.x,-t.y)}},function(t,e,n){var i=n(4),r=n(501);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=(t.x*e.x+t.y*e.y)/r(e);return 0!==s&&(n.x=s*e.x,n.y=s*e.y),n}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x*e.x+t.y*e.y;return 0!==r&&(n.x=r*e.x,n.y=r*e.y),n}},function(t,e,n){var i=n(500);t.exports=function(t,e){if(0!==t.x||0!==t.y){var n=i(t);t.x/=n,t.y/=n}return t.x*=e,t.y*=e,t}},function(t,e,n){var i=n(227);i.Clone=n(1258),i.Contains=n(228),i.ContainsPoint=n(1259),i.Earcut=n(70),i.GetAABB=n(469),i.GetNumberArray=n(1260),i.GetPoints=n(470),i.Perimeter=n(471),i.Reverse=n(1261),i.Simplify=n(1262),i.Smooth=n(472),i.Translate=n(1263),t.exports=i},function(t,e,n){var i=n(227);t.exports=function(t){return new i(t.points)}},function(t,e,n){var i=n(228);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){void 0===e&&(e=[]);for(var n=0;n<t.points.length;n++)e.push(t.points[n].x),e.push(t.points[n].y);return e}},function(t,e){t.exports=function(t){return t.points.reverse(),t}},function(t,e){function n(t,e,n){var i=e.x,r=e.y,s=n.x-i,o=n.y-r;if(0!==s||0!==o){var a=((t.x-i)*s+(t.y-r)*o)/(s*s+o*o);a>1?(i=n.x,r=n.y):a>0&&(i+=s*a,r+=o*a)}return(s=t.x-i)*s+(o=t.y-r)*o}function i(t,e,r,s,o){for(var a,h=s,u=e+1;u<r;u++){var c=n(t[u],t[e],t[r]);c>h&&(a=u,h=c)}h>s&&(a-e>1&&i(t,e,a,s,o),o.push(t[a]),r-a>1&&i(t,a,r,s,o))}function r(t,e){var n=t.length-1,r=[t[0]];return i(t,0,n,e,r),r.push(t[n]),r}t.exports=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);var i=t.points;if(i.length>2){var s=e*e;n||(i=function(t,e){for(var n,i,r,s,o,a=t[0],h=[a],u=1,c=t.length;u<c;u++)r=a,void 0,void 0,(s=(i=n=t[u]).x-r.x)*s+(o=i.y-r.y)*o>e&&(h.push(n),a=n);return a!==n&&h.push(n),h}(i,s)),t.setTo(r(i,s))}return t}},function(t,e){t.exports=function(t,e,n){for(var i=t.points,r=0;r<i.length;r++)i[r].x+=e,i[r].y+=n;return t}},function(t,e){t.exports=function(t){return t.width*t.height}},function(t,e){t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}},function(t,e){t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}},function(t,e,n){var i=n(10);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},function(t,e,n){var i=n(57);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},function(t,e,n){var i=n(237);t.exports=function(t,e){var n=i(t);return n<i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},function(t,e,n){var i=n(237);t.exports=function(t,e){var n=i(t);return n>i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},function(t,e){t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}},function(t,e){t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){return void 0===s&&(s=new i),s.setTo(Math.min(t,n),Math.min(e,r),Math.abs(t-n),Math.abs(e-r))}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.centerX,e.y=t.centerY,e}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.width,e.y=t.height,e}},function(t,e,n){var i=n(190);t.exports=function(t,e,n){var r=t.centerX,s=t.centerY;return t.setSize(t.width+2*e,t.height+2*n),i(t,r,s)}},function(t,e,n){var i=n(10),r=n(117);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)?(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y):n.setEmpty(),n}},function(t,e){t.exports=function(t,e){for(var n=t.x,i=t.right,r=t.y,s=t.bottom,o=0;o<e.length;o++)n=Math.min(n,e[o].x),i=Math.max(i,e[o].x),r=Math.min(r,e[o].y),s=Math.max(s,e[o].y);return t.x=n,t.y=r,t.width=i-n,t.height=s-r,t}},function(t,e){t.exports=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.right,e.right);t.x=n,t.width=i-n;var r=Math.min(t.y,e.y),s=Math.max(t.bottom,e.bottom);return t.y=r,t.height=s-r,t}},function(t,e){t.exports=function(t,e,n){var i=Math.min(t.x,e),r=Math.max(t.right,e);t.x=i,t.width=r-i;var s=Math.min(t.y,n),o=Math.max(t.bottom,n);return t.y=s,t.height=o-s,t}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e){t.exports=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}},function(t,e,n){var i=n(4),r=n(36);t.exports=function(t,e,n){void 0===n&&(n=new i),e=r(e);var s=Math.sin(e),o=Math.cos(e),a=o>0?t.width/2:t.width/-2,h=s>0?t.height/2:t.height/-2;return Math.abs(a*s)<Math.abs(h*o)?h=a*s/o:a=h*o/s,n.x=a+t.centerX,n.y=h+t.centerY,n}},function(t,e,n){var i=n(195),r=n(503),s=n(4);t.exports=function(t,e,n){if(void 0===n&&(n=new s),r(t,e))switch(i(0,3)){case 0:n.x=t.x+Math.random()*(e.right-t.x),n.y=t.y+Math.random()*(e.top-t.y);break;case 1:n.x=e.x+Math.random()*(t.right-e.x),n.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:n.x=t.x+Math.random()*(e.x-t.x),n.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:n.x=e.right+Math.random()*(t.right-e.right),n.y=t.y+Math.random()*(e.bottom-t.y)}return n}},function(t,e){t.exports=function(t,e){return t.width===e.width&&t.height===e.height}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=e),t.width*=e,t.height*=n,t}},function(t,e,n){var i=n(83);i.Area=n(1291),i.BuildEquilateral=n(1292),i.BuildFromPolygon=n(1293),i.BuildRight=n(1294),i.CenterOn=n(1295),i.Centroid=n(504),i.CircumCenter=n(1296),i.CircumCircle=n(1297),i.Clone=n(1298),i.Contains=n(115),i.ContainsArray=n(235),i.ContainsPoint=n(1299),i.CopyFrom=n(1300),i.Decompose=n(495),i.Equals=n(1301),i.GetPoint=n(476),i.GetPoints=n(477),i.InCenter=n(506),i.Perimeter=n(1302),i.Offset=n(505),i.Random=n(181),i.Rotate=n(1303),i.RotateAroundPoint=n(1304),i.RotateAroundXY=n(238),t.exports=i},function(t,e){t.exports=function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,s=t.x3,o=t.y3;return Math.abs(((s-e)*(r-n)-(i-e)*(o-n))/2)}},function(t,e,n){var i=n(83);t.exports=function(t,e,n){var r=n*(Math.sqrt(3)/2);return new i(t,e,t+n/2,e+r,t-n/2,e+r)}},function(t,e,n){var i=n(70),r=n(83);t.exports=function(t,e,n,s,o){void 0===e&&(e=null),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o=[]);for(var a,h,u,c,l,f,d,p,v,g=i(t,e),m=0;m<g.length;m+=3)a=g[m],h=g[m+1],u=g[m+2],c=t[2*a]*n,l=t[2*a+1]*s,f=t[2*h]*n,d=t[2*h+1]*s,p=t[2*u]*n,v=t[2*u+1]*s,o.push(new r(c,l,f,d,p,v));return o}},function(t,e,n){var i=n(83);t.exports=function(t,e,n,r){return void 0===r&&(r=n),new i(t,e,t,e-r,t+n,e)}},function(t,e,n){var i=n(504),r=n(505);t.exports=function(t,e,n,s){void 0===s&&(s=i);var o=s(t),a=e-o.x,h=n-o.y;return r(t,a,h)}},function(t,e,n){var i=n(3);function r(t,e,n,i){return t*i-e*n}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x3,s=t.y3,o=t.x1-n,a=t.y1-s,h=t.x2-n,u=t.y2-s,c=2*r(o,a,h,u),l=r(a,o*o+a*a,u,h*h+u*u),f=r(o,o*o+a*a,h,h*h+u*u);return e.x=n-l/c,e.y=s+f/c,e}},function(t,e,n){var i=n(64);t.exports=function(t,e){void 0===e&&(e=new i);var n,r,s=t.x1,o=t.y1,a=t.x2,h=t.y2,u=t.x3,c=t.y3,l=a-s,f=h-o,d=u-s,p=c-o,v=l*(s+a)+f*(o+h),g=d*(s+u)+p*(o+c),m=2*(l*(c-h)-f*(u-a));if(Math.abs(m)<1e-6){var y=Math.min(s,a,u),x=Math.min(o,h,c);n=.5*(Math.max(s,a,u)-y),r=.5*(Math.max(o,h,c)-x),e.x=y+n,e.y=x+r,e.radius=Math.sqrt(n*n+r*r)}else e.x=(p*v-f*g)/m,e.y=(l*g-d*v)/m,n=e.x-s,r=e.y-o,e.radius=Math.sqrt(n*n+r*r);return e}},function(t,e,n){var i=n(83);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},function(t,e,n){var i=n(115);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},function(t,e){t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}},function(t,e,n){var i=n(66);t.exports=function(t){var e=t.getLineA(),n=t.getLineB(),r=t.getLineC();return i(e)+i(n)+i(r)}},function(t,e,n){var i=n(238),r=n(506);t.exports=function(t,e){var n=r(t);return i(t,n.x,n.y,e)}},function(t,e,n){var i=n(238);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},function(t,e,n){var i=n(203),r=n(17),s={CreatePixelPerfectHandler:n(507),CreateInteractiveObject:n(508),Events:n(51),Gamepad:n(1306),InputManager:n(409),InputPlugin:n(1318),InputPluginCache:n(153),Keyboard:n(1319),Mouse:n(1333),Pointer:n(412),Touch:n(1334)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={Axis:n(509),Button:n(510),Events:n(239),Gamepad:n(511),GamepadPlugin:n(1313),Configs:n(1314)}},function(t,e){t.exports="down"},function(t,e){t.exports="up"},function(t,e){t.exports="connected"},function(t,e){t.exports="disconnected"},function(t,e){t.exports="down"},function(t,e){t.exports="up"},function(t,e,n){var i=n(0),r=n(9),s=n(239),o=n(511),a=n(6),h=n(153),u=n(51),c=new i({Extends:r,initialize:function(t){r.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,t.pluginEvents.once(u.BOOT,this.boot,this),t.pluginEvents.on(u.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,n=t.config;this.enabled=a(e,"gamepad",n.inputGamepad)&&t.device.input.gamepads,this.target=a(e,"gamepad.target",n.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(u.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(u.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,n=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=n,e.addEventListener("gamepadconnected",n,!1),e.addEventListener("gamepaddisconnected",n,!1),this.sceneInputPlugin.pluginEvents.on(u.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(u.UPDATE,this.update);for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].removeAllListeners()},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].pad.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,n=0;n<t.length;n++){var i=t[n];if(i){var r=i.id,s=i.index,a=e[s];if(a)a.id!==r?(a.destroy(),e[s]=new o(this,i)):a.update(i);else{var h=new o(this,i);e[s]=h,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=h):this._pad3=h:this._pad2=h:this._pad1=h}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},getPad:function(t){for(var e=this.gamepads,n=0;n<e.length;n++)if(e[n]&&e[n].index===t)return e[n]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var i=e[n],r=this.getPad(i.gamepad.index);"gamepadconnected"===i.type?this.emit(s.CONNECTED,r,i):"gamepaddisconnected"===i.type&&this.emit(s.DISCONNECTED,r,i)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});h.register("GamepadPlugin",c,"gamepad","gamepad","inputGamepad"),t.exports=c},function(t,e,n){t.exports={DUALSHOCK_4:n(1315),SNES_USB:n(1316),XBOX_360:n(1317)}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},function(t,e,n){var i=n(64),r=n(65),s=n(0),o=n(203),a=n(508),h=n(507),u=n(50),c=n(111),l=n(112),f=n(51),d=n(9),p=n(2),v=n(56),g=n(153),m=n(7),y=n(24),x=n(10),b=n(57),w=n(20),_=n(83),T=n(115),E=new s({Extends:d,initialize:function(t){d.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new d,this.enabled=!0,this.displayList,this.cameras,g.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(w.BOOT,this.boot,this),t.sys.events.on(w.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(w.DESTROY,this.destroy,this),this.pluginEvents.emit(f.BOOT)},start:function(){var t=this.systems.events;t.on(w.TRANSITION_START,this.transitionIn,this),t.on(w.TRANSITION_OUT,this.transitionOut,this),t.on(w.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(w.PRE_UPDATE,this.preUpdate,this),t.once(w.SHUTDOWN,this.shutdown,this),this.manager.events.on(f.GAME_OUT,this.onGameOut,this),this.manager.events.on(f.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(f.START)},onGameOver:function(t){this.isActive()&&this.emit(f.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(f.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(f.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,n=t.length,i=e.length;if(0!==n||0!==i){for(var r=this._list,s=0;s<n;s++){var o=t[s],a=r.indexOf(o);a>-1&&(r.splice(a,1),this.clear(o,!0))}t.length=0,this._pendingRemoval.length=0,this._list=r.concat(e.splice(0))}},isActive:function(){return this.enabled&&this.scene.sys.isActive()},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(f.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var n,i=this.manager,r=i.pointers,s=i.pointersTotal;for(n=0;n<s;n++)r[n].updateMotion();if(0===this._list.length)return!1;var o=this.pollRate;if(-1===o)return!1;if(o>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var a=!1;for(n=0;n<s;n++){var h=0,u=r[n];this._tempZones=[],this._temp=this.hitTestPointer(u),this.sortGameObjects(this._temp,u),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),h+=this.processOverOutEvents(u),2===this.getDragState(u)&&this.processDragThresholdEvent(u,t),h>0&&(a=!0)}return a},update:function(t,e){if(!this.isActive())return!1;for(var n=e.length,i=!1,r=0;r<n;r++){var s=0,a=e[r];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp,a),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case o.MOUSE_DOWN:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_UP:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOverOutEvents(a);break;case o.TOUCH_START:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverEvents(a);break;case o.TOUCH_END:case o.TOUCH_CANCEL:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOutEvents(a);break;case o.MOUSE_MOVE:case o.TOUCH_MOVE:s+=this.processDragMoveEvent(a),s+=this.processMoveEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_WHEEL:s+=this.processWheelEvent(a)}s>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1);var n=t.input;if(n){e||this.queueForRemoval(t),n.gameObject=void 0,n.target=void 0,n.hitArea=void 0,n.hitAreaCallback=void 0,n.callbackContext=void 0,t.input=null;var i=this._draggable.indexOf(t);return i>-1&&this._draggable.splice(i,1),(i=this._drag[0].indexOf(t))>-1&&this._drag[0].splice(i,1),(i=this._over[0].indexOf(t))>-1&&(this._over[0].splice(i,1),this.manager.resetCursor(n)),t}},disable:function(t){t.input.enabled=!1},enable:function(t,e,n,i){return void 0===i&&(i=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,n),t.input&&i&&!t.input.dropZone&&(t.input.dropZone=i),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),n=0;n<e.length;n++){for(var i=e[n],r=this.manager.hitTest(t,this._list,i),s=0;s<r.length;s++){var o=r[s];o.input.dropZone&&this._tempZones.push(o)}if(r.length>0)return t.camera=i,r}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input){if(e++,a.emit(f.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input){s=!0;break}if(this.emit(f.GAMEOBJECT_DOWN,t,a,r),i.cancelled||!a.input){s=!0;break}}}return!s&&this.manager&&(t.downElement===this.manager.game.canvas?this.emit(f.POINTER_DOWN,t,n):this.emit(f.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var n=!1,i=this.dragTimeThreshold,r=this.dragDistanceThreshold;if((r>0&&u(t.x,t.y,t.downX,t.downY)>=r||i>0&&e>=t.downTime+i)&&(n=!0),n)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;r.dragState=2,r.dragStartX=i.x,r.dragStartY=i.y,r.dragStartXGlobal=t.worldX,r.dragStartYGlobal=t.worldY,r.dragX=r.dragStartXGlobal-r.dragStartX,r.dragY=r.dragStartYGlobal-r.dragStartY,i.emit(f.GAMEOBJECT_DRAG_START,t,r.dragX,r.dragY),this.emit(f.DRAG_START,t,i)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var n=[],i=0;i<e.length;i++){var r=e[i];r.input.draggable&&0===r.input.dragState&&n.push(r)}return 0===n.length?(this.setDragState(t,0),0):(n.length>1&&(this.sortGameObjects(n,t),this.topOnly&&n.splice(1)),this._drag[t.id]=n,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(2===this.getDragState(t)&&this.processDragThresholdEvent(t,this.manager.game.loop.now),4!==this.getDragState(t))return 0;for(var e=this._tempZones,n=this._drag[t.id],i=0;i<n.length;i++){var r,s,o=n[i],a=o.input,h=a.target;if(h){var u=e.indexOf(h);0===u?(o.emit(f.GAMEOBJECT_DRAG_OVER,t,h),this.emit(f.DRAG_OVER,t,o,h)):u>0?(o.emit(f.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(f.DRAG_LEAVE,t,o,h),a.target=e[0],h=a.target,o.emit(f.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(f.DRAG_ENTER,t,o,h)):(o.emit(f.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(f.DRAG_LEAVE,t,o,h),e[0]?(a.target=e[0],h=a.target,o.emit(f.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(f.DRAG_ENTER,t,o,h)):a.target=null)}else!h&&e[0]&&(a.target=e[0],h=a.target,o.emit(f.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(f.DRAG_ENTER,t,o,h));if(o.parentContainer){var c=t.worldX-a.dragStartXGlobal,l=t.worldY-a.dragStartYGlobal,d=o.getParentRotation(),p=c*Math.cos(d)+l*Math.sin(d),v=l*Math.cos(d)-c*Math.sin(d);p*=1/o.parentContainer.scaleX,v*=1/o.parentContainer.scaleY,r=p+a.dragStartX,s=v+a.dragStartY}else r=t.worldX-a.dragX,s=t.worldY-a.dragY;o.emit(f.GAMEOBJECT_DRAG,t,r,s),this.emit(f.DRAG,t,o,r,s)}return n.length},processDragUpEvent:function(t){for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;if(r&&2===r.dragState){r.dragState=0,r.dragX=r.localX-i.displayOriginX,r.dragY=r.localY-i.displayOriginY;var s=!1,o=r.target;o&&(i.emit(f.GAMEOBJECT_DROP,t,o),this.emit(f.DROP,t,i,o),r.target=null,s=!0),i.input&&(i.emit(f.GAMEOBJECT_DRAG_END,t,r.dragX,r.dragY,s),this.emit(f.DRAG_END,t,i,s))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input){if(e++,a.emit(f.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input){s=!0;break}if(this.emit(f.GAMEOBJECT_MOVE,t,a,r),i.cancelled||!a.input){s=!0;break}if(this.topOnly)break}}return s||this.emit(f.POINTER_MOVE,t,n),e},processWheelEvent:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=t.deltaX,a=t.deltaY,h=t.deltaZ,u=0;u<n.length;u++){var c=n[u];if(c.input){if(e++,c.emit(f.GAMEOBJECT_POINTER_WHEEL,t,o,a,h,r),i.cancelled||!c.input){s=!0;break}if(this.emit(f.GAMEOBJECT_WHEEL,t,c,o,a,h,r),i.cancelled||!c.input){s=!0;break}}}return s||this.emit(f.POINTER_WHEEL,t,n,o,a,h),e},processOverEvents:function(t){var e=this._temp,n=0,i=e.length,r=[];if(i>0){var s=this.manager,o=this._eventData,a=this._eventContainer;o.cancelled=!1;for(var h=!1,u=0;u<i;u++){var c=e[u];if(c.input){if(r.push(c),s.setCursor(c.input),c.emit(f.GAMEOBJECT_POINTER_OVER,t,c.input.localX,c.input.localY,a),n++,o.cancelled||!c.input){h=!0;break}if(this.emit(f.GAMEOBJECT_OVER,t,c,a),o.cancelled||!c.input){h=!0;break}}}h||this.emit(f.POINTER_OVER,t,r)}return this._over[t.id]=r,n},processOutEvents:function(t){var e=this._over[t.id],n=0,i=e.length;if(i>0){var r=this.manager,s=this._eventData,o=this._eventContainer;s.cancelled=!1;var a=!1;this.sortGameObjects(e,t);for(var h=0;h<i;h++){var u=e[h];if((u=e[h]).input){if(r.resetCursor(u.input),u.emit(f.GAMEOBJECT_POINTER_OUT,t,o),n++,s.cancelled||!u.input){a=!0;break}if(this.emit(f.GAMEOBJECT_OUT,t,u,o),s.cancelled||!u.input){a=!0;break}a||this.emit(f.POINTER_OUT,t,e)}}this._over[t.id]=[]}return n},processOverOutEvents:function(t){var e,n,i=this._temp,r=[],s=[],o=[],a=this._over[t.id],h=this._drag[t.id],u=this.manager;for(e=0;e<a.length;e++)n=a[e],-1===i.indexOf(n)&&-1===h.indexOf(n)?r.push(n):o.push(n);for(e=0;e<i.length;e++)n=i[e],-1===a.indexOf(n)&&s.push(n);var c=r.length,l=0,d=this._eventData,p=this._eventContainer;d.cancelled=!1;var v=!1;if(c>0){for(this.sortGameObjects(r,t),e=0;e<c;e++)if((n=r[e]).input){if(u.resetCursor(n.input),n.emit(f.GAMEOBJECT_POINTER_OUT,t,p),l++,d.cancelled||!n.input){v=!0;break}if(this.emit(f.GAMEOBJECT_OUT,t,n,p),d.cancelled||!n.input){v=!0;break}}v||this.emit(f.POINTER_OUT,t,r)}if(c=s.length,d.cancelled=!1,v=!1,c>0){for(this.sortGameObjects(s,t),e=0;e<c;e++)if((n=s[e]).input){if(u.setCursor(n.input),n.emit(f.GAMEOBJECT_POINTER_OVER,t,n.input.localX,n.input.localY,p),l++,d.cancelled||!n.input){v=!0;break}if(this.emit(f.GAMEOBJECT_OVER,t,n,p),d.cancelled||!n.input){v=!0;break}}v||this.emit(f.POINTER_OVER,t,s)}return a=o.concat(s),this._over[t.id]=this.sortGameObjects(a,t),l},processUpEvents:function(t){var e=this._temp,n=this._eventData,i=this._eventContainer;n.cancelled=!1;for(var r=!1,s=0;s<e.length;s++){var o=e[s];if(o.input){if(o.emit(f.GAMEOBJECT_POINTER_UP,t,o.input.localX,o.input.localY,i),n.cancelled||!o.input){r=!0;break}if(this.emit(f.GAMEOBJECT_UP,t,o,i),n.cancelled||!o.input){r=!0;break}}}return!r&&this.manager&&(t.upElement===this.manager.game.canvas?this.emit(f.POINTER_UP,t,e):this.emit(f.POINTER_UP_OUTSIDE,t)),e.length},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];i.input.draggable=e;var r=this._draggable.indexOf(i);e&&-1===r?this._draggable.push(i):!e&&r>-1&&this._draggable.splice(r,1)}return this},makePixelPerfect:function(t){void 0===t&&(t=1);var e=this.systems.textures;return h(e,t)},setHitArea:function(t,e,n){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var i=!1,r=!1,s=!1,o=!1,h=!1,u=!0;if(m(e)){var c=e;e=p(c,"hitArea",null),n=p(c,"hitAreaCallback",null),i=p(c,"draggable",!1),r=p(c,"dropZone",!1),s=p(c,"cursor",!1),o=p(c,"useHandCursor",!1),h=p(c,"pixelPerfect",!1);var l=p(c,"alphaTolerance",1);h&&(e={},n=this.makePixelPerfect(l)),e&&n||(this.setHitAreaFromTexture(t),u=!1)}else"function"!=typeof e||n||(n=e,e={});for(var f=0;f<t.length;f++){var d=t[f];if(h&&"Container"===d.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var v=d.input?d.input:a(d,e,n);v.customHitArea=u,v.dropZone=r,v.cursor=o?"pointer":s,d.input=v,i&&this.setDraggable(d),this.queueForInsertion(d)}}return this},setHitAreaCircle:function(t,e,n,s,o){void 0===o&&(o=r);var a=new i(e,n,s);return this.setHitArea(t,a,o)},setHitAreaEllipse:function(t,e,n,i,r,s){void 0===s&&(s=l);var o=new c(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=b),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n],r=i.frame,s=0,o=0;i.width?(s=i.width,o=i.height):r&&(s=r.realWidth,o=r.realHeight),"Container"!==i.type||0!==s&&0!==o?0!==s&&0!==o&&(i.input=a(i,new x(0,0,s,o),e),this.queueForInsertion(i)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,n,i,r,s){void 0===s&&(s=b);var o=new x(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaTriangle:function(t,e,n,i,r,s,o,a){void 0===a&&(a=T);var h=new _(e,n,i,r,s,o);return this.setHitArea(t,h,a)},enableDebug:function(t,e){void 0===e&&(e=65280);var n=t.input;if(!n||!n.hitArea)return this;var i=n.hitArea,r=i.type,s=n.hitAreaDebug,o=this.systems.add,a=this.systems.updateList;s&&(a.remove(s),s.destroy(),s=null);var h=0,u=0;switch(r){case v.CIRCLE:s=o.arc(0,0,i.radius),h=i.x-i.radius,u=i.y-i.radius;break;case v.ELLIPSE:s=o.ellipse(0,0,i.width,i.height),h=i.x-i.width/2,u=i.y-i.height/2;break;case v.LINE:s=o.line(0,0,i.x1,i.y1,i.x2,i.y2);break;case v.POLYGON:s=o.polygon(0,0,i.points);break;case v.RECTANGLE:s=o.rectangle(0,0,i.width,i.height),h=i.x,u=i.y;break;case v.TRIANGLE:s=o.triangle(0,0,i.x1,i.y1,i.x2,i.y2,i.x3,i.y3)}return s&&(s.isFilled=!1,s.preUpdate=function(){s.setStrokeStyle(1/t.scale,e),s.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var n=t.x,i=t.y,r=t.rotation,o=t.scaleX,a=t.scaleY;if(t.parentContainer){var c=t.getWorldTransformMatrix();n=c.tx,i=c.ty,r=c.rotation,o=c.scaleX,a=c.scaleY}s.setRotation(r),s.setScale(o,a),s.setPosition(n+h,i+u),s.setScrollFactor(t.scrollFactorX,t.scrollFactorY),s.setDepth(t.depth)},a.add(s),n.hitAreaDebug=s),this},removeDebug:function(t){var e=t.input;if(e&&e.hitAreaDebug){var n=e.hitAreaDebug;this.systems.updateList.remove(n),n.destroy(),e.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2)return t;var n=e.camera.renderList;return t.sort((function(t,e){return n.indexOf(e)-n.indexOf(t)}))},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(t.parentContainer||e.parentContainer){if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var n=t.getIndexList(),i=e.getIndexList(),r=Math.min(n.length,i.length),s=0;s<r;s++){var o=n[s],a=i[s];if(o!==a)return a-o}return i.length-n.length}return this.displayList.getIndex(e)-this.displayList.getIndex(t)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(f.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var n=this.systems.events;n.off(w.TRANSITION_START,this.transitionIn,this),n.off(w.TRANSITION_OUT,this.transitionOut,this),n.off(w.TRANSITION_COMPLETE,this.transitionComplete,this),n.off(w.PRE_UPDATE,this.preUpdate,this),e.events.off(f.GAME_OUT,this.onGameOut,this),e.events.off(f.GAME_OVER,this.onGameOver,this),n.off(w.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.pluginEvents.emit(f.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(w.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});y.register("InputPlugin",E,"input"),t.exports=E},function(t,e,n){t.exports={Events:n(154),KeyboardManager:n(410),KeyboardPlugin:n(1327),Key:n(512),KeyCodes:n(144),KeyCombo:n(513),AdvanceKeyCombo:n(515),ProcessKeyCombo:n(514),ResetKeyCombo:n(516),JustDown:n(1329),JustUp:n(1330),DownDuration:n(1331),UpDuration:n(1332)}},function(t,e){t.exports="keydown"},function(t,e){t.exports="keyup"},function(t,e){t.exports="keycombomatch"},function(t,e){t.exports="down"},function(t,e){t.exports="keydown-"},function(t,e){t.exports="keyup-"},function(t,e){t.exports="up"},function(t,e,n){var i=n(0),r=n(9),s=n(154),o=n(22),a=n(6),h=n(51),u=n(153),c=n(512),l=n(144),f=n(513),d=n(1328),p=n(20),v=n(77),g=new i({Extends:r,initialize:function(t){r.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,t.pluginEvents.once(h.BOOT,this.boot,this),t.pluginEvents.on(h.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=a(t,"keyboard",!0);var e=a(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(h.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(h.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(h.SHUTDOWN,this.shutdown,this),this.game.events.on(o.BLUR,this.resetKeys,this),this.scene.sys.events.on(p.PAUSE,this.resetKeys,this),this.scene.sys.events.on(p.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:l.UP,down:l.DOWN,left:l.LEFT,right:l.RIGHT,space:l.SPACE,shift:l.SHIFT})},addKeys:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i={};if("string"==typeof t){t=t.split(",");for(var r=0;r<t.length;r++){var s=t[r].trim();s&&(i[s]=this.addKey(s,e,n))}}else for(var o in t)i[o]=this.addKey(t[o],e,n);return i},addKey:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i=this.keys;if(t instanceof c){var r=i.indexOf(t);return r>-1?i[r]=t:i[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(n),t}return"string"==typeof t&&(t=l[t.toUpperCase()]),i[t]||(i[t]=new c(this,t),e&&this.addCapture(t),i[t].setEmitOnRepeat(n)),i[t]},removeKey:function(t,e){void 0===e&&(e=!1);var n,i=this.keys;if(t instanceof c){var r=i.indexOf(t);r>-1&&(n=this.keys[r],this.keys[r]=void 0)}else"string"==typeof t&&(t=l[t.toUpperCase()]);return i[t]&&(n=i[t],i[t]=void 0),n&&(n.plugin=null,e&&n.destroy()),this},removeAllKeys:function(t){for(var e=this.keys,n=0;n<e.length;n++){var i=e[n];i&&(e[n]=void 0,t&&i.destroy())}return this},createCombo:function(t,e){return new f(this,t,e)},checkDown:function(t,e){if(void 0===e&&(e=0),this.enabled&&t.isDown){var n=v(this.time-t.timeDown,e);if(n>t._tick)return t._tick=n,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,i=0;i<e;i++){var r=t[i],o=r.keyCode,a=n[o],h=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&(o===this.prevCode&&r.timeStamp===this.prevTime&&r.type===this.prevType||(this.prevCode=o,this.prevTime=r.timeStamp,this.prevType=r.type,"keydown"===r.type?(a&&(h=a.isDown,a.onDown(r)),r.cancelled||a&&h||(d[o]&&this.emit(s.KEY_DOWN+d[o],r),r.cancelled||this.emit(s.ANY_KEY_DOWN,r))):(a&&a.onUp(r),r.cancelled||(d[o]&&this.emit(s.KEY_UP+d[o],r),r.cancelled||this.emit(s.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0)))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.resetKeys(),this.sceneInputPlugin.manager.events.off(h.MANAGER_PROCESS,this.update,this),this.game.events.off(o.BLUR,this.resetKeys),this.scene.sys.events.off(p.PAUSE,this.resetKeys,this),this.scene.sys.events.off(p.SLEEP,this.resetKeys,this),this.removeAllListeners(),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});u.register("KeyboardPlugin",g,"keyboard","keyboard","inputKeyboard"),t.exports=g},function(t,e,n){var i=n(144),r={};for(var s in i)r[i[s]]=s;t.exports=r},function(t,e){t.exports=function(t){return!!t._justDown&&(t._justDown=!1,!0)}},function(t,e){t.exports=function(t){return!!t._justUp&&(t._justUp=!1,!0)}},function(t,e){t.exports=function(t,e){void 0===e&&(e=50);var n=t.plugin.game.loop.time-t.timeDown;return t.isDown&&n<e}},function(t,e){t.exports=function(t,e){void 0===e&&(e=50);var n=t.plugin.game.loop.time-t.timeUp;return t.isUp&&n<e}},function(t,e,n){t.exports={MouseManager:n(411)}},function(t,e,n){t.exports={TouchManager:n(413)}},function(t,e,n){var i=n(21),r=n(17),s={Events:n(95),FileTypes:n(1336),File:n(23),FileTypesManager:n(8),GetURL:n(155),LoaderPlugin:n(1362),MergeXHRSettings:n(240),MultiFile:n(49),XHRLoader:n(517),XHRSettings:n(156)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={AnimationJSONFile:n(1337),AsepriteFile:n(1338),AtlasJSONFile:n(1339),AtlasXMLFile:n(1340),AudioFile:n(518),AudioSpriteFile:n(1341),BinaryFile:n(1342),BitmapFontFile:n(1343),CSSFile:n(1344),GLSLFile:n(1345),HTML5AudioFile:n(519),HTMLFile:n(1346),HTMLTextureFile:n(1347),ImageFile:n(72),JSONFile:n(60),MultiAtlasFile:n(1348),MultiScriptFile:n(1349),OBJFile:n(1350),PackFile:n(1351),PluginFile:n(1352),SceneFile:n(1353),ScenePluginFile:n(1354),ScriptFile:n(520),SpriteSheetFile:n(1355),SVGFile:n(1356),TextFile:n(242),TilemapCSVFile:n(1357),TilemapImpactFile:n(1358),TilemapJSONFile:n(1359),UnityAtlasFile:n(1360),VideoFile:n(1361),XMLFile:n(241)}},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(95),a=new i({Extends:s,initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.type="animationJSON"},onProcess:function(){this.loader.once(o.POST_PROCESS,this.onLoadComplete,this),s.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});r.register("animation",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this})),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(60),u=n(49),c=new i({Extends:u,initialize:function(t,e,n,i,r,c){var l,f;if(a(e)){var d=e;e=s(d,"key"),l=new o(t,{key:e,url:s(d,"textureURL"),extension:s(d,"textureExtension","png"),normalMap:s(d,"normalMap"),xhrSettings:s(d,"textureXhrSettings")}),f=new h(t,{key:e,url:s(d,"atlasURL"),extension:s(d,"atlasExtension","json"),xhrSettings:s(d,"atlasXhrSettings")})}else l=new o(t,e,n,r),f=new h(t,e,i,c);l.linkFile?u.call(this,t,"atlasjson",e,[l,f,l.linkFile]):u.call(this,t,"atlasjson",e,[l,f])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,n),e.addToCache(),this.complete=!0}}});r.register("aseprite",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(60),u=n(49),c=new i({Extends:u,initialize:function(t,e,n,i,r,c){var l,f;if(a(e)){var d=e;e=s(d,"key"),l=new o(t,{key:e,url:s(d,"textureURL"),extension:s(d,"textureExtension","png"),normalMap:s(d,"normalMap"),xhrSettings:s(d,"textureXhrSettings")}),f=new h(t,{key:e,url:s(d,"atlasURL"),extension:s(d,"atlasExtension","json"),xhrSettings:s(d,"atlasXhrSettings")})}else l=new o(t,e,n,r),f=new h(t,e,i,c);l.linkFile?u.call(this,t,"atlasjson",e,[l,f,l.linkFile]):u.call(this,t,"atlasjson",e,[l,f])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,n),e.pendingDestroy(),this.complete=!0}}});r.register("atlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(49),u=n(241),c=new i({Extends:h,initialize:function(t,e,n,i,r,c){var l,f;if(a(e)){var d=e;e=s(d,"key"),l=new o(t,{key:e,url:s(d,"textureURL"),extension:s(d,"textureExtension","png"),normalMap:s(d,"normalMap"),xhrSettings:s(d,"textureXhrSettings")}),f=new u(t,{key:e,url:s(d,"atlasURL"),extension:s(d,"atlasExtension","xml"),xhrSettings:s(d,"atlasXhrSettings")})}else l=new o(t,e,n,r),f=new u(t,e,i,c);l.linkFile?h.call(this,t,"atlasxml",e,[l,f,l.linkFile]):h.call(this,t,"atlasxml",e,[l,f])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,n),e.pendingDestroy(),this.complete=!0}}});r.register("atlasXML",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=c},function(t,e,n){var i=n(518),r=n(0),s=n(8),o=n(2),a=n(7),h=n(60),u=n(49),c=new r({Extends:u,initialize:function(t,e,n,r,s,c,l){if(a(e)){var f=e;e=o(f,"key"),n=o(f,"jsonURL"),r=o(f,"audioURL"),s=o(f,"audioConfig"),c=o(f,"audioXhrSettings"),l=o(f,"jsonXhrSettings")}var d;if(r){var p=i.create(t,e,r,s,c);p&&(d=new h(t,e,n,l),u.call(this,t,"audiosprite",e,[p,d]),this.config.resourceLoad=!1)}else d=new h(t,e,n,l),u.call(this,t,"audiosprite",e,[d]),this.config.resourceLoad=!0,this.config.audioConfig=s,this.config.audioXhrSettings=c},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,this.config.resourceLoad&&"json"===t.type&&t.data.hasOwnProperty("resources"))){var e=t.data.resources,n=o(this.config,"audioConfig"),r=o(this.config,"audioXhrSettings"),s=i.create(this.loader,t.key,e,n,r);s&&(this.addToMultiFile(s),this.loader.addFile(s))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.complete=!0}}});s.register("audioSprite",(function(t,e,n,i,r,s){var o,a=this.systems.game,h=a.config.audio,u=a.device.audio;if(h&&h.noAudio||!u.webAudio&&!u.audioData)return this;if(Array.isArray(t))for(var l=0;l<t.length;l++)(o=new c(this,t[l])).files&&this.addFile(o.files);else(o=new c(this,t,e,n,i,r,s)).files&&this.addFile(o.files);return this}))},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i,r){var o="bin";if(h(e)){var u=e;e=a(u,"key"),n=a(u,"url"),i=a(u,"xhrSettings"),o=a(u,"extension",o),r=a(u,"dataType",r)}var c={type:"binary",cache:t.cacheManager.binary,extension:o,responseType:"arraybuffer",key:e,url:n,xhrSettings:i,config:{dataType:r}};s.call(this,t,c)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});o.register("binary",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new u(this,t[r]));else this.addFile(new u(this,t,e,i,n));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(49),u=n(212),c=n(241),l=new i({Extends:h,initialize:function(t,e,n,i,r,u){var l,f;if(a(e)){var d=e;e=s(d,"key"),l=new o(t,{key:e,url:s(d,"textureURL"),extension:s(d,"textureExtension","png"),normalMap:s(d,"normalMap"),xhrSettings:s(d,"textureXhrSettings")}),f=new c(t,{key:e,url:s(d,"fontDataURL"),extension:s(d,"fontDataExtension","xml"),xhrSettings:s(d,"fontDataXhrSettings")})}else l=new o(t,e,n,r),f=new c(t,e,i,u);l.linkFile?h.call(this,t,"bitmapfont",e,[l,f,l.linkFile]):h.call(this,t,"bitmapfont",e,[l,f])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.pendingDestroy();var n=t.cache.get(t.key),i=u(e.data,t.cache.getFrame(t.key),0,0,n);this.loader.cacheManager.bitmapFont.add(t.key,{data:i,texture:t.key,frame:null}),this.complete=!0}}});r.register("bitmapFont",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new l(this,t[o]),this.addFile(s.files);else s=new l(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=l},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){var r="css";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"script",cache:!1,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("css",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=n(396),c=new i({Extends:s,initialize:function(t,e,n,i,r){var o="glsl";if(h(e)){var u=e;e=a(u,"key"),n=a(u,"url"),i=a(u,"shaderType","fragment"),r=a(u,"xhrSettings"),o=a(u,"extension",o)}else void 0===i&&(i="fragment");var c={type:"glsl",cache:t.cacheManager.shader,extension:o,responseType:"text",key:e,url:n,config:{shaderType:i},xhrSettings:r};s.call(this,t,c)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var n=this.getShaderName(e.header),i=this.getShaderType(e.header),r=this.getShaderUniforms(e.header),s=e.shader;if(this.cache.has(n)){var o=this.cache.get(n);"fragment"===i?o.fragmentSrc=s:o.vertexSrc=s,o.uniforms||(o.uniforms=r)}else"fragment"===i?this.cache.add(n,new u(n,s,"",r)):this.cache.add(n,new u(n,"",s,r));e=this.extractBlock(t,e.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new u(this.key,this.data)):this.cache.add(this.key,new u(this.key,"",this.data));this.pendingDestroy()},getShaderName:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("name:"===n.substring(0,5))return n.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("type:"===n.substring(0,5))return n.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},n=0;n<t.length;n++){var i=t[n].trim();if("uniform."===i.substring(0,8)){var r=i.indexOf(":");if(r){var s=i.substring(8,r);try{e[s]=JSON.parse(i.substring(r+1))}catch(t){console.warn("Invalid uniform JSON: "+s)}}}}return e},extractBlock:function(t,e){for(var n=-1,i=-1,r=-1,s=!1,o=!1,a=[],h=[],u=e;u<t.length;u++){var c=t[u].trim();if("---"===c)if(-1===n)n=u,s=!0;else{if(!s){o=!1;break}i=u,s=!1,o=!0}else s?a.push(c):o&&(h.push(c),r=u)}return s||-1===i?null:{header:a,shader:h.join("\n"),offset:r}}});o.register("glsl",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new c(this,t[r]));else this.addFile(new c(this,t,e,n,i));return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){var r="html";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"text",cache:t.cacheManager.html,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("html",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i,r,o){void 0===i&&(i=512),void 0===r&&(r=512);var u="html";if(h(e)){var c=e;e=a(c,"key"),n=a(c,"url"),o=a(c,"xhrSettings"),u=a(c,"extension",u),i=a(c,"width",i),r=a(c,"height",r)}var l={type:"html",cache:t.textureManager,extension:u,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:i,height:r}};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.width,e=this.config.height,n=[];n.push('<svg width="'+t+'px" height="'+e+'px" viewBox="0 0 '+t+" "+e+'" xmlns="http://www.w3.org/2000/svg">'),n.push('<foreignObject width="100%" height="100%">'),n.push('<body xmlns="http://www.w3.org/1999/xhtml">'),n.push(this.xhrLoader.responseText),n.push("</body>"),n.push("</foreignObject>"),n.push("</svg>");var i=[n.join("\n")],o=this;try{var a=new window.Blob(i,{type:"image/svg+xml;charset=utf-8"})}catch(t){return o.state=r.FILE_ERRORED,void o.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){s.revokeObjectURL(o.data),o.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(o.data),o.onProcessError()},s.createObjectURL(this.data,a,"image/svg+xml")},addToCache:function(){var t=this.cache.addImage(this.key,this.data);this.pendingDestroy(t)}});o.register("htmlTexture",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new u(this,t[s]));else this.addFile(new u(this,t,e,n,i,r));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(60),u=n(49),c=new i({Extends:u,initialize:function(t,e,n,i,r,o,c){if(a(e)){var l=e;e=s(l,"key"),n=s(l,"url",!1)?s(l,"url"):s(l,"atlasURL"),o=s(l,"xhrSettings"),i=s(l,"path"),r=s(l,"baseURL"),c=s(l,"textureXhrSettings")}var f=new h(t,e,n,o);u.call(this,t,"multiatlas",e,[f]),this.config.path=i,this.config.baseURL=r,this.config.textureXhrSettings=c},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,n=this.config,i=this.loader,r=i.baseURL,a=i.path,h=i.prefix,u=s(n,"baseURL",this.baseURL),c=s(n,"path",this.path),l=s(n,"prefix",this.prefix),f=s(n,"textureXhrSettings");i.setBaseURL(u),i.setPath(c),i.setPrefix(l);for(var d=0;d<e.length;d++){var p=e[d].image,v="MA"+this.multiKeyIndex+"_"+p,g=new o(i,v,p,f);if(this.addToMultiFile(g),i.addFile(g),e[d].normalMap){var m=new o(i,v,e[d].normalMap,f);m.type="normalMap",g.setLink(m),this.addToMultiFile(m),i.addFile(m)}}i.setBaseURL(r),i.setPath(a),i.setPrefix(h)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],n=[],i=[],r=1;r<this.files.length;r++){var s=this.files[r];if("normalMap"!==s.type)for(var o=s.key.indexOf("_"),a=s.key.substr(o+1),h=s.data,u=0;u<t.data.textures.length;u++){var c=t.data.textures[u];if(c.image===a){n.push(h),e.push(c),s.linkFile&&i.push(s.linkFile.data);break}}}for(0===i.length&&(i=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,n,e,i),this.complete=!0,r=0;r<this.files.length;r++)this.files[r].pendingDestroy()}}});r.register("multiatlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(7),a=n(49),h=n(520),u=new i({Extends:a,initialize:function(t,e,n,i){var r="js",u=[];if(o(e)){var c=e;e=s(c,"key"),n=s(c,"url"),i=s(c,"xhrSettings"),r=s(c,"extension",r)}Array.isArray(n)||(n=[n]);for(var l=0;l<n.length;l++){var f=new h(t,{key:e+"_"+l.toString(),url:n[l],extension:r,xhrSettings:i});f.onProcess=function(){this.onProcessComplete()},u.push(f)}a.call(this,t,"scripts",e,u)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});r.register("scripts",(function(t,e,n){var i;if(Array.isArray(t))for(var r=0;r<t.length;r++)i=new u(this,t[r]),this.addFile(i.files);else i=new u(this,t,e,n),this.addFile(i.files);return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(7),a=n(49),h=n(498),u=n(499),c=n(242),l=new i({Extends:a,initialize:function(t,e,n,i,r,h){var u,l,f=t.cacheManager.obj;if(o(e)){var d=e;e=s(d,"key"),u=new c(t,{key:e,type:"obj",cache:f,url:s(d,"url"),extension:s(d,"extension","obj"),xhrSettings:s(d,"xhrSettings"),config:{flipUV:s(d,"flipUV",r)}}),(i=s(d,"matURL"))&&(l=new c(t,{key:e,type:"mat",cache:f,url:i,extension:s(d,"matExtension","mat"),xhrSettings:s(d,"xhrSettings")}))}else u=new c(t,{key:e,url:n,type:"obj",cache:f,extension:"obj",xhrSettings:h,config:{flipUV:r}}),i&&(l=new c(t,{key:e,url:i,type:"mat",cache:f,extension:"mat",xhrSettings:h}));a.call(this,t,"obj",e,[u,l])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=h(t.data,t.config.flipUV);e&&(n.materials=u(e.data)),t.cache.add(t.key,n),this.complete=!0}}});r.register("obj",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new l(this,t[o]),this.addFile(s.files);else s=new l(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=l},function(t,e,n){var i=n(0),r=n(21),s=n(8),o=n(60),a=new i({Extends:o,initialize:function(t,e,n,i,r){o.call(this,t,e,n,i,r),this.type="packfile"},onProcess:function(){this.state!==r.FILE_POPULATED&&(this.state=r.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.loader.addPack(this.data,this.config),this.onProcessComplete()}});s.register("pack",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this})),t.exports=a},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i,o,u){var c="js";if(h(e)){var l=e;e=a(l,"key"),n=a(l,"url"),u=a(l,"xhrSettings"),c=a(l,"extension",c),i=a(l,"start"),o=a(l,"mapping")}var f={type:"plugin",cache:!1,extension:c,responseType:"text",key:e,url:n,xhrSettings:u,config:{start:i,mapping:o}};s.call(this,t,f),"function"==typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=a(e,"start",!1),i=a(e,"mapping",null);if(this.state===r.FILE_POPULATED)t.install(this.key,this.data,n,i);else{this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var s=t.install(this.key,window[this.key],n,i);(n||i)&&(this.loader.systems[i]=s,this.loader.scene[i]=s)}this.onProcessComplete()}});o.register("plugin",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new u(this,t[s]));else this.addFile(new u(this,t,e,n,i,r));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i){var r="js";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"text",extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),e=eval;this.loader.sceneManager.add(this.key,e(t)),this.complete=!0}});o.register("sceneFile",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i,o,u){var c="js";if(h(e)){var l=e;e=a(l,"key"),n=a(l,"url"),u=a(l,"xhrSettings"),c=a(l,"extension",c),i=a(l,"systemKey"),o=a(l,"sceneKey")}var f={type:"scenePlugin",cache:!1,extension:c,responseType:"text",key:e,url:n,xhrSettings:u,config:{systemKey:i,sceneKey:o}};s.call(this,t,f),"function"==typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=this.key,i=a(e,"systemKey",n),s=a(e,"sceneKey",n);this.state===r.FILE_POPULATED?t.installScenePlugin(i,this.data,s,this.loader.scene,!0):(this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(i,window[this.key],s,this.loader.scene,!0)),this.onProcessComplete()}});o.register("scenePlugin",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new u(this,t[s]));else this.addFile(new u(this,t,e,n,i,r));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(8),s=n(72),o=new i({Extends:s,initialize:function(t,e,n,i,r){s.call(this,t,e,n,r,i),this.type="spritesheet"},addToCache:function(){var t=this.cache.addSpriteSheet(this.key,this.data,this.config);this.pendingDestroy(t)}});r.register("spritesheet",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new o(this,t[r]));else this.addFile(new o(this,t,e,n,i));return this})),t.exports=o},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=new i({Extends:s,initialize:function(t,e,n,i,r){var o="svg";if(h(e)){var u=e;e=a(u,"key"),n=a(u,"url"),i=a(u,"svgConfig",{}),r=a(u,"xhrSettings"),o=a(u,"extension",o)}var c={type:"svg",cache:t.textureManager,extension:o,responseType:"text",key:e,url:n,xhrSettings:r,config:{width:a(i,"width"),height:a(i,"height"),scale:a(i,"scale")}};s.call(this,t,c)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.xhrLoader.responseText,e=[t],n=this.config.width,i=this.config.height,o=this.config.scale;t:if(n&&i||o){var a=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],h=a.hasAttribute("viewBox"),u=parseFloat(a.getAttribute("width")),c=parseFloat(a.getAttribute("height"));if(!h&&u&&c)a.setAttribute("viewBox","0  0 "+u+" "+c);else if(h&&!u&&!c){var l=a.getAttribute("viewBox").split(/\s+|,/);u=l[2],c=l[3]}if(o){if(!u||!c)break t;n=u*o,i=c*o}a.setAttribute("width",n.toString()+"px"),a.setAttribute("height",i.toString()+"px"),e=[(new XMLSerializer).serializeToString(a)]}try{var f=new window.Blob(e,{type:"image/svg+xml;charset=utf-8"})}catch(t){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var d=this,p=!1;this.data.onload=function(){p||s.revokeObjectURL(d.data),d.onProcessComplete()},this.data.onerror=function(){p?d.onProcessError():(p=!0,s.revokeObjectURL(d.data),d.data.src="data:image/svg+xml,"+encodeURIComponent(e.join("")))},s.createObjectURL(this.data,f,"image/svg+xml")},addToCache:function(){var t=this.cache.addImage(this.key,this.data);this.pendingDestroy(t)}});o.register("svg",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new u(this,t[r]));else this.addFile(new u(this,t,e,n,i));return this})),t.exports=u},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(2),h=n(7),u=n(40),c=new i({Extends:s,initialize:function(t,e,n,i){var r="csv";if(h(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var c={type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,c),this.tilemapFormat=u.CSV},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});o.register("tilemapCSV",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(40),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.WELTMEISTER,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});r.register("tilemapImpact",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this})),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(40),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.TILED_JSON,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});r.register("tilemapTiledJSON",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this})),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(72),a=n(7),h=n(49),u=n(242),c=new i({Extends:h,initialize:function(t,e,n,i,r,c){var l,f;if(a(e)){var d=e;e=s(d,"key"),l=new o(t,{key:e,url:s(d,"textureURL"),extension:s(d,"textureExtension","png"),normalMap:s(d,"normalMap"),xhrSettings:s(d,"textureXhrSettings")}),f=new u(t,{key:e,url:s(d,"atlasURL"),extension:s(d,"atlasExtension","txt"),xhrSettings:s(d,"atlasXhrSettings")})}else l=new o(t,e,n,r),f=new u(t,e,i,c);l.linkFile?h.call(this,t,"unityatlas",e,[l,f,l.linkFile]):h.call(this,t,"unityatlas",e,[l,f])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,n),e.pendingDestroy(),this.complete=!0}}});r.register("unityAtlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(21),s=n(23),o=n(8),a=n(155),h=n(2),u=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,r,o,a){void 0===i&&(i="loadeddata"),void 0===r&&(r=!1),void 0===o&&(o=!1),"loadeddata"!==i&&"canplay"!==i&&"canplaythrough"!==i&&(i="loadeddata");var h={type:"video",cache:t.cacheManager.video,extension:n.type,responseType:"blob",key:e,url:n.url,xhrSettings:a,config:{loadEvent:i,asBlob:r,noAudio:o}};this.onLoadCallback=this.onVideoLoadHandler.bind(this),this.onErrorCallback=this.onVideoErrorHandler.bind(this),s.call(this,t,h)},onProcess:function(){if(this.state=r.FILE_PROCESSING,this.config.asBlob){var t=this.createVideoElement();this.data=t;var e=this;this.data.onloadeddata=function(){e.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(e.data),e.onProcessError()},s.createObjectURL(t,this.xhrLoader.response,""),t.load()}else this.onProcessComplete()},createVideoElement:function(){var t=document.createElement("video");return t.controls=!1,t.crossOrigin=this.loader.crossOrigin,this.config.noAudio&&(t.muted=!0,t.defaultMuted=!0,t.setAttribute("autoplay","autoplay")),t.setAttribute("playsinline","playsinline"),t.setAttribute("preload","auto"),t},onVideoLoadHandler:function(t){var e=t.target;e.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),e.removeEventListener("error",this.onErrorCallback,!0),this.data=e,this.resetXHR(),this.loader.nextFile(this,!0)},onVideoErrorHandler:function(t){var e=t.target;e&&(e.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),e.removeEventListener("error",this.onErrorCallback,!0)),this.resetXHR(),this.loader.nextFile(this,!1)},load:function(){var t=this.config.loadEvent;if(this.config.asBlob)s.prototype.load.call(this);else{this.percentComplete=0;var e=this.createVideoElement();e.addEventListener(t,this.onLoadCallback,!0),e.addEventListener("error",this.onErrorCallback,!0),e.src=a(this,this.loader.baseURL),e.load()}}});c.create=function(t,e,n,i,r,s,o){var a=t.systems.game;u(e)&&(n=h(e,"url",[]),i=h(e,"loadEvent","loadeddata"),r=h(e,"asBlob",!1),s=h(e,"noAudio",!1),o=h(e,"xhrSettings"));var l=c.getVideoURL(a,n);if(l)return new c(t,e,l,i,r,s,o)},c.getVideoURL=function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i,r=h(e[n],"url",e[n]);if(0===r.indexOf("blob:"))return{url:r,type:""};if(i=0===r.indexOf("data:")?r.split(",")[0].match(/\/(.*?);/):r.match(/\.([a-zA-Z0-9]+)($|\?)/),i=h(e[n],"type",i?i[1]:"").toLowerCase(),t.device.video[i])return{url:r,type:i}}return null},o.register("video",(function(t,e,n,i,r,s){var o;if(Array.isArray(t))for(var a=0;a<t.length;a++)(o=c.create(this,t[a]))&&this.addFile(o);else(o=c.create(this,t,e,n,i,r,s))&&this.addFile(o);return this})),t.exports=c},function(t,e,n){var i=n(0),r=n(21),s=n(150),o=n(9),a=n(95),h=n(8),u=n(2),c=n(24),l=n(20),f=n(156),d=new i({Extends:o,initialize:function(t){o.call(this);var e=t.sys.game.config,n=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,h.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(u(n,"baseURL",e.loaderBaseURL)),this.setPath(u(n,"path",e.loaderPath)),this.setPrefix(u(n,"prefix",e.loaderPrefix)),this.maxParallelDownloads=u(n,"maxParallelDownloads",e.loaderMaxParallelDownloads),this.xhr=f(u(n,"responseType",e.loaderResponseType),u(n,"async",e.loaderAsync),u(n,"user",e.loaderUser),u(n,"password",e.loaderPassword),u(n,"timeout",e.loaderTimeout),u(n,"withCredentials",e.loaderWithCredentials)),this.crossOrigin=u(n,"crossOrigin",e.loaderCrossOrigin),this.totalToLoad=0,this.progress=0,this.list=new s,this.inflight=new s,this.queue=new s,this._deleteQueue=new s,this.totalFailed=0,this.totalComplete=0,this.state=r.LOADER_IDLE,this.multiKeyIndex=0,t.sys.events.once(l.BOOT,this.boot,this),t.sys.events.on(l.START,this.pluginStart,this)},boot:function(){this.systems.events.once(l.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(l.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];this.keyExists(n)||(this.list.set(n),this.emit(a.ADD,n.key,n.type,this,n),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1})),!e&&this.isLoading()&&(this.inflight.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1})),this.queue.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1}))),e},addPack:function(t,e){e&&t.hasOwnProperty(e)&&(t={packKey:t[e]});var n=0,i=this.baseURL,r=this.path,s=this.prefix;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=t[o],h=u(a,"baseURL",i),c=u(a,"path",r),l=u(a,"prefix",s),f=u(a,"files",null),d=u(a,"defaultType","void");if(Array.isArray(f)){this.setBaseURL(h),this.setPath(c),this.setPrefix(l);for(var p=0;p<f.length;p++){var v=f[p],g=v.hasOwnProperty("type")?v.type:d;this[g]&&(this[g](v),n++)}}}return this.setBaseURL(i),this.setPath(r),this.setPrefix(s),n>0},isLoading:function(){return this.state===r.LOADER_LOADING||this.state===r.LOADER_PROCESSING},isReady:function(){return this.state===r.LOADER_IDLE||this.state===r.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(a.START,this),0===this.list.size?this.loadComplete():(this.state=r.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(l.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(a.PROGRESS,this.progress)},update:function(){this.state===r.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each((function(t){if((t.state===r.FILE_POPULATED||t.state===r.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1}),this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(a.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(a.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===r.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===r.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&t.multiFile.addToCache():t.addToCache()),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(a.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=r.LOADER_COMPLETE,this.systems.events.off(l.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(a.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,n){void 0===e&&(e="file.json"),void 0===n&&(n="application/json");var i=new Blob([t],{type:n}),r=URL.createObjectURL(i),s=document.createElement("a");return s.download=e,s.textContent="Download "+e,s.href=r,s.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,e=this.systems.settings.loader;this.setBaseURL(u(e,"baseURL",t.loaderBaseURL)),this.setPath(u(e,"path",t.loaderPath)),this.setPrefix(u(e,"prefix",t.loaderPrefix)),this.state=r.LOADER_IDLE},shutdown:function(){this.reset(),this.state=r.LOADER_SHUTDOWN,this.systems.events.off(l.UPDATE,this.update,this),this.systems.events.off(l.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=r.LOADER_DESTROYED,this.systems.events.off(l.UPDATE,this.update,this),this.systems.events.off(l.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});c.register("Loader",d,"load"),t.exports=d},function(t,e,n){var i=n(61),r=n(17),s={ArcadePhysics:n(1364),Body:n(527),Collider:n(528),Components:n(243),Events:n(245),Factory:n(521),GetOverlapX:n(246),GetOverlapY:n(247),SeparateX:n(537),SeparateY:n(538),Group:n(524),Image:n(522),Sprite:n(157),StaticBody:n(539),StaticGroup:n(525),Tilemap:n(1388),World:n(526)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(0),r=n(36),s=n(50),o=n(353),a=n(521),h=n(2),u=n(128),c=n(523),l=n(244),f=n(24),d=n(20),p=n(3),v=n(526),g=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,t.sys.events.once(d.BOOT,this.boot,this),t.sys.events.on(d.START,this.start,this)},boot:function(){this.world=new v(this.scene,this.config),this.add=new a(this.world),this.systems.events.once(d.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new v(this.scene,this.config),this.add=new a(this.world));var t=this.systems.events;h(this.config,"customUpdate",!1)||t.on(d.UPDATE,this.world.update,this.world),t.on(d.POST_UPDATE,this.world.postUpdate,this.world),t.once(d.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(d.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(d.UPDATE,this.world.update,this.world)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return u(h(e,"arcade",{}),h(t,"arcade",{}))},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!1)},collideTiles:function(t,e,n,i,r){return this.world.collideTiles(t,e,n,i,r)},overlapTiles:function(t,e,n,i,r){return this.world.overlapTiles(t,e,n,i,r)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,n,i,r,s){void 0===i&&(i=60);var o=Math.atan2(n-t.y,e-t.x);return t.body.acceleration.setToPolar(o,i),void 0!==r&&void 0!==s&&t.body.maxVelocity.set(r,s),o},accelerateToObject:function(t,e,n,i,r){return this.accelerateTo(t,e.x,e.y,n,i,r)},closest:function(t,e){e||(e=this.world.bodies.entries);for(var n=Number.MAX_VALUE,i=null,r=t.x,s=t.y,a=e.length,h=0;h<a;h++){var u=e[h],c=u.body||u;if(t!==u&&t!==c&&t!==c.gameObject&&t!==c.center){var l=o(r,s,c.center.x,c.center.y);l<n&&(i=u,n=l)}}return i},furthest:function(t,e){e||(e=this.world.bodies.entries);for(var n=-1,i=null,r=t.x,s=t.y,a=e.length,h=0;h<a;h++){var u=e[h],c=u.body||u;if(t!==u&&t!==c&&t!==c.gameObject&&t!==c.center){var l=o(r,s,c.center.x,c.center.y);l>n&&(i=u,n=l)}}return i},moveTo:function(t,e,n,i,r){void 0===i&&(i=60),void 0===r&&(r=0);var o=Math.atan2(n-t.y,e-t.x);return r>0&&(i=s(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(o,i),o},moveToObject:function(t,e,n,i){return this.moveTo(t,e.x,e.y,n,i)},velocityFromAngle:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new p),n.setToPolar(r(t),e)},velocityFromRotation:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new p),n.setToPolar(t,e)},overlapRect:function(t,e,n,i,r,s){return l(this.world,t,e,n,i,r,s)},overlapCirc:function(t,e,n,i,r){return c(this.world,t,e,n,i,r)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(d.UPDATE,this.world.update,this.world),t.off(d.POST_UPDATE,this.world.postUpdate,this.world),t.off(d.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null}},destroy:function(){this.shutdown(),this.scene.sys.events.off(d.START,this.start,this),this.scene=null,this.systems=null}});f.register("ArcadePhysics",g,"arcadePhysics"),t.exports=g},function(t,e){t.exports={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}},function(t,e){t.exports={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}},function(t,e){t.exports={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,n){return this.body.setCollideWorldBounds(t,e,n),this}}},function(t,e){t.exports={setDebug:function(t,e,n){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=n,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}},function(t,e){t.exports={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}},function(t,e){t.exports={enableBody:function(t,e,n,i,r){return t&&this.body.reset(e,n),i&&(this.body.gameObject.active=!0),r&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}}},function(t,e){t.exports={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}},function(t,e){t.exports={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}},function(t,e){t.exports={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}}},function(t,e){t.exports={setMass:function(t){return this.body.mass=t,this}}},function(t,e){t.exports={setPushable:function(t){return void 0===t&&(t=!0),this.body.pushable=t,this}}},function(t,e){t.exports={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,n){return this.body.setSize(t,e,n),this},setBodySize:function(t,e,n){return this.body.setSize(t,e,n),this},setCircle:function(t,e,n){return this.body.setCircle(t,e,n),this}}},function(t,e){t.exports={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}}},function(t,e){t.exports="collide"},function(t,e){t.exports="overlap"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="tilecollide"},function(t,e){t.exports="tileoverlap"},function(t,e){t.exports="worldbounds"},function(t,e){t.exports="worldstep"},function(t,e){var n,i,r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x=function(){return l&&g&&i.blocked.right?(n.processX(-y,h,!1,!0),1):c&&m&&i.blocked.left?(n.processX(y,h,!0),1):p&&m&&n.blocked.right?(i.processX(-y,u,!1,!0),2):d&&g&&n.blocked.left?(i.processX(y,u,!0),2):0},b=function(t){if(r&&s)y*=.5,0===t||3===t?(n.processX(y,o),i.processX(-y,a)):(n.processX(-y,o),i.processX(y,a));else if(r&&!s)0===t||3===t?n.processX(y,h,!0):n.processX(-y,h,!1,!0);else if(!r&&s)0===t||3===t?i.processX(-y,u,!1,!0):i.processX(y,u,!0);else{var e=.5*y;0===t?v?(n.processX(y,0,!0),i.processX(0,null,!1,!0)):p?(n.processX(e,0,!0),i.processX(-e,0,!1,!0)):(n.processX(e,i.velocity.x,!0),i.processX(-e,null,!1,!0)):1===t?f?(n.processX(0,null,!1,!0),i.processX(y,0,!0)):l?(n.processX(-e,0,!1,!0),i.processX(e,0,!0)):(n.processX(-e,null,!1,!0),i.processX(e,n.velocity.x,!0)):2===t?v?(n.processX(-y,0,!1,!0),i.processX(0,null,!0)):d?(n.processX(-e,0,!1,!0),i.processX(e,0,!0)):(n.processX(-e,i.velocity.x,!1,!0),i.processX(e,null,!0)):3===t&&(f?(n.processX(0,null,!0),i.processX(-y,0,!1,!0)):c?(n.processX(e,0,!0),i.processX(-e,0,!1,!0)):(n.processX(e,i.velocity.y,!0),i.processX(-e,null,!1,!0)))}return!0};t.exports={BlockCheck:x,Check:function(){var t=n.velocity.x,e=i.velocity.x,r=Math.sqrt(e*e*i.mass/n.mass)*(e>0?1:-1),s=Math.sqrt(t*t*n.mass/i.mass)*(t>0?1:-1),h=.5*(r+s);return s-=h,o=h+(r-=h)*n.bounce.x,a=h+s*i.bounce.x,c&&m?b(0):d&&g?b(1):l&&g?b(2):!(!p||!m)&&b(3)},Set:function(t,e,o){i=e;var a=(n=t).velocity.x,b=i.velocity.x;return r=n.pushable,c=n._dx<0,l=n._dx>0,f=0===n._dx,g=Math.abs(n.right-i.x)<=Math.abs(i.right-n.x),h=b-a*n.bounce.x,s=i.pushable,d=i._dx<0,p=i._dx>0,v=0===i._dx,m=!g,u=a-b*i.bounce.x,y=Math.abs(o),x()},Run:b,RunImmovableBody1:function(t){1===t?i.velocity.x=0:g?i.processX(y,u,!0):i.processX(-y,u,!1,!0),n.moves&&(i.y+=(n.y-n.prev.y)*n.friction.y,i._dy=i.y-i.prev.y)},RunImmovableBody2:function(t){2===t?n.velocity.x=0:m?n.processX(y,h,!0):n.processX(-y,h,!1,!0),i.moves&&(n.y+=(i.y-i.prev.y)*i.friction.y,n._dy=n.y-n.prev.y)}}},function(t,e){var n,i,r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x=function(){return l&&g&&i.blocked.down?(n.processY(-y,h,!1,!0),1):c&&m&&i.blocked.up?(n.processY(y,h,!0),1):p&&m&&n.blocked.down?(i.processY(-y,u,!1,!0),2):d&&g&&n.blocked.up?(i.processY(y,u,!0),2):0},b=function(t){if(r&&s)y*=.5,0===t||3===t?(n.processY(y,o),i.processY(-y,a)):(n.processY(-y,o),i.processY(y,a));else if(r&&!s)0===t||3===t?n.processY(y,h,!0):n.processY(-y,h,!1,!0);else if(!r&&s)0===t||3===t?i.processY(-y,u,!1,!0):i.processY(y,u,!0);else{var e=.5*y;0===t?v?(n.processY(y,0,!0),i.processY(0,null,!1,!0)):p?(n.processY(e,0,!0),i.processY(-e,0,!1,!0)):(n.processY(e,i.velocity.y,!0),i.processY(-e,null,!1,!0)):1===t?f?(n.processY(0,null,!1,!0),i.processY(y,0,!0)):l?(n.processY(-e,0,!1,!0),i.processY(e,0,!0)):(n.processY(-e,null,!1,!0),i.processY(e,n.velocity.y,!0)):2===t?v?(n.processY(-y,0,!1,!0),i.processY(0,null,!0)):d?(n.processY(-e,0,!1,!0),i.processY(e,0,!0)):(n.processY(-e,i.velocity.y,!1,!0),i.processY(e,null,!0)):3===t&&(f?(n.processY(0,null,!0),i.processY(-y,0,!1,!0)):c?(n.processY(e,0,!0),i.processY(-e,0,!1,!0)):(n.processY(e,i.velocity.y,!0),i.processY(-e,null,!1,!0)))}return!0};t.exports={BlockCheck:x,Check:function(){var t=n.velocity.y,e=i.velocity.y,r=Math.sqrt(e*e*i.mass/n.mass)*(e>0?1:-1),s=Math.sqrt(t*t*n.mass/i.mass)*(t>0?1:-1),h=.5*(r+s);return s-=h,o=h+(r-=h)*n.bounce.y,a=h+s*i.bounce.y,c&&m?b(0):d&&g?b(1):l&&g?b(2):!(!p||!m)&&b(3)},Set:function(t,e,o){i=e;var a=(n=t).velocity.y,b=i.velocity.y;return r=n.pushable,c=n._dy<0,l=n._dy>0,f=0===n._dy,g=Math.abs(n.bottom-i.y)<=Math.abs(i.bottom-n.y),h=b-a*n.bounce.y,s=i.pushable,d=i._dy<0,p=i._dy>0,v=0===i._dy,m=!g,u=a-b*i.bounce.y,y=Math.abs(o),x()},Run:b,RunImmovableBody1:function(t){1===t?i.velocity.y=0:g?i.processY(y,u,!0):i.processY(-y,u,!1,!0),n.moves&&(i.x+=(n.x-n.prev.x)*n.friction.x,i._dx=i.x-i.prev.x)},RunImmovableBody2:function(t){2===t?n.velocity.y=0:m?n.processY(y,h,!0):n.processY(-y,h,!1,!0),i.moves&&(n.x+=(i.x-i.prev.x)*i.friction.x,n._dx=n.x-n.prev.x)}}},function(t,e,n){var i={ProcessTileCallbacks:n(530),ProcessTileSeparationX:n(534),ProcessTileSeparationY:n(536),SeparateTile:n(532),TileCheckX:n(533),TileCheckY:n(535),TileIntersectsBody:n(248)};t.exports=i},function(t,e,n){var i=n(0),r=n(3),s=new i({initialize:function(){this.boundsCenter=new r,this.centerDiff=new r},parseBody:function(t){if(!(t=t.hasOwnProperty("body")?t.body:t).hasOwnProperty("bounds")||!t.hasOwnProperty("centerOfMass"))return!1;var e=this.boundsCenter,n=this.centerDiff,i=t.bounds.max.x-t.bounds.min.x,r=t.bounds.max.y-t.bounds.min.y,s=i*t.centerOfMass.x,o=r*t.centerOfMass.y;return e.set(i/2,r/2),n.set(s-e.x,o-e.y),!0},getTopLeft:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n+i.y+s.y)}return!1},getTopCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+s.x,n+i.y+s.y)}return!1},getTopRight:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n+i.y+s.y)}return!1},getLeftCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n+s.y)}return!1},getCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.centerDiff;return new r(e+i.x,n+i.y)}return!1},getRightCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n+s.y)}return!1},getBottomLeft:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n-(i.y-s.y))}return!1},getBottomCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+s.x,n-(i.y-s.y))}return!1},getBottomRight:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n-(i.y-s.y))}return!1}});t.exports=s},function(t,e){function n(t,e,n){n=n||0;var i,r,s,o,a,h,u,c=[0,0];return i=t[1][1]-t[0][1],r=t[0][0]-t[1][0],s=i*t[0][0]+r*t[0][1],o=e[1][1]-e[0][1],a=e[0][0]-e[1][0],h=o*e[0][0]+a*e[0][1],E(u=i*a-o*r,0,n)||(c[0]=(a*s-r*h)/u,c[1]=(i*h-o*s)/u),c}function i(t,e,n,i){var r=e[0]-t[0],s=e[1]-t[1],o=i[0]-n[0],a=i[1]-n[1];if(o*s-a*r==0)return!1;var h=(r*(n[1]-t[1])+s*(t[0]-n[0]))/(o*s-a*r),u=(o*(t[1]-n[1])+a*(n[0]-t[0]))/(a*r-o*s);return h>=0&&h<=1&&u>=0&&u<=1}function r(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function s(t,e,n){return r(t,e,n)>0}function o(t,e,n){return r(t,e,n)>=0}function a(t,e,n){return r(t,e,n)<0}function h(t,e,n){return r(t,e,n)<=0}t.exports={decomp:function(t){var e=w(t);return e.length>0?_(t,e):[t]},quickDecomp:function t(e,n,i,r,u,c,l){c=c||100,l=l||0,u=u||25,n=void 0!==n?n:[],i=i||[],r=r||[];var g=[0,0],m=[0,0],y=[0,0],b=0,w=0,_=0,E=0,S=0,C=0,A=0,I=[],P=[],R=e,O=e;if(O.length<3)return n;if(++l>c)return console.warn("quickDecomp: max level ("+c+") reached."),n;for(var k=0;k<e.length;++k)if(v(R,k)){i.push(R[k]),b=w=Number.MAX_VALUE;for(var M=0;M<e.length;++M)s(d(R,k-1),d(R,k),d(R,M))&&h(d(R,k-1),d(R,k),d(R,M-1))&&(y=T(d(R,k-1),d(R,k),d(R,M),d(R,M-1)),a(d(R,k+1),d(R,k),y)&&(_=f(R[k],y))<w&&(w=_,m=y,C=M)),s(d(R,k+1),d(R,k),d(R,M+1))&&h(d(R,k+1),d(R,k),d(R,M))&&(y=T(d(R,k+1),d(R,k),d(R,M),d(R,M+1)),s(d(R,k-1),d(R,k),y)&&(_=f(R[k],y))<b&&(b=_,g=y,S=M));if(C===(S+1)%e.length)y[0]=(m[0]+g[0])/2,y[1]=(m[1]+g[1])/2,r.push(y),k<S?(p(I,R,k,S+1),I.push(y),P.push(y),0!==C&&p(P,R,C,R.length),p(P,R,0,k+1)):(0!==k&&p(I,R,k,R.length),p(I,R,0,S+1),I.push(y),P.push(y),p(P,R,C,k+1));else{if(C>S&&(S+=e.length),E=Number.MAX_VALUE,S<C)return n;for(M=C;M<=S;++M)o(d(R,k-1),d(R,k),d(R,M))&&h(d(R,k+1),d(R,k),d(R,M))&&(_=f(d(R,k),d(R,M)))<E&&x(R,k,M)&&(E=_,A=M%e.length);k<A?(p(I,R,k,A+1),0!==A&&p(P,R,A,O.length),p(P,R,0,k+1)):(0!==k&&p(I,R,k,O.length),p(I,R,0,A+1),p(P,R,A,k+1))}return I.length<P.length?(t(I,n,i,r,u,c,l),t(P,n,i,r,u,c,l)):(t(P,n,i,r,u,c,l),t(I,n,i,r,u,c,l)),n}return n.push(e),n},isSimple:function(t){var e,n=t;for(e=0;e<n.length-1;e++)for(var r=0;r<e-1;r++)if(i(n[e],n[e+1],n[r],n[r+1]))return!1;for(e=1;e<n.length-2;e++)if(i(n[0],n[n.length-1],n[e],n[e+1]))return!1;return!0},removeCollinearPoints:function(t,e){for(var n=0,i=t.length-1;t.length>3&&i>=0;--i)l(d(t,i-1),d(t,i),d(t,i+1),e)&&(t.splice(i%t.length,1),n++);return n},removeDuplicatePoints:function(t,e){for(var n=t.length-1;n>=1;--n)for(var i=t[n],r=n-1;r>=0;--r)S(i,t[r],e)&&t.splice(n,1)},makeCCW:function(t){for(var e=0,n=t,i=1;i<t.length;++i)(n[i][1]<n[e][1]||n[i][1]===n[e][1]&&n[i][0]>n[e][0])&&(e=i);return!s(d(t,e-1),d(t,e),d(t,e+1))&&(function(t){for(var e=[],n=t.length,i=0;i!==n;i++)e.push(t.pop());for(i=0;i!==n;i++)t[i]=e[i]}(t),!0)}};var u=[],c=[];function l(t,e,n,i){if(i){var s=u,o=c;s[0]=e[0]-t[0],s[1]=e[1]-t[1],o[0]=n[0]-e[0],o[1]=n[1]-e[1];var a=s[0]*o[0]+s[1]*o[1],h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(a/(h*l))<i}return 0===r(t,e,n)}function f(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function d(t,e){var n=t.length;return t[e<0?e%n+n:e%n]}function p(t,e,n,i){for(var r=n;r<i;r++)t.push(e[r])}function v(t,e){return a(d(t,e-1),d(t,e),d(t,e+1))}var g=[],m=[];function y(t,e,i){var r,s,a=g,u=m;if(o(d(t,e+1),d(t,e),d(t,i))&&h(d(t,e-1),d(t,e),d(t,i)))return!1;s=f(d(t,e),d(t,i));for(var c=0;c!==t.length;++c)if((c+1)%t.length!==e&&c!==e&&o(d(t,e),d(t,i),d(t,c+1))&&h(d(t,e),d(t,i),d(t,c))&&(a[0]=d(t,e),a[1]=d(t,i),u[0]=d(t,c),u[1]=d(t,c+1),r=n(a,u),f(d(t,e),r)<s))return!1;return!0}function x(t,e,n){for(var r=0;r!==t.length;++r)if(r!==e&&r!==n&&(r+1)%t.length!==e&&(r+1)%t.length!==n&&i(d(t,e),d(t,n),d(t,r),d(t,r+1)))return!1;return!0}function b(t,e,n,i){var r=i||[];if(function(t){t.length=0}(r),e<n)for(var s=e;s<=n;s++)r.push(t[s]);else{for(s=0;s<=n;s++)r.push(t[s]);for(s=e;s<t.length;s++)r.push(t[s])}return r}function w(t){for(var e=[],n=[],i=[],r=[],s=Number.MAX_VALUE,o=0;o<t.length;++o)if(v(t,o))for(var a=0;a<t.length;++a)if(y(t,o,a)){n=w(b(t,o,a,r)),i=w(b(t,a,o,r));for(var h=0;h<i.length;h++)n.push(i[h]);n.length<s&&(e=n,s=n.length,e.push([d(t,o),d(t,a)]))}return e}function _(t,e){if(0===e.length)return[t];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2===e[0].length&&e[0][0]instanceof Array){for(var n=[t],i=0;i<e.length;i++)for(var r=e[i],s=0;s<n.length;s++){var o=_(n[s],r);if(o){n.splice(s,1),n.push(o[0],o[1]);break}}return n}return r=e,i=t.indexOf(r[0]),s=t.indexOf(r[1]),-1!==i&&-1!==s&&[b(t,i,s),b(t,s,i)]}function T(t,e,n,i,r){r=r||0;var s=e[1]-t[1],o=t[0]-e[0],a=s*t[0]+o*t[1],h=i[1]-n[1],u=n[0]-i[0],c=h*n[0]+u*n[1],l=s*u-h*o;return E(l,0,r)?[0,0]:[(u*a-o*c)/l,(s*c-h*a)/l]}function E(t,e,n){return n=n||0,Math.abs(t-e)<=n}function S(t,e,n){return E(t[0],e[0],n)&&E(t[1],e[1],n)}},function(t,e,n){var i=n(87),r=n(0),s=n(591),o=n(129),a=n(592),h=n(1392),u=n(1393),c=n(1394),l=n(593),f=n(589),d=n(590),p=n(1395),v=n(63),g=new r({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},rectangle:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return this.world.add(o),o},trapezoid:function(t,e,n,r,s,o){var a=i.trapezoid(t,e,n,r,s,o);return this.world.add(a),a},circle:function(t,e,n,r,s){var o=i.circle(t,e,n,r,s);return this.world.add(o),o},polygon:function(t,e,n,r,s){var o=i.polygon(t,e,n,r,s);return this.world.add(o),o},fromVertices:function(t,e,n,r,s,o,a){"string"==typeof n&&(n=v.fromPath(n));var h=i.fromVertices(t,e,n,r,s,o,a);return this.world.add(h),h},fromPhysicsEditor:function(t,e,n,i,r){void 0===r&&(r=!0);var s=f.parseBody(t,e,n,i);return r&&!this.world.has(s)&&this.world.add(s),s},fromSVG:function(t,e,n,r,s,o){void 0===r&&(r=1),void 0===s&&(s={}),void 0===o&&(o=!0);for(var h=n.getElementsByTagName("path"),u=[],c=0;c<h.length;c++){var l=a.pathToVertices(h[c],30);1!==r&&v.scale(l,r,r),u.push(l)}var f=i.fromVertices(t,e,u,s);return o&&this.world.add(f),f},fromJSON:function(t,e,n,i,r){void 0===i&&(i={}),void 0===r&&(r=!0);var s=d.parseBody(t,e,n,i);return s&&r&&this.world.add(s),s},imageStack:function(t,e,n,i,r,o,a,h,c){void 0===a&&(a=0),void 0===h&&(h=0),void 0===c&&(c={});var l=this.world,f=this.sys.displayList;c.addToWorld=!1;var d=s.stack(n,i,r,o,a,h,(function(n,i){var r=new u(l,n,i,t,e,c);return f.add(r),r.body}));return l.add(d),d},stack:function(t,e,n,i,r,o,a){var h=s.stack(t,e,n,i,r,o,a);return this.world.add(h),h},pyramid:function(t,e,n,i,r,o,a){var h=s.pyramid(t,e,n,i,r,o,a);return this.world.add(h),h},chain:function(t,e,n,i,r,o){return s.chain(t,e,n,i,r,o)},mesh:function(t,e,n,i,r){return s.mesh(t,e,n,i,r)},newtonsCradle:function(t,e,n,i,r){var o=s.newtonsCradle(t,e,n,i,r);return this.world.add(o),o},car:function(t,e,n,i,r){var o=s.car(t,e,n,i,r);return this.world.add(o),o},softBody:function(t,e,n,i,r,o,a,h,u,c){var l=s.softBody(t,e,n,i,r,o,a,h,u,c);return this.world.add(l),l},joint:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},spring:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},constraint:function(t,e,n,i,r){void 0===i&&(i=1),void 0===r&&(r={}),r.bodyA="body"===t.type?t:t.body,r.bodyB="body"===e.type?e:e.body,isNaN(n)||(r.length=n),r.stiffness=i;var s=o.create(r);return this.world.add(s),s},worldConstraint:function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i={}),i.bodyB="body"===t.type?t:t.body,isNaN(e)||(i.length=e),i.stiffness=n;var r=o.create(i);return this.world.add(r),r},mouseSpring:function(t){return this.pointerConstraint(t)},pointerConstraint:function(t){void 0===t&&(t={}),t.hasOwnProperty("render")||(t.render={visible:!1});var e=new p(this.scene,this.world,t);return this.world.add(e.constraint),e},image:function(t,e,n,i,r){var s=new u(this.world,t,e,n,i,r);return this.sys.displayList.add(s),s},tileBody:function(t,e){return new l(this.world,t,e)},sprite:function(t,e,n,i,r){var s=new c(this.world,t,e,n,i,r);return this.sys.displayList.add(s),this.sys.updateList.add(s),s},gameObject:function(t,e,n){return h(this.world,t,e,n)},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=g},function(t,e,n){var i=n(249),r=n(2),s=n(3);t.exports=function(t,e,n,o){void 0===n&&(n={}),void 0===o&&(o=!0);var a=e.x,h=e.y;if(e.body={temp:!0,position:{x:a,y:h}},[i.Bounce,i.Collision,i.Force,i.Friction,i.Gravity,i.Mass,i.Sensor,i.SetBody,i.Sleep,i.Static,i.Transform,i.Velocity].forEach((function(t){for(var n in t)(i=t[n]).get&&"function"==typeof i.get||i.set&&"function"==typeof i.set?Object.defineProperty(e,n,{get:t[n].get,set:t[n].set}):Object.defineProperty(e,n,{value:t[n]});var i})),e.world=t,e._tempVec2=new s(a,h),n.hasOwnProperty("type")&&"body"===n.type)e.setExistingBody(n,o);else{var u=r(n,"shape",null);u||(u="rectangle"),n.addToWorld=o,e.setBody(u,n)}return e}},function(t,e,n){var i=n(0),r=n(249),s=n(15),o=n(2),a=n(126),h=n(167),u=n(3),c=new i({Extends:a,Mixins:[r.Bounce,r.Collision,r.Force,r.Friction,r.Gravity,r.Mass,r.Sensor,r.SetBody,r.Sleep,r.Static,r.Transform,r.Velocity,h],initialize:function(t,e,n,i,r,a){s.call(this,t.scene,"Image"),this._crop=this.resetCropObject(),this.setTexture(i,r),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new u(e,n);var h=o(a,"shape",null);h?this.setBody(h,a):this.setRectangle(this.width,this.height,a),this.setPosition(e,n),this.initPipeline()}});t.exports=c},function(t,e,n){var i=n(164),r=n(0),s=n(249),o=n(15),a=n(2),h=n(167),u=n(74),c=n(3),l=new r({Extends:u,Mixins:[s.Bounce,s.Collision,s.Force,s.Friction,s.Gravity,s.Mass,s.Sensor,s.SetBody,s.Sleep,s.Static,s.Transform,s.Velocity,h],initialize:function(t,e,n,r,s,h){o.call(this,t.scene,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(r,s),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new c(e,n);var u=a(h,"shape",null);u?this.setBody(u,h):this.setRectangle(this.width,this.height,h),this.setPosition(e,n),this.initPipeline()}});t.exports=l},function(t,e,n){var i=n(85),r=n(0),s=n(119),o=n(129),a=n(273),h=n(272),u=n(51),c=n(128),l=n(165),f=n(3),d=n(63),p=new r({initialize:function(t,e,n){void 0===n&&(n={}),this.scene=t,this.world=e,this.camera=null,this.pointer=null,this.active=!0,this.position=new f,this.body=null,this.part=null,this.constraint=o.create(c(n,{label:"Pointer Constraint",pointA:{x:0,y:0},pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,collisionFilter:{category:1,mask:4294967295,group:0}})),this.world.on(h.BEFORE_UPDATE,this.update,this),t.sys.input.on(u.POINTER_DOWN,this.onDown,this),t.sys.input.on(u.POINTER_UP,this.onUp,this)},onDown:function(t){this.pointer||(this.pointer=t,this.camera=t.camera)},onUp:function(t){t===this.pointer&&(this.pointer=null)},getBody:function(t){var e=this.position,n=this.constraint;this.camera.getWorldPoint(t.x,t.y,e);for(var r=s.allBodies(this.world.localWorld),o=0;o<r.length;o++){var u=r[o];if(!u.ignorePointer&&i.contains(u.bounds,e)&&a.canCollide(u.collisionFilter,n.collisionFilter)&&this.hitTestBody(u,e))return this.world.emit(h.DRAG_START,u,this.part,this),!0}return!1},hitTestBody:function(t,e){for(var n=this.constraint,i=t.parts.length,r=i>1?1:0;r<i;r++){var s=t.parts[r];if(d.contains(s.vertices,e))return n.pointA=e,n.pointB={x:e.x-t.position.x,y:e.y-t.position.y},n.bodyB=t,n.angleB=t.angle,l.set(t,!1),this.part=s,this.body=t,!0}return!1},update:function(){var t=this.pointer,e=this.body;if(this.active&&t)if(t.isDown||!e){if(t.isDown){if(!e&&!this.getBody(t))return;e=this.body;var n=this.position,i=this.constraint;this.camera.getWorldPoint(t.x,t.y,n),i.pointA.x=n.x,i.pointA.y=n.y,l.set(e,!1),this.world.emit(h.DRAG,e,this)}}else this.stopDrag();else e&&this.stopDrag()},stopDrag:function(){var t=this.body,e=this.constraint;e.bodyB=null,e.pointB=null,this.pointer=null,this.body=null,this.part=null,t&&this.world.emit(h.DRAG_END,t,this)},destroy:function(){this.world.removeConstraint(this.constraint),this.pointer=null,this.constraint=null,this.body=null,this.part=null,this.world.off(h.BEFORE_UPDATE,this.update),this.scene.sys.input.off(u.POINTER_DOWN,this.onDown,this),this.scene.sys.input.off(u.POINTER_UP,this.onUp,this)}});t.exports=p},function(t,e,n){var i={};t.exports=i;var r=n(595),s=n(32);i.name="matter-js",i.version="0.14.2",i.uses=[],i.used=[],i.use=function(){r.use(i,Array.prototype.slice.call(arguments))},i.before=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathBefore(i,t,e)},i.after=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathAfter(i,t,e)}},function(t,e,n){var i={};t.exports=i;var r=n(84),s=n(274),o=n(85),a=n(87),h=n(63);i.collides=function(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i];if(t!==r&&o.overlaps(r.bounds,t.bounds))for(var a=1===r.parts.length?0:1;a<r.parts.length;a++){var h=r.parts[a];if(o.overlaps(h.bounds,t.bounds)){var u=s.collides(h,t);if(u.collided){n.push(u);break}}}}return n},i.ray=function(t,e,n,s){s=s||1e-100;for(var o=r.angle(e,n),h=r.magnitude(r.sub(e,n)),u=.5*(n.x+e.x),c=.5*(n.y+e.y),l=a.rectangle(u,c,h,s,{angle:o}),f=i.collides(l,t),d=0;d<f.length;d+=1){var p=f[d];p.body=p.bodyB=p.bodyA}return f},i.region=function(t,e,n){for(var i=[],r=0;r<t.length;r++){var s=t[r],a=o.overlaps(s.bounds,e);(a&&!n||!a&&n)&&i.push(s)}return i},i.point=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(o.contains(r.bounds,e))for(var s=1===r.parts.length?0:1;s<r.parts.length;s++){var a=r.parts[s];if(o.contains(a.bounds,e)&&h.contains(a.vertices,e)){n.push(r);break}}}return n}},function(t,e,n){var i={};t.exports=i;var r=n(596),s=n(165),o=n(599),a=n(598),h=n(1520),u=n(597),c=n(166),l=n(119),f=n(129),d=n(32),p=n(41);i.create=function(t,e){e=(e=d.isElement(t)?e:t)||{},((t=d.isElement(t)?t:null)||e.render)&&d.warn("Engine.create: engine.render is deprecated (see docs)");var n={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:u}},i=d.extend(n,e);return i.world=e.world||r.create(i.world),i.pairs=a.create(),i.broadphase=i.broadphase.controller.create(i.broadphase),i.metrics=i.metrics||{extended:!1},i.metrics=h.create(i.metrics),i},i.update=function(t,e,n){e=e||1e3/60,n=n||1;var r,u=t.world,d=t.timing,p=t.broadphase,v=[];d.timestamp+=e*d.timeScale;var g={timestamp:d.timestamp};c.trigger(t,"beforeUpdate",g);var m=l.allBodies(u),y=l.allConstraints(u);for(h.reset(t.metrics),t.enableSleeping&&s.update(m,d.timeScale),i._bodiesApplyGravity(m,u.gravity),i._bodiesUpdate(m,e,d.timeScale,n,u.bounds),f.preSolveAll(m),r=0;r<t.constraintIterations;r++)f.solveAll(y,d.timeScale);f.postSolveAll(m),p.controller?(u.isModified&&p.controller.clear(p),p.controller.update(p,m,t,u.isModified),v=p.pairsList):v=m,u.isModified&&l.setModified(u,!1,!1,!0);var x=p.detector(v,t),b=t.pairs,w=d.timestamp;for(a.update(b,x,w),a.removeOld(b,w),t.enableSleeping&&s.afterCollisions(b.list,d.timeScale),b.collisionStart.length>0&&c.trigger(t,"collisionStart",{pairs:b.collisionStart}),o.preSolvePosition(b.list),r=0;r<t.positionIterations;r++)o.solvePosition(b.list,m,d.timeScale);for(o.postSolvePosition(m),f.preSolveAll(m),r=0;r<t.constraintIterations;r++)f.solveAll(y,d.timeScale);for(f.postSolveAll(m),o.preSolveVelocity(b.list),r=0;r<t.velocityIterations;r++)o.solveVelocity(b.list,d.timeScale);return b.collisionActive.length>0&&c.trigger(t,"collisionActive",{pairs:b.collisionActive}),b.collisionEnd.length>0&&c.trigger(t,"collisionEnd",{pairs:b.collisionEnd}),h.update(t.metrics,t),i._bodiesClearForces(m),c.trigger(t,"afterUpdate",g),t},i.merge=function(t,e){if(d.extend(t,e),e.world){t.world=e.world,i.clear(t);for(var n=l.allBodies(t.world),r=0;r<n.length;r++){var o=n[r];s.set(o,!1),o.id=d.nextId()}}},i.clear=function(t){var e=t.world;a.clear(t.pairs);var n=t.broadphase;if(n.controller){var i=l.allBodies(e);n.controller.clear(n),n.controller.update(n,i,t,!0)}},i._bodiesClearForces=function(t){for(var e=0;e<t.length;e++){var n=t[e];n.force.x=0,n.force.y=0,n.torque=0}},i._bodiesApplyGravity=function(t,e){var n=void 0!==e.scale?e.scale:.001;if((0!==e.x||0!==e.y)&&0!==n)for(var i=0;i<t.length;i++){var r=t[i];r.ignoreGravity||r.isStatic||r.isSleeping||(r.force.x+=r.mass*e.x*n*r.gravityScale.x,r.force.y+=r.mass*e.y*n*r.gravityScale.y)}},i._bodiesUpdate=function(t,e,n,i,r){for(var s=0;s<t.length;s++){var o=t[s];o.isStatic||o.isSleeping||p.update(o,e,n,i)}}},function(t,e,n){var i=n(87),r=n(41),s=n(0),o=n(32),a=n(119),h=n(1398),u=n(9),c=n(272),l=n(2),f=n(6),d=n(41),p=n(166),v=n(593),g=n(596),m=n(84),y=new s({Extends:u,initialize:function(t,e){u.call(this),this.scene=t,this.engine=h.create(e),this.localWorld=this.engine.world;var n=f(e,"gravity",null);n?this.setGravity(n.x,n.y,n.scale):!1===n&&this.setGravity(0,0,0),this.walls={left:null,right:null,top:null,bottom:null},this.enabled=f(e,"enabled",!0),this.correction=f(e,"correction",1),this.getDelta=f(e,"getDelta",this.update60Hz);var i=l(e,"runner",{}),r=l(i,"fps",!1),s=l(i,"fps",60),o=l(i,"delta",1e3/s),a=l(i,"deltaMin",1e3/s),c=l(i,"deltaMax",1e3/(.5*s));r||(s=1e3/o),this.runner={fps:s,correction:l(i,"correction",1),deltaSampleSize:l(i,"deltaSampleSize",60),counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:l(i,"isFixed",!1),delta:o,deltaMin:a,deltaMax:c},this.autoUpdate=f(e,"autoUpdate",!0);var d=f(e,"debug",!1);if(this.drawDebug="object"==typeof d||d,this.debugGraphic,this.debugConfig={showAxes:l(d,"showAxes",!1),showAngleIndicator:l(d,"showAngleIndicator",!1),angleColor:l(d,"angleColor",15208787),showBroadphase:l(d,"showBroadphase",!1),broadphaseColor:l(d,"broadphaseColor",16757760),showBounds:l(d,"showBounds",!1),boundsColor:l(d,"boundsColor",16777215),showVelocity:l(d,"showVelocity",!1),velocityColor:l(d,"velocityColor",44783),showCollisions:l(d,"showCollisions",!1),collisionColor:l(d,"collisionColor",16094476),showSeparations:l(d,"showSeparations",!1),separationColor:l(d,"separationColor",16753920),showBody:l(d,"showBody",!0),showStaticBody:l(d,"showStaticBody",!0),showInternalEdges:l(d,"showInternalEdges",!1),renderFill:l(d,"renderFill",!1),renderLine:l(d,"renderLine",!0),fillColor:l(d,"fillColor",1075465),fillOpacity:l(d,"fillOpacity",1),lineColor:l(d,"lineColor",2678297),lineOpacity:l(d,"lineOpacity",1),lineThickness:l(d,"lineThickness",1),staticFillColor:l(d,"staticFillColor",857979),staticLineColor:l(d,"staticLineColor",1255396),showSleeping:l(d,"showSleeping",!1),staticBodySleepOpacity:l(d,"staticBodySleepOpacity",.7),sleepFillColor:l(d,"sleepFillColor",4605510),sleepLineColor:l(d,"sleepLineColor",10066585),showSensors:l(d,"showSensors",!0),sensorFillColor:l(d,"sensorFillColor",857979),sensorLineColor:l(d,"sensorLineColor",1255396),showPositions:l(d,"showPositions",!0),positionSize:l(d,"positionSize",4),positionColor:l(d,"positionColor",14697178),showJoint:l(d,"showJoint",!0),jointColor:l(d,"jointColor",14737474),jointLineOpacity:l(d,"jointLineOpacity",1),jointLineThickness:l(d,"jointLineThickness",2),pinSize:l(d,"pinSize",4),pinColor:l(d,"pinColor",4382944),springColor:l(d,"springColor",14697184),anchorColor:l(d,"anchorColor",15724527),anchorSize:l(d,"anchorSize",4),showConvexHulls:l(d,"showConvexHulls",!1),hullColor:l(d,"hullColor",14091216)},this.drawDebug&&this.createDebugGraphic(),this.setEventsProxy(),l(e,"setBounds",!1)){var p=e.setBounds;if("boolean"==typeof p)this.setBounds();else{var v=l(p,"x",0),g=l(p,"y",0),m=l(p,"width",t.sys.scale.width),y=l(p,"height",t.sys.scale.height),x=l(p,"thickness",64),b=l(p,"left",!0),w=l(p,"right",!0),_=l(p,"top",!0),T=l(p,"bottom",!0);this.setBounds(v,g,m,y,x,b,w,_,T)}}},setCompositeRenderStyle:function(t){var e,n,i,r=t.bodies,s=t.constraints,o=t.composites;for(e=0;e<r.length;e++)i=(n=r[e]).render,this.setBodyRenderStyle(n,i.lineColor,i.lineOpacity,i.lineThickness,i.fillColor,i.fillOpacity);for(e=0;e<s.length;e++)i=(n=s[e]).render,this.setConstraintRenderStyle(n,i.lineColor,i.lineOpacity,i.lineThickness,i.pinSize,i.anchorColor,i.anchorSize);for(e=0;e<o.length;e++)n=o[e],this.setCompositeRenderStyle(n);return this},setBodyRenderStyle:function(t,e,n,i,r,s){var o=t.render,a=this.debugConfig;return o?(null==e&&(e=t.isStatic?a.staticLineColor:a.lineColor),null==n&&(n=a.lineOpacity),null==i&&(i=a.lineThickness),null==r&&(r=t.isStatic?a.staticFillColor:a.fillColor),null==s&&(s=a.fillOpacity),!1!==e&&(o.lineColor=e),!1!==n&&(o.lineOpacity=n),!1!==i&&(o.lineThickness=i),!1!==r&&(o.fillColor=r),!1!==s&&(o.fillOpacity=s),this):this},setConstraintRenderStyle:function(t,e,n,i,r,s,o){var a=t.render,h=this.debugConfig;if(!a)return this;if(null==e){var u=a.type;"line"===u?e=h.jointColor:"pin"===u?e=h.pinColor:"spring"===u&&(e=h.springColor)}return null==n&&(n=h.jointLineOpacity),null==i&&(i=h.jointLineThickness),null==r&&(r=h.pinSize),null==s&&(s=h.anchorColor),null==o&&(o=h.anchorSize),!1!==e&&(a.lineColor=e),!1!==n&&(a.lineOpacity=n),!1!==i&&(a.lineThickness=i),!1!==r&&(a.pinSize=r),!1!==s&&(a.anchorColor=s),!1!==o&&(a.anchorSize=o),this},setEventsProxy:function(){var t=this,e=this.engine,n=this.localWorld;this.drawDebug&&(p.on(n,"compositeModified",(function(e){t.setCompositeRenderStyle(e)})),p.on(n,"beforeAdd",(function(e){for(var n=[].concat(e.object),i=0;i<n.length;i++){var r=n[i],s=r.render;"body"===r.type?t.setBodyRenderStyle(r,s.lineColor,s.lineOpacity,s.lineThickness,s.fillColor,s.fillOpacity):"composite"===r.type?t.setCompositeRenderStyle(r):"constraint"===r.type&&t.setConstraintRenderStyle(r,s.lineColor,s.lineOpacity,s.lineThickness,s.pinSize,s.anchorColor,s.anchorSize)}}))),p.on(n,"beforeAdd",(function(e){t.emit(c.BEFORE_ADD,e)})),p.on(n,"afterAdd",(function(e){t.emit(c.AFTER_ADD,e)})),p.on(n,"beforeRemove",(function(e){t.emit(c.BEFORE_REMOVE,e)})),p.on(n,"afterRemove",(function(e){t.emit(c.AFTER_REMOVE,e)})),p.on(e,"beforeUpdate",(function(e){t.emit(c.BEFORE_UPDATE,e)})),p.on(e,"afterUpdate",(function(e){t.emit(c.AFTER_UPDATE,e)})),p.on(e,"collisionStart",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_START,e,n,i)})),p.on(e,"collisionActive",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_ACTIVE,e,n,i)})),p.on(e,"collisionEnd",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_END,e,n,i)}))},setBounds:function(t,e,n,i,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),void 0===r&&(r=64),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=!0),void 0===h&&(h=!0),this.updateWall(s,"left",t-r,e-r,r,i+2*r),this.updateWall(o,"right",t+n,e-r,r,i+2*r),this.updateWall(a,"top",t,e-r,n,r),this.updateWall(h,"bottom",t,e+i,n,r),this},updateWall:function(t,e,n,i,r,s){var o=this.walls[e];t?(o&&g.remove(this.localWorld,o),n+=r/2,i+=s/2,this.walls[e]=this.create(n,i,r,s,{isStatic:!0,friction:0,frictionStatic:0})):(o&&g.remove(this.localWorld,o),this.walls[e]=null)},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},disableGravity:function(){return this.localWorld.gravity.x=0,this.localWorld.gravity.y=0,this.localWorld.gravity.scale=0,this},setGravity:function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1),this.localWorld.gravity.x=t,this.localWorld.gravity.y=e,void 0!==n&&(this.localWorld.gravity.scale=n),this},create:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return g.add(this.localWorld,o),o},add:function(t){return g.add(this.localWorld,t),this},remove:function(t,e){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n],r=i.body?i.body:i;a.remove(this.localWorld,r,e)}return this},removeConstraint:function(t,e){return a.remove(this.localWorld,t,e),this},convertTilemapLayer:function(t,e){var n=t.layer,i=t.getTilesWithin(0,0,n.width,n.height,{isColliding:!0});return this.convertTiles(i,e),this},convertTiles:function(t,e){if(0===t.length)return this;for(var n=0;n<t.length;n++)new v(this,t[n],e);return this},nextGroup:function(t){return d.nextGroup(t)},nextCategory:function(){return d.nextCategory()},pause:function(){return this.enabled=!1,this.emit(c.PAUSE),this},resume:function(){return this.enabled=!0,this.emit(c.RESUME),this},update:function(t,e){if(this.enabled&&this.autoUpdate){var n=this.engine,i=this.runner,r=n.timing,s=this.correction;i.isFixed?e=this.getDelta(t,e):(e=t-i.timePrev||i.delta,i.timePrev=t,i.deltaHistory.push(e),i.deltaHistory=i.deltaHistory.slice(-i.deltaSampleSize),s=(e=(e=(e=Math.min.apply(null,i.deltaHistory))<i.deltaMin?i.deltaMin:e)>i.deltaMax?i.deltaMax:e)/i.delta,i.delta=e),0!==i.timeScalePrev&&(s*=r.timeScale/i.timeScalePrev),0===r.timeScale&&(s=0),i.timeScalePrev=r.timeScale,i.correction=s,i.frameCounter+=1,t-i.counterTimestamp>=1e3&&(i.fps=i.frameCounter*((t-i.counterTimestamp)/1e3),i.counterTimestamp=t,i.frameCounter=0),h.update(n,e,s)}},step:function(t,e){h.update(this.engine,t,e)},update60Hz:function(){return 1e3/60},update30Hz:function(){return 1e3/30},has:function(t){var e=t.hasOwnProperty("body")?t.body:t;return null!==a.get(this.localWorld,e.id,e.type)},getAllBodies:function(){return a.allBodies(this.localWorld)},getAllConstraints:function(){return a.allConstraints(this.localWorld)},getAllComposites:function(){return a.allComposites(this.localWorld)},postUpdate:function(){if(this.drawDebug){var t=this.debugConfig,e=this.engine,n=this.debugGraphic,i=a.allBodies(this.localWorld);this.debugGraphic.clear(),t.showBroadphase&&e.broadphase.controller&&this.renderGrid(e.broadphase,n,t.broadphaseColor,.5),t.showBounds&&this.renderBodyBounds(i,n,t.boundsColor,.5),(t.showBody||t.showStaticBody)&&this.renderBodies(i),t.showJoint&&this.renderJoints(),(t.showAxes||t.showAngleIndicator)&&this.renderBodyAxes(i,n,t.showAxes,t.angleColor,.5),t.showVelocity&&this.renderBodyVelocity(i,n,t.velocityColor,1,2),t.showSeparations&&this.renderSeparations(e.pairs.list,n,t.separationColor),t.showCollisions&&this.renderCollisions(e.pairs.list,n,t.collisionColor)}},renderGrid:function(t,e,n,i){e.lineStyle(1,n,i);for(var r=o.keys(t.buckets),s=0;s<r.length;s++){var a=r[s];if(!(t.buckets[a].length<2)){var h=a.split(/C|R/);e.strokeRect(parseInt(h[1],10)*t.bucketWidth,parseInt(h[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}return this},renderSeparations:function(t,e,n){e.lineStyle(1,n,1);for(var i=0;i<t.length;i++){var r=t[i];if(r.isActive){var s=r.collision,o=s.bodyA,a=s.bodyB,h=o.position,u=a.position,c=s.penetration,l=o.isStatic||a.isStatic?1:4;a.isStatic&&(l=0),e.lineBetween(u.x,u.y,u.x-c.x*l,u.y-c.y*l),l=o.isStatic||a.isStatic?1:4,o.isStatic&&(l=0),e.lineBetween(h.x,h.y,h.x-c.x*l,h.y-c.y*l)}}return this},renderCollisions:function(t,e,n){var i,r;for(e.lineStyle(1,n,.5),e.fillStyle(n,1),i=0;i<t.length;i++)if((r=t[i]).isActive)for(var s=0;s<r.activeContacts.length;s++){var o=r.activeContacts[s].vertex;e.fillRect(o.x-2,o.y-2,5,5)}for(i=0;i<t.length;i++)if((r=t[i]).isActive){var a=r.collision,h=r.activeContacts;if(h.length>0){var u=h[0].vertex.x,c=h[0].vertex.y;2===h.length&&(u=(h[0].vertex.x+h[1].vertex.x)/2,c=(h[0].vertex.y+h[1].vertex.y)/2),a.bodyB===a.supports[0].body||a.bodyA.isStatic?e.lineBetween(u-8*a.normal.x,c-8*a.normal.y,u,c):e.lineBetween(u+8*a.normal.x,c+8*a.normal.y,u,c)}}return this},renderBodyBounds:function(t,e,n,i){e.lineStyle(1,n,i);for(var r=0;r<t.length;r++){var s=t[r];if(s.render.visible){var o=s.bounds;if(o)e.strokeRect(o.min.x,o.min.y,o.max.x-o.min.x,o.max.y-o.min.y);else for(var a=s.parts,h=a.length>1?1:0;h<a.length;h++){var u=a[h];e.strokeRect(u.bounds.min.x,u.bounds.min.y,u.bounds.max.x-u.bounds.min.x,u.bounds.max.y-u.bounds.min.y)}}}return this},renderBodyAxes:function(t,e,n,i,r){e.lineStyle(1,i,r);for(var s=0;s<t.length;s++){var o,a,h,u=t[s],c=u.parts;if(u.render.visible)if(n)for(a=c.length>1?1:0;a<c.length;a++)for(o=c[a],h=0;h<o.axes.length;h++){var l=o.axes[h];e.lineBetween(o.position.x,o.position.y,o.position.x+20*l.x,o.position.y+20*l.y)}else for(a=c.length>1?1:0;a<c.length;a++)for(o=c[a],h=0;h<o.axes.length;h++)e.lineBetween(o.position.x,o.position.y,(o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}return this},renderBodyVelocity:function(t,e,n,i,r){e.lineStyle(r,n,i);for(var s=0;s<t.length;s++){var o=t[s];o.render.visible&&e.lineBetween(o.position.x,o.position.y,o.position.x+2*(o.position.x-o.positionPrev.x),o.position.y+2*(o.position.y-o.positionPrev.y))}return this},renderBodies:function(t){for(var e=this.debugGraphic,n=this.debugConfig,i=n.showBody,r=n.showStaticBody,s=n.showSleeping,o=n.showInternalEdges,a=n.showConvexHulls,h=n.renderFill,u=n.renderLine,c=n.staticBodySleepOpacity,l=n.sleepFillColor,f=n.sleepLineColor,d=n.hullColor,p=0;p<t.length;p++){var v=t[p];if(v.render.visible&&(r||!v.isStatic)&&(i||v.isStatic)){var g=v.render.lineColor,m=v.render.lineOpacity,y=v.render.lineThickness,x=v.render.fillColor,b=v.render.fillOpacity;s&&v.isSleeping&&(v.isStatic?(m*=c,b*=c):(g=f,x=l)),h||(x=null),u||(g=null),this.renderBody(v,e,o,g,m,y,x,b);var w=v.parts.length;a&&w>1&&this.renderConvexHull(v,e,d,y)}}},renderBody:function(t,e,n,i,r,s,o,a){void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=1),void 0===o&&(o=null),void 0===a&&(a=null);for(var h=this.debugConfig,u=h.sensorFillColor,c=h.sensorLineColor,l=t.parts,f=l.length,d=f>1?1:0;d<f;d++){var p=l[d],v=p.render,g=v.opacity;if(v.visible&&0!==g&&(!p.isSensor||h.showSensors)){var m=p.circleRadius;if(e.beginPath(),p.isSensor?(null!==o&&e.fillStyle(u,a*g),null!==i&&e.lineStyle(s,c,r*g)):(null!==o&&e.fillStyle(o,a*g),null!==i&&e.lineStyle(s,i,r*g)),m)e.arc(p.position.x,p.position.y,m,0,2*Math.PI);else{var y=p.vertices,x=y.length;e.moveTo(y[0].x,y[0].y);for(var b=1;b<x;b++){var w=y[b];if(!y[b-1].isInternal||n?e.lineTo(w.x,w.y):e.moveTo(w.x,w.y),b<x&&w.isInternal&&!n){var _=(b+1)%x;e.moveTo(y[_].x,y[_].y)}}e.closePath()}null!==o&&e.fillPath(),null!==i&&e.strokePath()}}if(h.showPositions&&!t.isStatic){var T=t.position.x,E=t.position.y,S=Math.ceil(h.positionSize/2);e.fillStyle(h.positionColor,1),e.fillRect(T-S,E-S,h.positionSize,h.positionSize)}return this},renderConvexHull:function(t,e,n,i){if(void 0===i&&(i=1),t.parts.length>1){var r=t.vertices;e.lineStyle(i,n),e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var s=1;s<r.length;s++)e.lineTo(r[s].x,r[s].y);e.lineTo(r[0].x,r[0].y),e.strokePath()}return this},renderJoints:function(){for(var t=this.debugGraphic,e=a.allConstraints(this.localWorld),n=0;n<e.length;n++){var i=e[n].render,r=i.lineColor,s=i.lineOpacity,o=i.lineThickness,h=i.pinSize,u=i.anchorColor,c=i.anchorSize;this.renderConstraint(e[n],t,r,s,o,h,u,c)}},renderConstraint:function(t,e,n,i,r,s,a,h){var u=t.render;if(!u.visible||!t.pointA||!t.pointB)return this;e.lineStyle(r,n,i);var c,l,f=t.bodyA,d=t.bodyB;if(c=f?m.add(f.position,t.pointA):t.pointA,"pin"===u.type)e.strokeCircle(c.x,c.y,s);else{if(l=d?m.add(d.position,t.pointB):t.pointB,e.beginPath(),e.moveTo(c.x,c.y),"spring"===u.type)for(var p,v=m.sub(l,c),g=m.perp(m.normalise(v)),y=Math.ceil(o.clamp(t.length/5,12,20)),x=1;x<y;x+=1)p=x%2==0?1:-1,e.lineTo(c.x+v.x*(x/y)+g.x*p*4,c.y+v.y*(x/y)+g.y*p*4);e.lineTo(l.x,l.y)}return e.strokePath(),u.anchors&&h>0&&(e.fillStyle(a),e.fillCircle(c.x,c.y,h),e.fillCircle(l.x,l.y,h)),this},resetCollisionIDs:function(){return r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,this},shutdown:function(){p.off(this.engine),this.removeAllListeners(),g.clear(this.localWorld,!1),h.clear(this.engine),this.drawDebug&&this.debugGraphic.destroy()},destroy:function(){this.shutdown()}});t.exports=y},function(t,e,n){t.exports={BasePlugin:n(540),DefaultPlugins:n(197),PluginCache:n(24),PluginManager:n(414),ScenePlugin:n(1401)}},function(t,e,n){var i=n(540),r=n(0),s=n(20),o=new r({Extends:i,initialize:function(t,e){i.call(this,e),this.scene=t,this.systems=t.sys,t.sys.events.once(s.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=o},function(t,e,n){t.exports={Canvas:n(1403),Events:n(92),Snapshot:n(1404),WebGL:n(1405)}},function(t,e,n){t.exports={CanvasRenderer:n(368),GetBlendModes:n(370),SetTransform:n(30)}},function(t,e,n){t.exports={Canvas:n(369),WebGL:n(383)}},function(t,e,n){var i=n(107),r=n(17),s={PipelineManager:n(372),Pipelines:n(1406),RenderTarget:n(142),Utils:n(12),WebGLPipeline:n(58),WebGLRenderer:n(371),WebGLShader:n(375)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(67),r=n(17),s={BitmapMaskPipeline:n(373),Events:n(374),GraphicsPipeline:n(376),LightPipeline:n(377),MultiPipeline:n(108),PointLightPipeline:n(378),PostFXPipeline:n(1407),RopePipeline:n(379),SinglePipeline:n(380),UtilityPipeline:n(381)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(0),r=n(198),s=n(2),o=n(1408),a=n(382),h=n(58),u=new i({Extends:h,initialize:function(t){t.renderTarget=s(t,"renderTarget",1),t.fragShader=s(t,"fragShader",o),t.vertShader=s(t,"vertShader",a),t.attributes=s(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.batchSize=1,t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],h.call(this,t),this.isPostFX=!0,this.gameObject,this.colorMatrix=new r,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){h.prototype.boot.call(this);var t=this.manager.UTILITY_PIPELINE;this.fullFrame1=t.fullFrame1,this.fullFrame2=t.fullFrame2,this.halfFrame1=t.halfFrame1,this.halfFrame2=t.halfFrame2,this.set1i("uMainSampler",0)},onDraw:function(t){this.bindAndDraw(t)},copyFrame:function(t,e,n,i,r){this.manager.copyFrame(t,e,n,i,r)},copyToGame:function(t){this.manager.copyToGame(t)},drawFrame:function(t,e,n){this.manager.drawFrame(t,e,n,this.colorMatrix)},blendFrames:function(t,e,n,i,r){this.manager.blendFrames(t,e,n,i,r)},blendFramesAdditive:function(t,e,n,i,r){this.manager.blendFramesAdditive(t,e,n,i,r)},clearFrame:function(t,e){this.manager.clearFrame(t,e)},blitFrame:function(t,e,n,i,r,s){this.manager.blitFrame(t,e,n,i,r,s)},copyFrameRect:function(t,e,n,i,r,s,o,a){this.manager.copyFrameRect(t,e,n,i,r,s,o,a)},bindAndDraw:function(t,e,n,i,r){void 0===n&&(n=!0),void 0===i&&(i=!0);var s=this.gl,o=this.renderer;this.bind(r),this.set1i("uMainSampler",0),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture,0),n&&(i?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT))):(o.popFramebuffer(!1,!1,!1),o.currentFramebuffer||s.viewport(0,0,o.width,o.height)),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),e?(s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null)):o.resetTextures()}});t.exports=u},function(t,e){t.exports=["#define SHADER_NAME PHASER_POSTFX_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","","varying vec2 outTexCoord;","","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}",""].join("\n")},function(t,e,n){var i=n(17),r=n(201),s={Center:n(403),Events:n(104),Orientation:n(404),ScaleManager:n(415),ScaleModes:n(405),Zoom:n(406)};s=i(!1,s,r.CENTER),s=i(!1,s,r.ORIENTATION),s=i(!1,s,r.SCALE_MODE),s=i(!1,s,r.ZOOM),t.exports=s},function(t,e,n){var i=n(145),r=n(17),s={Events:n(20),GetPhysicsPlugins:n(419),GetScenePlugins:n(420),SceneManager:n(417),ScenePlugin:n(1411),Settings:n(421),Systems:n(204)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(18),r=n(0),s=n(20),o=n(2),a=n(24),h=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.pluginStart,this)},boot:function(){this.systems.events.once(s.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(s.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=o(t,"target",!1),n=this.manager.getScene(e);if(!e||!this.checkValidTransition(n))return!1;var i=o(t,"duration",1e3);this._elapsed=0,this._target=n,this._duration=i,this._willSleep=o(t,"sleep",!1),this._willRemove=o(t,"remove",!1);var r=o(t,"onUpdate",null);r&&(this._onUpdate=r,this._onUpdateScope=o(t,"onUpdateScope",this.scene));var a=o(t,"allowInput",!1);this.settings.transitionAllowInput=a;var h=n.sys.settings;return h.isTransition=!0,h.transitionFrom=this.scene,h.transitionDuration=i,h.transitionAllowInput=a,o(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):o(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),n.sys.isSleeping()?n.sys.wake(o(t,"data")):this.manager.start(e,o(t,"data")),this.systems.events.emit(s.TRANSITION_OUT,n,i),this.systems.events.on(s.UPDATE,this.step,this),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(t,e){this._elapsed+=e,this.transitionProgress=i(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;this.systems.events.off(s.UPDATE,this.step,this),t.events.emit(s.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,n,i){return this.manager.add(t,e,n,i)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t){return t!==this.key&&this.manager.queueOp("switch",this.key,t),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,n){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setActive(t,n),this},setVisible:function(t,e){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(s.SHUTDOWN,this.shutdown,this),t.off(s.POST_UPDATE,this.step,this),t.off(s.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});a.register("ScenePlugin",h,"scenePlugin"),t.exports=h},function(t,e,n){t.exports={Events:n(438),List:n(110),Map:n(102),ProcessQueue:n(211),RTree:n(531),Set:n(150),Size:n(416)}},function(t,e,n){var i=n(17),r=n(1414),s={CanvasTexture:n(423),Events:n(106),FilterMode:r,Frame:n(109),Parsers:n(425),Texture:n(206),TextureManager:n(422),TextureSource:n(424)};s=i(!1,s,r),t.exports=s},function(t,e){t.exports={LINEAR:0,NEAREST:1}},function(t,e,n){var i=n(17),r=n(1416),s={Components:n(251),Parsers:n(1449),Formats:n(40),ImageCollection:n(576),ParseToTilemap:n(262),Tile:n(86),Tilemap:n(580),TilemapCreator:n(1456),TilemapFactory:n(1457),Tileset:n(123),TilemapLayer:n(581),Orientation:n(29),LayerData:n(121),MapData:n(122),ObjectLayer:n(572)};s=i(!1,s,r.ORIENTATION),t.exports=s},function(t,e,n){var i={ORIENTATION:n(29)};t.exports=i},function(t,e,n){var i=n(26),r=n(62);t.exports=function(t,e,n,s,o,a,h,u){void 0===h&&(h=!0),t<0&&(t=0),e<0&&(e=0);for(var c=i(t,e,n,s,null,u),l=o-t,f=a-e,d=0;d<c.length;d++){var p=c[d].x+l,v=c[d].y+f;p>=0&&p<u.width&&v>=0&&v<u.height&&u.data[v][p]&&u.data[v][p].copy(c[d])}h&&r(o-1,a-1,n+2,s+2,u)}},function(t,e,n){var i=n(26),r=n(542);t.exports=function(t,e,n,s,o,a){n||(n={}),Array.isArray(t)||(t=[t]);var h=a.tilemapLayer;s||(s=h.scene),o||(o=s.cameras.main);var u,c=i(0,0,a.width,a.height,null,a),l=[];for(u=0;u<c.length;u++){var f=c[u];if(-1!==t.indexOf(f.index)){var d=h.tileToWorldXY(f.x,f.y,void 0,o,a);n.x=d.x,n.y=d.y,l.push(s.make.sprite(n))}}if("number"==typeof e)for(u=0;u<t.length;u++)r(t[u],e,0,0,a.width,a.height,a);else if(Array.isArray(e))for(u=0;u<t.length;u++)r(t[u],e[u],0,0,a.width,a.height,a);return l}},function(t,e,n){var i=n(26),r=n(62),s=n(73);t.exports=function(t,e,n,o,a,h,u){for(var c=-1!==u.collideIndexes.indexOf(t),l=i(e,n,o,a,null,u),f=0;f<l.length;f++)l[f].index=t,s(l[f],c);h&&r(e-1,n-1,o+2,a+2,u)}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a,h){return i(n,r,s,o,a,h).filter(t,e)}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=!1);var r,s,o,a=0;if(n){for(s=i.height-1;s>=0;s--)for(r=i.width-1;r>=0;r--)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}}else for(s=0;s<i.height;s++)for(r=0;r<i.width;r++)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}return null}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a,h){return i(n,r,s,o,a,h).find(t,e)||null}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a,h){i(n,r,s,o,a,h).forEach(t,e)}},function(t,e,n){var i=n(29),r=n(544),s=n(545),o=n(547),a=n(1),h=n(548);t.exports=function(t){return t===i.ORTHOGONAL?r:t===i.HEXAGONAL?s:t===i.STAGGERED?h:t===i.ISOMETRIC?o:a}},function(t,e,n){var i=n(158),r=new(n(3));t.exports=function(t,e,n,s,o){return o.tilemapLayer.worldToTileXY(t,e,!0,r,s),i(r.x,r.y,n,o)}},function(t,e,n){var i=n(483),r=n(26),s=n(484),o=n(1),a=n(3),h=function(t,e){return s.RectangleToTriangle(e,t)},u=new a,c=new a,l=new a;t.exports=function(t,e,n,a){if(void 0===t)return[];var f=o;t instanceof i.Circle?f=s.CircleToRectangle:t instanceof i.Rectangle?f=s.RectangleToRectangle:t instanceof i.Triangle?f=h:t instanceof i.Line&&(f=s.LineToRectangle),a.tilemapLayer.worldToTileXY(t.left,t.top,!0,c,n);var d=c.x,p=c.y;a.tilemapLayer.worldToTileXY(t.right,t.bottom,!0,l,n);var v=Math.ceil(l.x),g=Math.ceil(l.y),m=Math.max(v-d,1),y=Math.max(g-p,1),x=r(d,p,m,y,e,a),b=a.tileWidth,w=a.tileHeight;a.tilemapLayer&&(b*=a.tilemapLayer.scaleX,w*=a.tilemapLayer.scaleY);for(var _=[],T=new i.Rectangle(0,0,b,w),E=0;E<x.length;E++){var S=x[E];a.tilemapLayer.tileToWorldXY(S.x,S.y,u,n),T.x=u.x,T.y=u.y,f(t,T)&&_.push(S)}return _}},function(t,e,n){var i=n(29),r=n(1),s=n(253);t.exports=function(t){return t===i.ORTHOGONAL?s:r}},function(t,e,n){var i=n(29),r=n(550),s=n(551),o=n(1),a=n(552),h=n(553);t.exports=function(t){return t===i.ORTHOGONAL?h:t===i.ISOMETRIC?s:t===i.HEXAGONAL?r:t===i.STAGGERED?a:o}},function(t,e,n){var i=n(29),r=n(554),s=n(1),o=n(555),a=n(254);t.exports=function(t){return t===i.ORTHOGONAL?a:t===i.HEXAGONAL?r:t===i.STAGGERED?o:s}},function(t,e,n){var i=n(29),r=n(1),s=n(255);t.exports=function(t){return t===i.ORTHOGONAL?s:r}},function(t,e,n){var i=n(29),r=n(556),s=n(557),o=n(1),a=n(558),h=n(559);t.exports=function(t){return t===i.ORTHOGONAL?h:t===i.ISOMETRIC?s:t===i.HEXAGONAL?r:t===i.STAGGERED?a:o}},function(t,e,n){var i=n(29),r=n(560),s=n(1),o=n(561),a=n(256);t.exports=function(t){return t===i.ORTHOGONAL?a:t===i.HEXAGONAL?r:t===i.STAGGERED?o:s}},function(t,e,n){var i=n(562),r=new(n(3));t.exports=function(t,e,n,s){s.tilemapLayer.worldToTileXY(t,e,!0,r,n);var o=r.x,a=r.y;return i(o,a,s)}},function(t,e,n){var i=n(257),r=new(n(3));t.exports=function(t,e,n,s,o,a){return a.tilemapLayer.worldToTileXY(e,n,!0,r,o,a),i(t,r.x,r.y,s,a)}},function(t,e,n){var i=n(62),r=n(257);t.exports=function(t,e,n,s,o){if(void 0===s&&(s=!0),!Array.isArray(t))return null;Array.isArray(t[0])||(t=[t]);for(var a=t.length,h=t[0].length,u=0;u<a;u++)for(var c=0;c<h;c++){var l=t[u][c];r(l,e+c,n+u,!1,o)}s&&i(e-1,n-1,h+2,a+2,o)}},function(t,e,n){var i=n(26),r=n(210);t.exports=function(t,e,n,s,o,a){var h,u=i(t,e,n,s,{},a);if(!o)for(o=[],h=0;h<u.length;h++)-1===o.indexOf(u[h].index)&&o.push(u[h].index);for(h=0;h<u.length;h++)u[h].index=r(o)}},function(t,e,n){var i=n(563),r=new(n(3));t.exports=function(t,e,n,s,o,a){return a.tilemapLayer.worldToTileXY(t,e,!0,r,o,a),i(r.x,r.y,n,s,a)}},function(t,e,n){var i=n(26),r=n(397),s=new r(105,210,231,150),o=new r(243,134,48,200),a=new r(40,39,37,150);t.exports=function(t,e,n){void 0===e&&(e={});var r=void 0!==e.tileColor?e.tileColor:s,h=void 0!==e.collidingTileColor?e.collidingTileColor:o,u=void 0!==e.faceColor?e.faceColor:a,c=i(0,0,n.width,n.height,null,n);t.translateCanvas(n.tilemapLayer.x,n.tilemapLayer.y),t.scaleCanvas(n.tilemapLayer.scaleX,n.tilemapLayer.scaleY);for(var l=0;l<c.length;l++){var f=c[l],d=f.width,p=f.height,v=f.pixelX,g=f.pixelY,m=f.collides?h:r;null!==m&&(t.fillStyle(m.color,m.alpha/255),t.fillRect(v,g,d,p)),v+=1,g+=1,d-=2,p-=2,null!==u&&(t.lineStyle(1,u.color,u.alpha/255),f.faceTop&&t.lineBetween(v,g,v+d,g),f.faceRight&&t.lineBetween(v+d,g,v+d,g+p),f.faceBottom&&t.lineBetween(v,g+p,v+d,g+p),f.faceLeft&&t.lineBetween(v,g,v,g+p))}}},function(t,e,n){var i=n(73),r=n(62),s=n(160);t.exports=function(t,e,n,o,a){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===a&&(a=!0),Array.isArray(t)||(t=[t]);for(var h=0;h<t.length;h++)s(t[h],e,o);if(a)for(var u=0;u<o.height;u++)for(var c=0;c<o.width;c++){var l=o.data[u][c];l&&-1!==t.indexOf(l.index)&&i(l,e)}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(73),r=n(62),s=n(160);t.exports=function(t,e,n,o,a,h){if(void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===h&&(h=!0),!(t>e)){for(var u=t;u<=e;u++)s(u,n,a);if(h)for(var c=0;c<a.height;c++)for(var l=0;l<a.width;l++){var f=a.data[c][l];f&&f.index>=t&&f.index<=e&&i(f,n)}o&&r(0,0,a.width,a.height,a)}}},function(t,e,n){var i=n(73),r=n(62),s=n(160);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0),Array.isArray(t)||(t=[t]);for(var a=0;a<o.height;a++)for(var h=0;h<o.width;h++){var u=o.data[a][h];u&&-1===t.indexOf(u.index)&&(i(u,e),s(u.index,e,o))}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(73),r=n(62),s=n(127);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0);for(var a=0;a<o.height;a++)for(var h=0;h<o.width;h++){var u=o.data[a][h];if(u)for(var c in t)if(s(u.properties,c)){var l=t[c];Array.isArray(l)||(l=[l]);for(var f=0;f<l.length;f++)u.properties[c]===l[f]&&i(u,e)}}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(73),r=n(62);t.exports=function(t,e,n){void 0===t&&(t=!0),void 0===e&&(e=!0);for(var s=0;s<n.height;s++)for(var o=0;o<n.width;o++){var a=n.data[s][o];if(a){var h=a.getCollisionGroup();h&&h.objects&&h.objects.length>0&&i(a,t)}}e&&r(0,0,n.width,n.height,n)}},function(t,e){t.exports=function(t,e,n,i){if("number"==typeof t)i.callbacks[t]=null!==e?{callback:e,callbackContext:n}:void 0;else for(var r=0,s=t.length;r<s;r++)i.callbacks[t[r]]=null!==e?{callback:e,callbackContext:n}:void 0}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a){for(var h=i(t,e,n,r,null,a),u=0;u<h.length;u++)h[u].setCollisionCallback(s,o)}},function(t,e,n){var i=n(26),r=n(132);t.exports=function(t,e,n,s,o){var a=i(t,e,n,s,null,o),h=a.map((function(t){return t.index}));r(h);for(var u=0;u<a.length;u++)a[u].index=h[u]}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o,a){for(var h=i(n,r,s,o,null,a),u=0;u<h.length;u++)h[u]&&(h[u].index===t?h[u].index=e:h[u].index===e&&(h[u].index=t))}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s,o){if(s){var a,h=i(t,e,n,r,null,o),u=0;for(a=0;a<s.length;a++)u+=s[a].weight;if(!(u<=0))for(a=0;a<h.length;a++){for(var c=Math.random()*u,l=0,f=-1,d=0;d<s.length;d++)if(c<=(l+=s[d].weight)){var p=s[d].index;f=Array.isArray(p)?p[Math.floor(Math.random()*p.length)]:p;break}h[a].index=f}}}},function(t,e,n){t.exports={FromOrientationString:n(258),Parse:n(564),Parse2DArray:n(259),ParseCSV:n(565),Impact:n(1451),Tiled:n(1452)}},function(t,e){t.exports=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=n;if(i.name&&""!==i.name&&(r=i.name),Array.isArray(i.wangtiles)&&i.wangtiles.length>0){var s,o,a,h={},u={};if(Array.isArray(i.edgecolors))for(s=0;s<i.edgecolors.length;s++)a=1+s,""!==(o=i.edgecolors[s]).name&&(h[a]=o.name);if(Array.isArray(i.cornercolors))for(s=0;s<i.cornercolors.length;s++)a=1+s,""!==(o=i.cornercolors[s]).name&&(u[a]=o.name);if(Array.isArray(i.colors))for(s=0;s<i.colors.length;s++)a=1+s,""!==(o=i.colors[s]).name&&(h[a]=u[a]=o.name);for(var c=[h,u,h,u,h,u,h,u],l=0;l<i.wangtiles.length;l++){var f=i.wangtiles[l],d=e[f.tileid]||(e[f.tileid]={});d=d.wangid||(d.wangid={});for(var p=[],v=0;v<Math.min(c.length,f.wangid.length);v++)if(0!==(o=f.wangid[v])){var g=c[v][o];void 0===g?p.push(o):p.push(g)}else p.push(void 0);d[r]=p}}}}},function(t,e,n){t.exports={ParseTileLayers:n(578),ParseTilesets:n(579),ParseWeltmeister:n(577)}},function(t,e,n){t.exports={AssignTileProperties:n(567),Base64Decode:n(574),BuildTilesetIndex:n(568),CreateGroupLayer:n(161),ParseGID:n(261),ParseImageLayers:n(569),ParseJSONTiled:n(566),ParseObject:n(260),ParseObjectLayers:n(570),ParseTileLayers:n(573),ParseTilesets:n(575)}},function(t,e,n){var i=n(1),r=n(1);i=n(1454),r=n(1455),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n){var r=e.cull(n),s=r.length,o=n.alpha*e.alpha;if(!(0===s||o<=0)){var a=e.gidMap,h=t.pipelines.set(e.pipeline,e),u=i.getTintAppendFloatAlpha,c=e.scrollFactorX,l=e.scrollFactorY,f=e.x,d=e.y,p=e.scaleX,v=e.scaleY;t.pipelines.preBatch(e);for(var g=0;g<s;g++){var m=r[g],y=a[m.index];if(y){var x=y.getTileTextureCoordinates(m.index);if(null!==x){var b=y.glTexture,w=h.setTexture2D(b,e),_=y.tileWidth,T=y.tileHeight,E=x.x,S=x.y,C=.5*y.tileWidth,A=.5*y.tileHeight,I=u(m.tint,o*m.alpha);h.batchTexture(e,b,b.width,b.height,f+(C+m.pixelX)*p,d+(A+m.pixelY)*v,m.width,m.height,p,v,m.rotation,m.flipX,m.flipY,c,l,C,A,E,S,_,T,I,I,I,I,!1,0,0,n,null,!0,w)}}}t.pipelines.postBatch(e)}}},function(t,e,n){var i=n(25),r=new i,s=new i,o=new i;t.exports=function(t,e,n,i){var a=e.cull(n),h=a.length,u=n.alpha*e.alpha;if(!(0===h||u<=0)){var c=r,l=s,f=o;l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),c.copyFrom(n.matrix);var d=t.currentContext,p=e.gidMap;d.save(),i?(c.multiplyWithOffset(i,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y,c.multiply(l,f),f.copyToContext(d)):(l.e-=n.scrollX*e.scrollFactorX,l.f-=n.scrollY*e.scrollFactorY,l.copyToContext(d)),(!t.antialias||e.scaleX>1||e.scaleY>1)&&(d.imageSmoothingEnabled=!1);for(var v=0;v<h;v++){var g=a[v],m=p[g.index];if(m){var y=m.image.getSourceImage(),x=m.getTileTextureCoordinates(g.index);if(null!==x){var b=m.tileWidth,w=m.tileHeight,_=.5*b,T=.5*w;d.save(),d.translate(g.pixelX+_,g.pixelY+T),0!==g.rotation&&d.rotate(g.rotation),(g.flipX||g.flipY)&&d.scale(g.flipX?-1:1,g.flipY?-1:1),d.globalAlpha=u*g.alpha,d.drawImage(y,x.x,x.y,b,w,-_,-T,b,w),d.restore()}}}d.restore()}}},function(t,e,n){var i=n(16),r=n(262);i.register("tilemap",(function(t){var e=void 0!==t?t:{};return r(this.scene,e.key,e.tileWidth,e.tileHeight,e.width,e.height,e.data,e.insertNull)}))},function(t,e,n){var i=n(5),r=n(262);i.register("tilemap",(function(t,e,n,i,s,o,a){return null===t&&(t=void 0),null===e&&(e=void 0),null===n&&(n=void 0),null===i&&(i=void 0),null===s&&(s=void 0),r(this.scene,t,e,n,i,s,o,a)}))},function(t,e,n){t.exports={Clock:n(1459),TimerEvent:n(582)}},function(t,e,n){var i=n(0),r=n(24),s=n(20),o=n(582),a=n(93),h=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(s.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(s.PRE_UPDATE,this.preUpdate,this),t.on(s.UPDATE,this.update,this),t.once(s.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;return t instanceof o?(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=-1===e.repeat||e.loop?999999999999:e.repeat):e=new o(t),this._pendingInsertion.push(e),e},delayedCall:function(t,e,n,i){return this.addEvent({delay:t,callback:e,args:n,callbackScope:i})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];a(this._pendingRemoval,n),a(this._pendingInsertion,n),a(this._active,n)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var n,i;for(n=0;n<t;n++){i=this._pendingRemoval[n];var r=this._active.indexOf(i);r>-1&&this._active.splice(r,1),i.destroy()}for(n=0;n<e;n++)i=this._pendingInsertion[n],this._active.push(i);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var n=0;n<this._active.length;n++){var i=this._active[n];if(!i.paused&&(i.elapsed+=e*i.timeScale,i.elapsed>=i.delay)){var r=i.elapsed-i.delay;i.elapsed=i.delay,!i.hasDispatched&&i.callback&&(i.hasDispatched=!0,i.callback.apply(i.callbackScope,i.args)),i.repeatCount>0?(i.repeatCount--,i.elapsed=r,i.hasDispatched=!1):this._pendingRemoval.push(i)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(s.PRE_UPDATE,this.preUpdate,this),e.off(s.UPDATE,this.update,this),e.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null}});r.register("Clock",h,"time"),t.exports=h},function(t,e,n){var i=n(100),r=n(17),s={Builders:n(1461),Events:n(267),TweenManager:n(1477),Tween:n(266),TweenData:n(268),Timeline:n(588)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={GetBoolean:n(99),GetEaseFunction:n(81),GetNewValue:n(162),GetProps:n(583),GetTargets:n(263),GetTweens:n(584),GetValueOp:n(264),NumberTweenBuilder:n(585),StaggerBuilder:n(586),TimelineBuilder:n(587),TweenBuilder:n(163)}},function(t,e){t.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","loop","loopDelay","offset","onActive","onActiveParams","onActiveScope","onComplete","onCompleteParams","onCompleteScope","onLoop","onLoopParams","onLoopScope","onRepeat","onRepeatParams","onRepeatScope","onStart","onStartParams","onStartScope","onStop","onStopParams","onStopScope","onUpdate","onUpdateParams","onUpdateScope","onYoyo","onYoyoParams","onYoyoScope","paused","props","repeat","repeatDelay","targets","useFrames","yoyo"]},function(t,e){t.exports="complete"},function(t,e){t.exports="loop"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="start"},function(t,e){t.exports="update"},function(t,e){t.exports="active"},function(t,e){t.exports="complete"},function(t,e){t.exports="loop"},function(t,e){t.exports="repeat"},function(t,e){t.exports="start"},function(t,e){t.exports="stop"},function(t,e){t.exports="update"},function(t,e){t.exports="yoyo"},function(t,e,n){var i=n(93),r=n(0),s=n(585),o=n(24),a=n(20),h=n(586),u=n(587),c=n(100),l=n(163),f=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.timeScale=1,this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,t.sys.events.once(a.BOOT,this.boot,this),t.sys.events.on(a.START,this.start,this)},boot:function(){this.systems.events.once(a.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(a.PRE_UPDATE,this.preUpdate,this),t.on(a.UPDATE,this.update,this),t.once(a.SHUTDOWN,this.shutdown,this),this.timeScale=1},createTimeline:function(t){return u(this,t)},timeline:function(t){var e=u(this,t);return e.paused||(this._add.push(e),this._toProcess++),e},create:function(t){return l(this,t)},add:function(t){var e=l(this,t);return this._add.push(e),this._toProcess++,e},existing:function(t){return this._add.push(t),this._toProcess++,this},addCounter:function(t){var e=s(this,t);return this._add.push(e),this._toProcess++,e},stagger:function(t,e){return h(t,e)},preUpdate:function(){if(0!==this._toProcess){var t,e,n=this._destroy,i=this._active,r=this._pending;for(t=0;t<n.length;t++){e=n[t];var s=i.indexOf(e);-1===s?(s=r.indexOf(e))>-1&&(e.state=c.REMOVED,r.splice(s,1)):(e.state=c.REMOVED,i.splice(s,1))}for(n.length=0,n=this._add,t=0;t<n.length;t++)(e=n[t]).state===c.PENDING_ADD&&(e.init()?(e.play(),this._active.push(e)):this._pending.push(e));n.length=0,this._toProcess=0}},update:function(t,e){var n,i=this._active;e*=this.timeScale;for(var r=0;r<i.length;r++)(n=i[r]).update(t,e)&&(this._destroy.push(n),this._toProcess++)},remove:function(t){return i(this._add,t),i(this._pending,t),i(this._active,t),i(this._destroy,t),t.state=c.REMOVED,this},makeActive:function(t){if(-1!==this._add.indexOf(t)||-1!==this._active.indexOf(t))return this;var e=this._pending.indexOf(t);return-1!==e&&this._pending.splice(e,1),this._add.push(t),t.state=c.PENDING_ADD,this._toProcess++,this},each:function(t,e){for(var n=[null],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[0]=this.list[r],t.apply(e,n)},getAllTweens:function(){for(var t=this._active,e=[],n=0;n<t.length;n++)e.push(t[n]);return e},getGlobalTimeScale:function(){return this.timeScale},getTweensOf:function(t,e){void 0===e&&(e=!1);var n,i,r,s=this._active,o=[];for(Array.isArray(t)||(t=[t]),i=0;i<s.length;i++)for(n=s[i],r=0;r<t.length;r++)n.hasTarget(t[r])&&o.push(n);if(e)for(s=this._pending,i=0;i<s.length;i++)for(n=s[i],r=0;r<t.length;r++)n.hasTarget(t[r])&&o.push(n);return o},isTweening:function(t){for(var e,n=this._active,i=0;i<n.length;i++)if((e=n[i]).hasTarget(t)&&e.isPlaying())return!0;return!1},killAll:function(){for(var t=this.getAllTweens(),e=0;e<t.length;e++)t[e].stop();return this},killTweensOf:function(t){for(var e=this.getTweensOf(t),n=0;n<e.length;n++)e[n].stop();return this},pauseAll:function(){for(var t=this._active,e=0;e<t.length;e++)t[e].pause();return this},resumeAll:function(){for(var t=this._active,e=0;e<t.length;e++)t[e].resume();return this},setGlobalTimeScale:function(t){return this.timeScale=t,this},shutdown:function(){this.killAll(),this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0;var t=this.systems.events;t.off(a.PRE_UPDATE,this.preUpdate,this),t.off(a.UPDATE,this.update,this),t.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(a.START,this.start,this),this.scene=null,this.systems=null}});o.register("TweenManager",f,"tweens"),t.exports=f},function(t,e,n){t.exports={Array:n(208),Base64:n(1479),Objects:n(1481),String:n(1485),NOOP:n(1)}},function(t,e,n){t.exports={ArrayBufferToBase64:n(1480),Base64ToArrayBuffer:n(433)}},function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports=function(t,e){for(var i=new Uint8Array(t),r=i.length,s=e?"data:"+e+";base64,":"",o=0;o<r;o+=3)s+=n[i[o]>>2],s+=n[(3&i[o])<<4|i[o+1]>>4],s+=n[(15&i[o+1])<<2|i[o+2]>>6],s+=n[63&i[o+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s}},function(t,e,n){t.exports={Clone:n(78),DeepCopy:n(175),Extend:n(17),GetAdvancedValue:n(13),GetFastValue:n(2),GetMinMaxValue:n(1482),GetValue:n(6),HasAll:n(1483),HasAny:n(455),HasValue:n(127),IsPlainObject:n(7),Merge:n(128),MergeRight:n(1484),Pick:n(571),SetValue:n(478)}},function(t,e,n){var i=n(6),r=n(18);t.exports=function(t,e,n,s,o){void 0===o&&(o=n);var a=i(t,e,o);return r(a,n,s)}},function(t,e){t.exports=function(t,e){for(var n=0;n<e.length;n++)if(!t.hasOwnProperty(e[n]))return!1;return!0}},function(t,e,n){var i=n(78);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)&&(n[r]=e[r]);return n}},function(t,e,n){t.exports={Format:n(1486),Pad:n(186),RemoveAt:n(1487),Reverse:n(1488),UppercaseFirst:n(205),UUID:n(222)}},function(t,e){t.exports=function(t,e){return t.replace(/%([0-9]+)/g,(function(t,n){return e[Number(n)-1]}))}},function(t,e){t.exports=function(t,e){return 0===e?t.slice(1):t.slice(0,e-1)+t.slice(e)}},function(t,e){t.exports=function(t){return t.split("").reverse().join("")}},function(t,e,n){t.exports={SoundManagerCreator:n(426),Events:n(71),BaseSound:n(147),BaseSoundManager:n(146),WebAudioSound:n(434),WebAudioSoundManager:n(432),HTML5AudioSound:n(429),HTML5AudioSoundManager:n(427),NoAudioSound:n(431),NoAudioSoundManager:n(430)}},function(t,e,n){t.exports={Arcade:n(1363),Matter:n(1491)}},function(t,e,n){t.exports={BodyBounds:n(1389),Components:n(249),Events:n(272),Factory:n(1391),MatterGameObject:n(1392),Image:n(1393),Matter:n(594),MatterPhysics:n(1521),PolyDecomp:n(1390),Sprite:n(1394),TileBody:n(593),PhysicsEditorParser:n(589),PhysicsJSONParser:n(590),PointerConstraint:n(1395),World:n(1399)}},function(t,e){t.exports={setBounce:function(t){return this.body.restitution=t,this}}},function(t,e){var n={setCollisionCategory:function(t){return this.body.collisionFilter.category=t,this},setCollisionGroup:function(t){return this.body.collisionFilter.group=t,this},setCollidesWith:function(t){var e=0;if(Array.isArray(t))for(var n=0;n<t.length;n++)e|=t[n];else e=t;return this.body.collisionFilter.mask=e,this},setOnCollide:function(t){return this.body.onCollideCallback=t,this},setOnCollideEnd:function(t){return this.body.onCollideEndCallback=t,this},setOnCollideActive:function(t){return this.body.onCollideActiveCallback=t,this},setOnCollideWith:function(t,e){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n].hasOwnProperty("body")?t[n].body:t[n];this.body.setOnCollideWith(i,e)}return this}};t.exports=n},function(t,e,n){var i=n(41),r={applyForce:function(t){return this._tempVec2.set(this.body.position.x,this.body.position.y),i.applyForce(this.body,this._tempVec2,t),this},applyForceFrom:function(t,e){return i.applyForce(this.body,t,e),this},thrust:function(t){var e=this.body.angle;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustLeft:function(t){var e=this.body.angle-Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustRight:function(t){var e=this.body.angle+Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustBack:function(t){var e=this.body.angle-Math.PI;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this}};t.exports=r},function(t,e){t.exports={setFriction:function(t,e,n){return this.body.friction=t,void 0!==e&&(this.body.frictionAir=e),void 0!==n&&(this.body.frictionStatic=n),this},setFrictionAir:function(t){return this.body.frictionAir=t,this},setFrictionStatic:function(t){return this.body.frictionStatic=t,this}}},function(t,e){t.exports={setIgnoreGravity:function(t){return this.body.ignoreGravity=t,this}}},function(t,e,n){var i=n(41),r=n(3),s={setMass:function(t){return i.setMass(this.body,t),this},setDensity:function(t){return i.setDensity(this.body,t),this},centerOfMass:{get:function(){return new r(this.body.centerOfMass.x,this.body.centerOfMass.y)}}};t.exports=s},function(t,e){t.exports={setSensor:function(t){return this.body.isSensor=t,this},isSensor:function(){return this.body.isSensor}}},function(t,e,n){var i=n(87),r=n(41),s=n(125),o=n(2),a=n(589),h=n(590),u=n(63),c={setRectangle:function(t,e,n){return this.setBody({type:"rectangle",width:t,height:e},n)},setCircle:function(t,e){return this.setBody({type:"circle",radius:t},e)},setPolygon:function(t,e,n){return this.setBody({type:"polygon",sides:e,radius:t},n)},setTrapezoid:function(t,e,n,i){return this.setBody({type:"trapezoid",width:t,height:e,slope:n},i)},setExistingBody:function(t,e){void 0===e&&(e=!0),this.body&&this.world.remove(this.body,!0),this.body=t;for(var n=0;n<t.parts.length;n++)t.parts[n].gameObject=this;var i=this;if(t.destroy=function(){i.world.remove(i.body,!0),i.body.gameObject=null},e&&(this.world.has(t)&&this.world.remove(t,!0),this.world.add(t)),this._originComponent){var r=t.render.sprite.xOffset,o=t.render.sprite.yOffset,a=t.centerOfMass.x,h=t.centerOfMass.y;if(s(a,.5)&&s(h,.5))this.setOrigin(r+.5,o+.5);else{var u=t.centerOffset.x,c=t.centerOffset.y;this.setOrigin(r+u/this.displayWidth,o+c/this.displayHeight)}}return this},setBody:function(t,e){if(!t)return this;var n;"string"==typeof t&&(t={type:t});var s=o(t,"type","rectangle"),c=o(t,"x",this._tempVec2.x),l=o(t,"y",this._tempVec2.y),f=o(t,"width",this.width),d=o(t,"height",this.height);switch(s){case"rectangle":n=i.rectangle(c,l,f,d,e);break;case"circle":var p=o(t,"radius",Math.max(f,d)/2),v=o(t,"maxSides",25);n=i.circle(c,l,p,e,v);break;case"trapezoid":var g=o(t,"slope",.5);n=i.trapezoid(c,l,f,d,g,e);break;case"polygon":var m=o(t,"sides",5),y=o(t,"radius",Math.max(f,d)/2);n=i.polygon(c,l,m,y,e);break;case"fromVertices":case"fromVerts":var x=o(t,"verts",null);if(x)if("string"==typeof x&&(x=u.fromPath(x)),this.body&&!this.body.hasOwnProperty("temp"))r.setVertices(this.body,x),n=this.body;else{var b=o(t,"flagInternal",!1),w=o(t,"removeCollinear",.01),_=o(t,"minimumArea",10);n=i.fromVertices(c,l,x,e,b,w,_)}break;case"fromPhysicsEditor":n=a.parseBody(c,l,t,e);break;case"fromPhysicsTracer":n=h.parseBody(c,l,t,e)}return n&&this.setExistingBody(n,t.addToWorld),this}};t.exports=c},function(t,e,n){var i=n(272),r=n(165),s=n(166),o={setToSleep:function(){return r.set(this.body,!0),this},setAwake:function(){return r.set(this.body,!1),this},setSleepThreshold:function(t){return void 0===t&&(t=60),this.body.sleepThreshold=t,this},setSleepEvents:function(t,e){return this.setSleepStartEvent(t),this.setSleepEndEvent(e),this},setSleepStartEvent:function(t){if(t){var e=this.world;s.on(this.body,"sleepStart",(function(t){e.emit(i.SLEEP_START,t,this)}))}else s.off(this.body,"sleepStart");return this},setSleepEndEvent:function(t){if(t){var e=this.world;s.on(this.body,"sleepEnd",(function(t){e.emit(i.SLEEP_END,t,this)}))}else s.off(this.body,"sleepEnd");return this}};t.exports=o},function(t,e){t.exports="afteradd"},function(t,e){t.exports="afterremove"},function(t,e){t.exports="afterupdate"},function(t,e){t.exports="beforeadd"},function(t,e){t.exports="beforeremove"},function(t,e){t.exports="beforeupdate"},function(t,e){t.exports="collisionactive"},function(t,e){t.exports="collisionend"},function(t,e){t.exports="collisionstart"},function(t,e){t.exports="dragend"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="sleepend"},function(t,e){t.exports="sleepstart"},function(t,e,n){var i=n(41),r={setStatic:function(t){return i.setStatic(this.body,t),this},isStatic:function(){return this.body.isStatic}};t.exports=r},function(t,e,n){var i=n(41),r=n(14),s=n(269),o=n(270),a={x:{get:function(){return this.body.position.x},set:function(t){this._tempVec2.set(t,this.y),i.setPosition(this.body,this._tempVec2)}},y:{get:function(){return this.body.position.y},set:function(t){this._tempVec2.set(this.x,t),i.setPosition(this.body,this._tempVec2)}},scaleX:{get:function(){return this._scaleX},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleX=t,0===this._scaleX?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,t,this._scaleY)}},scaleY:{get:function(){return this._scaleY},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleY=t,0===this._scaleY?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,this._scaleX,t)}},angle:{get:function(){return o(this.body.angle*r.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*r.DEG_TO_RAD}},rotation:{get:function(){return this.body.angle},set:function(t){this._rotation=s(t),i.setAngle(this.body,this._rotation)}},setPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._tempVec2.set(t,e),i.setPosition(this.body,this._tempVec2),this},setRotation:function(t){return void 0===t&&(t=0),this._rotation=s(t),i.setAngle(this.body,t),this},setFixedRotation:function(){return i.setInertia(this.body,1/0),this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,i.setAngle(this.body,this.rotation),this},setScale:function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=t);var r=1/this._scaleX,s=1/this._scaleY;return this._scaleX=t,this._scaleY=e,i.scale(this.body,r,s,n),i.scale(this.body,t,e,n),this}};t.exports=a},function(t,e,n){var i=n(41),r={setAngularVelocity:function(t){return i.setAngularVelocity(this.body,t),this},setVelocityX:function(t){return this._tempVec2.set(t,this.body.velocity.y),i.setVelocity(this.body,this._tempVec2),this},setVelocityY:function(t){return this._tempVec2.set(this.body.velocity.x,t),i.setVelocity(this.body,this._tempVec2),this},setVelocity:function(t,e){return this._tempVec2.set(t,e),i.setVelocity(this.body,this._tempVec2),this}};t.exports=r},function(t,e,n){var i={};t.exports=i;var r=n(119),s=n(32);i.create=function(t){return s.extend({extended:!1,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:1e-4,midEff:1e-4,broadEff:1e-4,collisions:0,buckets:0,bodies:0,pairs:0},!1,t)},i.reset=function(t){t.extended&&(t.narrowDetections=0,t.narrowphaseTests=0,t.narrowReuse=0,t.narrowReuseCount=0,t.midphaseTests=0,t.broadphaseTests=0,t.narrowEff=0,t.midEff=0,t.broadEff=0,t.collisions=0,t.buckets=0,t.pairs=0,t.bodies=0)},i.update=function(t,e){if(t.extended){var n=e.world,i=r.allBodies(n);t.collisions=t.narrowDetections,t.pairs=e.pairs.list.length,t.bodies=i.length,t.midEff=(t.narrowDetections/(t.midphaseTests||1)).toFixed(2),t.narrowEff=(t.narrowDetections/(t.narrowphaseTests||1)).toFixed(2),t.broadEff=(1-t.broadphaseTests/(i.length||1)).toFixed(2),t.narrowReuse=(t.narrowReuseCount/(t.narrowphaseTests||1)).toFixed(2)}}},function(t,e,n){var i=n(124),r=n(271),s=n(87),o=n(41),a=n(1389),h=n(85),u=n(0),c=n(119),l=n(591),f=n(129),d=n(273),p=n(50),v=n(1391),g=n(2),m=n(6),y=n(597),x=n(1522),b=n(1523),w=n(1396),_=n(1524),T=n(128),E=n(250),S=n(598),C=n(595),A=n(24),I=n(1397),P=n(599),R=n(274),O=n(20),k=n(592),M=n(84),D=n(63),L=n(1399),N=new u({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this.bodyBounds,this.body=o,this.composite=c,this.detector=d,this.grid=y,this.pair=E,this.pairs=S,this.query=I,this.resolver=P,this.sat=R,this.constraint=f,this.bodies=s,this.composites=l,this.axes=r,this.bounds=h,this.svg=k,this.vector=M,this.vertices=D,this.verts=D,this._tempVec2=M.create(),m(this.config,"plugins.collisionevents",!0)&&this.enableCollisionEventsPlugin(),m(this.config,"plugins.attractors",!1)&&this.enableAttractorPlugin(),m(this.config,"plugins.wrap",!1)&&this.enableWrapPlugin(),P._restingThresh=m(this.config,"restingThresh",4),P._restingThreshTangent=m(this.config,"restingThreshTangent",6),P._positionDampen=m(this.config,"positionDampen",.9),P._positionWarming=m(this.config,"positionWarming",.8),P._frictionNormalMultiplier=m(this.config,"frictionNormalMultiplier",5),t.sys.events.once(O.BOOT,this.boot,this),t.sys.events.on(O.START,this.start,this)},boot:function(){this.world=new L(this.scene,this.config),this.add=new v(this.world),this.bodyBounds=new a,this.systems.events.once(O.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new L(this.scene,this.config),this.add=new v(this.world));var t=this.systems.events;t.on(O.UPDATE,this.world.update,this.world),t.on(O.POST_UPDATE,this.world.postUpdate,this.world),t.once(O.SHUTDOWN,this.shutdown,this)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return T(g(e,"matter",{}),g(t,"matter",{}))},enableAttractorPlugin:function(){return C.register(x),C.use(w,x),this},enableWrapPlugin:function(){return C.register(_),C.use(w,_),this},enableCollisionEventsPlugin:function(){return C.register(b),C.use(w,b),this},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},set60Hz:function(){return this.world.getDelta=this.world.update60Hz,this.world.autoUpdate=!0,this},set30Hz:function(){return this.world.getDelta=this.world.update30Hz,this.world.autoUpdate=!0,this},step:function(t,e){this.world.step(t,e)},containsPoint:function(t,e,n){t=this.getMatterBodies(t);var i=M.create(e,n);return I.point(t,i).length>0},intersectPoint:function(t,e,n){n=this.getMatterBodies(n);var i=M.create(t,e),r=[];return I.point(n,i).forEach((function(t){-1===r.indexOf(t)&&r.push(t)})),r},intersectRect:function(t,e,n,i,r,s){void 0===r&&(r=!1),s=this.getMatterBodies(s);var o={min:{x:t,y:e},max:{x:t+n,y:e+i}},a=[];return I.region(s,o,r).forEach((function(t){-1===a.indexOf(t)&&a.push(t)})),a},intersectRay:function(t,e,n,i,r,s){void 0===r&&(r=1),s=this.getMatterBodies(s);for(var o=[],a=I.ray(s,M.create(t,e),M.create(n,i),r),h=0;h<a.length;h++)o.push(a[h].body);return o},intersectBody:function(t,e){e=this.getMatterBodies(e);for(var n=[],i=I.collides(t,e),r=0;r<i.length;r++){var s=i[r];s.bodyA===t?n.push(s.bodyB):n.push(s.bodyA)}return n},overlap:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),Array.isArray(t)||(t=[t]),t=this.getMatterBodies(t),e=this.getMatterBodies(e);for(var s=!1,o=0;o<t.length;o++)for(var a=t[o],h=I.collides(a,e),u=0;u<h.length;u++){var c=h[u],l=c.bodyA.id===a.id?c.bodyB:c.bodyA;if(!i||i.call(r,a,l,c))if(s=!0,n)n.call(r,a,l,c);else if(!i)return!0}return s},setCollisionCategory:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){t.collisionFilter.category=e})),this},setCollisionGroup:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){t.collisionFilter.group=e})),this},setCollidesWith:function(t,e){t=this.getMatterBodies(t);var n=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)n|=e[i];else n=e;return t.forEach((function(t){t.collisionFilter.mask=n})),this},getMatterBodies:function(t){if(!t)return this.world.getAllBodies();Array.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++){var i=t[n].hasOwnProperty("body")?t[n].body:t[n];e.push(i)}return e},setVelocity:function(t,e,n){t=this.getMatterBodies(t);var i=this._tempVec2;return i.x=e,i.y=n,t.forEach((function(t){o.setVelocity(t,i)})),this},setVelocityX:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return n.x=e,t.forEach((function(t){n.y=t.velocity.y,o.setVelocity(t,n)})),this},setVelocityY:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return n.y=e,t.forEach((function(t){n.x=t.velocity.x,o.setVelocity(t,n)})),this},setAngularVelocity:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){o.setAngularVelocity(t,e)})),this},applyForce:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return t.forEach((function(t){n.x=t.position.x,n.y=t.position.y,o.applyForce(t,n,e)})),this},applyForceFromPosition:function(t,e,n,i){t=this.getMatterBodies(t);var r=this._tempVec2;return t.forEach((function(t){void 0===i&&(i=t.angle),r.x=n*Math.cos(i),r.y=n*Math.sin(i),o.applyForce(t,e,r)})),this},applyForceFromAngle:function(t,e,n){t=this.getMatterBodies(t);var i=this._tempVec2;return t.forEach((function(t){void 0===n&&(n=t.angle),i.x=e*Math.cos(n),i.y=e*Math.sin(n),o.applyForce(t,{x:t.position.x,y:t.position.y},i)})),this},getConstraintLength:function(t){var e=t.pointA.x,n=t.pointA.y,i=t.pointB.x,r=t.pointB.y;return t.bodyA&&(e+=t.bodyA.position.x,n+=t.bodyA.position.y),t.bodyB&&(i+=t.bodyB.position.x,r+=t.bodyB.position.y),p(e,n,i,r)},alignBody:function(t,e,n,r){var s;switch(t=t.hasOwnProperty("body")?t.body:t,r){case i.TOP_LEFT:case i.LEFT_TOP:s=this.bodyBounds.getTopLeft(t,e,n);break;case i.TOP_CENTER:s=this.bodyBounds.getTopCenter(t,e,n);break;case i.TOP_RIGHT:case i.RIGHT_TOP:s=this.bodyBounds.getTopRight(t,e,n);break;case i.LEFT_CENTER:s=this.bodyBounds.getLeftCenter(t,e,n);break;case i.CENTER:s=this.bodyBounds.getCenter(t,e,n);break;case i.RIGHT_CENTER:s=this.bodyBounds.getRightCenter(t,e,n);break;case i.LEFT_BOTTOM:case i.BOTTOM_LEFT:s=this.bodyBounds.getBottomLeft(t,e,n);break;case i.BOTTOM_CENTER:s=this.bodyBounds.getBottomCenter(t,e,n);break;case i.BOTTOM_RIGHT:case i.RIGHT_BOTTOM:s=this.bodyBounds.getBottomRight(t,e,n)}return s&&o.setPosition(t,s),this},shutdown:function(){var t=this.systems.events;this.world&&(t.off(O.UPDATE,this.world.update,this.world),t.off(O.POST_UPDATE,this.world.postUpdate,this.world)),t.off(O.SHUTDOWN,this.shutdown,this),this.add&&this.add.destroy(),this.world&&this.world.destroy(),this.add=null,this.world=null},destroy:function(){this.shutdown(),this.scene.sys.events.off(O.START,this.start,this),this.scene=null,this.systems=null}});A.register("MatterPhysics",N,"matterPhysics"),t.exports=N},function(t,e,n){var i=n(594),r={name:"matter-attractors",version:"0.1.7",for:"matter-js@^0.14.2",silent:!0,install:function(t){t.after("Body.create",(function(){r.Body.init(this)})),t.before("Engine.update",(function(t){r.Engine.update(t)}))},Body:{init:function(t){t.plugin.attractors=t.plugin.attractors||[]}},Engine:{update:function(t){for(var e=i.Composite.allBodies(t.world),n=0;n<e.length;n++){var r=e[n],s=r.plugin.attractors;if(s&&s.length>0)for(var o=0;o<e.length;o++){var a=e[o];if(n!==o)for(var h=0;h<s.length;h++){var u=s[h],c=u;i.Common.isFunction(u)&&(c=u(r,a)),c&&i.Body.applyForce(a,a.position,c)}}}}},Attractors:{gravityConstant:.001,gravity:function(t,e){var n=i.Vector.sub(e.position,t.position),s=i.Vector.magnitudeSquared(n)||1e-4,o=i.Vector.normalise(n),a=-r.Attractors.gravityConstant*(t.mass*e.mass/s),h=i.Vector.mult(o,a);i.Body.applyForce(t,t.position,i.Vector.neg(h)),i.Body.applyForce(e,e.position,h)}}};t.exports=r},function(t,e){t.exports={name:"matter-collision-events",version:"0.1.6",for:"matter-js@^0.14.2",silent:!0,install:function(t){t.after("Engine.create",(function(){t.Events.on(this,"collisionStart",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collide",n,i,e),i.gameObject&&i.gameObject.emit("collide",i,n,e),t.Events.trigger(n,"onCollide",{pair:e}),t.Events.trigger(i,"onCollide",{pair:e}),n.onCollideCallback&&n.onCollideCallback(e),i.onCollideCallback&&i.onCollideCallback(e),n.onCollideWith[i.id]&&n.onCollideWith[i.id](i,e),i.onCollideWith[n.id]&&i.onCollideWith[n.id](n,e)}))})),t.Events.on(this,"collisionActive",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collideActive",n,i,e),i.gameObject&&i.gameObject.emit("collideActive",i,n,e),t.Events.trigger(n,"onCollideActive",{pair:e}),t.Events.trigger(i,"onCollideActive",{pair:e}),n.onCollideActiveCallback&&n.onCollideActiveCallback(e),i.onCollideActiveCallback&&i.onCollideActiveCallback(e)}))})),t.Events.on(this,"collisionEnd",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collideEnd",n,i,e),i.gameObject&&i.gameObject.emit("collideEnd",i,n,e),t.Events.trigger(n,"onCollideEnd",{pair:e}),t.Events.trigger(i,"onCollideEnd",{pair:e}),n.onCollideEndCallback&&n.onCollideEndCallback(e),i.onCollideEndCallback&&i.onCollideEndCallback(e)}))}))}))}}},function(t,e,n){var i=n(594),r={name:"matter-wrap",version:"0.1.4",for:"matter-js@^0.14.2",silent:!0,install:function(t){t.after("Engine.update",(function(){r.Engine.update(this)}))},Engine:{update:function(t){for(var e=t.world,n=i.Composite.allBodies(e),s=i.Composite.allComposites(e),o=0;o<n.length;o+=1){var a=n[o];a.plugin.wrap&&r.Body.wrap(a,a.plugin.wrap)}for(o=0;o<s.length;o+=1){var h=s[o];h.plugin.wrap&&r.Composite.wrap(h,h.plugin.wrap)}}},Bounds:{wrap:function(t,e){var n=null,i=null;if(void 0!==e.min.x&&void 0!==e.max.x&&(t.min.x>e.max.x?n=e.min.x-t.max.x:t.max.x<e.min.x&&(n=e.max.x-t.min.x)),void 0!==e.min.y&&void 0!==e.max.y&&(t.min.y>e.max.y?i=e.min.y-t.max.y:t.max.y<e.min.y&&(i=e.max.y-t.min.y)),null!==n||null!==i)return{x:n||0,y:i||0}}},Body:{wrap:function(t,e){var n=r.Bounds.wrap(t.bounds,e);return n&&i.Body.translate(t,n),n}},Composite:{bounds:function(t){for(var e=i.Composite.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return i.Bounds.create(n)},wrap:function(t,e){var n=r.Bounds.wrap(r.Composite.bounds(t),e);return n&&i.Composite.translate(t,n),n}}};t.exports=r},function(t,e,n){(function(e){var i=n(33),r=n(17),s={Actions:n(275),Animations:n(723),BlendModes:n(35),Cache:n(735),Cameras:n(738),Core:n(806),Class:n(0),Create:n(887),Curves:n(893),Data:n(895),Display:n(897),DOM:n(916),Events:n(917),Game:n(919),GameObjects:n(1010),Geom:n(483),Input:n(1305),Loader:n(1335),Math:n(193),Physics:n(1490),Plugins:n(1400),Renderer:n(1402),Scale:n(1409),ScaleModes:n(168),Scene:n(418),Scenes:n(1410),Structs:n(1412),Textures:n(1413),Tilemaps:n(1415),Time:n(1458),Tweens:n(1460),Utils:n(1478)};s.Sound=n(1489),s=r(!1,s,i),t.exports=s,e.Phaser=s}).call(this,n(600))}])},t.exports=e()},751:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=e.io=e.Manager=e.protocol=void 0;const i=n(744),r=n(703),s=n(277);Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return s.Socket}});const o=n(227)("socket.io-client");t.exports=e=h;const a=e.managers={};function h(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};const n=i.url(t,e.path),s=n.source,h=n.id,u=n.path,c=a[h]&&u in a[h].nsps;let l;return e.forceNew||e["force new connection"]||!1===e.multiplex||c?(o("ignoring socket cache for %s",s),l=new r.Manager(s,e)):(a[h]||(o("new io instance for %s",s),a[h]=new r.Manager(s,e)),l=a[h]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}e.io=h;var u=n(485);Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return u.protocol}}),e.connect=h;var c=n(703);Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return c.Manager}})},703:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;const i=n(983),r=n(277),s=n(485),o=n(657),a=n(10),h=n(791),u=n(227)("socket.io-client:manager");class c extends h.StrictEventEmitter{constructor(t,e){super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(u("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=i(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=o.on(e,"open",(function(){n.onopen(),t&&t()})),s=o.on(e,"error",(e=>{u("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;u("connect attempt will timeout after %d",t),0===t&&r();const n=setTimeout((()=>{u("connect attempt timed out after %d",t),r(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){u("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(o.on(t,"ping",this.onping.bind(this)),o.on(t,"data",this.ondata.bind(this)),o.on(t,"error",this.onerror.bind(this)),o.on(t,"close",this.onclose.bind(this)),o.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){u("error",t),this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new r.Socket(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return void u("socket %s is still active, skipping close",t);this._close()}_packet(t){u("writing packet %j",t);const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){u("cleanup"),this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){u("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){u("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this._reconnecting=!0;const n=setTimeout((()=>{t.skipReconnect||(u("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(u("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(u("reconnect success"),t.onreconnect())})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}e.Manager=c},657:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,n){return t.on(e,n),function(){t.off(e,n)}}},277:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;const i=n(485),r=n(657),s=n(791),o=n(227)("socket.io-client:socket"),a=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class h extends s.StrictEventEmitter{constructor(t,e,n){super(),this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[r.on(t,"open",this.onopen.bind(this)),r.on(t,"packet",this.onpacket.bind(this)),r.on(t,"error",this.onerror.bind(this)),r.on(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(a.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:i.PacketType.EVENT,data:e,options:{}};n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(o("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++);const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||r&&this.connected?this.connected?this.packet(n):this.sendBuffer.push(n):o("discard packet as the transport is not currently writable"),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){o("transport is open - connecting"),"function"==typeof this.auth?this.auth((t=>{this.packet({type:i.PacketType.CONNECT,data:t})})):this.packet({type:i.PacketType.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){o("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case i.PacketType.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case i.PacketType.EVENT:case i.PacketType.BINARY_EVENT:this.onevent(t);break;case i.PacketType.ACK:case i.PacketType.BINARY_ACK:this.onack(t);break;case i.PacketType.DISCONNECT:this.ondisconnect();break;case i.PacketType.CONNECT_ERROR:const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];o("emitting event %j",e),null!=t.id&&(o("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...r){n||(n=!0,o("sending ack %j",r),e.packet({type:i.PacketType.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];"function"==typeof e?(o("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):o("bad ack %s",t.id)}onconnect(t){o("socket connected with id %s",t),this.id=t,this.connected=!0,this.disconnected=!1,this.emitReserved("connect"),this.emitBuffered()}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>this.packet(t))),this.sendBuffer=[]}ondisconnect(){o("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(o("performing disconnect (%s)",this.nsp),this.packet({type:i.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}e.Socket=h},791:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StrictEventEmitter=void 0;const i=n(767);e.StrictEventEmitter=class extends i{on(t,e){return super.on(t,e),this}once(t,e){return super.once(t,e),this}emit(t,...e){return super.emit(t,...e),this}emitReserved(t,...e){return super.emit(t,...e),this}listeners(t){return super.listeners(t)}}},744:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;const i=n(187),r=n(227)("socket.io-client:url");e.url=function(t,e="",n){let s=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),r("parse %s",t),s=i(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const o=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+o+":"+s.port+e,s.href=s.protocol+"://"+o+(n&&n.port===s.port?"":":"+s.port),s}},719:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;const i=n(986);function r(t,e){if(!t)return t;if(i.isBinary(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=r(t[i],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const i in t)t.hasOwnProperty(i)&&(n[i]=r(t[i],e));return n}return t}function s(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=s(t[n],e);else if("object"==typeof t)for(const n in t)t.hasOwnProperty(n)&&(t[n]=s(t[n],e));return t}e.deconstructPacket=function(t){const e=[],n=t.data,i=t;return i.data=r(n,e),i.attachments=e.length,{packet:i,buffers:e}},e.reconstructPacket=function(t,e){return t.data=s(t.data,e),t.attachments=void 0,t}},485:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;const i=n(767),r=n(719),s=n(986),o=n(227)("socket.io-parser");var a;e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(a=e.PacketType||(e.PacketType={})),e.Encoder=class{encode(t){return o("encoding packet %j",t),t.type!==a.EVENT&&t.type!==a.ACK||!s.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==a.BINARY_EVENT&&t.type!==a.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),o("encoded %j as %s",t,e),e}encodeAsBinary(t){const e=r.deconstructPacket(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}};class h extends i{constructor(){super()}add(t){let e;if("string"==typeof t)e=this.decodeString(t),e.type===a.BINARY_EVENT||e.type===a.BINARY_ACK?(this.reconstructor=new u(e),0===e.attachments&&super.emit("decoded",e)):super.emit("decoded",e);else{if(!s.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emit("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===a[n.type])throw new Error("unknown packet type "+n.type);if(n.type===a.BINARY_EVENT||n.type===a.BINARY_ACK){const i=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const r=t.substring(i,e);if(r!=Number(r)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(e+1)){const i=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(i,e)}else n.nsp="/";const i=t.charAt(e+1);if(""!==i&&Number(i)==i){const i=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!h.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return o("decoded %s as %j",t,n),n}static isPayloadValid(t,e){switch(t){case a.CONNECT:return"object"==typeof e;case a.DISCONNECT:return void 0===e;case a.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}e.Decoder=h;class u{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},986:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;const n="function"==typeof ArrayBuffer,i=Object.prototype.toString,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);function o(t){return n&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||r&&t instanceof Blob||s&&t instanceof File}e.isBinary=o,e.hasBinary=function t(e,n){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let n=0,i=e.length;n<i;n++)if(t(e[n]))return!0;return!1}if(o(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return!0;return!1}},281:t=>{"use strict";var e,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={},r=0,s=0;function o(t){var e="";do{e=n[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function a(){var t=o(+new Date);return t!==e?(r=0,e=t):t+"."+o(r++)}for(;s<64;s++)i[n[s]]=s;a.encode=o,a.decode=function(t){var e=0;for(s=0;s<t.length;s++)e=64*e+i[t.charAt(s)];return e},t.exports=a}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t={socket:n(751)(),mapHeight:1e3,mapWidth:2e3};var e=n(260),i=n.n(e),r=n(984);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var i=t[e];if(i&&i.Math==Math)return i}return globalThis}(this);function s(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:s(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var s=0;s<t.length-1;s++){var o=t[s];o in r||(r[o]={}),r=r[o]}(n=n(s=r[t=t[t.length-1]]))!=s&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var s=i.setTimeout;n.prototype.c=function(t){s(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new n;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(t){s(t)}}:e}var r,s,o=new e((function(t,e){r=t,s=e}));return this.Qa(i(t,r),i(n,s)),o},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=o(t),s=i.next();!s.done;s=i.next())r(s.value).Qa(e,n)}))},e.all=function(t){var n=o(t),i=n.next();return i.done?r([]):new e((function(t,e){function s(e){return function(n){o[e]=n,0==--a&&t(o)}}var o=[],a=0;do{o.push(void 0),a++,r(i.value).Qa(s(o.length-1),e),i=n.next()}while(!i.done)}))},e}));var a=a||{},h=this||self,u=/^[\w+/_-]+[=]{0,2}$/,c=null;function l(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&u.test(t)?t:""}function f(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function m(t){return Object.prototype.hasOwnProperty.call(t,y)&&t[y]||(t[y]=++x)}var y="closure_uid_"+(1e9*Math.random()>>>0),x=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function A(t,e,n){this.code=R+t,this.message=e||O[t]||"",this.a=n||null}function I(t){var e=t&&t.code;return e?new A(e.substring(R.length),t.message,t.serverResponse):null}S(A,Error),A.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},A.prototype.toJSON=function(){return this.w()};var P,R="auth/",O={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},k={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function M(t){for(var e in k)if(k[e].id===t)return{firebaseEndpoint:(t=k[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function D(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");L.call(this,n+t[i])}function F(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function B(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function U(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function V(){this.b=this.a=null}P=M("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(N,L),N.prototype.name="AssertionError",B.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Y=new B((function(){return new X}),(function(t){t.reset()}));function z(){var t=be,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function X(){this.next=this.b=this.a=null}V.prototype.add=function(t,e){var n=Y.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},X.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},X.prototype.reset=function(){this.next=this.b=this.a=null};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)},W=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=[],r=0,s="string"==typeof t?t.split(""):t,o=0;o<n;o++)if(o in s){var a=s[o];e.call(void 0,a,o,t)&&(i[r++]=a)}return i},H=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r="string"==typeof t?t.split(""):t,s=0;s<n;s++)s in r&&(i[s]=e.call(void 0,r[s],s,t));return i},q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function K(t,e){return 0<=G(t,e)}function Q(t,e){var n;return(n=0<=(e=G(t,e)))&&Array.prototype.splice.call(t,e,1),n}function Z(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,(function(n,i){e.call(void 0,n,i,t)&&Array.prototype.splice.call(t,i,1).length}))}function J(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,it=/</g,rt=/>/g,st=/"/g,ot=/'/g,at=/\x00/g,ht=/[\x00&<>"']/;function ut(t,e){return-1!=t.indexOf(e)}function ct(t,e){return t<e?-1:t>e?1:0}t:{var lt=h.navigator;if(lt){var ft=lt.userAgent;if(ft){tt=ft;break t}}tt=""}function dt(t){return ut(tt,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var s=0;s<mt.length;s++)n=mt[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function xt(t,e){t:{try{var n=t&&t.ownerDocument,i=n&&(n.defaultView||n.parentWindow);if((i=i||h).Element&&i.Location){var r=i;break t}}catch(t){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(g(t))try{var s=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){s="<object could not be stringified>"}else s=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,s)}}function bt(t,e){this.a=t===Et&&e||"",this.b=Tt}function wt(t){return t instanceof bt&&t.constructor===bt&&t.b===Tt?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}bt.prototype.sa=!0,bt.prototype.ra=function(){return this.a},bt.prototype.toString=function(){return"Const{"+this.a+"}"};var _t,Tt={},Et={};function St(){if(void 0===_t){var t=null,e=h.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){h.console&&h.console.error(t.message)}_t=t}else _t=t}return _t}function Ct(t,e){this.a=e===Ot?t:""}function At(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function It(t,e){var n=wt(t);if(!Rt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,Ot)}(t=n.replace(Pt,(function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error('Found marker, "'+i+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[i])instanceof bt?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.sa=!0,Ct.prototype.ra=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Pt=/%{(\w+)}/g,Rt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ot={};function kt(t,e){this.a=e===Ut?t:""}function Mt(t){return t instanceof kt&&t.constructor===kt?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}kt.prototype.sa=!0,kt.prototype.ra=function(){return this.a.toString()},kt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Dt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Nt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof kt)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Nt.test(t))t=new kt(t,Ut);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&Dt.test(e[1])?new kt(t,Ut):null}return t}function Bt(t){return t instanceof kt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Nt.test(t)||(t="about:invalid#zClosurez"),new kt(t,Ut))}var Ut={},Vt=new kt("about:invalid#zClosurez",Ut);function Yt(t,e,n){this.a=n===zt?t:""}Yt.prototype.sa=!0,Yt.prototype.ra=function(){return this.a.toString()},Yt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var zt={};function Xt(t,e,n,i){return t=t instanceof kt?t:Bt(t),e=e||h,n=n instanceof bt?wt(n):n||"",e.open(Mt(t),n,i,void 0)}function Gt(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function jt(t){return ht.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(it,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(rt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(st,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ot,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(at,"&#0;"))),t}function Wt(t){return Wt[" "](t),t}Wt[" "]=f;var Ht,qt,Kt=dt("Opera"),Qt=dt("Trident")||dt("MSIE"),Zt=dt("Edge"),Jt=Zt||Qt,$t=dt("Gecko")&&!(ut(tt.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),te=ut(tt.toLowerCase(),"webkit")&&!dt("Edge");function ee(){var t=h.document;return t?t.documentMode:void 0}t:{var ne="",ie=(qt=tt,$t?/rv:([^\);]+)(\)|;)/.exec(qt):Zt?/Edge\/([\d\.]+)/.exec(qt):Qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(qt):te?/WebKit\/(\S+)/.exec(qt):Kt?/(?:Version)[ \/]?(\S+)/.exec(qt):void 0);if(ie&&(ne=ie?ie[1]:""),Qt){var re=ee();if(null!=re&&re>parseFloat(ne)){Ht=String(re);break t}}Ht=ne}var se,oe={};function ae(t){return function(t,e){var n=oe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=et(String(Ht)).split("."),i=et(String(t)).split("."),r=Math.max(n.length,i.length),s=0;0==e&&s<r;s++){var o=n[s]||"",a=i[s]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=ct(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||ct(0==o[2].length,0==a[2].length)||ct(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e}))}h.document&&Qt?se=ee()||parseInt(Ht,10)||void 0:se=void 0;var he=se;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(qt){}var ue=!Qt||9<=Number(he);function ce(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function le(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:pe.hasOwnProperty(n)?t.setAttribute(pe[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,de,pe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function i(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var s=n[r];if(!p(s)||g(s)&&0<s.nodeType)i(s);else{t:{if(s&&"number"==typeof s.length){if(g(s)){var o="function"==typeof s.item||"string"==typeof s.item;break t}if(v(s)){o="function"==typeof s.item;break t}}o=!1}j(o?$(s):s,i)}}}function ge(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){h.setTimeout((function(){throw t}),0)}function ye(t,e){de||function(){if(h.Promise&&h.Promise.resolve){var t=h.Promise.resolve(void 0);de=function(){t.then(we)}}else de=function(){var t=we;!v(h.setImmediate)||h.Window&&h.Window.prototype&&!dt("Edge")&&h.Window.prototype.setImmediate==h.setImmediate?(fe||(fe=function(){var t=h.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=ge(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_((function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){i.next={Gb:t},i=i.next,e.port2.postMessage(0)}}return function(t){h.setTimeout(t,0)}}()),fe(t)):h.setImmediate(t)}}(),xe||(de(),xe=!0),be.add(t,e)}var xe=!1,be=new V;function we(){for(var t;t=z();){try{t.a.call(t.b)}catch(t){me(t)}U(Y,t)}xe=!1}function _e(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Ne(n,Ee,t)}),(function(t){if(!(t instanceof Xe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Ne(n,Se,t)}))}catch(t){Ne(this,Se,t)}}var Te=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ae=new B((function(){return new Ce}),(function(t){t.reset()}));function Ie(t,e,n){var i=Ae.get();return i.g=t,i.b=e,i.f=n,i}function Pe(t){if(t instanceof _e)return t;var e=new _e(f);return Ne(e,Ee,t),e}function Re(t){return new _e((function(e,n){n(t)}))}function Oe(t,e,n){Fe(t,e,n,null)||ye(T(e,t))}function ke(t){return new _e((function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,s){n--,i[t]=r?{Pb:!0,value:s}:{Pb:!1,reason:s},0==n&&e(i)},s=0;s<t.length;s++)Oe(t[s],T(r,s,!0),T(r,s,!1));else e(i)}))}function Me(t,e){if(t.a==Te)if(t.c){var n=t.c;if(n.b){for(var i=0,r=null,s=null,o=n.b;o&&(o.c||(i++,o.a==t&&(r=o),!(r&&1<i)));o=o.next)r||(s=o);r&&(n.a==Te&&1==i?Me(n,e):(s?((i=s).next==n.f&&(n.f=i),i.next=i.next.next):Ue(n),Ve(n,r,Se,e)))}t.c=null}else Ne(t,Se,e)}function De(t,e){t.b||t.a!=Ee&&t.a!=Se||Be(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,i){var r=Ie(null,null,null);return r.a=new _e((function(t,s){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(t){s(t)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof Xe?s(e):t(r)}catch(t){s(t)}}:s})),r.a.c=t,De(t,r),r.a}function Ne(t,e,n){t.a==Te&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Be(t),e!=Se||n instanceof Xe||function(t,e){t.g=!0,ye((function(){t.g&&ze.call(null,e)}))}(t,n)))}function Fe(t,e,n,i){if(t instanceof _e)return De(t,Ie(e||f,n||null,i)),!0;if(D(t))return t.then(e,n,i),!0;if(g(t))try{var r=t.then;if(v(r))return function(t,e,n,i,r){function s(t){o||(o=!0,i.call(r,t))}var o=!1;try{e.call(t,(function(t){o||(o=!0,n.call(r,t))}),s)}catch(t){s(t)}}(t,r,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function Be(t){t.h||(t.h=!0,ye(t.gc,t))}function Ue(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Ve(t,e,n,i){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ye(e,n,i);else try{e.c?e.g.call(e.f):Ye(e,n,i)}catch(t){ze.call(null,t)}U(Ae,e)}function Ye(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}_e.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},_e.prototype.$goog_Thenable=!0,(t=_e.prototype).oa=function(t,e){return(t=Ie(t,t,e)).c=!0,De(this,t),this},t.o=function(t,e){return Le(this,null,t,e)},t.cancel=function(t){if(this.a==Te){var e=new Xe(t);ye((function(){Me(this,e)}),this)}},t.$c=function(t){this.a=Te,Ne(this,Ee,t)},t.ad=function(t){this.a=Te,Ne(this,Se,t)},t.gc=function(){for(var t;t=Ue(this);)Ve(this,t,this.a,this.i);this.h=!1};var ze=me;function Xe(t){L.call(this,t)}function Ge(){0!=je&&(We[m(this)]=this),this.xa=this.xa,this.pa=this.pa}S(Xe,L),Xe.prototype.name="cancel";var je=0,We={};function He(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=je)){var e=m(t);if(0!=je&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete We[e]}}Ge.prototype.xa=!1,Ge.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var qe=Object.freeze||function(t){return t},Ke=!Qt||9<=Number(he),Qe=Qt&&!ae("9"),Ze=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",f,e),h.removeEventListener("test",f,e)}catch(t){}return t}();function Je(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function $e(t,e){if(Je.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if($t){t:{try{Wt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Je.prototype.preventDefault=function(){this.defaultPrevented=!0},S($e,Je);var tn=qe({2:"touch",3:"pen",4:"mouse"});$e.prototype.preventDefault=function(){$e.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Qe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},$e.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Va=r,this.key=++nn,this.va=this.Pa=!1}function sn(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function on(t){this.src=t,this.a={},this.b=0}function an(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(sn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function hn(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.va&&s.listener==e&&s.capture==!!n&&s.Va==i)return r}return-1}on.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.a[s])||(t=this.a[s]=[],this.b++);var o=hn(t,e,i,r);return-1<o?(e=t[o],n||(e.Pa=!1)):((e=new rn(e,this.src,s,!!i,r)).Pa=n,t.push(e)),e};var un="closure_lm_"+(1e6*Math.random()|0),cn={};function ln(t,e,n,i,r){if(i&&i.once)dn(t,e,n,i,r);else if(Array.isArray(e))for(var s=0;s<e.length;s++)ln(t,e[s],n,i,r);else n=_n(n),t&&t[en]?En(t,e,n,g(i)?!!i.capture:!!i,r):fn(t,e,n,!1,i,r)}function fn(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=g(r)?!!r.capture:!!r,a=bn(t);if(a||(t[un]=a=new on(t)),!(n=a.add(e,n,i,o,s)).proxy)if(i=function(){var t=xn,e=Ke?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Ze||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(gn(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}}function dn(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)dn(t,e[s],n,i,r);else n=_n(n),t&&t[en]?Sn(t,e,n,g(i)?!!i.capture:!!i,r):fn(t,e,n,!0,i,r)}function pn(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)pn(t,e[s],n,i,r);else i=g(i)?!!i.capture:!!i,n=_n(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=hn(s=t.a[e],n,i,r))&&(sn(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.a[e],t.b--))):t&&(t=bn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=hn(e,n,i,r)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[en])an(e.v,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(gn(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=bn(e))?(an(n,t),0==n.b&&(n.src=null,e[un]=null)):sn(t)}}}function gn(t){return t in cn?cn[t]:cn[t]="on"+t}function mn(t,e,n,i){var r=!0;if((t=bn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var s=e[t];s&&s.capture==n&&!s.va&&(s=yn(s,i),r=r&&!1!==s)}return r}function yn(t,e){var n=t.listener,i=t.Va||t.src;return t.Pa&&vn(t),n.call(i,e)}function xn(t,e){if(t.va)return!0;if(!Ke){if(!e)t:{e=["window","event"];for(var n=h,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new $e(i=e,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(t){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var s=mn(i[r],t,!0,e);n=n&&s}for(r=0;r<i.length;r++)e.b=i[r],s=mn(i[r],t,!1,e),n=n&&s}return n}return yn(t,new $e(e,this))}function bn(t){return(t=t[un])instanceof on?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function _n(t){return v(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function Tn(){Ge.call(this),this.v=new on(this),this.ac=this,this.gb=null}function En(t,e,n,i,r){t.v.add(String(e),n,!1,i,r)}function Sn(t,e,n,i,r){t.v.add(String(e),n,!0,i,r)}function Cn(t,e,n,i){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.va&&o.capture==n){var a=o.listener,h=o.Va||o.src;o.Pa&&an(t.v,o),r=!1!==a.call(h,i)&&r}}return r&&!i.defaultPrevented}function An(t,e,n){if(v(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function In(t){var e=null;return new _e((function(n,i){-1==(e=An((function(){n(void 0)}),t))&&i(Error("Failed to schedule timer."))})).o((function(t){throw h.clearTimeout(e),t}))}function Pn(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function Rn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function On(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof On)for(n=t.Y(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function kn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Mn(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Mn(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function Mn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(Tn,Ge),Tn.prototype[en]=!0,Tn.prototype.addEventListener=function(t,e,n,i){ln(this,t,e,n,i)},Tn.prototype.removeEventListener=function(t,e,n,i){pn(this,t,e,n,i)},Tn.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var i=t.type||t;if("string"==typeof t)t=new Je(t,n);else if(t instanceof Je)t.target=t.target||n;else{var r=t;yt(t=new Je(i,n),r)}if(r=!0,e)for(var s=e.length-1;0<=s;s--){var o=t.b=e[s];r=Cn(o,i,!0,t)&&r}if(r=Cn(o=t.b=n,i,!0,t)&&r,r=Cn(o,i,!1,t)&&r,e)for(s=0;s<e.length;s++)r=Cn(o=t.b=e[s],i,!1,t)&&r;return r},Tn.prototype.Da=function(){if(Tn.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)sn(n[i]);delete e.a[t],e.b--}}this.gb=null},(t=On.prototype).W=function(){kn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return kn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Mn(this.b,t)?this.b[t]:e},t.set=function(t,e){Mn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var Dn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Nn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,Bn(this,ii(t.b)),this.h=t.h):t&&(n=String(t).match(Dn))?(this.i=!!e,Nn(this,n[1]||"",!0),this.l=Xn(n[2]||""),this.a=Xn(n[3]||"",!0),Fn(this,n[4]),this.f=Xn(n[5]||"",!0),Bn(this,n[6]||"",!0),this.h=Xn(n[7]||"")):(this.i=!!e,this.b=new Zn(null,this.i))}function Nn(t,e,n){t.c=n?Xn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Bn(t,e,n){e instanceof Zn?(t.b=e,function(t,e){e&&!t.f&&(Jn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(ti(this,e),ni(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Gn(e,Kn)),t.b=new Zn(e,t.i))}function Un(t,e,n){t.b.set(e,n)}function Vn(t,e){return t.b.get(e)}function Yn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function zn(t,e,n,i){var r=new Ln(null,void 0);return t&&Nn(r,t),e&&(r.a=e),n&&Fn(r,n),i&&(r.f=i),r}function Xn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,jn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Gn(e,Wn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Gn(e,Wn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Gn(n,"/"==n.charAt(0)?qn:Hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Gn(n,Qn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Nn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var i=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=i.charAt(0))if(this.a&&!this.f)i="/"+i;else{var r=e.f.lastIndexOf("/");-1!=r&&(i=e.f.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(ut(r,"./")||ut(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var s=[],o=0;o<r.length;){var a=r[o++];"."==a?i&&o==r.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),i&&o==r.length&&s.push("")):(s.push(a),i=!0)}i=s.join("/")}else i=r}return n?e.f=i:n=""!==t.b.toString(),n?Bn(e,ii(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Wn=/[#\/\?@]/g,Hn=/[#\?:]/g,qn=/[#\?]/g,Kn=/[#\?@]/g,Qn=/#/g;function Zn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Jn(t){t.a||(t.a=new On,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $n(t){var e=Rn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Zn(null,void 0);t=Pn(t);for(var i=0;i<e.length;i++){var r=e[i],s=t[i];Array.isArray(s)?ni(n,r,s):n.add(r,s)}return n}function ti(t,e){Jn(t),e=ri(t,e),Mn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Mn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&kn(t)))}function ei(t,e){return Jn(t),e=ri(t,e),Mn(t.a.b,e)}function ni(t,e,n){ti(t,e),0<n.length&&(t.c=null,t.a.set(ri(t,e),$(n)),t.b+=n.length)}function ii(t){var e=new Zn;return e.c=t.c,t.a&&(e.a=new On(t.a),e.b=t.b),e}function ri(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function si(t){var e=[];return ai(new oi,t,e),e.join("")}function oi(){}function ai(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var i=e;e=i.length,n.push("[");for(var r="",s=0;s<e;s++)n.push(r),ai(t,i[s],n),r=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(i in n.push("{"),r="",e)Object.prototype.hasOwnProperty.call(e,i)&&"function"!=typeof(s=e[i])&&(n.push(r),ci(i,n),n.push(":"),ai(t,s,n),r=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":ci(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Zn.prototype).add=function(t,e){Jn(this),this.c=null,t=ri(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Jn(this),this.a.forEach((function(n,i){j(n,(function(n){t.call(e,n,i,this)}),this)}),this)},t.Y=function(){Jn(this);for(var t=this.a.W(),e=this.a.Y(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},t.W=function(t){Jn(this);var e=[];if("string"==typeof t)ei(this,t)&&(e=J(e,this.a.get(ri(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=J(e,t[n])}return e},t.set=function(t,e){return Jn(this),this.c=null,ei(this,t=ri(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.W(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.c=t.join("&")};var hi={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ui=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ci(t,e){e.push('"',t.replace(ui,(function(t){var e=hi[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),hi[t]=e),e})),'"')}function li(){var t=Oi();return Qt&&!!he&&11==he||/Edge\/\d+/.test(t)}function fi(){return h.window&&h.window.location.href||self&&self.location&&self.location.href||""}function di(t,e){e=e||h.window;var n="about:blank";t&&(n=Mt(Ft(t)||Vt)),e.location.href=n}function pi(t,e){var n,i=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?i.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<pi(t[n],e[n]).length&&i.push(n):t[n]!==e[n]&&i.push(n):i.push(n);for(n in e)n in t||i.push(n);return i}function vi(t){return!!((t=(t||Oi()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function gi(t){t=t||h.window;try{t.close()}catch(t){}}function mi(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,s=(window.screen.availWidth-e)/2;for(o in e={width:e,height:n,top:0<r?r:0,left:0<s?s:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Oi().toLowerCase(),i&&(e.target=i,ut(n,"crios/")&&(e.target="_blank")),Ii(Oi())==Ci&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof kt?n:Ft(void 0!==n.href?n.href:String(n))||Vt,n=t.target||n.target,r=[],t)switch(o){case"width":case"height":case"top":case"left":r.push(o+"="+t[o]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(o+"="+(t[o]?1:0))}var o=r.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(xt(o=ge(document,"A"),"HTMLAnchorElement"),e=e instanceof kt?e:Bt(e),o.href=Mt(e),o.setAttribute("target",n),t.noreferrer&&o.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),o.dispatchEvent(t),o={}):t.noreferrer?(o=Xt("",i,n,o),t=Mt(e),o&&(Jt&&ut(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),o.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+jt(t)+'">',t=new Yt(t=(i=St())?i.createHTML(t):t,null,zt),i=o.document)&&(i.write(function(t){return t instanceof Yt&&t.constructor===Yt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),i.close())):(o=Xt(e,i,n,o))&&t.noopener&&(o.opener=null),o)try{o.focus()}catch(t){}return o}var yi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xi=/^[^@]+@[^@]+$/;function bi(){var t=null;return new _e((function(e){"complete"==h.document.readyState?e():(t=function(){e()},dn(window,"load",t))})).o((function(e){throw pn(window,"load",t),e}))}function wi(t){return t=t||Oi(),!("file:"!==Ni()&&"ionic:"!==Ni()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function _i(){var t=h.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Ti(){return void 0!==h.WorkerGlobalScope&&"function"==typeof h.importScripts}function Ei(){return r.Z.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.Z.INTERNAL.hasOwnProperty("node")?"Node":Ti()?"Worker":"Browser"}function Si(){var t=Ei();return"ReactNative"===t||"Node"===t}var Ci="Firefox",Ai="Chrome";function Ii(t){var e=t.toLowerCase();return ut(e,"opera/")||ut(e,"opr/")||ut(e,"opios/")?"Opera":ut(e,"iemobile")?"IEMobile":ut(e,"msie")||ut(e,"trident/")?"IE":ut(e,"edge/")?"Edge":ut(e,"firefox/")?Ci:ut(e,"silk/")?"Silk":ut(e,"blackberry")?"Blackberry":ut(e,"webos")?"Webos":!ut(e,"safari/")||ut(e,"chrome/")||ut(e,"crios/")||ut(e,"android")?!ut(e,"chrome/")&&!ut(e,"crios/")||ut(e,"edge/")?ut(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Ai:"Safari"}var Pi={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Ri(t,e){e=e||[];var n,i=[],r={};for(n in Pi)r[Pi[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=Ei())?i=Ii(r=Oi()):"Worker"===i&&(i=Ii(r=Oi())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function Oi(){return h.navigator&&h.navigator.userAgent||""}function ki(t,e){t=t.split("."),e=e||h;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Mi(){try{var t=h.localStorage,e=Yi();if(t)return t.setItem(e,"1"),t.removeItem(e),!li()||!!h.indexedDB}catch(t){return Ti()&&!!h.indexedDB}return!1}function Di(){return(Li()||"chrome-extension:"===Ni()||wi())&&!Si()&&Mi()&&!Ti()}function Li(){return"http:"===Ni()||"https:"===Ni()}function Ni(){return h.location&&h.location.protocol||null}function Fi(t){return!vi(t=t||Oi())&&Ii(t)!=Ci}function Bi(t){return void 0===t?null:si(t)}function Ui(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Vi(t){if(null!==t)return JSON.parse(t)}function Yi(t){return t||Math.floor(1e9*Math.random()).toString()}function zi(t){return"Safari"!=Ii(t=t||Oi())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Xi(){var t=h.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Gi(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Oi(),e=Ei(),this.b=vi(t)||"ReactNative"===e}function ji(){var t=h.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Wi(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Hi(){return!(!ki("fireauth.oauthhelper",h)&&!ki("fireauth.iframe",h))}Gi.prototype.get=function(){var t=h.navigator;return!t||"boolean"!=typeof t.onLine||!Li()&&"chrome-extension:"!==Ni()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var qi,Ki={};function Qi(t){Ki[t]||(Ki[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Zi={};Object.defineProperty(Zi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Zi,"abcd",{configurable:!0,enumerable:!0,value:2}),qi=2==Zi.abcd}catch(qt){qi=!1}function Ji(t,e,n){qi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function $i(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Ji(t,n,e[n])}function tr(t){var e={};return $i(e,t),e}function er(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Ji(e,n,er(t[n]));return e}function nr(t){var e=t&&(t[ar]?"phone":null);if(!(e&&t&&t[or]))throw new A("internal-error","Internal assert: invalid MultiFactorInfo object");Ji(this,"uid",t[or]),Ji(this,"displayName",t[rr]||null);var n=null;t[sr]&&(n=new Date(t[sr]).toUTCString()),Ji(this,"enrollmentTime",n),Ji(this,"factorId",e)}function ir(t){try{var e=new hr(t)}catch(t){e=null}return e}nr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var rr="displayName",sr="enrolledAt",or="mfaEnrollmentId",ar="phoneInfo";function hr(t){nr.call(this,t),Ji(this,"phoneNumber",t[ar])}function ur(t){var e={},n=t[dr],i=t[vr],r=t[gr];if(t=ir(t[pr]),!r||r!=lr&&r!=fr&&!n||r==fr&&!i||r==cr&&!t)throw Error("Invalid checkActionCode response!");r==fr?(e[yr]=n||null,e[br]=n||null,e[mr]=i):(e[yr]=i||null,e[br]=i||null,e[mr]=n||null),e[xr]=t||null,Ji(this,_r,r),Ji(this,wr,er(e))}S(hr,nr),hr.prototype.w=function(){var t=hr.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var cr="REVERT_SECOND_FACTOR_ADDITION",lr="EMAIL_SIGNIN",fr="VERIFY_AND_CHANGE_EMAIL",dr="email",pr="mfaInfo",vr="newEmail",gr="requestType",mr="email",yr="fromEmail",xr="multiFactorInfo",br="previousEmail",wr="data",_r="operation";function Tr(t){var e=Vn(t=Yn(t),Er)||null,n=Vn(t,Sr)||null,i=Vn(t,Ir)||null;if(i=i&&Rr[i]||null,!e||!n||!i)throw new A("argument-error",Er+", "+Sr+"and "+Ir+" are required in a valid action code URL.");$i(this,{apiKey:e,operation:i,code:n,continueUrl:Vn(t,Cr)||null,languageCode:Vn(t,Ar)||null,tenantId:Vn(t,Pr)||null})}var Er="apiKey",Sr="oobCode",Cr="continueUrl",Ar="languageCode",Ir="mode",Pr="tenantId",Rr={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:cr,signIn:lr,verifyAndChangeEmail:fr,verifyEmail:"VERIFY_EMAIL"};function Or(t){try{return new Tr(t)}catch(t){return null}}function kr(t){var e=t[Fr];if(void 0===e)throw new A("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new A("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Mr];if(n&&"object"==typeof n){e=n[Vr];var i=n[Br];if(n=n[Ur],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new A("argument-error",Br+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new A("argument-error",Ur+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new A("argument-error",Vr+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new A("missing-android-pkg-name")}}else if(void 0!==n)throw new A("argument-error",Mr+" property must be a non null object when specified.");if(this.f=null,(e=t[Nr])&&"object"==typeof e){if("string"==typeof(e=e[Yr])&&e.length)this.f=e;else if(void 0!==e)throw new A("argument-error",Yr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new A("argument-error",Nr+" property must be a non null object when specified.");if(void 0!==(e=t[Lr])&&"boolean"!=typeof e)throw new A("argument-error",Lr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Dr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new A("argument-error",Dr+" property must be a non empty string when specified.");this.i=t||null}var Mr="android",Dr="dynamicLinkDomain",Lr="handleCodeInApp",Nr="iOS",Fr="url",Br="installApp",Ur="minimumVersion",Vr="packageName",Yr="bundleId";function zr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Xr=null;function Gr(t){var e=Wr(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function jr(t){try{return new Gr(t)}catch(t){return null}}function Wr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var i=function(t){var e=[];return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=Xr[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Xr){Xr={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var i=t.concat(e[n].split("")),r=0;r<i.length;r++){var s=i[r];void 0===Xr[s]&&(Xr[s]=r)}}}();for(var i=0;;){var r=n(-1),s=n(0),o=n(64),a=n(64);if(64===a&&-1===r)break;e(r<<2|s>>4),64!=o&&(e(s<<4&240|o>>2),64!=a&&e(o<<6&192|a))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<i.length;){var r=i[e++];if(128>r)t[n++]=String.fromCharCode(r);else if(191<r&&224>r){var s=i[e++];t[n++]=String.fromCharCode((31&r)<<6|63&s)}else if(239<r&&365>r){s=i[e++];var o=i[e++],a=((7&r)<<18|(63&s)<<12|(63&o)<<6|63&i[e++])-65536;t[n++]=String.fromCharCode(55296+(a>>10)),t[n++]=String.fromCharCode(56320+(1023&a))}else s=i[e++],o=i[e++],t[n++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}return JSON.parse(t.join(""))}catch(t){}return null}Gr.prototype.T=function(){return this.f},Gr.prototype.l=function(){return this.c},Gr.prototype.toString=function(){return this.h};var Hr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qr=["client_id","response_type","scope","redirect_uri","state"],Kr={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:qr},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:qr},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:qr},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:Hr},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Qr(t){for(var e in Kr)if(Kr[e].fa==t)return Kr[e];return null}function Zr(t){var e={};e["facebook.com"]=ns,e["google.com"]=rs,e["github.com"]=is,e["twitter.com"]=ss;var n=t&&t[$r];try{if(n)return e[n]?new e[n](t):new es(t);if(void 0!==t[Jr])return new ts(t)}catch(t){}return null}var Jr="idToken",$r="providerId";function ts(t){var e=t[$r];if(!e&&t[Jr]){var n=jr(t[Jr]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Ji(this,"providerId",e),Ji(this,"isNewUser",n)}function es(t){ts.call(this,t),Ji(this,"profile",er((t=Vi(t.rawUserInfo||"{}"))||{}))}function ns(t){if(es.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function is(t){if(es.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Ji(this,"username",this.profile&&this.profile.login||null)}function rs(t){if(es.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function ss(t){if(es.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Ji(this,"username",t.screenName||null)}function os(t){var e=Yn(t),n=Vn(e,"link"),i=Vn(Yn(n),"link");return e=Vn(e,"deep_link_id"),Vn(Yn(e),"link")||e||i||n||t}function as(t,e){if(!t&&!e)throw new A("internal-error","Internal assert: no raw session string available");if(t&&e)throw new A("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?hs:us}S(es,ts),S(ns,es),S(is,es),S(rs,es),S(ss,es);var hs="enroll",us="signin";function cs(){}function ls(t,e){return t.then((function(t){if(t[$o]){var n=jr(t[$o]);if(!n||e!=n.i)throw new A("user-mismatch");return t}throw new A("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==R+"user-not-found"?new A("user-mismatch"):t}))}function fs(t,e){if(!e)throw new A("internal-error","failed to construct a credential");this.a=e,Ji(this,"providerId",t),Ji(this,"signInMethod",t)}function ds(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function ps(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new fs(t.providerId,t.pendingToken)}catch(t){}return null}function vs(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Ji(this,"idToken",e.idToken),e.accessToken&&Ji(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Ji(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new A("internal-error","failed to construct a credential");Ji(this,"accessToken",e.oauthToken),Ji(this,"secret",e.oauthTokenSecret)}Ji(this,"providerId",t),Ji(this,"signInMethod",n)}function gs(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:$n(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function ms(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new vs(t.providerId,e,t.signInMethod)}catch(t){}}return null}function ys(t,e){this.Qc=e||[],$i(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Qr(t)||{}).Ja||null,this.ob=null}function xs(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new A("argument-error",'SAML provider IDs must be prefixed with "saml."');ys.call(this,t,[])}function bs(t){ys.call(this,t,qr),this.a=[]}function ws(){bs.call(this,"facebook.com")}function _s(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new ws).credential({accessToken:e})}function Ts(){bs.call(this,"github.com")}function Es(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Ts).credential({accessToken:e})}function Ss(){bs.call(this,"google.com"),this.Ca("profile")}function Cs(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Ss).credential({idToken:n,accessToken:e})}function As(){ys.call(this,"twitter.com",Hr)}function Is(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new A("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new vs("twitter.com",n,"twitter.com")}function Ps(t,e,n){this.a=t,this.f=e,Ji(this,"providerId","password"),Ji(this,"signInMethod",n===Os.EMAIL_LINK_SIGN_IN_METHOD?Os.EMAIL_LINK_SIGN_IN_METHOD:Os.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Rs(t){return t&&t.email&&t.password?new Ps(t.email,t.password,t.signInMethod):null}function Os(){$i(this,{providerId:"password",isOAuthProvider:!1})}function ks(t,e){if(!(e=Ms(e)))throw new A("argument-error","Invalid email link!");return new Ps(t,e.code,Os.EMAIL_LINK_SIGN_IN_METHOD)}function Ms(t){return(t=Or(t=os(t)))&&t.operation===lr?t:null}function Ds(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new A("internal-error");this.a=t,Ji(this,"providerId","phone"),this.fa="phone",Ji(this,"signInMethod","phone")}function Ls(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return j(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Ds(e)}return null}function Ns(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function Fs(t){try{this.a=t||r.Z.auth()}catch(t){throw new A("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}$i(this,{providerId:"phone",isOAuthProvider:!1})}function Bs(t,e){if(!t)throw new A("missing-verification-id");if(!e)throw new A("missing-verification-code");return new Ds({eb:t,cb:e})}function Us(t){if(t.temporaryProof&&t.phoneNumber)return new Ds({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,s=t&&t.oauthIdToken,o=t&&t.pendingToken;try{switch(e){case"google.com":return Cs(s,n);case"facebook.com":return _s(n);case"github.com":return Es(n);case"twitter.com":return Is(n,i);default:return n||i||s||o?o?0==e.indexOf("saml.")?new fs(e,o):new vs(e,{pendingToken:o,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new bs(e).credential({idToken:s,accessToken:n,rawNonce:r}):null}}catch(t){return null}}function Vs(t){if(!t.isOAuthProvider)throw new A("invalid-oauth-provider")}function Ys(t,e,n,i,r,s,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=s||null,this.h=o||null,this.a=r||null,!this.g&&!this.a)throw new A("invalid-auth-event");if(this.g&&this.a)throw new A("invalid-auth-event");if(this.g&&!this.f)throw new A("invalid-auth-event")}function zs(t){return(t=t||{}).type?new Ys(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&I(t.error),t.postBody,t.tenantId):null}function Xs(){this.b=null,this.a=[]}as.prototype.Ha=function(){return this.a?Pe(this.a):Pe(this.b)},as.prototype.w=function(){return this.type==hs?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},cs.prototype.ka=function(){},cs.prototype.b=function(){},cs.prototype.c=function(){},cs.prototype.w=function(){},fs.prototype.ka=function(t){return ba(t,ds(this))},fs.prototype.b=function(t,e){var n=ds(this);return n.idToken=e,wa(t,n)},fs.prototype.c=function(t,e){return ls(_a(t,ds(this)),e)},fs.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},vs.prototype.ka=function(t){return ba(t,gs(this))},vs.prototype.b=function(t,e){var n=gs(this);return n.idToken=e,wa(t,n)},vs.prototype.c=function(t,e){return ls(_a(t,gs(this)),e)},vs.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},ys.prototype.Ka=function(t){return this.Ib=gt(t),this},S(xs,ys),S(bs,ys),bs.prototype.Ca=function(t){return K(this.a,t)||this.a.push(t),this},bs.prototype.Qb=function(){return $(this.a)},bs.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new A("argument-error","credential failed: must provide the ID token and/or the access token.");return new vs(this.providerId,n,this.providerId)},S(ws,bs),Ji(ws,"PROVIDER_ID","facebook.com"),Ji(ws,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Ts,bs),Ji(Ts,"PROVIDER_ID","github.com"),Ji(Ts,"GITHUB_SIGN_IN_METHOD","github.com"),S(Ss,bs),Ji(Ss,"PROVIDER_ID","google.com"),Ji(Ss,"GOOGLE_SIGN_IN_METHOD","google.com"),S(As,ys),Ji(As,"PROVIDER_ID","twitter.com"),Ji(As,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ps.prototype.ka=function(t){return this.signInMethod==Os.EMAIL_LINK_SIGN_IN_METHOD?ih(t,Ra,{email:this.a,oobCode:this.f}):ih(t,Ja,{email:this.a,password:this.f})},Ps.prototype.b=function(t,e){return this.signInMethod==Os.EMAIL_LINK_SIGN_IN_METHOD?ih(t,Oa,{idToken:e,email:this.a,oobCode:this.f}):ih(t,Ga,{idToken:e,email:this.a,password:this.f})},Ps.prototype.c=function(t,e){return ls(this.ka(t),e)},Ps.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},$i(Os,{PROVIDER_ID:"password"}),$i(Os,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),$i(Os,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ds.prototype.ka=function(t){return t.fb(Ns(this))},Ds.prototype.b=function(t,e){var n=Ns(this);return n.idToken=e,ih(t,th,n)},Ds.prototype.c=function(t,e){var n=Ns(this);return n.operation="REAUTH",ls(t=ih(t,eh,n),e)},Ds.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Fs.prototype.fb=function(t,e){var n=this.a.a;return Pe(e.verify()).then((function(i){if("string"!=typeof i)throw new A("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var r=g(t)?t.session:null,s=g(t)?t.phoneNumber:t;return(r&&r.type==hs?r.Ha().then((function(t){return function(t,e){return ih(t,Wa,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:i}})})):r&&r.type==us?r.Ha().then((function(e){return function(t,e){return ih(t,Ha,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:i}})})):function(t,e){return ih(t,za,e)}(n,{phoneNumber:s,recaptchaToken:i})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new A("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},$i(Fs,{PROVIDER_ID:"phone"}),$i(Fs,{PHONE_SIGN_IN_METHOD:"phone"}),Ys.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Ys.prototype.T=function(){return this.h},Ys.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Gs,js=null;function Ws(t){var e="unauthorized-domain",n=void 0,i=Yn(t);t=i.a,"chrome-extension"==(i=i.c)?n=Gt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=Gt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",A.call(this,e,n)}function Hs(t,e,n){A.call(this,t,n),(t=e||{}).Jb&&Ji(this,"email",t.Jb),t.ea&&Ji(this,"phoneNumber",t.ea),t.credential&&Ji(this,"credential",t.credential),t.Zb&&Ji(this,"tenantId",t.Zb)}function qs(t){if(t.code){var e=t.code||"";0==e.indexOf(R)&&(e=e.substring(R.length));var n={credential:Us(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new A(e,t.message||void 0);return new Hs(e,n,t.message)}return null}function Ks(){}function Qs(t){return t.c||(t.c=t.b())}function Zs(){}function Js(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function $s(){}function to(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=_(this.qc,this),this.a.onerror=_(this.Sb,this),this.a.onprogress=_(this.rc,this),this.a.ontimeout=_(this.vc,this)}function eo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function no(t,e,n){this.reset(t,e,n,void 0,void 0)}function io(t){this.f=t,this.b=this.c=this.a=null}function ro(t,e){this.name=t,this.value=e}S(Ws,A),S(Hs,A),Hs.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&yt(t,e),t},Hs.prototype.toJSON=function(){return this.w()},Ks.prototype.c=null,S(Zs,Ks),Zs.prototype.a=function(){var t=Js(this);return t?new ActiveXObject(t):new XMLHttpRequest},Zs.prototype.b=function(){var t={};return Js(this)&&(t[0]=!0,t[1]=!0),t},Gs=new Zs,S($s,Ks),$s.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new to;throw Error("Unsupported browser")},$s.prototype.b=function(){return{}},(t=to.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,eo(this,4)},t.Sb=function(){this.status=500,this.response=this.responseText="",eo(this,4)},t.vc=function(){this.Sb()},t.rc=function(){this.status=200,eo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},no.prototype.a=null,no.prototype.reset=function(t,e,n,i,r){i||E(),delete this.a},ro.prototype.toString=function(){return this.name};var so=new ro("SEVERE",1e3),oo=new ro("WARNING",900),ao=new ro("CONFIG",700),ho=new ro("FINE",500);function uo(t){return t.c?t.c:t.a?uo(t.a):(F("Root logger has no level set."),null)}io.prototype.log=function(t,e,n){if(t.value>=uo(this).value)for(v(e)&&(e=e()),t=new no(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var co={},lo=null;function fo(t){var e;if(lo||(lo=new io(""),co[""]=lo,lo.c=ao),!(e=co[t])){e=new io(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=fo(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,co[t]=e}return e}function po(t,e){t&&t.log(ho,e,void 0)}function vo(t){this.f=t}function go(t){Tn.call(this),this.u=t,this.h=void 0,this.readyState=mo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=fo("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(vo,Ks),vo.prototype.a=function(){return new go(this.f)},vo.prototype.b=function(t){return function(){return t}}({}),S(go,Tn);var mo=0;function yo(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function xo(t){t.readyState=4,t.g=null,t.c=null,t.m=null,bo(t)}function bo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function wo(t){Tn.call(this),this.headers=new On,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=_o,this.u=this.S=!1}(t=go.prototype).open=function(t,e){if(this.readyState!=mo)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,bo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,xo(this)),this.readyState=mo},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,bo(this)),this.a&&(this.readyState=3,bo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==h.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,yo(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?xo(this):bo(this),3==this.readyState&&yo(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,xo(this))},t.sc=function(t){this.a&&(this.response=t,xo(this))},t.Ua=function(t){var e=this.i;e&&e.log(oo,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&xo(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(oo,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(oo,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(go.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(wo,Tn);var _o="";wo.prototype.b=fo("goog.net.XhrIo");var To=/^https?$/i,Eo=["POST","PUT"];function So(t){return"content-type"==t.toLowerCase()}function Co(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Ao(t),Po(t)}function Ao(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Io(t){if(t.c&&void 0!==a)if(t.C[1]&&4==Oo(t)&&2==ko(t))po(t.b,Mo(t,"Local request error detected and ignored"));else if(t.i&&4==Oo(t))An(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==Oo(t)){po(t.b,Mo(t,"Request complete")),t.c=!1;try{var e,n=ko(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var s=String(t.l).match(Dn)[1]||null;if(!s&&h.self&&h.self.location){var o=h.self.location.protocol;s=o.substr(0,o.length-1)}r=!To.test(s?s.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var u=2<Oo(t)?t.a.statusText:""}catch(e){po(t.b,"Can not get status: "+e.message),u=""}t.h=u+" ["+ko(t)+"]",Ao(t)}}finally{Po(t)}}}function Po(t,e){if(t.a){Ro(t);var n=t.a,i=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(e){(t=t.b)&&t.log(so,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Ro(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(h.clearTimeout(t.s),t.s=null)}function Oo(t){return t.a?t.a.readyState:0}function ko(t){try{return 2<Oo(t)?t.a.status:-1}catch(t){return-1}}function Mo(t,e){return e+" ["+t.R+" "+t.l+" "+ko(t)+"]"}function Do(t){var e=jo;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Lo(t,e,n){t.a=!0,t.c=n,t.f=!e,Uo(t)}function No(t){if(t.a){if(!t.v)throw new Vo(t);t.v=!1}}function Fo(t,e,n,i){t.g.push([e,n,i]),t.a&&Uo(t)}function Bo(t){return q(t.g,(function(t){return v(t[1])}))}function Uo(t){if(t.h&&t.a&&Bo(t)){var e=t.h,n=Xo[e];n&&(h.clearTimeout(n.a),delete Xo[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=n=!1;t.g.length&&!t.i;){var r=t.g.shift(),s=r[0],o=r[1];if(r=r[2],s=t.f?o:s)try{var a=s.call(r||t.s,e);void 0!==a&&(t.f=t.f&&(a==e||a instanceof Error),t.c=e=a),(D(e)||"function"==typeof h.Promise&&e instanceof h.Promise)&&(i=!0,t.i=!0)}catch(i){e=i,t.f=!0,Bo(t)||(n=!0)}}t.c=e,i&&(a=_(t.m,t,!0),i=_(t.m,t,!1),e instanceof Do?(Fo(e,a,i),e.C=!0):e.then(a,i)),n&&(e=new zo(e),Xo[e.a]=e,t.h=e.a)}function Vo(){L.call(this)}function Yo(){L.call(this)}function zo(t){this.a=h.setTimeout(_(this.c,this),0),this.b=t}(t=wo.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",po(this.b,Mo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(po(this.b,Mo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Po(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Po(this,!0)),wo.ab.Da.call(this)},t.Vb=function(){this.xa||(this.O||this.i||this.f?Io(this):this.Jc())},t.Jc=function(){Io(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case _o:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(so,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return po(this.b,"Can not get response: "+t.message),null}},Do.prototype.cancel=function(t){if(this.a)this.c instanceof Do&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Yo(this),No(this),Lo(this,!1,t))}},Do.prototype.m=function(t,e){this.i=!1,Lo(this,t,e)},Do.prototype.then=function(t,e,n){var i,r,s=new _e((function(t,e){i=t,r=e}));return Fo(this,i,(function(t){t instanceof Yo?s.cancel():r(t)})),s.then(t,e,n)},Do.prototype.$goog_Thenable=!0,S(Vo,L),Vo.prototype.message="Deferred has already fired",Vo.prototype.name="AlreadyCalledError",S(Yo,L),Yo.prototype.message="Deferred was canceled",Yo.prototype.name="CanceledError",zo.prototype.c=function(){throw delete Xo[this.a],this.b};var Xo={};function Go(t){var e={},n=e.document||document,i=At(t).toString(),r=ge(document,"SCRIPT"),s={Wb:r,Ma:void 0},o=new Do(s),a=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(a=window.setTimeout((function(){Wo(r,!0);var t=new Ko(qo,"Timeout reached for loading script "+i);No(o),Lo(o,!1,t)}),u),s.Ma=a),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Wo(r,e.xd||!1,a),No(o),Lo(o,!0,null))},r.onerror=function(){Wo(r,!0,a);var t=new Ko(Ho,"Error while loading script "+i);No(o),Lo(o,!1,t)},yt(s=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),le(r,s),function(t,e){xt(t,"HTMLScriptElement"),t.src=At(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=h?e=l(e.document):(null===c&&(c=l(h.document)),e=c),e&&t.setAttribute("nonce",e)}(r,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),o}function jo(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&Wo(t,!0,this.Ma)}}function Wo(t,e,n){null!=n&&h.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ho=0,qo=1;function Ko(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Qo(t){this.f=t}function Zo(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||ta,this.g=gt(t.secureTokenHeaders||ea),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||na,this.a=gt(t.firebaseHeaders||ia),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Ei(),!(n=h.XMLHttpRequest||n&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.XMLHttpRequest)&&!Ti())throw new A("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Ti()?this.f=new vo(self):Si()?this.f=new Qo(n):this.f=new $s,this.b=null}S(Ko,L),S(Qo,Ks),Qo.prototype.a=function(){return new this.f},Qo.prototype.b=function(){return{}};var Jo,$o="idToken",ta=new Gi(3e4,6e4),ea={"Content-Type":"application/x-www-form-urlencoded"},na=new Gi(3e4,6e4),ia={"Content-Type":"application/json"};function ra(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function sa(t,e){e&&(t.l=oa("https://securetoken.googleapis.com/v1/token",e),t.h=oa("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=oa("https://identitytoolkit.googleapis.com/v2/",e))}function oa(t,e){return t=Yn(t),e=Yn(e.url),t.f=t.a+t.f,Nn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function aa(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ha(t,e,n,i,r,s,o){(function(){var t=Oi();return!((t=Ii(t)!=Ai?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Qt&&he&&!(9<he))})()||Ti()?t=_(t.u,t):(Jo||(Jo=new _e((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(h[ca]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Fo(t,null,e,void 0)}(Go(It(ua,{onload:ca})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=_(t.s,t)),t(e,n,i,r,s,o)}Zo.prototype.T=function(){return this.b},Zo.prototype.u=function(t,e,n,i,r,s){if(Ti()&&(void 0===h.fetch||void 0===h.Headers||void 0===h.Request))throw new A("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var o=new wo(this.f);if(s){o.g=Math.max(0,s);var a=setTimeout((function(){o.dispatchEvent("timeout")}),s)}En(o,"complete",(function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return po(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(o,"ready",(function(){a&&clearTimeout(a),He(this)})),Sn(o,"timeout",(function(){a&&clearTimeout(a),He(this),e&&e(null)})),function(t,e,n,i,r){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Gs.a(),t.C=t.D?Qs(t.D):Qs(Gs),t.a.onreadystatechange=_(t.Vb,t);try{po(t.b,Mo(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(e){return po(t.b,Mo(t,"Error opening Xhr: "+e.message)),void Co(t,e)}e=i||"";var s=new On(t.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)j(t,e,void 0);else for(var n=Rn(t),i=Pn(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(r,(function(t,e){s.set(e,t)})),r=function(t){t:{for(var e=So,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(s.Y()),i=h.FormData&&e instanceof h.FormData,!K(Eo,n)||r||i||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Ro(t),0<t.g&&(t.u=function(t){return Qt&&ae(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),po(t.b,Mo(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=_(t.Ma,t)):t.s=An(t.Ma,t.g,t)),po(t.b,Mo(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){po(t.b,Mo(t,"Send error: "+e.message)),Co(t,e)}}(o,t,n,i,r)};var ua=new bt(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),ca="__fcb"+Math.floor(1e6*Math.random()).toString();function la(t){if("string"!=typeof(t=t.email)||!xi.test(t))throw new A("invalid-email")}function fa(t){"email"in t&&la(t)}function da(t){if(!t[$o]){if(t.mfaPendingCredential)throw new A("multi-factor-auth-required",null,gt(t));throw new A("internal-error")}}function pa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new A("internal-error")}else{if(!t.sessionInfo)throw new A("missing-verification-id");if(!t.code)throw new A("missing-verification-code")}}Zo.prototype.s=function(t,e,n,i,r){var s=this;Jo.then((function(){window.gapi.client.setApiKey(s.c);var o=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(o),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Zo.prototype.zb=function(){return ih(this,ja,{})},Zo.prototype.Bb=function(t,e){return ih(this,Xa,{idToken:t,email:e})},Zo.prototype.Cb=function(t,e){return ih(this,Ga,{idToken:t,password:e})};var va={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ga(t){if(!t.phoneVerificationInfo)throw new A("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new A("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new A("missing-verification-code")}function ma(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new A("internal-error")}function ya(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&ei(t=new Zn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function xa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=qs(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=qs(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=qs(t)):t.errorMessage&&(e=rh(t.errorMessage)),e)throw e;da(t)}function ba(t,e){return e.returnIdpCredential=!0,ih(t,qa,e)}function wa(t,e){return e.returnIdpCredential=!0,ih(t,Qa,e)}function _a(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ih(t,Ka,e)}function Ta(t){if(!t.oobCode)throw new A("invalid-action-code")}(t=Zo.prototype).Db=function(t,e){var n={idToken:t},i=[];return pt(va,(function(t,r){var s=e[r];null===s?i.push(t):r in e&&(n[r]=s)})),i.length&&(n.deleteAttribute=i),ih(this,Xa,n)},t.vb=function(t,e){return yt(t={requestType:"PASSWORD_RESET",email:t},e),ih(this,Ba,t)},t.wb=function(t,e){return yt(t={requestType:"EMAIL_SIGNIN",email:t},e),ih(this,La,t)},t.ub=function(t,e){return yt(t={requestType:"VERIFY_EMAIL",idToken:t},e),ih(this,Na,t)},t.Eb=function(t,e,n){return yt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),ih(this,Fa,t)},t.fb=function(t){return ih(this,$a,t)},t.nb=function(t,e){return ih(this,Ya,{oobCode:t,newPassword:e})},t.Ra=function(t){return ih(this,Sa,{oobCode:t})},t.jb=function(t){return ih(this,Ea,{oobCode:t})};var Ea={endpoint:"setAccountInfo",A:Ta,Z:"email",B:!0},Sa={endpoint:"resetPassword",A:Ta,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new A("internal-error")},B:!0},Ca={endpoint:"signupNewUser",A:function(t){if(la(t),!t.password)throw new A("weak-password")},G:da,V:!0,B:!0},Aa={endpoint:"createAuthUri",B:!0},Ia={endpoint:"deleteAccount",N:["idToken"]},Pa={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new A("internal-error")}},Ra={endpoint:"emailLinkSignin",N:["email","oobCode"],A:la,G:da,V:!0,B:!0},Oa={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:la,G:da,V:!0},ka={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:ga,G:da,B:!0,Na:!0},Ma={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:ga,G:da,B:!0,Na:!0},Da={endpoint:"getAccountInfo"},La={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new A("internal-error");la(t)},Z:"email",B:!0},Na={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Fa={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Ba={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new A("internal-error");la(t)},Z:"email",B:!0},Ua={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},Va={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new A("internal-error")}},Ya={endpoint:"resetPassword",A:Ta,Z:"email",B:!0},za={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Xa={endpoint:"setAccountInfo",N:["idToken"],A:fa,V:!0},Ga={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(fa(t),!t.password)throw new A("weak-password")},G:da,V:!0},ja={endpoint:"signupNewUser",G:da,V:!0,B:!0},Wa={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new A("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new A("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Ha={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},qa={endpoint:"verifyAssertion",A:ma,Ya:ya,G:xa,V:!0,B:!0},Ka={endpoint:"verifyAssertion",A:ma,Ya:ya,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new A("user-not-found");if(t.errorMessage)throw rh(t.errorMessage);da(t)},V:!0,B:!0},Qa={endpoint:"verifyAssertion",A:function(t){if(ma(t),!t.idToken)throw new A("internal-error")},Ya:ya,G:xa,V:!0},Za={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new A("invalid-custom-token")},G:da,V:!0,B:!0},Ja={endpoint:"verifyPassword",A:function(t){if(la(t),!t.password)throw new A("wrong-password")},G:da,V:!0,B:!0},$a={endpoint:"verifyPhoneNumber",A:pa,G:da,B:!0},th={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new A("internal-error");pa(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",qs(t);da(t)}},eh={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:pa,G:da,B:!0},nh={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[$o]^!!t.refreshToken)throw new A("internal-error")},B:!0,Na:!0};function ih(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.N))return Re(new A("internal-error"));var i,r=!!e.Na,s=e.Ub||"POST";return Pe(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,i,r,s,o){var a=Yn(e+n);Un(a,"key",t.c),o&&Un(a,"cb",E().toString());var h="GET"==i;if(h)for(var u in r)r.hasOwnProperty(u)&&Un(a,u,r[u]);return new _e((function(e,n){ha(t,a.toString(),(function(t){t?t.error?n(sh(t,s||{})):e(t):n(new A("network-request-failed"))}),i,h?void 0:si(Ui(r)),t.a,t.v.get())}))}(t,r?t.i:t.h,e.endpoint,s,n,e.Hb,e.lb||!1)})).then((function(t){return i=t,e.Ya?e.Ya(n,i):i})).then(e.G).then((function(){if(!e.Z)return i;if(!(e.Z in i))throw new A("internal-error");return i[e.Z]}))}function rh(t){return sh({error:{errors:[{message:t}],code:400,message:t}})}function sh(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new A(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",yt(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new A(i[r],e);return!e&&t&&(e=Bi(t)),new A("internal-error",e)}function oh(t){this.b=t,this.a=null,this.rb=function(t){return(ch||(ch=new _e((function(t,e){function n(){Xi(),ki("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Xi(),e(Error("Network Error"))},timeout:hh.get()})}if(ki("gapi.iframes.Iframe"))t();else if(ki("gapi.load"))n();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();h[i]=function(){ki("gapi.load")?n():e(Error("Network Error"))},Pe(Go(i=It(ah,{onload:i}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw ch=null,t})))).then((function(){return new _e((function(e,n){ki("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:ki("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(i){function r(){clearTimeout(s),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var s=setTimeout((function(){n(Error("Network Error"))}),uh.get());i.ping(r).then(r,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var ah=new bt(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),hh=new Gi(3e4,6e4),uh=new Gi(5e3,15e3),ch=null;function lh(t,e,n,i){this.l=t,this.h=e,this.i=n,this.g=i,this.f=null,t=this.g?zn((t=Yn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):zn("https",this.l,null,"/__/auth/iframe"),this.a=t,Un(this.a,"apiKey",this.h),Un(this.a,"appName",this.i),this.b=null,this.c=[]}function fh(t,e,n,i,r,s){this.u=t,this.s=e,this.c=n,this.m=i,this.v=s,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function dh(t){try{return r.Z.app(t).auth().Ga()}catch(t){return[]}}function ph(t,e,n,i,r,s){this.s=t,this.g=e,this.b=n,this.f=s,this.c=i||null,this.i=r||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function vh(t){var e=fi();return function(t){return ih(t,Ua,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Yn(e),i=n.c;n=n.a;for(var r=0;r<t.length;r++){var s=t[r],o=n,a=i;if(0==s.indexOf("chrome-extension://")?o=Yn(s).a==o&&"chrome-extension"==a:"http"!=a&&"https"!=a?o=!1:yi.test(s)?o=o==s:(s=s.split(".").join("\\."),o=new RegExp("^(.+\\."+s+"|"+s+")$","i").test(o)),o){t=!0;break t}}t=!1}if(!t)throw new Ws(fi())}))}function gh(t){return t.m||(t.m=bi().then((function(){if(!t.u){var e=t.c,n=t.i,i=dh(t.b),r=new lh(t.s,t.g,t.b,t.f);r.f=e,r.b=n,r.c=$(i||[]),t.u=r.toString()}t.v=new oh(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then((function(){t.a.register("authEvent",e,ki("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=zs(e.authEvent),n=0;n<t.h.length;n++)i=t.h[n](e)||i;return(n={}).status=i?"ACK":"ERROR",Pe(n)}return n.status="ERROR",Pe(n)}))}(t)}))),t.m}function mh(t){return t.l||(t.C=t.c?Ri(t.c,dh(t.b)):null,t.l=new Zo(t.g,M(t.i),t.C),t.f&&sa(t.l,t.f)),t.l}function yh(t,e,n,i,r,s,o,a,h,u,c,l){return(t=new fh(t,e,n,i,r,l)).l=s,t.g=o,t.i=a,t.b=gt(h||null),t.f=u,t.yb(c).toString()}function xh(t){if(this.a=t||r.Z.INTERNAL.reactNative&&r.Z.INTERNAL.reactNative.AsyncStorage,!this.a)throw new A("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function bh(t){this.b=t,this.a={},this.f=_(this.c,this)}lh.prototype.toString=function(){return this.f?Un(this.a,"v",this.f):ti(this.a.b,"v"),this.b?Un(this.a,"eid",this.b):ti(this.a.b,"eid"),this.c.length?Un(this.a,"fw",this.c.join(",")):ti(this.a.b,"fw"),this.a.toString()},fh.prototype.yb=function(t){return this.h=t,this},fh.prototype.toString=function(){if(this.v){var t=Yn(this.v.url);t=zn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=zn("https",this.u,null,"/__/auth/handler");if(Un(t,"apiKey",this.s),Un(t,"appName",this.c),Un(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.Z.app(this.c).auth().la()}catch(t){n=null}for(var i in e.ob=n,Un(t,"providerId",this.a.providerId),e=Ui((n=this.a).Ib))e[i]=e[i].toString();i=n.Qc,e=gt(e);for(var s=0;s<i.length;s++){var o=i[s];o in e&&delete e[o]}n.pb&&n.ob&&!e[n.pb]&&(e[n.pb]=n.ob),vt(e)||Un(t,"customParameters",Bi(e))}if("function"==typeof this.a.Qb&&(n=this.a.Qb()).length&&Un(t,"scopes",n.join(",")),this.l?Un(t,"redirectUrl",this.l):ti(t.b,"redirectUrl"),this.g?Un(t,"eventId",this.g):ti(t.b,"eventId"),this.i?Un(t,"v",this.i):ti(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Vn(t,a)&&Un(t,a,this.b[a]);return this.h?Un(t,"tid",this.h):ti(t.b,"tid"),this.f?Un(t,"eid",this.f):ti(t.b,"eid"),(a=dh(this.c)).length&&Un(t,"fw",a.join(",")),t.toString()},(t=ph.prototype).Ob=function(t,e,n){var i=new A("popup-closed-by-user"),r=new A("web-storage-unsupported"),s=this,o=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return gh(t).then((function(){return function(t,e){return t.rb.then((function(){return new _e((function(n){t.a.send(e.type,e,n,ki("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(s).then((function(n){n||(t&&gi(t),e(r),o=!0)}))})).o((function(){})).then((function(){if(!o)return function(t){return new _e((function(e){return function n(){In(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!o)return In(n).then((function(){e(i)}))}))},t.Xb=function(){var t=Oi();return!Fi(t)&&!zi(t)},t.Tb=function(){return!1},t.Mb=function(t,e,n,i,r,s,o,a){if(!t)return Re(new A("popup-blocked"));if(o&&!Fi())return this.ma().o((function(e){gi(t),r(e)})),i(),Pe();this.a||(this.a=vh(mh(this)));var h=this;return this.a.then((function(){var e=h.ma().o((function(e){throw gi(t),r(e),e}));return i(),e})).then((function(){Vs(n),o||di(yh(h.s,h.g,h.b,e,n,null,s,h.c,void 0,h.i,a,h.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(h.a=null),t}))},t.Nb=function(t,e,n,i){this.a||(this.a=vh(mh(this)));var r=this;return this.a.then((function(){Vs(e),di(yh(r.s,r.g,r.b,t,e,fi(),n,r.c,void 0,r.i,i,r.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t}))},t.ma=function(){var t=this;return gh(this).then((function(){return t.v.rb})).o((function(){throw t.a=null,new A("network-request-failed")}))},t.$b=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Sa=function(t){Z(this.h,(function(e){return e==t}))},(t=xh.prototype).get=function(t){return Pe(this.a.getItem(t)).then((function(t){return t&&Vi(t)}))},t.set=function(t,e){return Pe(this.a.setItem(t,Bi(e)))},t.U=function(t){return Pe(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var wh,_h=[];function Th(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Eh(t){this.a=t}function Sh(t){this.c=t,this.b=!1,this.a=[]}function Ch(t,e,n,i){var r,s,o,a,h=n||{},u=null;if(t.b)return Re(Error("connection_unavailable"));var c=i?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new _e((function(n,i){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),o=setTimeout((function(){i(Error("unsupported_event"))}),c),u={messageChannel:l,onMessage:s=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(o),a=setTimeout((function(){i(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(o),clearTimeout(a),i(Error("invalid_response"))))}},t.a.push(u),l.port1.addEventListener("message",s),t.c.postMessage({eventType:e,eventId:r,data:h},[l.port2])):i(Error("connection_unavailable"))})).then((function(e){return Ah(t,u),e})).o((function(e){throw Ah(t,u),e}))}function Ah(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),Z(t.a,(function(t){return t==e}))}}function Ih(){if(!kh())throw new A("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=h.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Ti()&&self?(this.v=function(){var t=Ti()?self:null;if(j(_h,(function(n){n.b==t&&(e=n)})),!e){var e=new bh(t);_h.push(e)}return e}(),Th(this.v,"keyChanged",(function(e,n){return Fh(t).then((function(e){return 0<e.length&&j(t.a,(function(t){t(e)})),{keyProcessed:K(e,n.key)}}))})),Th(this.v,"ping",(function(){return Pe(["keyChanged"])}))):function(){var t=h.navigator;return t&&t.serviceWorker?Pe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Pe(null)}().then((function(e){(t.h=e)&&(t.g=new Sh(new Eh(e)),Ch(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&K(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Ph(t){return new _e((function(e,n){var i=t.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new _e((function(e,n){var i=t.m.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Ph(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Rh(t){return t.i||(t.i=Ph(t)),t.i}function Oh(t,e){var n=0;return new _e((function i(r,s){Rh(t).then(e).then(r).o((function(e){if(!(3<++n))return Rh(t).then((function(e){return e.close(),t.i=void 0,i(r,s)})).o((function(t){s(t)}));s(e)}))}))}function kh(){try{return!!h.indexedDB}catch(t){return!1}}function Mh(t){return t.objectStore("firebaseLocalStorage")}function Dh(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Lh(t){return new _e((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Nh(t,e){return t.g&&t.h&&function(){var t=h.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Ch(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Pe()}function Fh(t){return Rh(t).then((function(t){var e=Mh(Dh(t,!1));return e.getAll?Lh(e.getAll()):new _e((function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=pi(t.c,n),t.c=n}return i}))}function Bh(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Uh(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Pe().then((function(){if(kh()){var t=Yi(),i="__sak"+t;return wh||(wh=new Ih),(n=wh).set(i,t).then((function(){return n.get(i)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(i)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){j(e.a,(function(e){e(t)}))})),t}))}function Vh(){this.a={},this.type="inMemory"}function Yh(){if(!function(){var t="Node"==Ei();if(!(t=zh()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Ei())throw new A("internal-error","The LocalStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=zh()||r.Z.INTERNAL.node.localStorage,this.type="localStorage"}function zh(){try{var t=h.localStorage,e=Yi();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Xh(){this.type="nullStorage"}function Gh(){if(!function(){var t="Node"==Ei();if(!(t=jh()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Ei())throw new A("internal-error","The SessionStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=jh()||r.Z.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function jh(){try{var t=h.sessionStorage,e=Yi();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Wh(){var t={};t.Browser=Kh,t.Node=Qh,t.ReactNative=Zh,t.Worker=Jh,this.a=t[Ei()]}bh.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];j(i,(function(e){r.push(Pe().then((function(){return e(t.origin,t.data.data)})))})),ke(r).then((function(i){var r=[];j(i,(function(t){r.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})})),j(r,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})}))}},Eh.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Sh.prototype.close=function(){for(;0<this.a.length;)Ah(this,this.a[0]);this.b=!0},(t=Ih.prototype).set=function(t,e){var n=this,i=!1;return Oh(this,(function(e){return Lh((e=Mh(Dh(e,!0))).get(t))})).then((function(r){return Oh(n,(function(s){if(s=Mh(Dh(s,!0)),r)return r.value=e,Lh(s.put(r));n.b++,i=!0;var o={};return o.fbase_key=t,o.value=e,Lh(s.add(o))}))})).then((function(){return n.c[t]=e,Nh(n,t)})).oa((function(){i&&n.b--}))},t.get=function(t){return Oh(this,(function(e){return Lh(Mh(Dh(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Oh(this,(function(i){return n=!0,e.b++,Lh(Mh(Dh(i,!0)).delete(t))})).then((function(){return delete e.c[t],Nh(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){Bh(t),function e(){t.f=setTimeout((function(){t.l=Fh(t).then((function(e){0<e.length&&j(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){Z(this.a,(function(e){return e==t})),0==this.a.length&&Bh(this)},(t=Uh.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){Z(this.a,(function(e){return e==t}))},(t=Vh.prototype).get=function(t){return Pe(this.a[t])},t.set=function(t,e){return this.a[t]=e,Pe()},t.U=function(t){return delete this.a[t],Pe()},t.ca=function(){},t.ia=function(){},(t=Yh.prototype).get=function(t){var e=this;return Pe().then((function(){return Vi(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var i=Bi(e);null===i?n.U(t):n.a.setItem(t,i)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(t){h.window&&ln(h.window,"storage",t)},t.ia=function(t){h.window&&pn(h.window,"storage",t)},(t=Xh.prototype).get=function(){return Pe(null)},t.set=function(){return Pe()},t.U=function(){return Pe()},t.ca=function(){},t.ia=function(){},(t=Gh.prototype).get=function(t){var e=this;return Pe().then((function(){return Vi(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var i=Bi(e);null===i?n.U(t):n.a.setItem(t,i)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Hh,qh,Kh={F:Yh,bb:Gh},Qh={F:Yh,bb:Gh},Zh={F:xh,bb:Xh},Jh={F:Yh,bb:Xh},$h={rd:"local",NONE:"none",td:"session"};function tu(){var t=!(zi(Oi())||!_i()),e=Fi(),n=Mi();this.m=t,this.h=e,this.l=n,this.a={},Hh||(Hh=new Wh),t=Hh;try{this.g=!li()&&Hi()||!h.indexedDB?new t.a.F:new Uh(Ti()?new Vh:new t.a.F)}catch(t){this.g=new Vh,this.h=!0}try{this.i=new t.a.bb}catch(t){this.i=new Vh}this.v=new Vh,this.f=_(this.Yb,this),this.b={}}function eu(){return qh||(qh=new tu),qh}function nu(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function iu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ru(t,e,n){return n=iu(e,n),"local"==e.F&&(t.b[n]=null),nu(t,e.F).U(n)}function su(t){t.c&&(clearInterval(t.c),t.c=null)}function ou(t){this.a=t,this.b=eu()}(t=tu.prototype).get=function(t,e){return nu(this,t.F).get(iu(t,e))},t.set=function(t,e,n){var i=iu(t,n),r=this,s=nu(this,t.F);return s.set(i,e).then((function(){return s.get(i)})).then((function(e){"local"==t.F&&(r.b[i]=e)}))},t.addListener=function(t,e,n){t=iu(t,e),this.l&&(this.b[t]=h.localStorage.getItem(t)),vt(this.a)&&(nu(this,"local").ca(this.f),this.h||(li()||!Hi())&&h.indexedDB||!this.l||function(t){su(t),t.c=setInterval((function(){for(var e in t.a){var n=h.localStorage.getItem(e),i=t.b[e];n!=i&&(t.b[e]=n,n=new $e({type:"storage",key:e,target:window,oldValue:i,newValue:n,a:!0}),t.Yb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=iu(t,e),this.a[t]&&(Z(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(nu(this,"local").ia(this.f),su(this))},t.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=h.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?nu(this,"local").ia(this.f):su(this),this.m)if(n=h.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?h.localStorage.setItem(e,i):h.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var s=this;n=function(){void 0===t.a.a&&s.b[e]===h.localStorage.getItem(e)||(s.b[e]=h.localStorage.getItem(e),s.mb(e))},Qt&&he&&10==he&&h.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else j(t,_(this.mb,this))},t.mb=function(t){this.a[t]&&j(this.a[t],(function(t){t()}))};var au,hu={name:"authEvent",F:"local"};function uu(){this.a=eu()}function cu(t,e){this.b=lu,this.f=h.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=h.Int32Array?new Int32Array(64):Array(64),void 0===au&&(au=h.Int32Array?new Int32Array(yu):yu),this.reset()}S(cu,(function(){this.b=-1}));for(var lu=64,fu=lu-1,du=[],pu=0;pu<fu;pu++)du[pu]=0;var vu=J(128,du);function gu(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var s=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,o=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=s+o|0}i=0|t.a[0],r=0|t.a[1];var a=0|t.a[2],h=0|t.a[3],u=0|t.a[4],c=0|t.a[5],l=0|t.a[6];for(s=0|t.a[7],e=0;64>e;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&a^r&a)|0;o=(s=s+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))|0)+((o=(o=u&c^~u&l)+(0|au[e])|0)+(0|n[e])|0)|0,s=l,l=c,c=u,u=h+o|0,h=a,a=r,r=i,i=o+f|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+h|0,t.a[4]=t.a[4]+u|0,t.a[5]=t.a[5]+c|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+s|0}function mu(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if("string"==typeof e)for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(gu(t),r=0);else{if(!p(e))throw Error("message must be string or array");for(;i<n;){var s=e[i++];if(!("number"==typeof s&&0<=s&&255>=s&&s==(0|s)))throw Error("message must be a byte array");t.f[r++]=s,r==t.b&&(gu(t),r=0)}}t.c=r,t.g+=n}cu.prototype.reset=function(){this.g=this.c=0,this.a=h.Int32Array?new Int32Array(this.h):$(this.h)};var yu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function xu(){cu.call(this,8,bu)}S(xu,cu);var bu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function wu(t,e,n,i,r,s){this.v=t,this.i=e,this.l=n,this.m=i||null,this.u=r||null,this.s=s,this.h=e+":"+n,this.C=new uu,this.g=new ou(this.h),this.f=null,this.b=[],this.a=this.c=null}function _u(t){return new A("invalid-cordova-configuration",t)}function Tu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Eu(t){return t.f||(t.f=t.ma().then((function(){return new _e((function(e){t.Ea((function n(i){return e(i),t.Sa(n),!1})),function(t){function e(e){i=!0,r&&r.cancel(),Su(t).then((function(i){var r=n;if(i&&e&&e.url){var s=null;-1!=(r=os(e.url)).indexOf("/__/auth/callback")&&(s=(s="object"==typeof(s=Vi(Vn(s=Yn(r),"firebaseError")||null))?I(s):null)?new Ys(i.c,i.b,null,null,s,null,i.T()):new Ys(i.c,i.b,r,i.f,null,null,i.T())),r=s||n}Tu(t,r)}))}var n=new Ys("unknown",null,null,null,new A("no-auth-event")),i=!1,r=In(500).then((function(){return Su(t).then((function(){i||Tu(t,n)}))})),s=h.handleOpenURL;h.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(ki("BuildInfo.packageName",h).toLowerCase()+"://")&&e({url:t}),"function"==typeof s)try{s(t)}catch(t){console.error(t)}},js||(js=new Xs),function(t){var e=js;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=ki("universalLinks.subscribe",h))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Su(t){var e=null;return function(t){return t.b.get(hu,t.a).then((function(t){return zs(t)}))}(t.g).then((function(n){return e=n,ru((n=t.g).b,hu,n.a)})).then((function(){return e}))}function Cu(t){this.a=t,this.b=eu()}(t=wu.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wi(void 0)?bi().then((function(){return new _e((function(t,e){var n=h.document,i=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(i),t()}),!1)}))})):Re(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof ki("universalLinks.subscribe",h))throw _u("cordova-universal-links-plugin-fix is not installed");if(void 0===ki("BuildInfo.packageName",h))throw _u("cordova-plugin-buildinfo is not installed");if("function"!=typeof ki("cordova.plugins.browsertab.openUrl",h))throw _u("cordova-plugin-browsertab is not installed");if("function"!=typeof ki("cordova.InAppBrowser.open",h))throw _u("cordova-plugin-inappbrowser is not installed")}),(function(){throw new A("cordova-not-ready")}))},t.Ob=function(t,e){return e(new A("operation-not-supported-in-this-environment")),Pe()},t.Mb=function(){return Re(new A("operation-not-supported-in-this-environment"))},t.$b=function(){return!1},t.Xb=function(){return!0},t.Tb=function(){return!0},t.Nb=function(t,e,n,i){if(this.c)return Re(new A("redirect-operation-pending"));var r=this,s=h.document,o=null,a=null,u=null,c=null;return this.c=Pe().then((function(){return Vs(e),Eu(r)})).then((function(){return function(t,e,n,i,r){var s=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),o=new Ys(e,i,null,s,new A("no-auth-event"),null,r),a=ki("BuildInfo.packageName",h);if("string"!=typeof a)throw new A("invalid-cordova-configuration");var u=ki("BuildInfo.displayName",h),c={};if(Oi().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=a;else{if(!Oi().toLowerCase().match(/android/))return Re(new A("operation-not-supported-in-this-environment"));c.apn=a}u&&(c.appDisplayName=u),s=function(t){var e=new xu;mu(e,t),t=[];var n=8*e.g;56>e.c?mu(e,vu,56-e.c):mu(e,vu,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(gu(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return H(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(s),c.sessionId=s;var l=yh(t.v,t.i,t.l,e,n,null,i,t.m,c,t.u,r,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(hu,o.w(),e)})).then((function(){var e=ki("cordova.plugins.browsertab.isAvailable",h);if("function"!=typeof e)throw new A("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=ki("cordova.plugins.browsertab.openUrl",h)))throw new A("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=ki("cordova.InAppBrowser.open",h)))throw new A("invalid-cordova-configuration");e=Oi(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(r,t,e,n,i)})).then((function(){return new _e((function(t,e){a=function(){var e=ki("cordova.plugins.browsertab.close",h);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Ea(a),u=function(){o||(o=In(2e3).then((function(){e(new A("redirect-cancelled-by-user"))})))},c=function(){ji()&&u()},s.addEventListener("resume",u,!1),Oi().toLowerCase().match(/android/)||s.addEventListener("visibilitychange",c,!1)})).o((function(t){return Su(r).then((function(){throw t}))}))})).oa((function(){u&&s.removeEventListener("resume",u,!1),c&&s.removeEventListener("visibilitychange",c,!1),o&&o.cancel(),a&&r.Sa(a),r.c=null}))},t.Ea=function(t){this.b.push(t),Eu(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ys("unknown",null,null,null,new A("no-auth-event")),t(e))}))},t.Sa=function(t){Z(this.b,(function(e){return e==t}))};var Au={name:"pendingRedirect",F:"session"};function Iu(t){return ru(t.b,Au,t.a)}function Pu(t,e,n,i){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=i,this.h=[],this.f=!1,this.l=_(this.s,this),this.b=new Gu,this.C=new Ku,this.g=new Cu(zu(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Ru(this.D,this.v,this.m,P,this.J)}function Ru(t,e,n,i,s){var o=r.Z.SDK_VERSION||null;return wi()?new wu(t,e,n,o,i,s):new ph(t,e,n,o,i,s)}function Ou(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function ku(t){t.a.Xb()&&Ou(t).o((function(e){var n=new Ys("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Bu(e)&&t.s(n)})),t.a.Tb()||ju(t.b)}function Mu(t,e){K(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Au,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Iu(t.g).then((function(){Ou(t).o((function(e){var n=new Ys("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Bu(e)&&t.s(n)}))})):ku(t)})).o((function(){ku(t)}))}function Du(t,e){Z(t.h,(function(t){return t==e}))}Pu.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Ru(this.D,this.v,this.m,null,this.J),this.i={}},Pu.prototype.s=function(t){if(!t)throw new A("invalid-auth-event");if(6e5<=E()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=E())),e=!0;break}}return ju(this.b),e};var Lu=new Gi(2e3,1e4),Nu=new Gi(3e4,6e4);function Fu(t,e,n,i,r,s,o){return t.a.Mb(e,n,i,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),r,s,o)}function Bu(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Uu(t,e,n,i,r){var s;return function(t){return t.b.set(Au,"pending",t.a)}(t.g).then((function(){return t.a.Nb(e,n,i,r).o((function(e){if(Bu(e))throw new A("operation-not-supported-in-this-environment");return s=e,Iu(t.g).then((function(){throw s}))})).then((function(){return t.a.$b()?new _e((function(){})):Iu(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function Vu(t,e,n,i,r){return t.a.Ob(i,(function(t){e.na(n,null,t,r)}),Lu.get())}Pu.prototype.qa=function(){return this.b.qa()};var Yu={};function zu(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Xu(t,e,n,i){var r=zu(e,n,i);return Yu[r]||(Yu[r]=new Pu(t,e,n,i)),Yu[r]}function Gu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function ju(t){t.g||(t.g=!0,qu(t,!1,null,null))}function Wu(t){t.g&&!t.i&&qu(t,!1,null,null)}function Hu(t,e){if(t.b=function(){return Pe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function qu(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Re(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):Hu(t,n):Hu(t,{user:null}),t.f=[],t.c=[]}function Ku(){}function Qu(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Zu(t,e){this.a=e,Ji(this,"verificationId",t)}function Ju(t,e,n,i){return new Fs(t).fb(e,n).then((function(t){return new Zu(t,i)}))}function $u(t){var e=Wr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new A("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");$i(this,{token:t,expirationTime:Wi(1e3*e.exp),authTime:Wi(1e3*e.auth_time),issuedAtTime:Wi(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function tc(t,e,n){var i=e&&e[nc];if(!i)throw new A("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new as(null,i),this.b=[];var r=this;j(e[ec]||[],(function(t){(t=ir(t))&&r.b.push(t)})),Ji(this,"auth",this.a),Ji(this,"session",this.c),Ji(this,"hints",this.b)}Gu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Gu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,s=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!s),"unknown"!=n||r||s?t.a?(qu(this,!0,null,t.a),Pe()):e.Fa(n,i)?function(t,e,n){n=n.Fa(e.c,e.b);var i=e.g,r=e.f,s=e.i,o=e.T(),a=!!e.c.match(/Redirect$/);n(i,r,o,s).then((function(e){qu(t,a,e,null)})).o((function(e){qu(t,a,null,e)}))}(this,t,e):Re(new A("invalid-auth-event")):(qu(this,!1,null,null),Pe())}else Re(new A("invalid-auth-event"))},Gu.prototype.qa=function(){var t=this;return new _e((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new A("timeout");t.a&&t.a.cancel(),t.a=In(Nu.get()).then((function(){t.b||(t.g=!0,qu(t,!0,null,e))}))}(t))}))},Ku.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.na(t.c,null,t.a,t.b),Pe()):e.Fa(n,i)?function(t,e){var n=t.b,i=t.c;e.Fa(i,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(i,t,null,n)})).o((function(t){e.na(i,null,t,n)}))}(t,e):Re(new A("invalid-auth-event"))}else Re(new A("invalid-auth-event"))},Zu.prototype.confirm=function(t){return t=Bs(this.verificationId,t),this.a(t)};var ec="mfaInfo",nc="mfaPendingCredential";function ic(t,e,n,i){A.call(this,"multi-factor-auth-required",i,e),this.b=new tc(t,e,n),Ji(this,"resolver",this.b)}function rc(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new ic(e,t.serverResponse,n,t.message)}catch(t){}return null}function sc(){}function oc(t){Ji(this,"factorId",t.fa),this.a=t}function ac(t){if(oc.call(this,t),this.a.fa!=Fs.PROVIDER_ID)throw new A("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function hc(t,e){for(var n in Je.call(this,t),e)this[n]=e[n]}function uc(t,e){this.a=t,this.b=[],this.c=_(this.yc,this),ln(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&j(e.multiFactor.enrolledFactors,(function(t){var e=null,i={};if(t){t.uid&&(i[or]=t.uid),t.displayName&&(i[rr]=t.displayName),t.enrollmentTime&&(i[sr]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(i[ar]=t.phoneNumber);try{e=new hr(i)}catch(t){}t=e}else t=null;t&&n.push(t)})),cc(this,n)}function cc(t,e){t.b=e,Ji(t,"enrolledFactors",e)}function lc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fc(t,e){t.stop(),t.b=In(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=h.document,e=null;return ji()||!t?Pe():new _e((function(n){e=function(){ji()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){fc(t,!0)})).o((function(e){t.i(e)&&fc(t,!1)}))}function dc(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function pc(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function vc(t,e){t.b=jr(e[$o]||""),t.a=e.refreshToken,pc(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function gc(t,e){this.a=t||null,this.b=e||null,$i(this,{lastSignInTime:Wi(e||null),creationTime:Wi(t||null)})}function mc(t,e,n,i,r,s){$i(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:s||null,providerId:e})}function yc(t,e,n){this.J=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.Z.SDK_VERSION?Ri(r.Z.SDK_VERSION):null;this.a=new Zo(this.l,M(P),i),t.emulatorConfig&&sa(this.a,t.emulatorConfig),this.b=new dc(this.a),Cc(this,e[$o]),vc(this.b,e),Ji(this,"refreshToken",this.b.a),Pc(this,n||{}),Tn.call(this),this.R=!1,this.s&&Di()&&(this.i=Xu(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new lc((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.aa=_(this.hb,this);var s=this;this.ya=null,this.Oa=function(t){s.wa(t.h)},this.ja=null,this.Aa=function(t){sa(s.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){wc(s,t.f)},this.ba=null,this.O=new uc(this,n),Ji(this,"multiFactor",this.O)}function xc(t,e){t.ja&&pn(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&ln(e,"languageCodeChanged",t.Oa)}function bc(t,e){t.X&&pn(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&ln(e,"emulatorConfigChanged",t.Aa)}function wc(t,e){t.$=e,aa(t.a,r.Z.SDK_VERSION?Ri(r.Z.SDK_VERSION,t.$):null)}function _c(t,e){t.ba&&pn(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&ln(e,"frameworkChanged",t.Ba)}function Tc(t){try{return r.Z.app(t.m).auth()}catch(e){throw new A("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Ec(t){t.D||t.u.b||(t.u.start(),pn(t,"tokenChanged",t.aa),ln(t,"tokenChanged",t.aa))}function Sc(t){pn(t,"tokenChanged",t.aa),t.u.stop()}function Cc(t,e){t.za=e,Ji(t,"_lat",e)}function Ac(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return ke(e).then((function(){return t}))}function Ic(t){t.i&&!t.R&&(t.R=!0,Mu(t.i,t))}function Pc(t,e){$i(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new gc(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Rc(){}function Oc(t){return Pe().then((function(){if(t.D)throw new A("app-deleted")}))}function kc(t){return H(t.providerData,(function(t){return t.providerId}))}function Mc(t,e){e&&(Dc(t,e.providerId),t.providerData.push(e))}function Dc(t,e){Z(t.providerData,(function(t){return t.providerId==e}))}function Lc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Ji(t,e,n)}function Nc(t,e){t!=e&&($i(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Ji(t,"metadata",function(t){return new gc(t.a,t.b)}(e.metadata)):Ji(t,"metadata",new gc),j(e.providerData,(function(e){Mc(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Ji(t,"refreshToken",t.b.a),cc(t.O,e.O.b))}function Fc(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return ih(t.a,Da,{idToken:e}).then(_(t.Kc,t))}(t,e).then((function(){return n||Lc(t,"isAnonymous",!1),e}))}))}function Bc(t,e){e[$o]&&t.za!=e[$o]&&(vc(t.b,e),t.dispatchEvent(new hc("tokenChanged")),Cc(t,e[$o]),Lc(t,"refreshToken",t.b.a))}function Uc(t,e){return Fc(t).then((function(){if(K(kc(t),e))return Ac(t).then((function(){throw new A("provider-already-linked")}))}))}function Vc(t,e,n){return tr({user:t,credential:Us(e),additionalUserInfo:e=Zr(e),operationType:n})}function Yc(t,e){return Bc(t,e),t.reload().then((function(){return t}))}function zc(t,e,n,i,s){if(!Di())return Re(new A("operation-not-supported-in-this-environment"));if(t.h&&!s)return Re(t.h);var o=Qr(n.providerId),a=Yi(t.uid+":::"),h=null;(!Fi()||_i())&&t.s&&n.isOAuthProvider&&(h=yh(t.s,t.l,t.m,e,n,null,a,r.Z.SDK_VERSION||null,null,null,t.tenantId));var u=mi(h,o&&o.ua,o&&o.ta);return i=i().then((function(){if(Gc(t),!s)return t.I().then((function(){}))})).then((function(){return Fu(t.i,u,e,n,a,!!h,t.tenantId)})).then((function(){return new _e((function(n,i){t.na(e,null,new A("cancelled-popup-request"),t.g||null),t.f=n,t.C=i,t.g=a,t.c=Vu(t.i,t,e,u,a)}))})).then((function(t){return u&&gi(u),t?tr(t):null})).o((function(t){throw u&&gi(u),t})),jc(t,i,s)}function Xc(t,e,n,i,r){if(!Di())return Re(new A("operation-not-supported-in-this-environment"));if(t.h&&!r)return Re(t.h);var s=null,o=Yi(t.uid+":::");return i=i().then((function(){if(Gc(t),!r)return t.I().then((function(){}))})).then((function(){return t.ga=o,Ac(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(qc,t.w(),e.a)),e})).then((function(){return Uu(t.i,e,n,o,t.tenantId)})).o((function(e){if(s=e,t.ha)return Kc(t.ha);throw s})).then((function(){if(s)throw s})),jc(t,i,r)}function Gc(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new A("internal-error");throw new A("auth-domain-config-required")}}function jc(t,e,n){var i=function(t,e,n){return t.h&&!n?(e.cancel(),Re(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new hc("userInvalidated")),t.h=e),e}))}(t,e,n);return t.J.push(i),i.oa((function(){Q(t.J,i)})),i.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=rc(e.w(),Tc(t),_(t.jc,t))),n||e}))}function Wc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[$o]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var i=t.stsTokenManager.expirationTime;i&&(n.expiresIn=(i-Date.now())/1e3);var r=new yc(e,n,t);return t.providerData&&j(t.providerData,(function(t){t&&Mc(r,tr(t))})),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Hc(t){this.a=t,this.b=eu()}tc.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[ec],delete n[nc],yt(n,t),e.g(n)}))},S(ic,A),sc.prototype.sb=function(t,e,n){return e.type==hs?function(t,e,n,i){return n.Ha().then((function(n){return n={idToken:n},void 0!==i&&(n.displayName=i),yt(n,{phoneVerificationInfo:Ns(t.a)}),ih(e,ka,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return yt(n={mfaPendingCredential:n},{phoneVerificationInfo:Ns(t.a)}),ih(e,Ma,n)}))}(this,t,e)},S(oc,sc),S(ac,oc),S(hc,Je),(t=uc.prototype).yc=function(t){cc(this,function(t){var e=[];return j(t.mfaInfo||[],(function(t){(t=ir(t))&&e.push(t)})),e}(t.hd))},t.Rb=function(){return this.a.I().then((function(t){return new as(t,null)}))},t.fc=function(t,e){var n=this,i=this.a.a;return this.Rb().then((function(n){return t.sb(i,n,e)})).then((function(t){return Bc(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,i=this.a.a;return this.a.I().then((function(t){return ih(i,nh,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var i=W(e.b,(function(t){return t.uid!=n}));return cc(e,i),Bc(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:H(this.b,(function(t){return t.w()}))}}},lc.prototype.start=function(){this.a=this.c,fc(this,!0)},lc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},dc.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},dc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Re(new A("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new _e((function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ha(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?i(sh(t)):t.access_token&&t.refresh_token?n(t):i(new A("internal-error")):i(new A("network-request-failed"))}),"POST",$n(e).toString(),t.g,t.m.get()):i(new A("internal-error"))}))}(t.f,e).then((function(e){return t.b=jr(e.access_token),t.a=e.refresh_token,pc(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Pe(null):Pe({accessToken:this.b.toString(),refreshToken:this.a})},gc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(yc,Tn),yc.prototype.wa=function(t){this.ya=t,ra(this.a,t)},yc.prototype.la=function(){return this.ya},yc.prototype.Ga=function(){return $(this.$)},yc.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},Ji(yc.prototype,"providerId","firebase"),(t=yc.prototype).reload=function(){var t=this;return jc(this,Oc(this).then((function(){return Fc(t).then((function(){return Ac(t)})).then(Rc)})))},t.oc=function(t){return this.I(t).then((function(t){return new $u(t)}))},t.I=function(t){var e=this;return jc(this,Oc(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new A("internal-error");return t.accessToken!=e.za&&(Cc(e,t.accessToken),e.dispatchEvent(new hc("tokenChanged"))),Lc(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new A("internal-error");Pc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?H(t,(function(t){return new mc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Mc(this,e[n]);Lc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new hc("userReloaded",{hd:t}))},t.Lc=function(t){return Qi("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},t.tb=function(t){var e=this,n=null;return jc(this,t.c(this.a,this.uid).then((function(t){return Bc(e,t),n=Vc(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Qi("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},t.qb=function(t){var e=this,n=null;return jc(this,Uc(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Vc(e,t,"link"),Yc(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return jc(this,Uc(this,"phone").then((function(){return Ju(Tc(n),t,e,_(n.qb,n))})))},t.Mc=function(t,e){var n=this;return jc(this,Pe().then((function(){return Ju(Tc(n),t,e,_(n.tb,n))})),!0)},t.Bb=function(t){var e=this;return jc(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Bc(e,t),e.reload()})))},t.ed=function(t){var e=this;return jc(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Bc(e,t),e.reload()})))},t.Cb=function(t){var e=this;return jc(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Bc(e,t),e.reload()})))},t.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Oc(this);var e=this;return jc(this,this.I().then((function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Bc(e,t),Lc(e,"displayName",t.displayName||null),Lc(e,"photoURL",t.photoUrl||null),j(e.providerData,(function(t){"password"===t.providerId&&(Ji(t,"displayName",e.displayName),Ji(t,"photoURL",e.photoURL))})),Ac(e)})).then(Rc))},t.cd=function(t){var e=this;return jc(this,Fc(this).then((function(n){return K(kc(e),t)?function(t,e,n){return ih(t,Pa,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return j(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),j(kc(e),(function(t){n[t]||Dc(e,t)})),n[Fs.PROVIDER_ID]||Ji(e,"phoneNumber",null),Ac(e)})):Ac(e).then((function(){throw new A("no-such-provider")}))})))},t.delete=function(){var t=this;return jc(this,this.I().then((function(e){return ih(t.a,Ia,{idToken:e})})).then((function(){t.dispatchEvent(new hc("userDeleted"))}))).then((function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");xc(t,null),bc(t,null),_c(t,null),t.J=[],t.D=!0,Sc(t),Ji(t,"refreshToken",null),t.i&&Du(t.i,t)}))},t.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?_(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?_(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?_(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?_(this.Lb,this):null},t.Ec=function(t){var e=this;return zc(this,"linkViaPopup",t,(function(){return Uc(e,t.providerId).then((function(){return Ac(e)}))}),!1)},t.Nc=function(t){return zc(this,"reauthViaPopup",t,(function(){return Pe()}),!0)},t.Fc=function(t){var e=this;return Xc(this,"linkViaRedirect",t,(function(){return Uc(e,t.providerId)}),!1)},t.Oc=function(t){return Xc(this,"reauthViaRedirect",t,(function(){return Pe()}),!0)},t.Kb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var s=null;return jc(this,this.I().then((function(n){return wa(r.a,{requestUri:t,postBody:i,sessionId:e,idToken:n})})).then((function(t){return s=Vc(r,t,"link"),Yc(r,t)})).then((function(){return s})))},t.Lb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var s=null;return jc(this,Pe().then((function(){return ls(_a(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)})).then((function(t){return s=Vc(r,t,"reauthenticate"),Bc(r,t),r.h=null,r.reload()})).then((function(){return s})),!0)},t.ub=function(t){var e=this,n=null;return jc(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:zr(new kr(t))})).then((function(t){return e.a.ub(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Eb=function(t,e){var n=this,i=null;return jc(this,this.I().then((function(t){return i=t,void 0===e||vt(e)?{}:zr(new kr(e))})).then((function(e){return n.a.Eb(i,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return jc(this,t=ls(Pe(t),n.uid).then((function(t){return e=Vc(n,t,"reauthenticate"),Bc(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&yt(t,this.metadata.w()),j(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),yt(t,this.O.w()),t};var qc={name:"redirectUser",F:"session"};function Kc(t){return ru(t.b,qc,t.a)}function Qc(t){this.a=t,this.b=eu(),this.c=null,this.f=function(t){var e=$c("local"),n=$c("session"),i=$c("none");return function(t,e,n){var i=iu(e,n),r=nu(t,e.F);return t.get(e,n).then((function(s){var o=null;try{o=Vi(h.localStorage.getItem(i))}catch(t){}if(o&&!s)return h.localStorage.removeItem(i),t.set(e,o,n);o&&s&&"localStorage"!=r.type&&h.localStorage.removeItem(i)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(r){return r?n:t.b.get(i,t.a).then((function(n){return n?i:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Jc,t.a).then((function(t){return t?$c(t):e}))}))}))})).then((function(e){return t.c=e,Zc(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener($c("local"),this.a,_(this.g,this))}function Zc(t,e){var n,i=[];for(n in $h)$h[n]!==e&&i.push(ru(t.b,$c($h[n]),t.a));return i.push(ru(t.b,Jc,t.a)),function(t){return new _e((function(e,n){var i=t.length,r=[];if(i)for(var s=function(t,n){i--,r[t]=n,0==i&&e(r)},o=function(t){n(t)},a=0;a<t.length;a++)Oe(t[a],T(s,a),o);else e(r)}))}(i)}Qc.prototype.g=function(){var t=this,e=$c("local");il(this,(function(){return Pe().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Zc(t,"local").then((function(){t.c=e}))}))}))};var Jc={name:"persistence",F:"session"};function $c(t){return{name:"authUser",F:t}}function tl(t,e){return il(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function el(t){return il(t,(function(){return ru(t.b,t.c,t.a)}))}function nl(t,e,n){return il(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Wc(t||{})}))}))}function il(t,e){return t.f=t.f.then(e,e),t.f}function rl(t){if(this.l=!1,Ji(this,"settings",new Qu),Ji(this,"app",t),!fl(this).options||!fl(this).options.apiKey)throw new A("invalid-api-key");t=r.Z.SDK_VERSION?Ri(r.Z.SDK_VERSION):null,this.a=new Zo(fl(this).options&&fl(this).options.apiKey,M(P),t),this.R=[],this.s=[],this.O=[],this.hb=r.Z.INTERNAL.createSubscribe(_(this.zc,this)),this.X=void 0,this.bc=r.Z.INTERNAL.createSubscribe(_(this.Ac,this)),cl(this,null),this.i=new Qc(fl(this).options.apiKey+":"+fl(this).name),this.D=new Hc(fl(this).options.apiKey+":"+fl(this).name),this.$=gl(this,function(t){var e=fl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(qc,t.a).then((function(t){return t&&e&&(t.authDomain=e),Wc(t||{})}))}(t.D,fl(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Kc(t.D)}));return gl(t,e)}(t).then((function(){return nl(t.i,e,t.P)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return tl(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:el(t.i)}))):null})).then((function(e){cl(t,e||null)}));return gl(t,n)}(this)),this.h=gl(this,function(t){return t.$.then((function(){return ul(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener($c("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=_(this.Zc,this),this.Ba=_(this.da,this),this.ya=_(this.mc,this),this.za=_(this.wc,this),this.Aa=_(this.xc,this),this.b=null,function(t){var e=fl(t).options.authDomain,n=fl(t).options.apiKey;e&&Di()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Xu(e,n,fl(t).name,t.P),Mu(t.b,t),dl(t)&&Ic(dl(t)),t.m){Ic(t.m);var i=t.m;i.wa(t.la()),xc(i,t),wc(i=t.m,t.J),_c(i,t),sa((i=t.m).a,t.P),bc(i,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=_(this.delete,this),this.INTERNAL.logFramework=_(this.Gc,this),this.u=0,Tn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=Yn(this.P.url);t=tr({protocol:t.c,host:t.a,port:t.g,options:tr({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function sl(t){Je.call(this,"languageCodeChanged"),this.h=t}function ol(t){Je.call(this,"emulatorConfigChanged"),this.c=t}function al(t){Je.call(this,"frameworkChanged"),this.f=t}function hl(t){return t.Oa||Re(new A("auth-domain-config-required"))}function ul(t){if(!Di())return Re(new A("operation-not-supported-in-this-environment"));var e=hl(t).then((function(){return t.b.qa()})).then((function(t){return t?tr(t):null}));return gl(t,e)}function cl(t,e){dl(t)&&(function(t,e){Z(t.S,(function(t){return t==e}))}(dl(t),t.Ba),pn(dl(t),"tokenChanged",t.ya),pn(dl(t),"userDeleted",t.za),pn(dl(t),"userInvalidated",t.Aa),Sc(dl(t))),e&&(e.S.push(t.Ba),ln(e,"tokenChanged",t.ya),ln(e,"userDeleted",t.za),ln(e,"userInvalidated",t.Aa),0<t.u&&Ec(e)),Ji(t,"currentUser",e),e&&(e.wa(t.la()),xc(e,t),wc(e,t.J),_c(e,t),sa(e.a,t.P),bc(e,t))}function ll(t,e){var n=null,i=null;return gl(t,e.then((function(e){return n=Us(e),i=Zr(e),function(t,e){var n={};return n.apiKey=fl(t).options.apiKey,n.authDomain=fl(t).options.authDomain,n.appName=fl(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then((function(){return function(t,e,n,i){var r=new yc(t,e);return n&&(r.ha=n),i&&wc(r,i),r.reload().then((function(){return r}))}(n,e,t.D,t.Ga())})).then((function(e){return dl(t)&&e.uid==dl(t).uid?(Nc(dl(t),e),t.da(e)):(cl(t,e),Ic(e),t.da(e))})).then((function(){vl(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=rc(e.w(),t,_(t.kc,t))),n||e})).then((function(){return tr({user:dl(t),credential:n,additionalUserInfo:i,operationType:"signIn"})})))}function fl(t){return t.app}function dl(t){return t.currentUser}function pl(t){return dl(t)&&dl(t)._lat||null}function vl(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](pl(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](pl(t))}}function gl(t,e){return t.R.push(e),e.oa((function(){Q(t.R,e)})),e}function ml(){}function yl(){this.a={},this.b=1e12}Qc.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new A("invalid-persistence-type"),n=new A("unsupported-persistence-type");t:{for(i in $h)if($h[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(Ei()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!kh()&&"none"!==t)throw n;break;default:if(!Mi()&&"none"!==t)throw n}}(t),il(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(i){return e=i,Zc(n,t)})).then((function(){if(n.c=$c(t),e)return n.b.set(n.c,e,n.a)})):Pe()}))},S(rl,Tn),S(sl,Je),S(ol,Je),S(al,Je),(t=rl.prototype).xb=function(t){return gl(this,t=this.i.xb(t))},t.wa=function(t){this.aa===t||this.l||(this.aa=t,ra(this.a,this.aa),this.dispatchEvent(new sl(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=h.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new A("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),h.document&&!t&&bi().then((function(){var t=h.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),h.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,sa(this.a,this.P),this.dispatchEvent(new ol(this.P))}},t.Gc=function(t){this.J.push(t),aa(this.a,r.Z.SDK_VERSION?Ri(r.Z.SDK_VERSION,this.J):null),this.dispatchEvent(new al(this.J))},t.Ga=function(){return $(this.J)},t.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:fl(this).options.apiKey,authDomain:fl(this).options.authDomain,appName:fl(this).name,currentUser:dl(this)&&dl(this).w()}},t.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?_(this.ic,this):null},t.ic=function(t,e,n,i){var r=this,s={requestUri:t,postBody:i,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),r.$.then((function(){return ll(r,ba(r.a,s))}))},t.Xc=function(t){if(!Di())return Re(new A("operation-not-supported-in-this-environment"));var e=this,n=Qr(t.providerId),i=Yi(),s=null;(!Fi()||_i())&&fl(this).options.authDomain&&t.isOAuthProvider&&(s=yh(fl(this).options.authDomain,fl(this).options.apiKey,fl(this).name,"signInViaPopup",t,null,i,r.Z.SDK_VERSION||null,null,null,this.T(),this.P));var o=mi(s,n&&n.ua,n&&n.ta);return gl(this,n=hl(this).then((function(n){return Fu(n,o,"signInViaPopup",t,i,!!s,e.T())})).then((function(){return new _e((function(t,n){e.na("signInViaPopup",null,new A("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=Vu(e.b,e,"signInViaPopup",o,i)}))})).then((function(t){return o&&gi(o),t?tr(t):null})).o((function(t){throw o&&gi(o),t})))},t.Yc=function(t){if(!Di())return Re(new A("operation-not-supported-in-this-environment"));var e=this;return gl(this,hl(this).then((function(){return function(t){return il(t,(function(){return t.b.set(Jc,t.c.F,t.a)}))}(e.i)})).then((function(){return Uu(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.qa=function(){var t=this;return ul(this).then((function(e){return t.b&&Wu(t.b.b),e})).o((function(e){throw t.b&&Wu(t.b.b),e}))},t.dd=function(t){if(!t)return Re(new A("null-user"));if(this.S!=t.tenantId)return Re(new A("tenant-id-mismatch"));var e=this,n={};n.apiKey=fl(this).options.apiKey,n.authDomain=fl(this).options.authDomain,n.appName=fl(this).name;var i=function(t,e,n,i){var r=t.b,s={};return s[$o]=r.b&&r.b.toString(),s.refreshToken=r.a,e=new yc(e||{apiKey:t.l,authDomain:t.s,appName:t.m},s),n&&(e.ha=n),i&&wc(e,i),Nc(e,t),e}(t,n,e.D,e.Ga());return gl(this,this.h.then((function(){if(fl(e).options.apiKey!=t.l)return i.reload()})).then((function(){return dl(e)&&t.uid==dl(e).uid?(Nc(dl(e),t),e.da(t)):(cl(e,i),Ic(i),e.da(i))})).then((function(){vl(e)})))},t.Ab=function(){var t=this;return gl(this,this.h.then((function(){return t.b&&Wu(t.b.b),dl(t)?(cl(t,null),el(t.i).then((function(){vl(t)}))):Pe()})))},t.Zc=function(){var t=this;return nl(this.i,fl(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=dl(t)&&e){n=dl(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return Nc(dl(t),e),dl(t).I();(dl(t)||e)&&(cl(t,e),e&&(Ic(e),e.ha=t.D),t.b&&Mu(t.b,t),vl(t))}}))},t.da=function(t){return tl(this.i,t)},t.mc=function(){vl(this),this.da(dl(this))},t.wc=function(){this.Ab()},t.xc=function(){this.Ab()},t.kc=function(t){var e=this;return this.h.then((function(){return ll(e,Pe(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(dl(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.O.push(e),gl(t,t.h.then((function(){!t.l&&K(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(pl(t)))})))}(this,(function(){t.next(dl(e))}))},t.Ic=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(dl(i)):"function"==typeof t.next&&t.next(dl(i))})),this.hb(t,e,n)},t.Hc=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then((function(){i.X=i.getUid(),"function"==typeof t?t(dl(i)):"function"==typeof t.next&&t.next(dl(i))})),this.bc(t,e,n)},t.nc=function(t){var e=this;return gl(this,this.h.then((function(){return dl(e)?dl(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return ll(e,ih(e.a,Za,{token:t}))})).then((function(t){var n=t.user;return Lc(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ih(n.a,Ja,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ih(n.a,Ca,{email:t,password:e}))}))},t.$a=function(t){var e=this;return this.h.then((function(){return ll(e,t.ka(e.a))}))},t.Sc=function(t){return Qi("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},t.zb=function(){var t=this;return this.h.then((function(){var e=dl(t);if(e&&e.isAnonymous){var n=tr({providerId:null,isNewUser:!1});return tr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ll(t,t.a.zb()).then((function(e){var n=e.user;return Lc(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return dl(this)&&dl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&dl(this)&&Ec(dl(this))},t.Pc=function(t){var e=this;j(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&dl(this)&&Sc(dl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),gl(this,this.h.then((function(){e.l||K(e.s,t)&&t(pl(e))})))},t.removeAuthTokenListener=function(t){Z(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener($c("local"),t.a,this.ja),this.b&&(Du(this.b,this),Wu(this.b.b)),Promise.resolve()},t.hc=function(t){return gl(this,function(t,e){return ih(t,Aa,{identifier:e,continueUri:Li()?fi():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Ms(t)},t.wb=function(t,e){var n=this;return gl(this,Pe().then((function(){var t=new kr(e);if(!t.c)throw new A("argument-error",Lr+" must be true when sending sign in link to email");return zr(t)})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.jd=function(t){return this.Ra(t).then((function(t){return t.data.email}))},t.nb=function(t,e){return gl(this,this.a.nb(t,e).then((function(){})))},t.Ra=function(t){return gl(this,this.a.Ra(t).then((function(t){return new ur(t)})))},t.jb=function(t){return gl(this,this.a.jb(t).then((function(){})))},t.vb=function(t,e){var n=this;return gl(this,Pe().then((function(){return void 0===e||vt(e)?{}:zr(new kr(e))})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.Wc=function(t,e){return gl(this,Ju(this,t,e,_(this.$a,this)))},t.Vc=function(t,e){var n=this;return gl(this,Pe().then((function(){var i=e||fi(),r=ks(t,i);if(!(i=Ms(i)))throw new A("argument-error","Invalid email link!");if(i.tenantId!==n.T())throw new A("tenant-id-mismatch");return n.$a(r)})))},ml.prototype.render=function(){},ml.prototype.reset=function(){},ml.prototype.getResponse=function(){},ml.prototype.execute=function(){};var xl=null;function bl(t,e){return(e=wl(e))&&t.a[e]||null}function wl(t){return(t=void 0===t?1e12:t)?t.toString():null}function _l(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ce(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ln(this.f,"click",this.i)}function Tl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function El(){}function Sl(){}yl.prototype.render=function(t,e){return this.a[this.b.toString()]=new _l(t,e),this.b++},yl.prototype.reset=function(t){var e=bl(this,t);t=wl(t),e&&t&&(e.delete(),delete this.a[t])},yl.prototype.getResponse=function(t){return(t=bl(this,t))?t.getResponse():null},yl.prototype.execute=function(t){(t=bl(this,t))&&t.execute()},_l.prototype.getResponse=function(){return Tl(this),this.b},_l.prototype.execute=function(){Tl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},_l.prototype.delete=function(){Tl(this),this.g=!0,clearTimeout(this.a),this.a=null,pn(this.f,"click",this.i)},Ji(El,"FACTOR_ID","phone"),Sl.prototype.g=function(){return xl||(xl=new yl),Pe(xl)},Sl.prototype.c=function(){};var Cl=null;function Al(){this.b=h.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Il=new bt(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Pl=new Gi(3e4,6e4);Al.prototype.g=function(t){var e=this;return new _e((function(n,i){var r=setTimeout((function(){i(new A("network-request-failed"))}),Pl.get());!h.grecaptcha||t!==e.f&&!e.b?(h[e.a]=function(){if(h.grecaptcha){e.f=t;var s=h.grecaptcha.render;h.grecaptcha.render=function(t,n){return t=s(t,n),e.b++,t},clearTimeout(r),n(h.grecaptcha)}else clearTimeout(r),i(new A("internal-error"));delete h[e.a]},Pe(Go(It(Il,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(r),i(new A("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(r),n(h.grecaptcha))}))},Al.prototype.c=function(){this.b--};var Rl=null;function Ol(t,e,n,i,r,s,o){if(Ji(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,o?(Cl||(Cl=new Sl),o=Cl):(Rl||(Rl=new Al),o=Rl),this.m=o,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Dl])throw new A("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ll],!h.document)throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ce(e)||!this.i&&ce(e).hasChildNodes())throw new A("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Zo(t,s||null,r||null),this.u=i||function(){return null};var a=this;this.l=[];var u=this.a[kl];this.a[kl]=function(t){if(Nl(a,t),"function"==typeof u)u(t);else if("string"==typeof u){var e=ki(u,h);"function"==typeof e&&e(t)}};var c=this.a[Ml];this.a[Ml]=function(){if(Nl(a,null),"function"==typeof c)c();else if("string"==typeof c){var t=ki(c,h);"function"==typeof t&&t()}}}var kl="callback",Ml="expired-callback",Dl="sitekey",Ll="size";function Nl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Fl(t,e){return t.h.push(e),e.oa((function(){Q(t.h,e)})),e}function Bl(t){if(t.D)throw new A("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ul(t,e,n){var i=!1;try{this.b=n||r.Z.app()}catch(t){throw new A("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new A("invalid-api-key");n=this.b.options.apiKey;var s=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=r.Z.SDK_VERSION?Ri(r.Z.SDK_VERSION,o):null,Ol.call(this,n,t,e,(function(){try{var t=s.b.auth().la()}catch(e){t=null}return t}),o,M(P),i)}function Vl(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,s=!1,o=0;o<e.length;o++)if(e[o].optional)s=!0;else{if(s)throw new A("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(s=e.length,n.length<r||s<n.length)i="Expected "+(r==s?1==r?"1 argument":r+" arguments":r+"-"+s+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(s=e[r].optional&&void 0===n[r],!e[r].M(n[r])&&!s){if(e=e[r],0>r||r>=Yl.length)throw new A("internal-error","Argument validator received an unsupported number of arguments.");n=Yl[r],i=(i?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}i=null}}if(i)throw new A("argument-error",t+" failed: "+i)}(t=Ol.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Fl(this,Pe().then((function(){if(Li()&&!Ti())return bi();throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,ih(t.s,Va,{})})).then((function(e){t.a[Dl]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Bl(this);var t=this;return Fl(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=ce(e);e=function(t,e,n){var i=arguments,r=document,s=String(i[0]),o=i[1];if(!ue&&o&&(o.name||o.type)){if(s=["<",s],o.name&&s.push(' name="',jt(o.name),'"'),o.type){s.push(' type="',jt(o.type),'"');var a={};yt(a,o),delete a.type,o=a}s.push(">"),s=s.join("")}return s=ge(r,s),o&&("string"==typeof o?s.className=o:Array.isArray(o)?s.className=o.join(" "):le(s,o)),2<i.length&&ve(r,s,i),s}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Bl(this);var t=this;return Fl(this,this.render().then((function(e){return new _e((function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){Z(t.l,(function(t){return t==e}))}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Bl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Bl(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ce(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(Ul,Ol);var Yl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function zl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Xl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Gl(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function jl(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Wl(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Hl(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function ql(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Kl(t){return g(t)&&"string"==typeof t.uid}function Ql(t,e,n,i){return{name:n||"",K:t.K+" or "+e.K,optional:!!i,M:function(n){return t.M(n)||e.M(n)}}}function Zl(t,e){for(var n in e){var i=e[n].name;t[i]=tf(i,t[n],e[n].j)}}function Jl(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:T((function(t){return this[t]}),n),set:T((function(t,e,n,i){Vl(t,[n],[i],!0),this[e]=i}),i,n,e[n].kb),enumerable:!0})}}function $l(t,e,n,i){t[e]=tf(e,n,i)}function tf(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return Vl(s,n,t),e.apply(this,t)}if(!n)return e;var r,s=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Zl(rl.prototype,{jb:{name:"applyActionCode",j:[zl("code")]},Ra:{name:"checkActionCode",j:[zl("code")]},nb:{name:"confirmPasswordReset",j:[zl("code"),zl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[zl("email"),zl("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[zl("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[zl("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Ql(Gl(),jl(),"nextOrObserver"),jl("opt_error",!0),jl("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Ql(Gl(),jl(),"nextOrObserver"),jl("opt_error",!0),jl("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[zl("email"),Ql(Gl("opt_actionCodeSettings",!0),Wl(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[zl("email"),Gl("actionCodeSettings")]},xb:{name:"setPersistence",j:[zl("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Hl()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[Hl()]},Tc:{name:"signInWithCustomToken",j:[zl("token")]},Uc:{name:"signInWithEmailAndPassword",j:[zl("email"),zl("password")]},Vc:{name:"signInWithEmailLink",j:[zl("email"),zl("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[zl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Ql({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof yc)}},Wl(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[zl(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[zl("url"),Gl("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[zl("code")]}}),Jl(rl.prototype,{lc:{name:"languageCode",kb:Ql(zl(),Wl(),"languageCode")},ti:{name:"tenantId",kb:Ql(zl(),Wl(),"tenantId")}}),rl.Persistence=$h,rl.Persistence.LOCAL="local",rl.Persistence.SESSION="session",rl.Persistence.NONE="none",Zl(yc.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Xl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Xl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Hl()]},qb:{name:"linkWithCredential",j:[Hl()]},Dc:{name:"linkWithPhoneNumber",j:[zl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Hl()]},tb:{name:"reauthenticateWithCredential",j:[Hl()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[zl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[Ql(Gl("opt_actionCodeSettings",!0),Wl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[zl(null,!0)]},cd:{name:"unlink",j:[zl("provider")]},Bb:{name:"updateEmail",j:[zl("email")]},Cb:{name:"updatePassword",j:[zl("password")]},ed:{name:"updatePhoneNumber",j:[Hl("phone")]},Db:{name:"updateProfile",j:[Gl("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[zl("email"),Ql(Gl("opt_actionCodeSettings",!0),Wl(null,!0),"opt_actionCodeSettings",!0)]}}),Zl(yl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zl(ml.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zl(_e.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Jl(Qu.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Xl("appVerificationDisabledForTesting")}}),Zl(Zu.prototype,{confirm:{name:"confirm",j:[zl("verificationCode")]}}),$l(cs,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[ms,Rs,Ls,ps],i=0;i<n.length;i++)if(e=n[i](t))return e;return null}),[Ql(zl(),Gl(),"json")]),$l(Os,"credential",(function(t,e){return new Ps(t,e)}),[zl("email"),zl("password")]),Zl(Ps.prototype,{w:{name:"toJSON",j:[zl(null,!0)]}}),Zl(ws.prototype,{Ca:{name:"addScope",j:[zl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),$l(ws,"credential",_s,[Ql(zl(),Gl(),"token")]),$l(Os,"credentialWithLink",ks,[zl("email"),zl("emailLink")]),Zl(Ts.prototype,{Ca:{name:"addScope",j:[zl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),$l(Ts,"credential",Es,[Ql(zl(),Gl(),"token")]),Zl(Ss.prototype,{Ca:{name:"addScope",j:[zl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),$l(Ss,"credential",Cs,[Ql(zl(),Ql(Gl(),Wl()),"idToken"),Ql(zl(),Wl(),"accessToken",!0)]),Zl(As.prototype,{Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),$l(As,"credential",Is,[Ql(zl(),Gl(),"token"),zl("secret",!0)]),Zl(bs.prototype,{Ca:{name:"addScope",j:[zl("scope")]},credential:{name:"credential",j:[Ql(zl(),Ql(Gl(),Wl()),"optionsOrIdToken"),Ql(zl(),Wl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),Zl(vs.prototype,{w:{name:"toJSON",j:[zl(null,!0)]}}),Zl(fs.prototype,{w:{name:"toJSON",j:[zl(null,!0)]}}),$l(Fs,"credential",Bs,[zl("verificationId"),zl("verificationCode")]),Zl(Fs.prototype,{fb:{name:"verifyPhoneNumber",j:[Ql(zl(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?ql(t.session,hs)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?ql(t.session,us)&&Kl(t.multiFactorHint):t.session&&t.multiFactorUid?ql(t.session,us)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Zl(Ds.prototype,{w:{name:"toJSON",j:[zl(null,!0)]}}),Zl(A.prototype,{toJSON:{name:"toJSON",j:[zl(null,!0)]}}),Zl(Hs.prototype,{toJSON:{name:"toJSON",j:[zl(null,!0)]}}),Zl(Ws.prototype,{toJSON:{name:"toJSON",j:[zl(null,!0)]}}),Zl(ic.prototype,{toJSON:{name:"toJSON",j:[zl(null,!0)]}}),Zl(tc.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Zl(uc.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},zl("displayName",!0)]},bd:{name:"unenroll",j:[Ql({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Kl},zl(),"multiFactorInfoIdentifier")]}}),Zl(Ul.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),$l(Tr,"parseLink",Or,[zl("link")]),$l(El,"assertion",(function(t){return new ac(t)}),[Hl("phone")]),function(){if(void 0===r.Z||!r.Z.INTERNAL||!r.Z.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:lr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:cr,VERIFY_AND_CHANGE_EMAIL:fr,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:rl,AuthCredential:cs,Error:A};$l(t,"EmailAuthProvider",Os,[]),$l(t,"FacebookAuthProvider",ws,[]),$l(t,"GithubAuthProvider",Ts,[]),$l(t,"GoogleAuthProvider",Ss,[]),$l(t,"TwitterAuthProvider",As,[]),$l(t,"OAuthProvider",bs,[zl("providerId")]),$l(t,"SAMLAuthProvider",xs,[zl("providerId")]),$l(t,"PhoneAuthProvider",Fs,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof rl)}}]),$l(t,"RecaptchaVerifier",Ul,[Ql(zl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Gl("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.Z.app.App)}}]),$l(t,"ActionCodeURL",Tr,[]),$l(t,"PhoneMultiFactorGenerator",El,[]),r.Z.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new rl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.Z.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:_((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:_(t.nc,t),addAuthTokenListener:_(t.cc,t),removeAuthTokenListener:_(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.Z.registerVersion("@firebase/auth","0.16.4"),r.Z.INTERNAL.extendNamespace({User:yc})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n(790);var s=n(594),o=n(448),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function h(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var u,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l=l||{},f=c||self;function d(){}function p(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),m=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function x(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:x).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function _(){return Date.now()}function T(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function E(){this.j=this.j,this.i=this.i}E.prototype.j=!1,E.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++m)}(this)},E.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function A(t){return Array.prototype.concat.apply([],arguments)}function I(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function P(t){return/^[\s\xa0]*$/.test(t)}var R,O=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function k(t,e){return-1!=t.indexOf(e)}function M(t,e){return t<e?-1:t>e?1:0}t:{var D=f.navigator;if(D){var L=D.userAgent;if(L){R=L;break t}}R=""}function N(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function F(t){var e={};for(var n in t)e[n]=t[n];return e}var B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var s=0;s<B.length;s++)n=B[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function V(t){return V[" "](t),t}V[" "]=d;var Y,z,X=k(R,"Opera"),G=k(R,"Trident")||k(R,"MSIE"),j=k(R,"Edge"),W=j||G,H=k(R,"Gecko")&&!(k(R.toLowerCase(),"webkit")&&!k(R,"Edge"))&&!(k(R,"Trident")||k(R,"MSIE"))&&!k(R,"Edge"),q=k(R.toLowerCase(),"webkit")&&!k(R,"Edge");function K(){var t=f.document;return t?t.documentMode:void 0}t:{var Q="",Z=(z=R,H?/rv:([^\);]+)(\)|;)/.exec(z):j?/Edge\/([\d\.]+)/.exec(z):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(z):q?/WebKit\/(\S+)/.exec(z):X?/(?:Version)[ \/]?(\S+)/.exec(z):void 0);if(Z&&(Q=Z?Z[1]:""),G){var J=K();if(null!=J&&J>parseFloat(Q)){Y=String(J);break t}}Y=Q}var $,tt={};function et(t){return function(t,e){var n=tt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=O(String(Y)).split("."),i=O(String(t)).split("."),r=Math.max(n.length,i.length),s=0;0==e&&s<r;s++){var o=n[s]||"",a=i[s]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=M(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||M(0==o[2].length,0==a[2].length)||M(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e}))}f.document&&G?$=K()||parseInt(Y,10)||void 0:$=void 0;var nt=$,it=!G||9<=Number(nt),rt=G&&!et("9"),st=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{f.addEventListener("test",d,e),f.removeEventListener("test",d,e)}catch(t){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function at(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{V(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ht[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.defaultPrevented=!0},T(at,ot);var ht={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ut="closure_listenable_"+(1e6*Math.random()|0),ct=0;function lt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++ct,this.Y=this.Z=!1}function ft(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function dt(t){this.src=t,this.a={},this.b=0}function pt(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],s=S(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ft(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function vt(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.Y&&s.listener==e&&s.capture==!!n&&s.ca==i)return r}return-1}dt.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.a[s])||(t=this.a[s]=[],this.b++);var o=vt(t,e,i,r);return-1<o?(e=t[o],n||(e.Z=!1)):((e=new lt(e,this.src,s,!!i,r)).Z=n,t.push(e)),e};var gt="closure_lm_"+(1e6*Math.random()|0),mt={};function yt(t,e,n,i,r){if(i&&i.once)return bt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)yt(t,e[s],n,i,r);return null}return n=It(n),t&&t[ut]?t.va(e,n,v(i)?!!i.capture:!!i,r):xt(t,e,n,!1,i,r)}function xt(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=v(r)?!!r.capture:!!r;if(o&&!it)return null;var a=Ct(t);if(a||(t[gt]=a=new dt(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){var t=St,e=it?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)st||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Tt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function bt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)bt(t,e[s],n,i,r);return null}return n=It(n),t&&t[ut]?t.wa(e,n,v(i)?!!i.capture:!!i,r):xt(t,e,n,!0,i,r)}function wt(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)wt(t,e[s],n,i,r);else i=v(i)?!!i.capture:!!i,n=It(n),t&&t[ut]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=vt(s=t.a[e],n,i,r))&&(ft(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.a[e],t.b--))):t&&(t=Ct(t))&&(e=t.a[e.toString()],t=-1,e&&(t=vt(e,n,i,r)),(n=-1<t?e[t]:null)&&_t(n))}function _t(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ut])pt(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Tt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ct(e))?(pt(n,t),0==n.b&&(n.src=null,e[gt]=null)):ft(t)}}}function Tt(t){return t in mt?mt[t]:mt[t]="on"+t}function Et(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&_t(t),n.call(i,e)}function St(t,e){if(t.Y)return!0;if(!it){if(!e)t:{e=["window","event"];for(var n=f,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Et(t,e=new at(e,this))}return Et(t,new at(e,this))}function Ct(t){return(t=t[gt])instanceof dt?t:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function It(t){return"function"==typeof t?t:(t[At]||(t[At]=function(e){return t.handleEvent(e)}),t[At])}function Pt(){E.call(this),this.c=new dt(this),this.J=this,this.C=null}function Rt(t,e){var n,i=t.C;if(i)for(n=[];i;i=i.C)n.push(i);if(t=t.J,i=e.type||e,"string"==typeof e)e=new ot(e,t);else if(e instanceof ot)e.target=e.target||t;else{var r=e;U(e=new ot(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.a=n[s];r=Ot(o,i,!0,e)&&r}if(r=Ot(o=e.a=t,i,!0,e)&&r,r=Ot(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Ot(o=e.a=n[s],i,!1,e)&&r}function Ot(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.Y&&o.capture==n){var a=o.listener,h=o.ca||o.src;o.Z&&pt(t.c,o),r=!1!==a.call(h,i)&&r}}return r&&!i.defaultPrevented}T(Pt,E),Pt.prototype[ut]=!0,(u=Pt.prototype).addEventListener=function(t,e,n,i){yt(this,t,e,n,i)},u.removeEventListener=function(t,e,n,i){wt(this,t,e,n,i)},u.G=function(){if(Pt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)ft(n[i]);delete e.a[t],e.b--}}this.C=null},u.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},u.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var kt=f.JSON.stringify;function Mt(){this.b=this.a=null}var Dt,Lt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ft}),(function(t){t.reset()}));function Nt(){var t=Yt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ft(){this.next=this.b=this.a=null}function Bt(t){f.setTimeout((function(){throw t}),0)}function Ut(t,e){Dt||function(){var t=f.Promise.resolve(void 0);Dt=function(){t.then(zt)}}(),Vt||(Dt(),Vt=!0),Yt.add(t,e)}Mt.prototype.add=function(t,e){var n=Lt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ft.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ft.prototype.reset=function(){this.next=this.b=this.a=null};var Vt=!1,Yt=new Mt;function zt(){for(var t;t=Nt();){try{t.a.call(t.b)}catch(t){Bt(t)}var e=Lt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Vt=!1}function Xt(t,e){Pt.call(this),this.b=t||1,this.a=e||f,this.f=b(this.Za,this),this.g=_()}function Gt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function jt(t,e,n){if("function"==typeof t)n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:f.setTimeout(t,e||0)}function Wt(t){t.a=jt((function(){t.a=null,t.c&&(t.c=!1,Wt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}T(Xt,Pt),(u=Xt.prototype).aa=!1,u.M=null,u.Za=function(){if(this.aa){var t=_()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Rt(this,"tick"),this.aa&&(Gt(this),this.start()))}},u.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=_())},u.G=function(){Xt.X.G.call(this),Gt(this),delete this.a};var Ht=function(t){function e(e,n){var i=t.call(this)||this;return i.g=e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Wt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(f.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(E);function qt(t){E.call(this),this.b=t,this.a={}}T(qt,E);var Kt=[];function Qt(t,e,n,i){Array.isArray(n)||(n&&(Kt[0]=n.toString()),n=Kt);for(var r=0;r<n.length;r++){var s=yt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!s)break;t.a[s.key]=s}}function Zt(t){N(t.a,(function(t,e){this.a.hasOwnProperty(e)&&_t(t)}),t),t.a={}}function Jt(){this.a=!0}function $t(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return kt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}qt.prototype.G=function(){qt.X.G.call(this),Zt(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Jt.prototype.info=function(){};var te={},ee=null;function ne(){return ee=ee||new Pt}function ie(t){ot.call(this,te.Fa,t)}function re(t){var e=ne();Rt(e,new ie(e,t))}function se(t,e){ot.call(this,te.STAT_EVENT,t),this.stat=e}function oe(t){var e=ne();Rt(e,new se(e,t))}function ae(t){ot.call(this,te.Ga,t)}function he(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){t()}),e)}te.Fa="serverreachability",T(ie,ot),te.STAT_EVENT="statevent",T(se,ot),te.Ga="timingevent",T(ae,ot);var ue={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ce={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function le(){}function fe(t){var e;return(e=t.a)||(e=t.a={}),e}function de(){}le.prototype.a=null;var pe,ve={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ge(){ot.call(this,"d")}function me(){ot.call(this,"c")}function ye(){}function xe(t,e,n,i){this.g=t,this.c=e,this.f=n,this.S=i||1,this.J=new qt(this),this.P=be,t=W?125:void 0,this.R=new Xt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}T(ge,ot),T(me,ot),T(ye,le),pe=new ye;var be=45e3,we={},_e={};function Te(t,e,n){t.H=1,t.i=je(Ue(e)),t.j=n,t.I=!0,Ee(t,null)}function Ee(t,e){t.u=_(),Ae(t),t.l=Ue(t.i);var n=t.l,i=t.S;Array.isArray(i)||(i=[String(i)]),sn(n.b,"t",i),t.D=0,t.a=$n(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ht(b(t.Ca,t,t.a),t.O)),Qt(t.J,t.a,"readystatechange",t.Xa),e=t.B?F(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),re(1),function(t,e,n,i,r,s){t.info((function(){if(t.a)if(s)for(var o="",a=s.split("&"),h=0;h<a.length;h++){var u=a[h].split("=");if(1<u.length){var c=u[0];u=u[1];var l=c.split("_");o=2<=l.length&&"type"==l[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Se(t,e,n){for(var i=!0;!t.A&&t.D<n.length;){var r=Ce(t,n);if(r==_e){4==e&&(t.h=4,oe(14),i=!1),$t(t.c,t.f,null,"[Incomplete Response]");break}if(r==we){t.h=4,oe(15),$t(t.c,t.f,n,"[Invalid Chunk]"),i=!1;break}$t(t.c,t.f,r,null),ke(t,r)}4==e&&0==n.length&&(t.h=1,oe(16),i=!1),t.b=t.b&&i,i?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),jn(e),e.F=!0,oe(11))):($t(t.c,t.f,n,"[Invalid Chunked Response]"),Oe(t),Re(t))}function Ce(t,e){var n=t.D,i=e.indexOf("\n",n);return-1==i?_e:(n=Number(e.substring(n,i)),isNaN(n)?we:(i+=1)+n>e.length?_e:(e=e.substr(i,n),t.D=i+n,e))}function Ae(t){t.T=_()+t.P,Ie(t,t.P)}function Ie(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=he(b(t.Va,t),e)}function Pe(t){t.o&&(f.clearTimeout(t.o),t.o=null)}function Re(t){0==t.g.v||t.A||qn(t.g,t)}function Oe(t){Pe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Gt(t.R),Zt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ke(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||fn(n.b,t)))if(n.I=t.N,!t.C&&fn(n.b,t)&&3==n.v){try{var i=n.ka.a.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Hn(n),Nn(n)}Gn(n),oe(18)}}else n.oa=r[1],0<n.oa-n.P&&37500>r[2]&&n.H&&0==n.o&&!n.m&&(n.m=he(b(n.Sa,n),6e3));if(1>=ln(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Qn(n,11)}else if((t.C||n.a==t)&&Hn(n),!P(e))for(e=i=n.ka.a.parse(e),i=0;i<e.length;i++)if(r=e[i],n.P=r[0],r=r[1],2==n.v)if("c"==r[0]){n.J=r[1],n.ga=r[2];var s=r[3];null!=s&&(n.ha=s,n.c.info("VER="+n.ha));var o=r[4];null!=o&&(n.pa=o,n.c.info("SVER="+n.pa));var a=r[5];if(null!=a&&"number"==typeof a&&0<a){var h=1.5*a;n.D=h,n.c.info("backChannelRequestTimeoutMs_="+h)}h=n;var u=t.a;if(u){var c=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(c){var l=h.b;!l.a&&(k(c,"spdy")||k(c,"quic")||k(c,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(dn(l,l.b),l.b=null))}if(h.A){var f=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(h.na=f,Ge(h.B,h.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=_()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((h=n).la=Jn(h,h.C?h.ga:null,h.fa),d.C){pn(h.b,d);var p=d,v=h.D;v&&p.setTimeout(v),p.o&&(Pe(p),Ae(p)),h.a=d}else Xn(h);0<n.g.length&&Un(n)}else"stop"!=r[0]&&"close"!=r[0]||Qn(n,7);else 3==n.v&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Qn(n,7):Ln(n):"noop"!=r[0]&&n.f&&n.f.sa(r),n.o=0);re(4)}catch(t){}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)C(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(p(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function De(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof De)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Le(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ne(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ne(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function Ne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(u=xe.prototype).setTimeout=function(t){this.P=t},u.Xa=function(t){t=t.target;var e=this.F;e&&3==On(t)?e.f():this.Ca(t)},u.Ca=function(t){try{if(t==this.a)t:{var e=On(this.a),n=this.a.ua(),i=this.a.W();if(!(3>e||3==e&&!W&&!this.a.$())){this.A||4!=e||7==n||re(8==n||0>=i?3:2),Pe(this);var r=this.a.W();this.N=r;var s=this.a.$();if(this.b=200==r,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.c,this.m,this.l,this.f,this.S,e,r),this.b){if(this.U&&!this.C){e:{if(this.a){var o,a=this.a;if((o=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(o)){var h=o;break e}}h=null}if(!h){this.b=!1,this.h=3,oe(12),Oe(this),Re(this);break t}$t(this.c,this.f,h,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ke(this,h)}this.I?(Se(this,e,s),W&&this.b&&3==e&&(Qt(this.J,this.R,"tick",this.Wa),this.R.start())):($t(this.c,this.f,s,null),ke(this,s)),4==e&&Oe(this),this.b&&!this.A&&(4==e?qn(this.g,this):(this.b=!1,Ae(this)))}else 400==r&&0<s.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),Oe(this),Re(this)}}}catch(t){}},u.Wa=function(){if(this.a){var t=On(this.a),e=this.a.$();this.D<e.length&&(Pe(this),Se(this,t,e),this.b&&4!=t&&Ae(this))}},u.cancel=function(){this.A=!0,Oe(this)},u.Va=function(){this.o=null;var t=_();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(re(3),oe(17)),Oe(this),this.h=2,Re(this)):Ie(this,this.T-t)},(u=De.prototype).K=function(){Le(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},u.L=function(){return Le(this),this.a.concat()},u.get=function(t,e){return Ne(this.b,t)?this.b[t]:e},u.set=function(t,e){Ne(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},u.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var Fe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Be(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Be){this.a=void 0!==e?e:t.a,Ve(this,t.f),this.j=t.j,Ye(this,t.c),ze(this,t.h),this.g=t.g,e=t.b;var n=new tn;n.c=e.c,e.a&&(n.a=new De(e.a),n.b=e.b),Xe(this,n),this.i=t.i}else t&&(n=String(t).match(Fe))?(this.a=!!e,Ve(this,n[1]||"",!0),this.j=We(n[2]||""),Ye(this,n[3]||"",!0),ze(this,n[4]),this.g=We(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=We(n[7]||"")):(this.a=!!e,this.b=new tn(null,this.a))}function Ue(t){return new Be(t)}function Ve(t,e,n){t.f=n?We(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?We(e,!0):e}function ze(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){e instanceof tn?(t.b=e,function(t,e){e&&!t.f&&(en(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(nn(this,e),sn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=He(e,Je)),t.b=new tn(e,t.a))}function Ge(t,e,n){t.b.set(e,n)}function je(t){return Ge(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36)),t}function We(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,qe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Be.prototype.toString=function(){var t=[],e=this.f;e&&t.push(He(e,Ke,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(He(e,Ke,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?Ze:Qe,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",He(n,$e)),t.join("")};var Ke=/[#\/\?@]/g,Qe=/[#\?:]/g,Ze=/[#\?]/g,Je=/[#\?@]/g,$e=/#/g;function tn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function en(t){t.a||(t.a=new De,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function nn(t,e){en(t),e=on(t,e),Ne(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ne((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Le(t)))}function rn(t,e){return en(t),e=on(t,e),Ne(t.a.b,e)}function sn(t,e,n){nn(t,e),0<n.length&&(t.c=null,t.a.set(on(t,e),I(n)),t.b+=n.length)}function on(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(u=tn.prototype).add=function(t,e){en(this),this.c=null,t=on(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},u.forEach=function(t,e){en(this),this.a.forEach((function(n,i){C(n,(function(n){t.call(e,n,i,this)}),this)}),this)},u.L=function(){en(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},u.K=function(t){en(this);var e=[];if("string"==typeof t)rn(this,t)&&(e=A(e,this.a.get(on(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=A(e,t[n])}return e},u.set=function(t,e){return en(this),this.c=null,rn(this,t=on(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},u.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},u.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.K(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.c=t.join("&")};var an=function(t,e){this.b=t,this.a=e};function hn(t){this.g=t||un,t=f.PerformanceNavigationTiming?0<(t=f.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(f.ia&&f.ia.ya&&f.ia.ya()&&f.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var un=10;function cn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ln(t){return t.b?1:t.a?t.a.size:0}function fn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function dn(t,e){t.a?t.a.add(e):t.b=e}function pn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function vn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var i=t.c;try{for(var r=h(t.a.values()),s=r.next();!s.done;s=r.next()){var o=s.value;i=i.concat(o.s)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}return I(t.c)}function gn(){}function mn(){this.a=new gn}function yn(t,e,n){var i=n||"";try{Me(t,(function(t,n){var r=t;v(t)&&(r=kt(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function xn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}hn.prototype.cancel=function(){var t,e;if(this.c=vn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=h(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},gn.prototype.stringify=function(t){return f.JSON.stringify(t,void 0)},gn.prototype.parse=function(t){return f.JSON.parse(t,void 0)};var bn=f.JSON.parse;function wn(t){Pt.call(this),this.headers=new De,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}T(wn,Pt);var _n="",Tn=/^https?$/i,En=["POST","PUT"];function Sn(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,An(t),Pn(t)}function An(t){t.u||(t.u=!0,Rt(t,"complete"),Rt(t,"error"))}function In(t){if(t.b&&void 0!==l&&(!t.s[1]||4!=On(t)||2!=t.W()))if(t.l&&4==On(t))jt(t.za,0,t);else if(Rt(t,"readystatechange"),4==On(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var s=String(t.B).match(Fe)[1]||null;if(!s&&f.self&&f.self.location){var o=f.self.location.protocol;s=o.substr(0,o.length-1)}r=!Tn.test(s?s.toLowerCase():"")}e=r}if(e)Rt(t,"complete"),Rt(t,"success");else{t.h=6;try{var a=2<On(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",An(t)}}finally{Pn(t)}}}function Pn(t,e){if(t.a){Rn(t);var n=t.a,i=t.s[0]?d:null;t.a=null,t.s=null,e||Rt(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(f.clearTimeout(t.m),t.m=null)}function On(t){return t.a?t.a.readyState:0}function kn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){var e="";return N(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ge(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Dn(t){this.pa=0,this.g=[],this.c=new Jt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Mn("baseRetryDelayMs",5e3,t),this.Ra=Mn("retryDelaySeedMs",1e4,t),this.Ma=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new hn(t&&t.concurrentRequestLimit),this.ka=new mn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ln(t){if(Fn(t),3==t.v){var e=t.R++,n=Ue(t.B);Ge(n,"SID",t.J),Ge(n,"RID",e),Ge(n,"TYPE","terminate"),Yn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=je(Ue(n)),n=!1,f.navigator&&f.navigator.sendBeacon&&(n=f.navigator.sendBeacon(e.i.toString(),"")),!n&&f.Image&&((new Image).src=e.i,n=!0),n||(e.a=$n(e.g,null),e.a.ba(e.i)),e.u=_(),Ae(e)}Zn(t)}function Nn(t){t.a&&(jn(t),t.a.cancel(),t.a=null)}function Fn(t){Nn(t),t.j&&(f.clearTimeout(t.j),t.j=null),Hn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&f.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new an(t.Oa++,e)),3==t.v&&Un(t)}function Un(t){cn(t.b)||t.h||(t.h=!0,Ut(t.Ba,t),t.u=0)}function Vn(t,e){var n;n=e?e.f:t.R++;var i=Ue(t.B);Ge(i,"SID",t.J),Ge(i,"RID",n),Ge(i,"AID",t.P),Yn(t,i),t.i&&t.l&&kn(i,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),dn(t.b,n),Te(n,i,e)}function Yn(t,e){t.f&&Me({},(function(t,n){Ge(e,n,t)}))}function zn(t,e,n){n=Math.min(t.g.length,n);var i=t.f?b(t.f.Ja,t.f,t):null;t:for(var r=t.g,s=-1;;){var o=["count="+n];-1==s?0<n?(s=r[0].b,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,h=0;h<n;h++){var u=r[h].b,c=r[h].a;if(0>(u-=s))s=Math.max(0,r[h].b-100),a=!1;else try{yn(c,o,"req"+u+"_")}catch(t){i&&i(c)}}if(a){i=o.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function Xn(t){t.a||t.j||(t.T=1,Ut(t.Aa,t),t.o=0)}function Gn(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=he(b(t.Aa,t),Kn(t,t.o)),t.o++,0))}function jn(t){null!=t.s&&(f.clearTimeout(t.s),t.s=null)}function Wn(t){t.a=new xe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ue(t.la);Ge(e,"RID","rpc"),Ge(e,"SID",t.J),Ge(e,"CI",t.H?"0":"1"),Ge(e,"AID",t.P),Yn(t,e),Ge(e,"TYPE","xmlhttp"),t.i&&t.l&&kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=je(Ue(e)),n.j=null,n.I=!0,Ee(n,t)}function Hn(t){null!=t.m&&(f.clearTimeout(t.m),t.m=null)}function qn(t,e){var n=null;if(t.a==e){Hn(t),jn(t),t.a=null;var i=2}else{if(!fn(t.b,e))return;n=e.s,pn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==i){n=e.j?e.j.length:0,e=_()-e.u;var r=t.u;Rt(i=ne(),new ae(i,n,e,r)),Un(t)}else Xn(t);else if(3==(r=e.h)||0==r&&0<t.I||!(1==i&&function(t,e){return!(ln(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=he(b(t.Ba,t,e),Kn(t,t.u)),t.u++,0)))}(t,e)||2==i&&Gn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),r){case 1:Qn(t,5);break;case 4:Qn(t,10);break;case 3:Qn(t,6);break;default:Qn(t,2)}}function Kn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Qn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var i=b(t.Ya,t);n||(n=new Be("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||Ve(n,"https"),je(n)),function(t,e){var n=new Jt;if(f.Image){var i=new Image;i.onload=w(xn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=w(xn,n,i,"TestLoadImage: error",!1,e),i.onabort=w(xn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=w(xn,n,i,"TestLoadImage: timeout",!1,e),f.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else oe(2);t.v=0,t.f&&t.f.ra(e),Zn(t),Fn(t)}function Zn(t){t.v=0,t.I=-1,t.f&&(0==vn(t.b).length&&0==t.g.length||(t.b.c.length=0,I(t.g),t.g.length=0),t.f.qa())}function Jn(t,e,n){var i=function(t){return t instanceof Be?Ue(t):new Be(t,void 0)}(n);if(""!=i.c)e&&Ye(i,e+"."+i.c),ze(i,i.h);else{var r=f.location;i=function(t,e,n,i){var r=new Be(null,void 0);return t&&Ve(r,t),e&&Ye(r,e),n&&ze(r,n),i&&(r.g=i),r}(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.V&&N(t.V,(function(t,e){Ge(i,e,t)})),e=t.A,n=t.na,e&&n&&Ge(i,e,n),Ge(i,"VER",t.ha),Yn(t,i),i}function $n(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new wn(t.Na)).F=t.C,e}function ti(){}function ei(){if(G&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function ni(t,e){Pt.call(this),this.a=new Dn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!P(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!P(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new si(this)}function ii(t){ge.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ri(){me.call(this),this.status=1}function si(t){this.a=t}(u=wn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fe(this.H):fe(pe),this.a.onreadystatechange=b(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Cn(this,t)}t=n||"";var r=new De(this.headers);i&&Me(i,(function(t,e){r.set(e,t)})),i=function(t){t:{for(var e=Sn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.L()),n=f.FormData&&t instanceof f.FormData,!(0<=S(En,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=function(t){return G&&et(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.xa,this)):this.m=jt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},u.xa=function(){void 0!==l&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Rt(this,"timeout"),this.abort(8))},u.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Rt(this,"complete"),Rt(this,"abort"),Pn(this))},u.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Pn(this,!0)),wn.X.G.call(this)},u.za=function(){this.j||(this.A||this.l||this.g?In(this):this.Ua())},u.Ua=function(){In(this)},u.W=function(){try{return 2<On(this)?this.a.status:-1}catch(t){return-1}},u.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},u.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),bn(e)}},u.ua=function(){return this.h},u.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(u=Dn.prototype).ha=8,u.v=1,u.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),i=this.l;if(this.O&&(i?U(i=F(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var s=this.g[r];if(void 0===(s="__data__"in s.a&&"string"==typeof(s=s.a.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=zn(this,n,e),Ge(r=Ue(this.B),"RID",t),Ge(r,"CVER",22),this.A&&Ge(r,"X-HTTP-Session-Id",this.A),Yn(this,r),this.i&&i&&kn(r,this.i,i),dn(this.b,n),this.Ia&&Ge(r,"TYPE","init"),this.da?(Ge(r,"$req",e),Ge(r,"SID","null"),n.U=!0,Te(n,r,null)):Te(n,r,e),this.v=2}}else 3==this.v&&(t?Vn(this,t):0==this.g.length||cn(this.b)||Vn(this))},u.Aa=function(){if(this.j=null,Wn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=he(b(this.Ta,this),t)}},u.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,oe(10),Nn(this),Wn(this))},u.Sa=function(){null!=this.m&&(this.m=null,Nn(this),Gn(this),oe(19))},u.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(u=ti.prototype).ta=function(){},u.sa=function(){},u.ra=function(){},u.qa=function(){},u.Ja=function(){},ei.prototype.a=function(t,e){return new ni(t,e)},T(ni,Pt),ni.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;oe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Jn(t,null,t.fa),Un(t)},ni.prototype.close=function(){Ln(this.a)},ni.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Bn(this.a,e)}else this.l?((e={}).__data__=kt(t),Bn(this.a,e)):Bn(this.a,t)},ni.prototype.G=function(){this.a.f=null,delete this.f,Ln(this.a),delete this.a,ni.X.G.call(this)},T(ii,ge),T(ri,me),T(si,ti),si.prototype.ta=function(){Rt(this.a,"a")},si.prototype.sa=function(t){Rt(this.a,new ii(t))},si.prototype.ra=function(t){Rt(this.a,new ri(t))},si.prototype.qa=function(){Rt(this.a,"b")},ei.prototype.createWebChannel=ei.prototype.a,ni.prototype.send=ni.prototype.h,ni.prototype.open=ni.prototype.g,ni.prototype.close=ni.prototype.close,ue.NO_ERROR=0,ue.TIMEOUT=8,ue.HTTP_ERROR=6,ce.COMPLETE="complete",de.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",Pt.prototype.listen=Pt.prototype.va,wn.prototype.listenOnce=wn.prototype.wa,wn.prototype.getLastError=wn.prototype.Qa,wn.prototype.getLastErrorCode=wn.prototype.ua,wn.prototype.getStatus=wn.prototype.W,wn.prototype.getResponseJson=wn.prototype.Pa,wn.prototype.getResponseText=wn.prototype.$,wn.prototype.send=wn.prototype.ba;var oi=ue,ai=ce,hi=te,ui=10,ci=11,li=de,fi=wn,di=function(t,e){return(di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function pi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}di(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function vi(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function gi(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function mi(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}Object.create,Object.create;var yi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();yi.o=-1;var xi=new s.Yd("@firebase/firestore");function bi(){return xi.logLevel}function wi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(xi.logLevel<=s.in.DEBUG){var i=e.map(Ei);xi.debug.apply(xi,mi(["Firestore (8.3.1): "+t],i))}}function _i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(xi.logLevel<=s.in.ERROR){var i=e.map(Ei);xi.error.apply(xi,mi(["Firestore (8.3.1): "+t],i))}}function Ti(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(xi.logLevel<=s.in.WARN){var i=e.map(Ei);xi.warn.apply(xi,mi(["Firestore (8.3.1): "+t],i))}}function Ei(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Si(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.3.1) INTERNAL ASSERTION FAILED: "+t;throw _i(e),new Error(e)}function Ci(t,e){t||Si()}function Ai(t,e){return t}function Ii(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}var Pi=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Ii(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},t}();function Ri(t,e){return t<e?-1:t>e?1:0}function Oi(t,e,n){return t.length===e.length&&t.every((function(t,i){return n(t,e[i])}))}function ki(t){return t+"\0"}function Mi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Di(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Li(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ni(t){return null==t}function Fi(t){return 0===t&&1/t==-1/0}function Bi(t){return"number"==typeof t&&Number.isInteger(t)&&!Fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ui={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Vi=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this).code=e,i.message=n,i.name="FirebaseError",i.toString=function(){return i.name+": [code="+i.code+"]: "+i.message},i}return pi(e,t),e}(Error),Yi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Si(),void 0===n?n=t.length-e:n>t.length-e&&Si(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),s=e.get(i);if(r<s)return-1;if(r>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.construct=function(t,n,i){return new e(t,n,i)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=[],r=0,s=t;r<s.length;r++){var o=s[r];if(o.indexOf("//")>=0)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");i.push.apply(i,o.split("/").filter((function(t){return t.length>0})))}return new e(i)},e.emptyPath=function(){return new e([])},e}(Yi),Xi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.construct=function(t,n,i){return new e(t,n,i)},e.isValidIdentifier=function(t){return Xi.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],i="",r=0,s=function(){if(0===i.length)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(i),i=""},o=!1;r<t.length;){var a=t[r];if("\\"===a){if(r+1===t.length)throw new Vi(Ui.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var h=t[r+1];if("\\"!==h&&"."!==h&&"`"!==h)throw new Vi(Ui.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=h,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Vi(Ui.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Yi),ji=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(zi.fromString(e))},t.fromName=function(e){return new t(zi.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===zi.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return zi.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new zi(e.slice()))},t}(),Wi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Ri(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Wi.EMPTY_BYTE_STRING=new Wi("");var Hi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){if(Ci(!!t),"string"==typeof t){var e=0,n=Hi.exec(t);if(Ci(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ki(t.seconds),nanos:Ki(t.nanos)}}function Ki(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Qi(t){return"string"==typeof t?Wi.fromBase64String(t):Wi.fromUint8Array(t)}var Zi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Vi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Vi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Vi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Vi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Ri(this.nanoseconds,t.nanoseconds):Ri(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}();function Ji(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function $i(t){var e=t.mapValue.fields.__previous_value__;return Ji(e)?$i(e):e}function tr(t){var e=qi(t.mapValue.fields.__local_write_time__.timestampValue);return new Zi(e.seconds,e.nanos)}function er(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ji(t)?4:10:Si()}function nr(t,e){var n=er(t);if(n!==er(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return tr(t).isEqual(tr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=qi(t.timestampValue),i=qi(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Qi(t.bytesValue).isEqual(Qi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ki(t.geoPointValue.latitude)===Ki(e.geoPointValue.latitude)&&Ki(t.geoPointValue.longitude)===Ki(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ki(t.integerValue)===Ki(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ki(t.doubleValue),i=Ki(e.doubleValue);return n===i?Fi(n)===Fi(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Oi(t.arrayValue.values||[],e.arrayValue.values||[],nr);case 10:return function(t,e){var n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Mi(n)!==Mi(i))return!1;for(var r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!nr(n[r],i[r])))return!1;return!0}(t,e);default:return Si()}}function ir(t,e){return void 0!==(t.values||[]).find((function(t){return nr(t,e)}))}function rr(t,e){var n=er(t),i=er(e);if(n!==i)return Ri(n,i);switch(n){case 0:return 0;case 1:return Ri(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ki(t.integerValue||t.doubleValue),i=Ki(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return sr(t.timestampValue,e.timestampValue);case 4:return sr(tr(t),tr(e));case 5:return Ri(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Qi(t),i=Qi(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var s=Ri(n[r],i[r]);if(0!==s)return s}return Ri(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ri(Ki(t.latitude),Ki(e.latitude));return 0!==n?n:Ri(Ki(t.longitude),Ki(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var s=rr(n[r],i[r]);if(s)return s}return Ri(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(var o=0;o<i.length&&o<s.length;++o){var a=Ri(i[o],s[o]);if(0!==a)return a;var h=rr(n[i[o]],r[s[o]]);if(0!==h)return h}return Ri(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Si()}}function sr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ri(t,e);var n=qi(t),i=qi(e),r=Ri(n.seconds,i.seconds);return 0!==r?r:Ri(n.nanos,i.nanos)}function or(t){return ar(t)}function ar(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=qi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Qi(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,ji.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,i=0,r=t.values||[];i<r.length;i++)n?n=!1:e+=",",e+=ar(r[i]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var s=r[i];n?n=!1:e+=",",e+=s+":"+ar(t.fields[s])}return e+"}"}(t.mapValue):Si();var e,n}function hr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ur(t){return!!t&&"integerValue"in t}function cr(t){return!!t&&"arrayValue"in t}function lr(t){return!!t&&"nullValue"in t}function fr(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function dr(t){return!!t&&"mapValue"in t}var pr=function(t,e){this.key=t,this.version=e},vr=function(t){function e(e,n,i,r){var s=this;return(s=t.call(this,e,n)||this).objectValue=i,s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return pi(e,t),e.prototype.field=function(t){return this.objectValue.field(t)},e.prototype.data=function(){return this.objectValue},e.prototype.toProto=function(){return this.objectValue.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.objectValue.isEqual(t.objectValue)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.objectValue.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(pr),gr=function(t){function e(e,n,i){var r=this;return(r=t.call(this,e,n)||this).hasCommittedMutations=!(!i||!i.hasCommittedMutations),r}return pi(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(pr),mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(pr),yr=function(t,e,n,i,r,s,o){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.h=null};function xr(t,e,n,i,r,s,o){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null),new yr(t,e,n,i,r,s,o)}function br(t){var e=Ai(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+or(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Ni(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Mr(e.startAt)),e.endAt&&(n+="|ub:",n+=Mr(e.endAt)),e.h=n}return e.h}function wr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Lr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var i=0;i<t.filters.length;i++)if(r=t.filters[i],s=e.filters[i],r.op!==s.op||!r.field.isEqual(s.field)||!nr(r.value,s.value))return!1;var r,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fr(t.startAt,e.startAt)&&Fr(t.endAt,e.endAt)}function _r(t){return ji.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Tr=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).field=e,r.op=n,r.value=i,r}return pi(e,t),e.create=function(t,n,i){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,i):new Er(t,n,i):"array-contains"===n?new Ir(t,i):"in"===n?new Pr(t,i):"not-in"===n?new Rr(t,i):"array-contains-any"===n?new Or(t,i):new e(t,n,i)},e.l=function(t,e,n){return"in"===e?new Sr(t,n):new Cr(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.m(rr(e,this.value)):null!==e&&er(this.value)===er(e)&&this.m(rr(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Si()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Er=function(t){function e(e,n,i){var r=this;return(r=t.call(this,e,n,i)||this).key=ji.fromName(i.referenceValue),r}return pi(e,t),e.prototype.matches=function(t){var e=ji.comparator(t.key,this.key);return this.m(e)},e}(Tr),Sr=function(t){function e(e,n){var i=this;return(i=t.call(this,e,"in",n)||this).keys=Ar(0,n),i}return pi(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Tr),Cr=function(t){function e(e,n){var i=this;return(i=t.call(this,e,"not-in",n)||this).keys=Ar(0,n),i}return pi(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Tr);function Ar(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ji.fromName(t.referenceValue)}))}var Ir=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return pi(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return cr(e)&&ir(e.arrayValue,this.value)},e}(Tr),Pr=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return pi(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ir(this.value.arrayValue,e)},e}(Tr),Rr=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return pi(e,t),e.prototype.matches=function(t){if(ir(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ir(this.value.arrayValue,e)},e}(Tr),Or=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return pi(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!cr(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ir(e.value.arrayValue,t)}))},e}(Tr),kr=function(t,e){this.position=t,this.before=e};function Mr(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return or(t)})).join(",")}var Dr=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Lr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Nr(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var s=e[r],o=t.position[r];if(i=s.field.isKeyField()?ji.comparator(ji.fromName(o.referenceValue),n.key):rr(o,n.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Fr(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!nr(t.position[n],e.position[n]))return!1;return!0}var Br=function(t,e,n,i,r,s,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===s&&(s="F"),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Ur(t,e,n,i,r,s,o,a){return new Br(t,e,n,i,r,s,o,a)}function Vr(t){return new Br(t)}function Yr(t){return!Ni(t.limit)&&"F"===t.limitType}function zr(t){return!Ni(t.limit)&&"L"===t.limitType}function Xr(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Gr(t){for(var e=0,n=t.filters;e<n.length;e++){var i=n[e];if(i.g())return i.field}return null}function jr(t){return null!==t.collectionGroup}function Wr(t){var e=Ai(t);if(null===e.p){e.p=[];var n=Gr(e),i=Xr(e);if(null!==n&&null===i)n.isKeyField()||e.p.push(new Dr(n)),e.p.push(new Dr(Gi.keyField(),"asc"));else{for(var r=!1,s=0,o=e.explicitOrderBy;s<o.length;s++){var a=o[s];e.p.push(a),a.field.isKeyField()&&(r=!0)}if(!r){var h=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Dr(Gi.keyField(),h))}}}return e.p}function Hr(t){var e=Ai(t);if(!e.T)if("F"===e.limitType)e.T=xr(e.path,e.collectionGroup,Wr(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=Wr(e);i<r.length;i++){var s=r[i],o="desc"===s.dir?"asc":"desc";n.push(new Dr(s.field,o))}var a=e.endAt?new kr(e.endAt.position,!e.endAt.before):null,h=e.startAt?new kr(e.startAt.position,!e.startAt.before):null;e.T=xr(e.path,e.collectionGroup,n,e.filters,e.limit,a,h)}return e.T}function qr(t,e,n){return new Br(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Kr(t,e){return wr(Hr(t),Hr(e))&&t.limitType===e.limitType}function Qr(t){return br(Hr(t))+"|lt:"+t.limitType}function Zr(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+or(e.value);var e})).join(", ")+"]"),Ni(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Mr(t.startAt)),t.endAt&&(e+=", endAt: "+Mr(t.endAt)),"Target("+e+")"}(Hr(t))+"; limitType="+t.limitType+")"}function Jr(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ji.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,i=t.explicitOrderBy;n<i.length;n++){var r=i[n];if(!r.field.isKeyField()&&null===e.field(r.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,i=t.filters;n<i.length;n++)if(!i[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Nr(t.startAt,Wr(t),e)||t.endAt&&Nr(t.endAt,Wr(t),e))}(t,e)}function $r(t){return function(e,n){for(var i=!1,r=0,s=Wr(t);r<s.length;r++){var o=s[r],a=ts(o,e,n);if(0!==a)return a;i=i||o.field.isKeyField()}return 0}}function ts(t,e,n){var i=t.field.isKeyField()?ji.comparator(e.key,n.key):function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?rr(i,r):Si()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Si()}}var es=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Zi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}(),ns=function(){function t(t){this.fields=t,t.sort(Gi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Oi(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),is=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!dr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.isEqual=function(t){return nr(this.proto,t.proto)},t}(),rs=function(){function t(t){void 0===t&&(t=is.empty()),this.I=t,this.A=new Map}return t.prototype.set=function(t,e){return this.R(t,e),this},t.prototype.delete=function(t){return this.R(t,null),this},t.prototype.R=function(t,e){for(var n=this.A,i=0;i<t.length-1;++i){var r=t.get(i),s=n.get(r);s instanceof Map?n=s:s&&10===er(s)?(s=new Map(Object.entries(s.mapValue.fields||{})),n.set(r,s),n=s):(s=new Map,n.set(r,s),n=s)}n.set(t.lastSegment(),e)},t.prototype.v=function(){var t=this.P(Gi.emptyPath(),this.A);return null!=t?new is(t):this.I},t.prototype.P=function(t,e){var n=this,i=!1,r=this.I.field(t),s=dr(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((function(e,r){if(e instanceof Map){var o=n.P(t.child(r),e);null!=o&&(s[r]=o,i=!0)}else null!==e?(s[r]=e,i=!0):s.hasOwnProperty(r)&&(delete s[r],i=!0)})),i?{mapValue:{fields:s}}:null},t}();function ss(t){var e=[];return Di(t.fields||{},(function(t,n){var i=new Gi([t]);if(dr(n)){var r=ss(n.mapValue).fields;if(0===r.length)e.push(i);else for(var s=0,o=r;s<o.length;s++){var a=o[s];e.push(i.child(a))}}else e.push(i)})),new ns(e)}function os(t,e){if(t.V){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fi(e)?"-0":e}}function as(t){return{integerValue:""+t}}function hs(t,e){return Bi(e)?as(e):os(t,e)}var us=function(){this._=void 0};function cs(t,e,n){return t instanceof ds?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ps?vs(t,e):t instanceof gs?ms(t,e):function(t,e){var n=fs(t,e),i=xs(n)+xs(t.S);return ur(n)&&ur(t.S)?as(i):os(t.D,i)}(t,e)}function ls(t,e,n){return t instanceof ps?vs(t,e):t instanceof gs?ms(t,e):n}function fs(t,e){return t instanceof ys?ur(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e}(us),ps=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return pi(e,t),e}(us);function vs(t,e){for(var n=bs(e),i=function(t){n.some((function(e){return nr(e,t)}))||n.push(t)},r=0,s=t.elements;r<s.length;r++)i(s[r]);return{arrayValue:{values:n}}}var gs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return pi(e,t),e}(us);function ms(t,e){for(var n=bs(e),i=function(t){n=n.filter((function(e){return!nr(e,t)}))},r=0,s=t.elements;r<s.length;r++)i(s[r]);return{arrayValue:{values:n}}}var ys=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).D=e,i.S=n,i}return pi(e,t),e}(us);function xs(t){return Ki(t.integerValue||t.doubleValue)}function bs(t){return cr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ws=function(t,e){this.field=t,this.transform=e},_s=function(t,e){this.version=t,this.transformResults=e},Ts=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Es(t,e){return void 0!==t.updateTime?e instanceof vr&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof vr}var Ss=function(){};function Cs(t,e,n){return t instanceof Os?function(t,e,n){var i=t.value,r=Ds(t.fieldTransforms,e,n.transformResults);return i=Ns(t.fieldTransforms,i,r),new vr(t.key,n.version,i,{hasCommittedMutations:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(!Es(t.precondition,e))return new mr(t.key,n.version);var i=Ms(t,e,Ds(t.fieldTransforms,e,n.transformResults));return new vr(t.key,n.version,i,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new gr(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function As(t,e,n){return t instanceof Os?function(t,e,n){if(!Es(t.precondition,e))return e;var i=t.value,r=Ls(t.fieldTransforms,n,e);i=Ns(t.fieldTransforms,i,r);var s=Rs(e);return new vr(t.key,s,i,{hasLocalMutations:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(!Es(t.precondition,e))return e;var i=Rs(e),r=Ms(t,e,Ls(t.fieldTransforms,n,e));return new vr(t.key,i,r,{hasLocalMutations:!0})}(t,e,n):function(t,e){return Es(t.precondition,e)?new gr(t.key,es.min()):e}(t,e)}function Is(t,e){return function(t,e){for(var n=null,i=0,r=t;i<r.length;i++){var s=r[i],o=e instanceof vr?e.field(s.field):void 0,a=fs(s.transform,o||null);null!=a&&(n=null==n?(new rs).set(s.field,a):n.set(s.field,a))}return n?n.v():null}(t.fieldTransforms,e)}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Oi(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ps&&e instanceof ps||t instanceof gs&&e instanceof gs?Oi(t.elements,e.elements,nr):t instanceof ys&&e instanceof ys?nr(t.S,e.S):t instanceof ds&&e instanceof ds}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Rs(t){return t instanceof vr?t.version:es.min()}var Os=function(t){function e(e,n,i,r){void 0===r&&(r=[]);var s=this;return(s=t.call(this)||this).key=e,s.value=n,s.precondition=i,s.fieldTransforms=r,s.type=0,s}return pi(e,t),e}(Ss),ks=function(t){function e(e,n,i,r,s){void 0===s&&(s=[]);var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.fieldMask=i,o.precondition=r,o.fieldTransforms=s,o.type=1,o}return pi(e,t),e}(Ss);function Ms(t,e,n){var i;return i=function(t,e){var n=new rs(e);return t.fieldMask.fields.forEach((function(e){if(!e.isEmpty()){var i=t.data.field(e);null!==i?n.set(e,i):n.delete(e)}})),n.v()}(t,i=e instanceof vr?e.data():is.empty()),Ns(t.fieldTransforms,i,n)}function Ds(t,e,n){var i=[];Ci(t.length===n.length);for(var r=0;r<n.length;r++){var s=t[r],o=s.transform,a=null;e instanceof vr&&(a=e.field(s.field)),i.push(ls(o,a,n[r]))}return i}function Ls(t,e,n){for(var i=[],r=0,s=t;r<s.length;r++){var o=s[r],a=o.transform,h=null;n instanceof vr&&(h=n.field(o.field)),i.push(cs(a,h,e))}return i}function Ns(t,e,n){for(var i=new rs(e),r=0;r<t.length;r++){var s=t[r];i.set(s.field,n[r])}return i.v()}var Fs,Bs,Us=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).key=e,i.precondition=n,i.type=2,i.fieldTransforms=[],i}return pi(e,t),e}(Ss),Vs=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).key=e,i.precondition=n,i.type=3,i.fieldTransforms=[],i}return pi(e,t),e}(Ss),Ys=function(t){this.count=t};function zs(t){switch(t){case Ui.OK:return Si();case Ui.CANCELLED:case Ui.UNKNOWN:case Ui.DEADLINE_EXCEEDED:case Ui.RESOURCE_EXHAUSTED:case Ui.INTERNAL:case Ui.UNAVAILABLE:case Ui.UNAUTHENTICATED:return!1;case Ui.INVALID_ARGUMENT:case Ui.NOT_FOUND:case Ui.ALREADY_EXISTS:case Ui.PERMISSION_DENIED:case Ui.FAILED_PRECONDITION:case Ui.ABORTED:case Ui.OUT_OF_RANGE:case Ui.UNIMPLEMENTED:case Ui.DATA_LOSS:return!0;default:return Si()}}function Xs(t){if(void 0===t)return _i("GRPC error has no .code"),Ui.UNKNOWN;switch(t){case Fs.OK:return Ui.OK;case Fs.CANCELLED:return Ui.CANCELLED;case Fs.UNKNOWN:return Ui.UNKNOWN;case Fs.DEADLINE_EXCEEDED:return Ui.DEADLINE_EXCEEDED;case Fs.RESOURCE_EXHAUSTED:return Ui.RESOURCE_EXHAUSTED;case Fs.INTERNAL:return Ui.INTERNAL;case Fs.UNAVAILABLE:return Ui.UNAVAILABLE;case Fs.UNAUTHENTICATED:return Ui.UNAUTHENTICATED;case Fs.INVALID_ARGUMENT:return Ui.INVALID_ARGUMENT;case Fs.NOT_FOUND:return Ui.NOT_FOUND;case Fs.ALREADY_EXISTS:return Ui.ALREADY_EXISTS;case Fs.PERMISSION_DENIED:return Ui.PERMISSION_DENIED;case Fs.FAILED_PRECONDITION:return Ui.FAILED_PRECONDITION;case Fs.ABORTED:return Ui.ABORTED;case Fs.OUT_OF_RANGE:return Ui.OUT_OF_RANGE;case Fs.UNIMPLEMENTED:return Ui.UNIMPLEMENTED;case Fs.DATA_LOSS:return Ui.DATA_LOSS;default:return Si()}}(Bs=Fs||(Fs={}))[Bs.OK=0]="OK",Bs[Bs.CANCELLED=1]="CANCELLED",Bs[Bs.UNKNOWN=2]="UNKNOWN",Bs[Bs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bs[Bs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bs[Bs.NOT_FOUND=5]="NOT_FOUND",Bs[Bs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bs[Bs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bs[Bs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bs[Bs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bs[Bs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bs[Bs.ABORTED=10]="ABORTED",Bs[Bs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bs[Bs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bs[Bs.INTERNAL=13]="INTERNAL",Bs[Bs.UNAVAILABLE=14]="UNAVAILABLE",Bs[Bs.DATA_LOSS=15]="DATA_LOSS";var Gs=function(){function t(t,e){this.comparator=t,this.root=e||Ws.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ws.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ws.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new js(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new js(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new js(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new js(this.root,t,this.comparator,!0)},t}(),js=function(){function t(t,e,n,i){this.isReverse=i,this.nodeStack=[];for(var r=1;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Ws=function(){function t(e,n,i,r,s){this.key=e,this.value=n,this.color=null!=i?i:t.RED,this.left=null!=r?r:t.EMPTY,this.right=null!=s?s:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,i,r,s){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=s?s:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===n(e,r.key)){if(r.right.isEmpty())return t.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Si();if(this.right.isRed())throw Si();var t=this.left.check();if(t!==this.right.check())throw Si();return t+(this.isRed()?0:1)},t}();Ws.EMPTY=null,Ws.RED=!0,Ws.BLACK=!1,Ws.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Si()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Si()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,i,r){return this},t.prototype.insert=function(t,e,n){return new Ws(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Hs=function(){function t(t){this.comparator=t,this.data=new Gs(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new qs(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new qs(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),i=e.data.getIterator();n.hasNext();){var r=n.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),qs=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Ks=new Gs(ji.comparator);function Qs(){return Ks}function Zs(){return Qs()}var Js=new Gs(ji.comparator);function $s(){return Js}var to=new Gs(ji.comparator);function eo(){return to}var no=new Hs(ji.comparator);function io(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=no,i=0,r=t;i<r.length;i++){var s=r[i];n=n.add(s)}return n}var ro=new Hs(Ri);function so(){return ro}var oo=function(){function t(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var i=new Map;return i.set(e,ao.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(es.min(),i,so(),Qs(),io())},t}(),ao=function(){function t(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Wi.EMPTY_BYTE_STRING,n,io(),io(),io())},t}(),ho=function(t,e,n,i){this.C=t,this.removedTargetIds=e,this.key=n,this.N=i},uo=function(t,e){this.targetId=t,this.$=e},co=function(t,e,n,i){void 0===n&&(n=Wi.EMPTY_BYTE_STRING),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i},lo=function(){function t(){this.F=0,this.O=vo(),this.k=Wi.EMPTY_BYTE_STRING,this.M=!1,this.L=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.M},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.k},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"B",{get:function(){return 0!==this.F},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"q",{get:function(){return this.L},enumerable:!1,configurable:!0}),t.prototype.U=function(t){t.approximateByteSize()>0&&(this.L=!0,this.k=t)},t.prototype.K=function(){var t=io(),e=io(),n=io();return this.O.forEach((function(i,r){switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Si()}})),new ao(this.k,this.M,t,e,n)},t.prototype.W=function(){this.L=!1,this.O=vo()},t.prototype.j=function(t,e){this.L=!0,this.O=this.O.insert(t,e)},t.prototype.G=function(t){this.L=!0,this.O=this.O.remove(t)},t.prototype.H=function(){this.F+=1},t.prototype.J=function(){this.F-=1},t.prototype.Y=function(){this.L=!0,this.M=!0},t}(),fo=function(){function t(t){this.X=t,this.Z=new Map,this.tt=Qs(),this.et=po(),this.nt=new Hs(Ri)}return t.prototype.st=function(t){for(var e=0,n=t.C;e<n.length;e++){var i=n[e];t.N instanceof vr?this.it(i,t.N):t.N instanceof gr&&this.rt(i,t.key,t.N)}for(var r=0,s=t.removedTargetIds;r<s.length;r++)i=s[r],this.rt(i,t.key,t.N)},t.prototype.ot=function(t){var e=this;this.forEachTarget(t,(function(n){var i=e.ct(n);switch(t.state){case 0:e.at(n)&&i.U(t.resumeToken);break;case 1:i.J(),i.B||i.W(),i.U(t.resumeToken);break;case 2:i.J(),i.B||e.removeTarget(n);break;case 3:e.at(n)&&(i.Y(),i.U(t.resumeToken));break;case 4:e.at(n)&&(e.ut(n),i.U(t.resumeToken));break;default:Si()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Z.forEach((function(t,i){n.at(i)&&e(i)}))},t.prototype.ht=function(t){var e=t.targetId,n=t.$.count,i=this.lt(e);if(i){var r=i.target;if(_r(r))if(0===n){var s=new ji(r.path);this.rt(e,s,new gr(s,es.min()))}else Ci(1===n);else this.ft(e)!==n&&(this.ut(e),this.nt=this.nt.add(e))}},t.prototype.dt=function(t){var e=this,n=new Map;this.Z.forEach((function(i,r){var s=e.lt(r);if(s){if(i.current&&_r(s.target)){var o=new ji(s.target.path);null!==e.tt.get(o)||e.wt(r,o)||e.rt(r,o,new gr(o,t))}i.q&&(n.set(r,i.K()),i.W())}}));var i=io();this.et.forEach((function(t,n){var r=!0;n.forEachWhile((function(t){var n=e.lt(t);return!n||2===n.purpose||(r=!1,!1)})),r&&(i=i.add(t))}));var r=new oo(t,n,this.nt,this.tt,i);return this.tt=Qs(),this.et=po(),this.nt=new Hs(Ri),r},t.prototype.it=function(t,e){if(this.at(t)){var n=this.wt(t,e.key)?2:0;this.ct(t).j(e.key,n),this.tt=this.tt.insert(e.key,e),this.et=this.et.insert(e.key,this._t(e.key).add(t))}},t.prototype.rt=function(t,e,n){if(this.at(t)){var i=this.ct(t);this.wt(t,e)?i.j(e,1):i.G(e),this.et=this.et.insert(e,this._t(e).delete(t)),n&&(this.tt=this.tt.insert(e,n))}},t.prototype.removeTarget=function(t){this.Z.delete(t)},t.prototype.ft=function(t){var e=this.ct(t).K();return this.X.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.H=function(t){this.ct(t).H()},t.prototype.ct=function(t){var e=this.Z.get(t);return e||(e=new lo,this.Z.set(t,e)),e},t.prototype._t=function(t){var e=this.et.get(t);return e||(e=new Hs(Ri),this.et=this.et.insert(t,e)),e},t.prototype.at=function(t){var e=null!==this.lt(t);return e||wi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.lt=function(t){var e=this.Z.get(t);return e&&e.B?null:this.X.yt(t)},t.prototype.ut=function(t){var e=this;this.Z.set(t,new lo),this.X.getRemoteKeysForTarget(t).forEach((function(n){e.rt(t,n,null)}))},t.prototype.wt=function(t,e){return this.X.getRemoteKeysForTarget(t).has(e)},t}();function po(){return new Gs(ji.comparator)}function vo(){return new Gs(ji.comparator)}var go={asc:"ASCENDING",desc:"DESCENDING"},mo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yo=function(t,e){this.databaseId=t,this.V=e};function xo(t,e){return t.V?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function bo(t,e){return t.V?e.toBase64():e.toUint8Array()}function wo(t,e){return xo(t,e.toTimestamp())}function _o(t){return Ci(!!t),es.fromTimestamp(function(t){var e=qi(t);return new Zi(e.seconds,e.nanos)}(t))}function To(t,e){return function(t){return new zi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Eo(t){var e=zi.fromString(t);return Ci(qo(e)),e}function So(t,e){return To(t.databaseId,e.path)}function Co(t,e){var n=Eo(e);if(n.get(1)!==t.databaseId.projectId)throw new Vi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Vi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ji(Ro(n))}function Ao(t,e){return To(t.databaseId,e)}function Io(t){var e=Eo(t);return 4===e.length?zi.emptyPath():Ro(e)}function Po(t){return new zi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ro(t){return Ci(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Oo(t,e,n){return{name:So(t,e),fields:n.proto.mapValue.fields}}function ko(t,e,n){var i=Co(t,e.name),r=_o(e.updateTime),s=new is({mapValue:{fields:e.fields}});return new vr(i,r,s,{hasCommittedMutations:!!n})}function Mo(t,e){var n;if(e instanceof Os)n={update:Oo(t,e.key,e.value)};else if(e instanceof Us)n={delete:So(t,e.key)};else if(e instanceof ks)n={update:Oo(t,e.key,e.data),updateMask:Ho(e.fieldMask)};else{if(!(e instanceof Vs))return Si();n={verify:So(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof ds)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ps)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof gs)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ys)return{fieldPath:e.field.canonicalString(),increment:n.S};throw Si()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:wo(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Si()}(t,e.precondition)),n}function Do(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ts.updateTime(_o(t.updateTime)):void 0!==t.exists?Ts.exists(t.exists):Ts.none()}(e.currentDocument):Ts.none(),i=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Ci("REQUEST_TIME"===e.setToServerValue),n=new ds;else if("appendMissingElements"in e){var i=e.appendMissingElements.values||[];n=new ps(i)}else if("removeAllFromArray"in e){var r=e.removeAllFromArray.values||[];n=new gs(r)}else"increment"in e?n=new ys(t,e.increment):Si();var s=Gi.fromServerFormat(e.fieldPath);return new ws(s,n)}(t,e)})):[];if(e.update){e.update.name;var r=Co(t,e.update.name),s=new is({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new ns(e.map((function(t){return Gi.fromServerFormat(t)})))}(e.updateMask);return new ks(r,s,o,n,i)}return new Os(r,s,n,i)}if(e.delete){var a=Co(t,e.delete);return new Us(a,n)}if(e.verify){var h=Co(t,e.verify);return new Vs(h,n)}return Si()}function Lo(t,e){return{documents:[Ao(t,e.path)]}}function No(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Ao(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ao(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);var r=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(fr(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(lr(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(fr(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(lr(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:zo(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var s=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Xo(t.field),direction:Yo(t.dir)}}(t)}))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);var o=function(t,e){return t.V||Ni(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Uo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Uo(e.endAt)),n}function Fo(t){var e=Io(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(i>0){Ci(1===i);var s=n.from[0];s.allDescendants?r=s.collectionId:e=e.child(s.collectionId)}var o=[];n.where&&(o=Bo(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new Dr(Go(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var h=null;n.limit&&(h=function(t){var e;return Ni(e="object"==typeof t?t.value:t)?null:e}(n.limit));var u=null;n.startAt&&(u=Vo(n.startAt));var c=null;return n.endAt&&(c=Vo(n.endAt)),Ur(e,r,a,o,h,"F",u,c)}function Bo(t){return t?void 0!==t.unaryFilter?[Wo(t)]:void 0!==t.fieldFilter?[jo(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Bo(t)})).reduce((function(t,e){return t.concat(e)})):Si():[]}function Uo(t){return{before:t.before,values:t.position}}function Vo(t){var e=!!t.before,n=t.values||[];return new kr(n,e)}function Yo(t){return go[t]}function zo(t){return mo[t]}function Xo(t){return{fieldPath:t.canonicalString()}}function Go(t){return Gi.fromServerFormat(t.fieldPath)}function jo(t){return Tr.create(Go(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Si()}}(t.fieldFilter.op),t.fieldFilter.value)}function Wo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Go(t.unaryFilter.field);return Tr.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Go(t.unaryFilter.field);return Tr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var i=Go(t.unaryFilter.field);return Tr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var r=Go(t.unaryFilter.field);return Tr.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Si()}}function Ho(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function qo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ko(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Zo(e)),e=Qo(t.get(n),e);return Zo(e)}function Qo(t,e){for(var n=e,i=t.length,r=0;r<i;r++){var s=t.charAt(r);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Zo(t){return t+""}function Jo(t){var e=t.length;if(Ci(e>=2),2===e)return Ci(""===t.charAt(0)&&""===t.charAt(1)),zi.emptyPath();for(var n=e-2,i=[],r="",s=0;s<e;){var o=t.indexOf("",s);switch((o<0||o>n)&&Si(),t.charAt(o+1)){case"":var a=t.substring(s,o),h=void 0;0===r.length?h=a:(h=r+=a,r=""),i.push(h);break;case"":r+=t.substring(s,o),r+="\0";break;case"":r+=t.substring(s,o+1);break;default:Si()}s=o+2}return new zi(i)}var $o=function(t,e){this.seconds=t,this.nanoseconds=e},ta=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ta.store="owner",ta.key="owner";var ea=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ea.store="mutationQueues",ea.keyPath="userId";var na=function(t,e,n,i,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=i,this.mutations=r};na.store="mutations",na.keyPath="batchId",na.userMutationsIndex="userMutationsIndex",na.userMutationsKeyPath=["userId","batchId"];var ia=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ko(e)]},t.key=function(t,e,n){return[t,Ko(e),n]},t}();ia.store="documentMutations",ia.PLACEHOLDER=new ia;var ra=function(t,e){this.path=t,this.readTime=e},sa=function(t,e){this.path=t,this.version=e},oa=function(t,e,n,i,r,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=i,this.readTime=r,this.parentPath=s};oa.store="remoteDocuments",oa.readTimeIndex="readTimeIndex",oa.readTimeIndexPath="readTime",oa.collectionReadTimeIndex="collectionReadTimeIndex",oa.collectionReadTimeIndexPath=["parentPath","readTime"];var aa=function(t){this.byteSize=t};aa.store="remoteDocumentGlobal",aa.key="remoteDocumentGlobalKey";var ha=function(t,e,n,i,r,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=i,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=s,this.query=o};ha.store="targets",ha.keyPath="targetId",ha.queryTargetsIndexName="queryTargetsIndex",ha.queryTargetsKeyPath=["canonicalId","targetId"];var ua=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ua.store="targetDocuments",ua.keyPath=["targetId","path"],ua.documentTargetsIndex="documentTargetsIndex",ua.documentTargetsKeyPath=["path","targetId"];var ca=function(t,e,n,i){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=i};ca.key="targetGlobalKey",ca.store="targetGlobal";var la=function(t,e){this.collectionId=t,this.parent=e};la.store="collectionParents",la.keyPath=["collectionId","parent"];var fa=function(t,e,n,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=i};fa.store="clientMetadata",fa.keyPath="clientId";var da=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};da.store="bundles",da.keyPath="bundleId";var pa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};pa.store="namedQueries",pa.keyPath="name";var va=mi(mi([],mi(mi([],mi(mi([],mi(mi([],[ea.store,na.store,ia.store,oa.store,ha.store,ta.store,ca.store,ua.store]),[fa.store])),[aa.store])),[la.store])),[da.store,pa.store]),ga="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ma=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),ya=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},xa=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var i=this;return this.callbackAttached&&Si(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,r){i.nextCallback=function(n){i.wrapSuccess(e,n).next(t,r)},i.catchCallback=function(e){i.wrapFailure(n,e).next(t,r)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var i=0,r=0,s=!1;e.forEach((function(e){++i,e.next((function(){++r,s&&r===i&&t()}),(function(t){return n(t)}))})),s=!0,r===i&&t()}))},t.or=function(e){for(var n=t.resolve(!1),i=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},r=0,s=e;r<s.length;r++)i(s[r]);return n},t.forEach=function(t,e){var n=this,i=[];return t.forEach((function(t,r){i.push(e.call(n,t,r))})),this.waitFor(i)},t}(),ba=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.gt=new ya,this.transaction.oncomplete=function(){n.gt.resolve()},this.transaction.onabort=function(){e.error?n.gt.reject(new Ta(t,e.error)):n.gt.resolve()},this.transaction.onerror=function(e){var i=Ia(e.target.error);n.gt.reject(new Ta(t,i))}}return t.open=function(e,n,i,r){try{return new t(n,e.transaction(r,i))}catch(e){throw new Ta(n,e)}},Object.defineProperty(t.prototype,"Et",{get:function(){return this.gt.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.gt.reject(t),this.aborted||(wi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Sa(e)},t}(),wa=function(){function t(e,n,i){this.name=e,this.version=n,this.Tt=i,12.2===t.It((0,o.z$)())&&_i("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return wi("SimpleDb","Removing database:",t),Ca(window.indexedDB.deleteDatabase(t)).toPromise()},t.At=function(){if("undefined"==typeof indexedDB)return!1;if(t.Rt())return!0;var e=(0,o.z$)(),n=t.It(e),i=0<n&&n<10,r=t.bt(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)},t.Rt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.vt)},t.Pt=function(t,e){return t.store(e)},t.It=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.bt=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Vt=function(t){return vi(this,void 0,void 0,(function(){var e,n=this;return gi(this,(function(i){switch(i.label){case 0:return this.db?[3,2]:(wi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,i){var r=indexedDB.open(n.name,n.version);r.onsuccess=function(t){var n=t.target.result;e(n)},r.onblocked=function(){i(new Ta(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(e){var n=e.target.error;"VersionError"===n.name?i(new Vi(Ui.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i(new Ta(t,n))},r.onupgradeneeded=function(t){wi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Tt.St(e,r.transaction,t.oldVersion,n.version).next((function(){wi("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=i.sent(),i.label=2;case 2:return[2,(this.Dt&&(this.db.onversionchange=function(t){return n.Dt(t)}),this.db)]}}))}))},t.prototype.Ct=function(t){this.Dt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s,o,a,h;return gi(this,(function(u){switch(u.label){case 0:r="readonly"===e,s=0,o=function(){var e,o,h,u,c;return gi(this,(function(l){switch(l.label){case 0:++s,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.Vt(t)];case 2:return a.db=l.sent(),e=ba.open(a.db,t,r?"readonly":"readwrite",n),o=i(e).catch((function(t){return e.abort(t),xa.reject(t)})).toPromise(),h={},o.catch((function(){})),[4,e.Et];case 3:return[2,(h.value=(l.sent(),o),h)];case 4:return u=l.sent(),c="FirebaseError"!==u.name&&s<3,wi("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),a.close(),c?[3,5]:[2,{value:Promise.reject(u)}];case 5:return[2]}}))},a=this,u.label=1;case 1:return[5,o()];case 2:if("object"==typeof(h=u.sent()))return[2,h.value];u.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),_a=function(){function t(t){this.xt=t,this.Nt=!1,this.$t=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Nt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ft",{get:function(){return this.$t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.xt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Nt=!0},t.prototype.Ot=function(t){this.$t=t},t.prototype.delete=function(){return Ca(this.xt.delete())},t}(),Ta=function(t){function e(e,n){var i=this;return(i=t.call(this,Ui.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",i}return pi(e,t),e}(Vi);function Ea(t){return"IndexedDbTransactionError"===t.name}var Sa=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(wi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(wi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ca(n)},t.prototype.add=function(t){return wi("SimpleDb","ADD",this.store.name,t,t),Ca(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ca(this.store.get(t)).next((function(n){return void 0===n&&(n=null),wi("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return wi("SimpleDb","DELETE",this.store.name,t),Ca(this.store.delete(t))},t.prototype.count=function(){return wi("SimpleDb","COUNT",this.store.name),Ca(this.store.count())},t.prototype.kt=function(t,e){var n=this.cursor(this.options(t,e)),i=[];return this.Mt(n,(function(t,e){i.push(e)})).next((function(){return i}))},t.prototype.Lt=function(t,e){wi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Bt=!1;var i=this.cursor(n);return this.Mt(i,(function(t,e,n){return n.delete()}))},t.prototype.qt=function(t,e){var n;e?n=t:(n={},e=t);var i=this.cursor(n);return this.Mt(i,e)},t.prototype.Ut=function(t){var e=this.cursor({});return new xa((function(n,i){e.onerror=function(t){var e=Ia(t.target.error);i(e)},e.onsuccess=function(e){var i=e.target.result;i?t(i.primaryKey,i.value).next((function(t){t?i.continue():n()})):n()}}))},t.prototype.Mt=function(t,e){var n=[];return new xa((function(i,r){t.onerror=function(t){r(t.target.error)},t.onsuccess=function(t){var r=t.target.result;if(r){var s=new _a(r),o=e(r.primaryKey,r.value,s);if(o instanceof xa){var a=o.catch((function(t){return s.done(),xa.reject(t)}));n.push(a)}s.isDone?i():null===s.Ft?r.continue():r.continue(s.Ft)}else i()}})).next((function(){return xa.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Bt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ca(t){return new xa((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ia(t.target.error);n(e)}}))}var Aa=!1;function Ia(t){var e=wa.It((0,o.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var i=new Vi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Aa||(Aa=!0,setTimeout((function(){throw i}),0)),i}}return t}var Pa=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).Qt=e,i.currentSequenceNumber=n,i}return pi(e,t),e}(ma);function Ra(t,e){var n=Ai(t);return wa.Pt(n.Qt,e)}var Oa=function(){function t(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}return t.prototype.applyToRemoteDocument=function(t,e,n){for(var i=n.mutationResults,r=0;r<this.mutations.length;r++){var s=this.mutations[r];s.key.isEqual(t)&&(e=Cs(s,e,i[r]))}return e},t.prototype.applyToLocalView=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++)(o=i[n]).key.isEqual(t)&&(e=As(o,e,this.localWriteTime));for(var r=0,s=this.mutations;r<s.length;r++){var o;(o=s[r]).key.isEqual(t)&&(e=As(o,e,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(i){var r=e.applyToLocalView(i.key,t.get(i.key));r&&(n=n.insert(i.key,r))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),io())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Oi(this.mutations,t.mutations,(function(t,e){return Ps(t,e)}))&&Oi(this.baseMutations,t.baseMutations,(function(t,e){return Ps(t,e)}))},t}(),ka=function(){function t(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}return t.from=function(e,n,i){Ci(e.mutations.length===i.length);for(var r=eo(),s=e.mutations,o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new t(e,n,i,r)},t}(),Ma=function(){function t(t,e,n,i,r,s,o){void 0===r&&(r=es.min()),void 0===s&&(s=es.min()),void 0===o&&(o=Wi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Da=function(t){this.Kt=t};function La(t,e){if(e.document)return ko(t.Kt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ji.fromSegments(e.noDocument.path),i=Va(e.noDocument.readTime);return new gr(n,i,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var r=ji.fromSegments(e.unknownDocument.path);return i=Va(e.unknownDocument.version),new mr(r,i)}return Si()}function Na(t,e,n){var i=Fa(n),r=e.key.path.popLast().toArray();if(e instanceof vr){var s=function(t,e){return{name:So(t,e.key),fields:e.toProto().mapValue.fields,updateTime:xo(t,e.version.toTimestamp())}}(t.Kt,e),o=e.hasCommittedMutations;return new oa(null,null,s,o,i,r)}if(e instanceof gr){var a=e.key.path.toArray(),h=Ua(e.version);return o=e.hasCommittedMutations,new oa(null,new ra(a,h),null,o,i,r)}if(e instanceof mr){var u=e.key.path.toArray(),c=Ua(e.version);return new oa(new sa(u,c),null,null,!0,i,r)}return Si()}function Fa(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ba(t){var e=new Zi(t[0],t[1]);return es.fromTimestamp(e)}function Ua(t){var e=t.toTimestamp();return new $o(e.seconds,e.nanoseconds)}function Va(t){var e=new Zi(t.seconds,t.nanoseconds);return es.fromTimestamp(e)}function Ya(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Do(t.Kt,e)})),i=0;i<e.mutations.length-1;++i){var r=e.mutations[i];if(i+1<e.mutations.length&&void 0!==e.mutations[i+1].transform){var s=e.mutations[i+1];r.updateTransforms=s.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}var o=e.mutations.map((function(e){return Do(t.Kt,e)})),a=Zi.fromMillis(e.localWriteTimeMs);return new Oa(e.batchId,a,n,o)}function za(t){var e,n,i=Va(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Va(t.lastLimboFreeSnapshotVersion):es.min();return void 0!==t.query.documents?(Ci(1===(n=t.query).documents.length),e=Hr(Vr(Io(n.documents[0])))):e=function(t){return Hr(Fo(t))}(t.query),new Ma(e,t.targetId,0,t.lastListenSequenceNumber,i,r,Wi.fromBase64String(t.resumeToken))}function Xa(t,e){var n,i=Ua(e.snapshotVersion),r=Ua(e.lastLimboFreeSnapshotVersion);n=_r(e.target)?Lo(t.Kt,e.target):No(t.Kt,e.target);var s=e.resumeToken.toBase64();return new ha(e.targetId,br(e.target),i,s,e.sequenceNumber,r,n)}function Ga(t){var e=Fo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?qr(e,e.limit,"L"):e}var ja=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Wa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Va(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Wa(t).put({bundleId:(n=e).id,createTime:Ua(_o(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Ha(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Ga(e.bundledQuery),readTime:Va(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Ha(t).put(function(t){return{name:t.name,readTime:Ua(_o(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Wa(t){return Ra(t,da.store)}function Ha(t){return Ra(t,pa.store)}var qa=function(){function t(){this.Wt=new Ka}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Wt.add(e),xa.resolve()},t.prototype.getCollectionParents=function(t,e){return xa.resolve(this.Wt.getEntries(e))},t}(),Ka=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Hs(zi.comparator),r=!i.has(n);return this.index[e]=i.add(n),r},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Hs(zi.comparator)).toArray()},t}(),Qa=function(){function t(){this.jt=new Ka}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.jt.has(e)){var i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener((function(){n.jt.add(e)}));var s={collectionId:i,parent:Ko(r)};return Za(t).put(s)}return xa.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],i=IDBKeyRange.bound([e,""],[ki(e),""],!1,!0);return Za(t).kt(i).next((function(t){for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.collectionId!==e)break;n.push(Jo(s.parent))}return n}))},t}();function Za(t){return Ra(t,la.store)}var Ja={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$a=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function th(t,e,n){var i=t.store(na.store),r=t.store(ia.store),s=[],o=IDBKeyRange.only(n.batchId),a=0,h=i.qt({range:o},(function(t,e,n){return a++,n.delete()}));s.push(h.next((function(){Ci(1===a)})));for(var u=[],c=0,l=n.mutations;c<l.length;c++){var f=l[c],d=ia.key(e,f.key.path,n.batchId);s.push(r.delete(d)),u.push(f.key)}return xa.waitFor(s).next((function(){return u}))}function eh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Si();e=t.noDocument}return JSON.stringify(e).length}$a.DEFAULT_COLLECTION_PERCENTILE=10,$a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$a.DEFAULT=new $a(41943040,$a.DEFAULT_COLLECTION_PERCENTILE,$a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$a.DISABLED=new $a(-1,0,0);var nh=function(){function t(t,e,n,i){this.userId=t,this.D=e,this.Gt=n,this.referenceDelegate=i,this.zt={}}return t.Ht=function(e,n,i,r){return Ci(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,i,r)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return rh(t).qt({index:na.userMutationsIndex,range:n},(function(t,n,i){e=!1,i.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,i){var r=this,s=sh(t),o=rh(t);return o.add({}).next((function(a){Ci("number"==typeof a);for(var h=new Oa(a,e,n,i),u=function(t,e,n){var i=n.baseMutations.map((function(e){return Mo(t.Kt,e)})),r=n.mutations.map((function(e){return Mo(t.Kt,e)}));return new na(e,n.batchId,n.localWriteTime.toMillis(),i,r)}(r.D,r.userId,h),c=[],l=new Hs((function(t,e){return Ri(t.canonicalString(),e.canonicalString())})),f=0,d=i;f<d.length;f++){var p=d[f],v=ia.key(r.userId,p.key.path,a);l=l.add(p.key.path.popLast()),c.push(o.put(u)),c.push(s.put(v,ia.PLACEHOLDER))}return l.forEach((function(e){c.push(r.Gt.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){r.zt[a]=h.keys()})),xa.waitFor(c).next((function(){return h}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return rh(t).get(e).next((function(t){return t?(Ci(t.userId===n.userId),Ya(n.D,t)):null}))},t.prototype.Jt=function(t,e){var n=this;return this.zt[e]?xa.resolve(this.zt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var i=t.keys();return n.zt[e]=i,i}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return rh(t).qt({index:na.userMutationsIndex,range:r},(function(t,e,r){e.userId===n.userId&&(Ci(e.batchId>=i),s=Ya(n.D,e)),r.done()})).next((function(){return s}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return rh(t).qt({index:na.userMutationsIndex,range:e,reverse:!0},(function(t,e,i){n=e.batchId,i.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return rh(t).kt(na.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ya(e.D,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,i=ia.prefixForPath(this.userId,e.path),r=IDBKeyRange.lowerBound(i),s=[];return sh(t).qt({range:r},(function(i,r,o){var a=i[0],h=i[1],u=i[2],c=Jo(h);if(a===n.userId&&e.path.isEqual(c))return rh(t).get(u).next((function(t){if(!t)throw Si();Ci(t.userId===n.userId),s.push(Ya(n.D,t))}));o.done()})).next((function(){return s}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,i=new Hs(Ri),r=[];return e.forEach((function(e){var s=ia.prefixForPath(n.userId,e.path),o=IDBKeyRange.lowerBound(s),a=sh(t).qt({range:o},(function(t,r,s){var o=t[0],a=t[1],h=t[2],u=Jo(a);o===n.userId&&e.path.isEqual(u)?i=i.add(h):s.done()}));r.push(a)})),xa.waitFor(r).next((function(){return n.Yt(t,i)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,i=e.path,r=i.length+1,s=ia.prefixForPath(this.userId,i),o=IDBKeyRange.lowerBound(s),a=new Hs(Ri);return sh(t).qt({range:o},(function(t,e,s){var o=t[0],h=t[1],u=t[2],c=Jo(h);o===n.userId&&i.isPrefixOf(c)?c.length===r&&(a=a.add(u)):s.done()})).next((function(){return n.Yt(t,a)}))},t.prototype.Yt=function(t,e){var n=this,i=[],r=[];return e.forEach((function(e){r.push(rh(t).get(e).next((function(t){if(null===t)throw Si();Ci(t.userId===n.userId),i.push(Ya(n.D,t))})))})),xa.waitFor(r).next((function(){return i}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return th(t.Qt,this.userId,e).next((function(i){return t.addOnCommittedListener((function(){n.Xt(e.batchId)})),xa.forEach(i,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Xt=function(t){delete this.zt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return xa.resolve();var i=IDBKeyRange.lowerBound(ia.prefixForUser(e.userId)),r=[];return sh(t).qt({range:i},(function(t,n,i){if(t[0]===e.userId){var s=Jo(t[1]);r.push(s)}else i.done()})).next((function(){Ci(0===r.length)}))}))},t.prototype.containsKey=function(t,e){return ih(t,this.userId,e)},t.prototype.Zt=function(t){var e=this;return oh(t).get(this.userId).next((function(t){return t||new ea(e.userId,-1,"")}))},t}();function ih(t,e,n){var i=ia.prefixForPath(e,n.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return sh(t).qt({range:s,Bt:!0},(function(t,n,i){var s=t[0],a=t[1];t[2],s===e&&a===r&&(o=!0),i.done()})).next((function(){return o}))}function rh(t){return Ra(t,na.store)}function sh(t){return Ra(t,ia.store)}function oh(t){return Ra(t,ea.store)}var ah=function(){function t(t){this.te=t}return t.prototype.next=function(){return this.te+=2,this.te},t.ee=function(){return new t(0)},t.ne=function(){return new t(-1)},t}(),hh=function(){function t(t,e){this.referenceDelegate=t,this.D=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.se(t).next((function(n){var i=new ah(n.highestTargetId);return n.highestTargetId=i.next(),e.ie(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.se(t).next((function(t){return es.fromTimestamp(new Zi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.se(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var i=this;return this.se(t).next((function(r){return r.highestListenSequenceNumber=e,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),i.ie(t,r)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.re(t,e).next((function(){return n.se(t).next((function(i){return i.targetCount+=1,n.oe(e,i),n.ie(t,i)}))}))},t.prototype.updateTargetData=function(t,e){return this.re(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return uh(t).delete(e.targetId)})).next((function(){return n.se(t)})).next((function(e){return Ci(e.targetCount>0),e.targetCount-=1,n.ie(t,e)}))},t.prototype.removeTargets=function(t,e,n){var i=this,r=0,s=[];return uh(t).qt((function(o,a){var h=za(a);h.sequenceNumber<=e&&null===n.get(h.targetId)&&(r++,s.push(i.removeTargetData(t,h)))})).next((function(){return xa.waitFor(s)})).next((function(){return r}))},t.prototype.forEachTarget=function(t,e){return uh(t).qt((function(t,n){var i=za(n);e(i)}))},t.prototype.se=function(t){return ch(t).get(ca.key).next((function(t){return Ci(null!==t),t}))},t.prototype.ie=function(t,e){return ch(t).put(ca.key,e)},t.prototype.re=function(t,e){return uh(t).put(Xa(this.D,e))},t.prototype.oe=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.se(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=br(e),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),r=null;return uh(t).qt({range:i,index:ha.queryTargetsIndexName},(function(t,n,i){var s=za(n);wr(e,s.target)&&(r=s,i.done())})).next((function(){return r}))},t.prototype.addMatchingKeys=function(t,e,n){var i=this,r=[],s=lh(t);return e.forEach((function(e){var o=Ko(e.path);r.push(s.put(new ua(n,o))),r.push(i.referenceDelegate.addReference(t,n,e))})),xa.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var i=this,r=lh(t);return xa.forEach(e,(function(e){var s=Ko(e.path);return xa.waitFor([r.delete([n,s]),i.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=lh(t),i=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(i)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),i=lh(t),r=io();return i.qt({range:n,Bt:!0},(function(t,e,n){var i=Jo(t[1]),s=new ji(i);r=r.add(s)})).next((function(){return r}))},t.prototype.containsKey=function(t,e){var n=Ko(e.path),i=IDBKeyRange.bound([n],[ki(n)],!1,!0),r=0;return lh(t).qt({index:ua.documentTargetsIndex,Bt:!0,range:i},(function(t,e,n){var i=t[0];t[1],0!==i&&(r++,n.done())})).next((function(){return r>0}))},t.prototype.yt=function(t,e){return uh(t).get(e).next((function(t){return t?za(t):null}))},t}();function uh(t){return Ra(t,ha.store)}function ch(t){return Ra(t,ca.store)}function lh(t){return Ra(t,ua.store)}function fh(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){if(t.code!==Ui.FAILED_PRECONDITION||t.message!==ga)throw t;return wi("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function dh(t,e){var n=t[0],i=t[1],r=e[0],s=e[1],o=Ri(n,r);return 0===o?Ri(i,s):o}var ph=function(){function t(t){this.ce=t,this.buffer=new Hs(dh),this.ae=0}return t.prototype.ue=function(){return++this.ae},t.prototype.he=function(t){var e=[t,this.ue()];if(this.buffer.size<this.ce)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();dh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),vh=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.le=!1,this.fe=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.de(t)},t.prototype.stop=function(){this.fe&&(this.fe.cancel(),this.fe=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.fe},enumerable:!1,configurable:!0}),t.prototype.de=function(t){var e=this,n=this.le?3e5:6e4;wi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.fe=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return vi(e,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:this.fe=null,this.le=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ea(e=n.sent())?(wi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,fh(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.de(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),gh=function(){function t(t,e){this.we=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.we._e(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return xa.resolve(yi.o);var i=new ph(e);return this.we.forEachTarget(t,(function(t){return i.he(t.sequenceNumber)})).next((function(){return n.we.me(t,(function(t){return i.he(t)}))})).next((function(){return i.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.we.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.we.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(wi("LruGarbageCollector","Garbage collection skipped; disabled"),xa.resolve(Ja)):this.getCacheSize(t).next((function(i){return i<n.params.cacheSizeCollectionThreshold?(wi("LruGarbageCollector","Garbage collection skipped; Cache size "+i+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Ja):n.ye(t,e)}))},t.prototype.getCacheSize=function(t){return this.we.getCacheSize(t)},t.prototype.ye=function(t,e){var n,i,r,o,a,h,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(wi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),i=c.params.maximumSequenceNumbersToCollect):i=e,o=Date.now(),c.nthSequenceNumber(t,i)})).next((function(i){return n=i,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return r=e,h=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),bi()<=s.in.DEBUG&&wi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+i+" in "+(a-o)+"ms\n\tRemoved "+r+" targets in "+(h-a)+"ms\n\tRemoved "+t+" documents in "+(u-h)+"ms\nTotal Duration: "+(u-l)+"ms"),xa.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:t})}))},t}(),mh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new gh(t,e)}(this,e)}return t.prototype._e=function(t){var e=this.ge(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.ge=function(t){var e=0;return this.me(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.me=function(t,e){return this.pe(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return yh(t,n)},t.prototype.removeReference=function(t,e,n){return yh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return yh(t,e)},t.prototype.Ee=function(t,e){return function(t,e){var n=!1;return oh(t).Ut((function(i){return ih(t,i,e).next((function(t){return t&&(n=!0),xa.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],s=0;return this.pe(t,(function(o,a){if(a<=e){var h=n.Ee(t,o).next((function(e){if(!e)return s++,i.getEntry(t,o).next((function(){return i.removeEntry(o),lh(t).delete([0,Ko(o.path)])}))}));r.push(h)}})).next((function(){return xa.waitFor(r)})).next((function(){return i.apply(t)})).next((function(){return s}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return yh(t,e)},t.prototype.pe=function(t,e){var n,i=lh(t),r=yi.o;return i.qt({index:ua.documentTargetsIndex},(function(t,i){var s=t[0],o=(t[1],i.path),a=i.sequenceNumber;0===s?(r!==yi.o&&e(new ji(Jo(n)),r),r=a,n=o):r=yi.o})).next((function(){r!==yi.o&&e(new ji(Jo(n)),r)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function yh(t,e){return lh(t).put(function(t,e){return new ua(0,Ko(t.path),e)}(e,t.currentSequenceNumber))}var xh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var s=r[i],o=s[0],a=s[1];if(this.equalsFn(o,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),i=this.inner[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),!0;return!1},t.prototype.forEach=function(t){Di(this.inner,(function(e,n){for(var i=0,r=n;i<r.length;i++){var s=r[i],o=s[0],a=s[1];t(o,a)}}))},t.prototype.isEmpty=function(){return Li(this.inner)},t}(),bh=function(){function t(){this.changes=new xh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:es.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{maybeDocument:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{maybeDocument:null,readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?xa.resolve(n.maybeDocument):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),wh=function(){function t(t,e){this.D=t,this.Gt=e}return t.prototype.addEntry=function(t,e,n){return Eh(t).put(Sh(e),n)},t.prototype.removeEntry=function(t,e){var n=Eh(t),i=Sh(e);return n.delete(i)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(i){return i.byteSize+=e,n.Te(t,i)}))},t.prototype.getEntry=function(t,e){var n=this;return Eh(t).get(Sh(e)).next((function(t){return n.Ie(t)}))},t.prototype.Ae=function(t,e){var n=this;return Eh(t).get(Sh(e)).next((function(t){var e=n.Ie(t);return e?{maybeDocument:e,size:eh(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,i=Zs();return this.Re(t,e,(function(t,e){var r=n.Ie(e);i=i.insert(t,r)})).next((function(){return i}))},t.prototype.be=function(t,e){var n=this,i=Zs(),r=new Gs(ji.comparator);return this.Re(t,e,(function(t,e){var s=n.Ie(e);s?(i=i.insert(t,s),r=r.insert(t,eh(e))):(i=i.insert(t,null),r=r.insert(t,0))})).next((function(){return{ve:i,Pe:r}}))},t.prototype.Re=function(t,e,n){if(e.isEmpty())return xa.resolve();var i=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),r=e.getIterator(),s=r.getNext();return Eh(t).qt({range:i},(function(t,e,i){for(var o=ji.fromSegments(t);s&&ji.comparator(s,o)<0;)n(s,null),s=r.getNext();s&&s.isEqual(o)&&(n(s,e),s=r.hasNext()?r.getNext():null),s?i.Ot(s.path.toArray()):i.done()})).next((function(){for(;s;)n(s,null),s=r.hasNext()?r.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var i=this,r=$s(),s=e.path.length+1,o={};if(n.isEqual(es.min())){var a=e.path.toArray();o.range=IDBKeyRange.lowerBound(a)}else{var h=e.path.toArray(),u=Fa(n);o.range=IDBKeyRange.lowerBound([h,u],!0),o.index=oa.collectionReadTimeIndex}return Eh(t).qt(o,(function(t,n,o){if(t.length===s){var a=La(i.D,n);e.path.isPrefixOf(a.key.path)?a instanceof vr&&Jr(e,a)&&(r=r.insert(a.key,a)):o.done()}})).next((function(){return r}))},t.prototype.newChangeBuffer=function(t){return new _h(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Th(t).get(aa.key).next((function(t){return Ci(!!t),t}))},t.prototype.Te=function(t,e){return Th(t).put(aa.key,e)},t.prototype.Ie=function(t){if(t){var e=La(this.D,t);return e instanceof gr&&e.version.isEqual(es.min())?null:e}return null},t}(),_h=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).Ve=e,i.trackRemovals=n,i.Se=new xh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),i}return pi(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],i=0,r=new Hs((function(t,e){return Ri(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(s,o){var a=e.Se.get(s);if(o.maybeDocument){var h=Na(e.Ve.D,o.maybeDocument,e.getReadTime(s));r=r.add(s.path.popLast());var u=eh(h);i+=u-a,n.push(e.Ve.addEntry(t,s,h))}else if(i-=a,e.trackRemovals){var c=Na(e.Ve.D,new gr(s,es.min()),e.getReadTime(s));n.push(e.Ve.addEntry(t,s,c))}else n.push(e.Ve.removeEntry(t,s))})),r.forEach((function(i){n.push(e.Ve.Gt.addToCollectionParentIndex(t,i))})),n.push(this.Ve.updateMetadata(t,i)),xa.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ve.Ae(t,e).next((function(t){return null===t?(n.Se.set(e,0),null):(n.Se.set(e,t.size),t.maybeDocument)}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ve.be(t,e).next((function(t){var e=t.ve;return t.Pe.forEach((function(t,e){n.Se.set(t,e)})),e}))},e}(bh);function Th(t){return Ra(t,aa.store)}function Eh(t){return Ra(t,oa.store)}function Sh(t){return t.path.toArray()}var Ch=function(){function t(t){this.D=t}return t.prototype.St=function(t,e,n,i){var r=this;Ci(n<i&&n>=0&&i<=11);var s=new ba("createOrUpgrade",e);n<1&&i>=1&&(function(t){t.createObjectStore(ta.store)}(t),function(t){t.createObjectStore(ea.store,{keyPath:ea.keyPath}),t.createObjectStore(na.store,{keyPath:na.keyPath,autoIncrement:!0}).createIndex(na.userMutationsIndex,na.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ia.store)}(t),Ah(t),function(t){t.createObjectStore(oa.store)}(t));var o=xa.resolve();return n<3&&i>=3&&(0!==n&&(function(t){t.deleteObjectStore(ua.store),t.deleteObjectStore(ha.store),t.deleteObjectStore(ca.store)}(t),Ah(t)),o=o.next((function(){return function(t){var e=t.store(ca.store),n=new ca(0,0,es.min().toTimestamp(),0);return e.put(ca.key,n)}(s)}))),n<4&&i>=4&&(0!==n&&(o=o.next((function(){return function(t,e){return e.store(na.store).kt().next((function(n){t.deleteObjectStore(na.store),t.createObjectStore(na.store,{keyPath:na.keyPath,autoIncrement:!0}).createIndex(na.userMutationsIndex,na.userMutationsKeyPath,{unique:!0});var i=e.store(na.store),r=n.map((function(t){return i.put(t)}));return xa.waitFor(r)}))}(t,s)}))),o=o.next((function(){!function(t){t.createObjectStore(fa.store,{keyPath:fa.keyPath})}(t)}))),n<5&&i>=5&&(o=o.next((function(){return r.De(s)}))),n<6&&i>=6&&(o=o.next((function(){return function(t){t.createObjectStore(aa.store)}(t),r.Ce(s)}))),n<7&&i>=7&&(o=o.next((function(){return r.xe(s)}))),n<8&&i>=8&&(o=o.next((function(){return r.Ne(t,s)}))),n<9&&i>=9&&(o=o.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(oa.store);e.createIndex(oa.readTimeIndex,oa.readTimeIndexPath,{unique:!1}),e.createIndex(oa.collectionReadTimeIndex,oa.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&i>=10&&(o=o.next((function(){return r.$e(s)}))),n<11&&i>=11&&(o=o.next((function(){!function(t){t.createObjectStore(da.store,{keyPath:da.keyPath})}(t),function(t){t.createObjectStore(pa.store,{keyPath:pa.keyPath})}(t)}))),o},t.prototype.Ce=function(t){var e=0;return t.store(oa.store).qt((function(t,n){e+=eh(n)})).next((function(){var n=new aa(e);return t.store(aa.store).put(aa.key,n)}))},t.prototype.De=function(t){var e=this,n=t.store(ea.store),i=t.store(na.store);return n.kt().next((function(n){return xa.forEach(n,(function(n){var r=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return i.kt(na.userMutationsIndex,r).next((function(i){return xa.forEach(i,(function(i){Ci(i.userId===n.userId);var r=Ya(e.D,i);return th(t,n.userId,r).next((function(){}))}))}))}))}))},t.prototype.xe=function(t){var e=t.store(ua.store),n=t.store(oa.store);return t.store(ca.store).get(ca.key).next((function(t){var i=[];return n.qt((function(n,r){var s=new zi(n),o=function(t){return[0,Ko(t)]}(s);i.push(e.get(o).next((function(n){return n?xa.resolve():function(n){return e.put(new ua(0,Ko(n),t.highestListenSequenceNumber))}(s)})))})).next((function(){return xa.waitFor(i)}))}))},t.prototype.Ne=function(t,e){t.createObjectStore(la.store,{keyPath:la.keyPath});var n=e.store(la.store),i=new Ka,r=function(t){if(i.add(t)){var e=t.lastSegment(),r=t.popLast();return n.put({collectionId:e,parent:Ko(r)})}};return e.store(oa.store).qt({Bt:!0},(function(t,e){var n=new zi(t);return r(n.popLast())})).next((function(){return e.store(ia.store).qt({Bt:!0},(function(t,e){t[0];var n=t[1],i=(t[2],Jo(n));return r(i.popLast())}))}))},t.prototype.$e=function(t){var e=this,n=t.store(ha.store);return n.qt((function(t,i){var r=za(i),s=Xa(e.D,r);return n.put(s)}))},t}();function Ah(t){t.createObjectStore(ua.store,{keyPath:ua.keyPath}).createIndex(ua.documentTargetsIndex,ua.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ha.store,{keyPath:ha.keyPath}).createIndex(ha.queryTargetsIndexName,ha.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ca.store)}var Ih="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ph=function(){function t(e,n,i,r,s,o,a,h,u,c){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=i,this.Fe=s,this.window=o,this.document=a,this.Oe=u,this.ke=c,this.Me=null,this.Le=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Be=null,this.inForeground=!1,this.qe=null,this.Ue=null,this.Qe=Number.NEGATIVE_INFINITY,this.Ke=function(t){return Promise.resolve()},!t.At())throw new Vi(Ui.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new mh(this,r),this.We=n+"main",this.D=new Da(h),this.je=new wa(this.We,11,new Ch(this.D)),this.Ge=new hh(this.referenceDelegate,this.D),this.Gt=new Qa,this.ze=function(t,e){return new wh(t,e)}(this.D,this.Gt),this.He=new ja,this.window&&this.window.localStorage?this.Je=this.window.localStorage:(this.Je=null,!1===c&&_i("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Ye().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Vi(Ui.FAILED_PRECONDITION,Ih);return t.Xe(),t.Ze(),t.tn(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ge.getHighestSequenceNumber(e)}))})).then((function(e){t.Me=new yi(e,t.Oe)})).then((function(){t.Le=!0})).catch((function(e){return t.je&&t.je.close(),Promise.reject(e)}))},t.prototype.en=function(t){var e=this;return this.Ke=function(n){return vi(e,void 0,void 0,(function(){return gi(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.je.Ct((function(n){return vi(e,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Fe.enqueueAndForget((function(){return vi(e,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return this.started?[4,this.Ye()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Ye=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Oh(e).put(new fa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.nn(e).next((function(e){e||(t.isPrimary=!1,t.Fe.enqueueRetryable((function(){return t.Ke(!1)})))}))})).next((function(){return t.sn(e)})).next((function(n){return t.isPrimary&&!n?t.rn(e).next((function(){return!1})):!!n&&t.on(e).next((function(){return!0}))}))})).catch((function(e){if(Ea(e))return wi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return wi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Fe.enqueueRetryable((function(){return t.Ke(e)})),t.isPrimary=e}))},t.prototype.nn=function(t){var e=this;return Rh(t).get(ta.key).next((function(t){return xa.resolve(e.cn(t))}))},t.prototype.an=function(t){return Oh(t).delete(this.clientId)},t.prototype.un=function(){return vi(this,void 0,void 0,(function(){var t,e,n,i,r=this;return gi(this,(function(s){switch(s.label){case 0:return!this.isPrimary||this.hn(this.Qe,18e5)?[3,2]:(this.Qe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ra(t,fa.store);return e.kt().next((function(t){var n=r.ln(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return xa.forEach(i,(function(t){return e.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:if(t=s.sent(),this.Je)for(e=0,n=t;e<n.length;e++)i=n[e],this.Je.removeItem(this.fn(i.clientId));s.label=2;case 2:return[2]}}))}))},t.prototype.tn=function(){var t=this;this.Ue=this.Fe.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.Ye().then((function(){return t.un()})).then((function(){return t.tn()}))}))},t.prototype.cn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sn=function(t){var e=this;return this.ke?xa.resolve(!0):Rh(t).get(ta.key).next((function(n){if(null!==n&&e.hn(n.leaseTimestampMs,5e3)&&!e.dn(n.ownerId)){if(e.cn(n)&&e.networkEnabled)return!0;if(!e.cn(n)){if(!n.allowTabSynchronization)throw new Vi(Ui.FAILED_PRECONDITION,Ih);return!1}}return!(!e.networkEnabled||!e.inForeground)||Oh(t).kt().next((function(t){return void 0===e.ln(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,i=!e.inForeground&&t.inForeground,r=e.networkEnabled===t.networkEnabled;if(n||i&&r)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&wi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return vi(this,void 0,void 0,(function(){var t=this;return gi(this,(function(e){switch(e.label){case 0:return this.Le=!1,this.wn(),this.Ue&&(this.Ue.cancel(),this.Ue=null),this._n(),this.mn(),[4,this.je.runTransaction("shutdown","readwrite",[ta.store,fa.store],(function(e){var n=new Pa(e,yi.o);return t.rn(n).next((function(){return t.an(n)}))}))];case 1:return e.sent(),this.je.close(),this.yn(),[2]}}))}))},t.prototype.ln=function(t,e){var n=this;return t.filter((function(t){return n.hn(t.updateTimeMs,e)&&!n.dn(t.clientId)}))},t.prototype.gn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Oh(e).kt().next((function(e){return t.ln(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return nh.Ht(t,this.D,this.Gt,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.Ge},t.prototype.getRemoteDocumentCache=function(){return this.ze},t.prototype.getIndexManager=function(){return this.Gt},t.prototype.getBundleCache=function(){return this.He},t.prototype.runTransaction=function(t,e,n){var i=this;wi("IndexedDbPersistence","Starting transaction:",t);var r,s="readonly"===e?"readonly":"readwrite";return this.je.runTransaction(t,s,va,(function(s){return r=new Pa(s,i.Me?i.Me.next():yi.o),"readwrite-primary"===e?i.nn(r).next((function(t){return!!t||i.sn(r)})).next((function(e){if(!e)throw _i("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Fe.enqueueRetryable((function(){return i.Ke(!1)})),new Vi(Ui.FAILED_PRECONDITION,ga);return n(r)})).next((function(t){return i.on(r).next((function(){return t}))})):i.pn(r).next((function(){return n(r)}))})).then((function(t){return r.raiseOnCommittedEvent(),t}))},t.prototype.pn=function(t){var e=this;return Rh(t).get(ta.key).next((function(t){if(null!==t&&e.hn(t.leaseTimestampMs,5e3)&&!e.dn(t.ownerId)&&!e.cn(t)&&!(e.ke||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Vi(Ui.FAILED_PRECONDITION,Ih)}))},t.prototype.on=function(t){var e=new ta(this.clientId,this.allowTabSynchronization,Date.now());return Rh(t).put(ta.key,e)},t.At=function(){return wa.At()},t.prototype.rn=function(t){var e=this,n=Rh(t);return n.get(ta.key).next((function(t){return e.cn(t)?(wi("IndexedDbPersistence","Releasing primary lease."),n.delete(ta.key)):xa.resolve()}))},t.prototype.hn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(_i("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Xe=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=function(){t.Fe.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ye()}))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)},t.prototype._n=function(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)},t.prototype.Ze=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Be=function(){e.wn(),e.Fe.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.Be))},t.prototype.mn=function(){this.Be&&(this.window.removeEventListener("unload",this.Be),this.Be=null)},t.prototype.dn=function(t){var e;try{var n=null!==(null===(e=this.Je)||void 0===e?void 0:e.getItem(this.fn(t)));return wi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return _i("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wn=function(){if(this.Je)try{this.Je.setItem(this.fn(this.clientId),String(Date.now()))}catch(t){_i("Failed to set zombie client id.",t)}},t.prototype.yn=function(){if(this.Je)try{this.Je.removeItem(this.fn(this.clientId))}catch(t){}},t.prototype.fn=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Rh(t){return Ra(t,ta.store)}function Oh(t){return Ra(t,fa.store)}function kh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Mh=function(t,e){this.progress=t,this.En=e},Dh=function(){function t(t,e,n){this.ze=t,this.Tn=e,this.Gt=n}return t.prototype.In=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(i){return n.An(t,e,i)}))},t.prototype.An=function(t,e,n){return this.ze.getEntry(t,e).next((function(t){for(var i=0,r=n;i<r.length;i++)t=r[i].applyToLocalView(e,t);return t}))},t.prototype.Rn=function(t,e,n){var i=Zs();return e.forEach((function(t,e){for(var r=0,s=n;r<s.length;r++)e=s[r].applyToLocalView(t,e);i=i.insert(t,e)})),i},t.prototype.bn=function(t,e){var n=this;return this.ze.getEntries(t,e).next((function(e){return n.vn(t,e)}))},t.prototype.vn=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(i){var r=n.Rn(t,e,i),s=Qs();return r.forEach((function(t,e){e||(e=new gr(t,es.min())),s=s.insert(t,e)})),s}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return ji.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Pn(t,e.path):jr(e)?this.Vn(t,e,n):this.Sn(t,e,n)},t.prototype.Pn=function(t,e){return this.In(t,new ji(e)).next((function(t){var e=$s();return t instanceof vr&&(e=e.insert(t.key,t)),e}))},t.prototype.Vn=function(t,e,n){var i=this,r=e.collectionGroup,s=$s();return this.Gt.getCollectionParents(t,r).next((function(o){return xa.forEach(o,(function(o){var a=function(t,e){return new Br(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return i.Sn(t,a,n).next((function(t){t.forEach((function(t,e){s=s.insert(t,e)}))}))})).next((function(){return s}))}))},t.prototype.Sn=function(t,e,n){var i,r,s=this;return this.ze.getDocumentsMatchingQuery(t,e,n).next((function(n){return i=n,s.Tn.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return r=e,s.Dn(t,r,i).next((function(t){i=t;for(var e=0,n=r;e<n.length;e++)for(var s=n[e],o=0,a=s.mutations;o<a.length;o++){var h=a[o],u=h.key,c=As(h,i.get(u),s.localWriteTime);i=c instanceof vr?i.insert(u,c):i.remove(u)}}))})).next((function(){return i.forEach((function(t,n){Jr(e,n)||(i=i.remove(t))})),i}))},t.prototype.Dn=function(t,e,n){for(var i=io(),r=0,s=e;r<s.length;r++)for(var o=0,a=s[r].mutations;o<a.length;o++){var h=a[o];h instanceof ks&&null===n.get(h.key)&&(i=i.add(h.key))}var u=n;return this.ze.getEntries(t,i).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof vr&&(u=u.insert(t,e))})),u}))},t}(),Lh=function(){function t(t,e,n,i){this.targetId=t,this.fromCache=e,this.Cn=n,this.xn=i}return t.Nn=function(e,n){for(var i=io(),r=io(),s=0,o=n.docChanges;s<o.length;s++){var a=o[s];switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}}return new t(e,n.fromCache,i,r)},t}(),Nh=function(){function t(){}return t.prototype.$n=function(t){this.Fn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,i){var r=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(es.min())?this.On(t,e):this.Fn.bn(t,i).next((function(o){var a=r.kn(e,o);return(Yr(e)||zr(e))&&r.Mn(e.limitType,a,i,n)?r.On(t,e):(bi()<=s.in.DEBUG&&wi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Zr(e)),r.Fn.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.kn=function(t,e){var n=new Hs($r(t));return e.forEach((function(e,i){i instanceof vr&&Jr(t,i)&&(n=n.add(i))})),n},t.prototype.Mn=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)},t.prototype.On=function(t,e){return bi()<=s.in.DEBUG&&wi("QueryEngine","Using full collection scan to execute query:",Zr(e)),this.Fn.getDocumentsMatchingQuery(t,e,es.min())},t}(),Fh=function(){function t(t,e,n,i){this.persistence=t,this.Ln=e,this.D=i,this.Bn=new Gs(Ri),this.qn=new xh((function(t){return br(t)}),wr),this.Un=es.min(),this.Tn=t.getMutationQueue(n),this.Qn=t.getRemoteDocumentCache(),this.Ge=t.getTargetCache(),this.Kn=new Dh(this.Qn,this.Tn,this.persistence.getIndexManager()),this.He=t.getBundleCache(),this.Ln.$n(this.Kn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Bn)}))},t}();function Bh(t,e,n,i){return new Fh(t,e,n,i)}function Uh(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s;return gi(this,(function(o){switch(o.label){case 0:return n=Ai(t),i=n.Tn,r=n.Kn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var s;return n.Tn.getAllMutationBatches(t).next((function(o){return s=o,i=n.persistence.getMutationQueue(e),r=new Dh(n.Qn,i,n.persistence.getIndexManager()),i.getAllMutationBatches(t)})).next((function(e){for(var n=[],i=[],o=io(),a=0,h=s;a<h.length;a++){var u=h[a];n.push(u.batchId);for(var c=0,l=u.mutations;c<l.length;c++){var f=l[c];o=o.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];i.push(v.batchId);for(var g=0,m=v.mutations;g<m.length;g++){var y=m[g];o=o.add(y.key)}}return r.bn(t,o).next((function(t){return{Wn:t,removedBatchIds:n,addedBatchIds:i}}))}))}))];case 1:return s=o.sent(),[2,(n.Tn=i,n.Kn=r,n.Ln.$n(n.Kn),s)]}}))}))}function Vh(t,e){var n=Ai(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var i=e.batch.keys(),r=n.Qn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){var r=n.batch,s=r.keys(),o=xa.resolve();return s.forEach((function(t){o=o.next((function(){return i.getEntry(e,t)})).next((function(e){var s=e,o=n.docVersions.get(t);Ci(null!==o),(!s||s.version.compareTo(o)<0)&&(s=r.applyToRemoteDocument(t,s,n))&&i.addEntry(s,n.commitVersion)}))})),o.next((function(){return t.Tn.removeMutationBatch(e,r)}))}(n,t,e,r).next((function(){return r.apply(t)})).next((function(){return n.Tn.performConsistencyCheck(t)})).next((function(){return n.Kn.bn(t,i)}))}))}function Yh(t){var e=Ai(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ge.getLastRemoteSnapshotVersion(t)}))}function zh(t,e){var n=Ai(t),i=e.snapshotVersion,r=n.Bn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var s=n.Qn.newChangeBuffer({trackRemovals:!0});r=n.Bn;var o=[];e.targetChanges.forEach((function(e,s){var a=r.get(s);if(a){o.push(n.Ge.removeMatchingKeys(t,e.removedDocuments,s).next((function(){return n.Ge.addMatchingKeys(t,e.addedDocuments,s)})));var h=e.resumeToken;if(h.approximateByteSize()>0){var u=a.withResumeToken(h,i).withSequenceNumber(t.currentSequenceNumber);r=r.insert(s,u),function(t,e,n){return Ci(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,e)&&o.push(n.Ge.updateTargetData(t,u))}}}));var a=Qs();if(e.documentUpdates.forEach((function(i,r){e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(Xh(t,s,e.documentUpdates,i,void 0).next((function(t){a=t}))),!i.isEqual(es.min())){var h=n.Ge.getLastRemoteSnapshotVersion(t).next((function(e){return n.Ge.setTargetsMetadata(t,t.currentSequenceNumber,i)}));o.push(h)}return xa.waitFor(o).next((function(){return s.apply(t)})).next((function(){return n.Kn.vn(t,a)}))})).then((function(t){return n.Bn=r,t}))}function Xh(t,e,n,i,r){var s=io();return n.forEach((function(t){return s=s.add(t)})),e.getEntries(t,s).next((function(t){var s=Qs();return n.forEach((function(n,o){var a=t.get(n),h=(null==r?void 0:r.get(n))||i;o instanceof gr&&o.version.isEqual(es.min())?(e.removeEntry(n,h),s=s.insert(n,o)):null==a||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(o,h),s=s.insert(n,o)):wi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function Gh(t,e){var n=Ai(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Tn.getNextMutationBatchAfterBatchId(t,e)}))}function jh(t,e){var n=Ai(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var i;return n.Ge.getTargetData(t,e).next((function(r){return r?(i=r,xa.resolve(i)):n.Ge.allocateTargetId(t).next((function(r){return i=new Ma(e,r,0,t.currentSequenceNumber),n.Ge.addTargetData(t,i).next((function(){return i}))}))}))})).then((function(t){var i=n.Bn.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Bn=n.Bn.insert(t.targetId,t),n.qn.set(e,t.targetId)),t}))}function Wh(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o;return gi(this,(function(a){switch(a.label){case 0:i=Ai(t),r=i.Bn.get(e),s=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",s,(function(t){return i.persistence.referenceDelegate.removeTarget(t,r)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ea(o=a.sent()))throw o;return wi("LocalStore","Failed to update sequence numbers for target "+e+": "+o),[3,5];case 5:return i.Bn=i.Bn.remove(e),i.qn.delete(r.target),[2]}}))}))}function Hh(t,e,n){var i=Ai(t),r=es.min(),s=io();return i.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var i=Ai(t),r=i.qn.get(n);return void 0!==r?xa.resolve(i.Bn.get(r)):i.Ge.getTargetData(e,n)}(i,t,Hr(e)).next((function(e){if(e)return r=e.lastLimboFreeSnapshotVersion,i.Ge.getMatchingKeysForTargetId(t,e.targetId).next((function(t){s=t}))})).next((function(){return i.Ln.getDocumentsMatchingQuery(t,e,n?r:es.min(),n?s:io())})).next((function(t){return{documents:t,jn:s}}))}))}function qh(t,e){var n=Ai(t),i=Ai(n.Ge),r=n.Bn.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return i.yt(t,e).next((function(t){return t?t.target:null}))}))}function Kh(t){var e=Ai(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var i=Ai(t),r=Qs(),s=Fa(n),o=Eh(e),a=IDBKeyRange.lowerBound(s,!0);return o.qt({index:oa.readTimeIndex,range:a},(function(t,e){var n=La(i.D,e);r=r.insert(n.key,n),s=e.readTime})).next((function(){return{En:r,readTime:Ba(s)}}))}(e.Qn,t,e.Un)})).then((function(t){var n=t.En,i=t.readTime;return e.Un=i,n}))}function Qh(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){return[2,(e=Ai(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Eh(t),n=es.min();return e.qt({index:oa.readTimeIndex,reverse:!0},(function(t,e,i){e.readTime&&(n=Ba(e.readTime)),i.done()})).next((function(){return n}))}(t)})).then((function(t){e.Un=t}))]}))}))}function Zh(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s,o,a,h,u,c,l,f,d;return gi(this,(function(p){switch(p.label){case 0:for(r=Ai(t),s=io(),o=Qs(),a=eo(),h=0,u=n;h<u.length;h++)c=u[h],l=e.Gn(c.metadata.name),c.document&&(s=s.add(l)),o=o.insert(l,e.zn(c)),a=a.insert(l,e.Hn(c.metadata.readTime));return f=r.Qn.newChangeBuffer({trackRemovals:!0}),[4,jh(r,function(t){return Hr(Vr(zi.fromString("__bundle__/docs/"+t)))}(i))];case 1:return d=p.sent(),[2,r.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Xh(t,f,o,es.min(),a).next((function(e){return f.apply(t),e})).next((function(e){return r.Ge.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return r.Ge.addMatchingKeys(t,s,d.targetId)})).next((function(){return r.Kn.vn(t,e)}))}))}))]}}))}))}function Jh(t,e,n){return void 0===n&&(n=io()),vi(this,void 0,void 0,(function(){var i,r;return gi(this,(function(s){switch(s.label){case 0:return[4,jh(t,Hr(Ga(e.bundledQuery)))];case 1:return i=s.sent(),[2,(r=Ai(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var s=_o(e.readTime);if(i.snapshotVersion.compareTo(s)>=0)return r.He.saveNamedQuery(t,e);var o=i.withResumeToken(Wi.EMPTY_BYTE_STRING,s);return r.Bn=r.Bn.insert(o.targetId,o),r.Ge.updateTargetData(t,o).next((function(){return r.Ge.removeMatchingKeysForTargetId(t,i.targetId)})).next((function(){return r.Ge.addMatchingKeys(t,n,i.targetId)})).next((function(){return r.He.saveNamedQuery(t,e)}))}))]}}))}))}var $h=function(){function t(t){this.D=t,this.Jn=new Map,this.Yn=new Map}return t.prototype.getBundleMetadata=function(t,e){return xa.resolve(this.Jn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Jn.set(e.id,{id:(n=e).id,version:n.version,createTime:_o(n.createTime)}),xa.resolve()},t.prototype.getNamedQuery=function(t,e){return xa.resolve(this.Yn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.Yn.set(e.name,function(t){return{name:t.name,query:Ga(t.bundledQuery),readTime:_o(t.readTime)}}(e)),xa.resolve()},t}(),tu=function(){function t(){this.Xn=new Hs(eu.Zn),this.ts=new Hs(eu.es)}return t.prototype.isEmpty=function(){return this.Xn.isEmpty()},t.prototype.addReference=function(t,e){var n=new eu(t,e);this.Xn=this.Xn.add(n),this.ts=this.ts.add(n)},t.prototype.ns=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.ss(new eu(t,e))},t.prototype.rs=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.os=function(t){var e=this,n=new ji(new zi([])),i=new eu(n,t),r=new eu(n,t+1),s=[];return this.ts.forEachInRange([i,r],(function(t){e.ss(t),s.push(t.key)})),s},t.prototype.cs=function(){var t=this;this.Xn.forEach((function(e){return t.ss(e)}))},t.prototype.ss=function(t){this.Xn=this.Xn.delete(t),this.ts=this.ts.delete(t)},t.prototype.us=function(t){var e=new ji(new zi([])),n=new eu(e,t),i=new eu(e,t+1),r=io();return this.ts.forEachInRange([n,i],(function(t){r=r.add(t.key)})),r},t.prototype.containsKey=function(t){var e=new eu(t,0),n=this.Xn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),eu=function(){function t(t,e){this.key=t,this.hs=e}return t.Zn=function(t,e){return ji.comparator(t.key,e.key)||Ri(t.hs,e.hs)},t.es=function(t,e){return Ri(t.hs,e.hs)||ji.comparator(t.key,e.key)},t}(),nu=function(){function t(t,e){this.Gt=t,this.referenceDelegate=e,this.Tn=[],this.ls=1,this.fs=new Hs(eu.Zn)}return t.prototype.checkEmpty=function(t){return xa.resolve(0===this.Tn.length)},t.prototype.addMutationBatch=function(t,e,n,i){var r=this.ls;this.ls++,this.Tn.length>0&&this.Tn[this.Tn.length-1];var s=new Oa(r,e,n,i);this.Tn.push(s);for(var o=0,a=i;o<a.length;o++){var h=a[o];this.fs=this.fs.add(new eu(h.key,r)),this.Gt.addToCollectionParentIndex(t,h.key.path.popLast())}return xa.resolve(s)},t.prototype.lookupMutationBatch=function(t,e){return xa.resolve(this.ds(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,i=this.ws(n),r=i<0?0:i;return xa.resolve(this.Tn.length>r?this.Tn[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return xa.resolve(0===this.Tn.length?-1:this.ls-1)},t.prototype.getAllMutationBatches=function(t){return xa.resolve(this.Tn.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,i=new eu(e,0),r=new eu(e,Number.POSITIVE_INFINITY),s=[];return this.fs.forEachInRange([i,r],(function(t){var e=n.ds(t.hs);s.push(e)})),xa.resolve(s)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,i=new Hs(Ri);return e.forEach((function(t){var e=new eu(t,0),r=new eu(t,Number.POSITIVE_INFINITY);n.fs.forEachInRange([e,r],(function(t){i=i.add(t.hs)}))})),xa.resolve(this._s(i))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,i=n.length+1,r=n;ji.isDocumentKey(r)||(r=r.child(""));var s=new eu(new ji(r),0),o=new Hs(Ri);return this.fs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.hs)),!0)}),s),xa.resolve(this._s(o))},t.prototype._s=function(t){var e=this,n=[];return t.forEach((function(t){var i=e.ds(t);null!==i&&n.push(i)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Ci(0===this.ys(e.batchId,"removed")),this.Tn.shift();var i=this.fs;return xa.forEach(e.mutations,(function(r){var s=new eu(r.key,e.batchId);return i=i.delete(s),n.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((function(){n.fs=i}))},t.prototype.Xt=function(t){},t.prototype.containsKey=function(t,e){var n=new eu(e,0),i=this.fs.firstAfterOrEqual(n);return xa.resolve(e.isEqual(i&&i.key))},t.prototype.performConsistencyCheck=function(t){return this.Tn.length,xa.resolve()},t.prototype.ys=function(t,e){return this.ws(t)},t.prototype.ws=function(t){return 0===this.Tn.length?0:t-this.Tn[0].batchId},t.prototype.ds=function(t){var e=this.ws(t);return e<0||e>=this.Tn.length?null:this.Tn[e]},t}(),iu=function(){function t(t,e){this.Gt=t,this.gs=e,this.docs=new Gs(ji.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.gs(e);return this.docs=this.docs.insert(i,{maybeDocument:e,size:o,readTime:n}),this.size+=o-s,this.Gt.addToCollectionParentIndex(t,i.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return xa.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,i=Zs();return e.forEach((function(t){var e=n.docs.get(t);i=i.insert(t,e?e.maybeDocument:null)})),xa.resolve(i)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var i=$s(),r=new ji(e.path.child("")),s=this.docs.getIteratorFrom(r);s.hasNext();){var o=s.getNext(),a=o.key,h=o.value,u=h.maybeDocument,c=h.readTime;if(!e.path.isPrefixOf(a.path))break;c.compareTo(n)<=0||u instanceof vr&&Jr(e,u)&&(i=i.insert(u.key,u))}return xa.resolve(i)},t.prototype.ps=function(t,e){return xa.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new ru(this)},t.prototype.getSize=function(t){return xa.resolve(this.size)},t}(),ru=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ve=e,n}return pi(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(i,r){r&&r.maybeDocument?n.push(e.Ve.addEntry(t,r.maybeDocument,e.getReadTime(i))):e.Ve.removeEntry(i)})),xa.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ve.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ve.getEntries(t,e)},e}(bh),su=function(){function t(t){this.persistence=t,this.Es=new xh((function(t){return br(t)}),wr),this.lastRemoteSnapshotVersion=es.min(),this.highestTargetId=0,this.Ts=0,this.Is=new tu,this.targetCount=0,this.As=ah.ee()}return t.prototype.forEachTarget=function(t,e){return this.Es.forEach((function(t,n){return e(n)})),xa.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return xa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return xa.resolve(this.Ts)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.As.next(),xa.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ts&&(this.Ts=e),xa.resolve()},t.prototype.re=function(t){this.Es.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.As=new ah(e),this.highestTargetId=e),t.sequenceNumber>this.Ts&&(this.Ts=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.re(e),this.targetCount+=1,xa.resolve()},t.prototype.updateTargetData=function(t,e){return this.re(e),xa.resolve()},t.prototype.removeTargetData=function(t,e){return this.Es.delete(e.target),this.Is.os(e.targetId),this.targetCount-=1,xa.resolve()},t.prototype.removeTargets=function(t,e,n){var i=this,r=0,s=[];return this.Es.forEach((function(o,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i.Es.delete(o),s.push(i.removeMatchingKeysForTargetId(t,a.targetId)),r++)})),xa.waitFor(s).next((function(){return r}))},t.prototype.getTargetCount=function(t){return xa.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.Es.get(e)||null;return xa.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.Is.ns(e,n),xa.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this.Is.rs(e,n);var i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((function(e){r.push(i.markPotentiallyOrphaned(t,e))})),xa.waitFor(r)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.Is.os(e),xa.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.Is.us(e);return xa.resolve(n)},t.prototype.containsKey=function(t,e){return xa.resolve(this.Is.containsKey(e))},t}(),ou=function(){function t(t,e){var n=this;this.Rs={},this.Me=new yi(0),this.Le=!1,this.Le=!0,this.referenceDelegate=t(this),this.Ge=new su(this),this.Gt=new qa,this.ze=function(t,e){return new iu(t,(function(t){return n.referenceDelegate.bs(t)}))}(this.Gt),this.D=new Da(e),this.He=new $h(this.D)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.Le=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Gt},t.prototype.getMutationQueue=function(t){var e=this.Rs[t.toKey()];return e||(e=new nu(this.Gt,this.referenceDelegate),this.Rs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.Ge},t.prototype.getRemoteDocumentCache=function(){return this.ze},t.prototype.getBundleCache=function(){return this.He},t.prototype.runTransaction=function(t,e,n){var i=this;wi("MemoryPersistence","Starting transaction:",t);var r=new au(this.Me.next());return this.referenceDelegate.vs(),n(r).next((function(t){return i.referenceDelegate.Ps(r).next((function(){return t}))})).toPromise().then((function(t){return r.raiseOnCommittedEvent(),t}))},t.prototype.Vs=function(t,e){return xa.or(Object.values(this.Rs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),au=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return pi(e,t),e}(ma),hu=function(){function t(t){this.persistence=t,this.Ss=new tu,this.Ds=null}return t.Cs=function(e){return new t(e)},Object.defineProperty(t.prototype,"xs",{get:function(){if(this.Ds)return this.Ds;throw Si()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.Ss.addReference(n,e),this.xs.delete(n.toString()),xa.resolve()},t.prototype.removeReference=function(t,e,n){return this.Ss.removeReference(n,e),this.xs.add(n.toString()),xa.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.xs.add(e.toString()),xa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Ss.os(e.targetId).forEach((function(t){return n.xs.add(t.toString())}));var i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.xs.add(t.toString())}))})).next((function(){return i.removeTargetData(t,e)}))},t.prototype.vs=function(){this.Ds=new Set},t.prototype.Ps=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xa.forEach(this.xs,(function(i){var r=ji.fromPath(i);return e.Ns(t,r).next((function(t){t||n.removeEntry(r)}))})).next((function(){return e.Ds=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ns(t,e).next((function(t){t?n.xs.delete(e.toString()):n.xs.add(e.toString())}))},t.prototype.bs=function(t){return 0},t.prototype.Ns=function(t,e){var n=this;return xa.or([function(){return xa.resolve(n.Ss.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Vs(t,e)}])},t}(),uu=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function cu(t,e){return"firestore_clients_"+t+"_"+e}function lu(t,e,n){var i="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(i+="_"+e.uid),i}function fu(t,e){return"firestore_targets_"+t+"_"+e}uu.UNAUTHENTICATED=new uu(null),uu.GOOGLE_CREDENTIALS=new uu("google-credentials-uid"),uu.FIRST_PARTY=new uu("first-party-uid");var du=function(){function t(t,e,n,i){this.user=t,this.batchId=e,this.state=n,this.error=i}return t.$s=function(e,n,i){var r,s=JSON.parse(i),o="object"==typeof s&&-1!==["pending","acknowledged","rejected"].indexOf(s.state)&&(void 0===s.error||"object"==typeof s.error);return o&&s.error&&(o="string"==typeof s.error.message&&"string"==typeof s.error.code)&&(r=new Vi(s.error.code,s.error.message)),o?new t(e,n,s.state,r):(_i("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+i),null)},t.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),pu=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.$s=function(e,n){var i,r=JSON.parse(n),s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(i=new Vi(r.error.code,r.error.message)),s?new t(e,r.state,i):(_i("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),vu=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.$s=function(e,n){for(var i=JSON.parse(n),r="object"==typeof i&&i.activeTargetIds instanceof Array,s=so(),o=0;r&&o<i.activeTargetIds.length;++o)r=Bi(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new t(e,s):(_i("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),gu=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.$s=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(_i("SharedClientState","Failed to parse online state: "+e),null)},t}(),mu=function(){function t(){this.activeTargetIds=so()}return t.prototype.Os=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ks=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Fs=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),yu=function(){function t(t,e,n,i,r){this.window=t,this.Fe=e,this.persistenceKey=n,this.Ms=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ls=this.Bs.bind(this),this.qs=new Gs(Ri),this.started=!1,this.Us=[];var s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.Qs=cu(this.persistenceKey,this.Ms),this.Ks=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.qs=this.qs.insert(this.Ms,new mu),this.Ws=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.js=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Gs=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.zs=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Hs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Ls)}return t.At=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return vi(this,void 0,void 0,(function(){var t,e,n,i,r,s,o,a,h,u,c,l=this;return gi(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.gn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(i=n[e])!==this.Ms&&(r=this.getItem(cu(this.persistenceKey,i)))&&(s=vu.$s(i,r))&&(this.qs=this.qs.insert(s.clientId,s));for(this.Js(),(o=this.storage.getItem(this.zs))&&(a=this.Ys(o))&&this.Xs(a),h=0,u=this.Us;h<u.length;h++)c=u[h],this.Bs(c);return this.Us=[],this.window.addEventListener("unload",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ks,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Zs(this.qs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.qs.forEach((function(n,i){i.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.ti(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.ti(t,e,n),this.ei(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(fu(this.persistenceKey,t));if(n){var i=pu.$s(t,n);i&&(e=i.state)}}return this.ni.Os(t),this.Js(),e},t.prototype.removeLocalQueryTarget=function(t){this.ni.ks(t),this.Js()},t.prototype.isLocalQueryTarget=function(t){return this.ni.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(fu(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.si(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var i=this;e.forEach((function(t){i.ei(t)})),this.currentUser=t,n.forEach((function(t){i.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.ii(t)},t.prototype.notifyBundleLoaded=function(){this.ri()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.Ls),this.removeItem(this.Qs),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return wi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){wi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){wi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Bs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(wi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Qs)return void _i("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fe.enqueueRetryable((function(){return vi(e,void 0,void 0,(function(){var t,e,i,r,s,o;return gi(this,(function(a){if(this.started){if(null!==n.key)if(this.Ws.test(n.key)){if(null==n.newValue)return t=this.oi(n.key),[2,this.ci(t,null)];if(e=this.ai(n.key,n.newValue))return[2,this.ci(e.clientId,e)]}else if(this.js.test(n.key)){if(null!==n.newValue&&(i=this.ui(n.key,n.newValue)))return[2,this.hi(i)]}else if(this.Gs.test(n.key)){if(null!==n.newValue&&(r=this.li(n.key,n.newValue)))return[2,this.fi(r)]}else if(n.key===this.zs){if(null!==n.newValue&&(s=this.Ys(n.newValue)))return[2,this.Xs(s)]}else if(n.key===this.Ks)(o=function(t){var e=yi.o;if(null!=t)try{var n=JSON.parse(t);Ci("number"==typeof n),e=n}catch(t){_i("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==yi.o&&this.sequenceNumberHandler(o);else if(n.key===this.Hs)return[2,this.syncEngine.di()]}else this.Us.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"ni",{get:function(){return this.qs.get(this.Ms)},enumerable:!1,configurable:!0}),t.prototype.Js=function(){this.setItem(this.Qs,this.ni.Fs())},t.prototype.ti=function(t,e,n){var i=new du(this.currentUser,t,e,n),r=lu(this.persistenceKey,this.currentUser,t);this.setItem(r,i.Fs())},t.prototype.ei=function(t){var e=lu(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ii=function(t){var e={clientId:this.Ms,onlineState:t};this.storage.setItem(this.zs,JSON.stringify(e))},t.prototype.si=function(t,e,n){var i=fu(this.persistenceKey,t),r=new pu(t,e,n);this.setItem(i,r.Fs())},t.prototype.ri=function(){this.setItem(this.Hs,"value-not-used")},t.prototype.oi=function(t){var e=this.Ws.exec(t);return e?e[1]:null},t.prototype.ai=function(t,e){var n=this.oi(t);return vu.$s(n,e)},t.prototype.ui=function(t,e){var n=this.js.exec(t),i=Number(n[1]),r=void 0!==n[2]?n[2]:null;return du.$s(new uu(r),i,e)},t.prototype.li=function(t,e){var n=this.Gs.exec(t),i=Number(n[1]);return pu.$s(i,e)},t.prototype.Ys=function(t){return gu.$s(t)},t.prototype.hi=function(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.wi(t.batchId,t.state,t.error)]:(wi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.fi=function(t){return this.syncEngine._i(t.targetId,t.state,t.error)},t.prototype.ci=function(t,e){var n=this,i=e?this.qs.insert(t,e):this.qs.remove(t),r=this.Zs(this.qs),s=this.Zs(i),o=[],a=[];return s.forEach((function(t){r.has(t)||o.push(t)})),r.forEach((function(t){s.has(t)||a.push(t)})),this.syncEngine.mi(o,a).then((function(){n.qs=i}))},t.prototype.Xs=function(t){this.qs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Zs=function(t){var e=so();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),xu=function(){function t(){this.yi=new mu,this.gi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.yi.Os(t),this.gi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.gi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.yi.ks(t)},t.prototype.isLocalQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.gi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.yi.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},t.prototype.start=function(){return this.yi=new mu,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),bu=function(){function t(){}return t.prototype.pi=function(t){},t.prototype.shutdown=function(){},t}(),wu=function(){function t(){var t=this;this.Ei=function(){return t.Ti()},this.Ii=function(){return t.Ai()},this.Ri=[],this.bi()}return t.prototype.pi=function(t){this.Ri.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ii)},t.prototype.bi=function(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ii)},t.prototype.Ti=function(){wi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(0)},t.prototype.Ai=function(){wi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(1)},t.At=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),_u={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Tu=function(){function t(t){this.vi=t.vi,this.Pi=t.Pi}return t.prototype.Vi=function(t){this.Si=t},t.prototype.Di=function(t){this.Ci=t},t.prototype.onMessage=function(t){this.xi=t},t.prototype.close=function(){this.Pi()},t.prototype.send=function(t){this.vi(t)},t.prototype.Ni=function(){this.Si()},t.prototype.$i=function(t){this.Ci(t)},t.prototype.Fi=function(t){this.xi(t)},t}(),Eu=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return pi(e,t),e.prototype.qi=function(t,e,n,i){return new Promise((function(r,s){var o=new fi;o.listenOnce(ai.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case oi.NO_ERROR:var e=o.getResponseJson();wi("Connection","XHR received:",JSON.stringify(e)),r(e);break;case oi.TIMEOUT:wi("Connection",'RPC "'+t+'" timed out'),s(new Vi(Ui.DEADLINE_EXCEEDED,"Request time out"));break;case oi.HTTP_ERROR:var n=o.getStatus();if(wi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var i=o.getResponseJson().error;if(i&&i.status&&i.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ui).indexOf(e)>=0?e:Ui.UNKNOWN}(i.status);s(new Vi(a,i.message))}else s(new Vi(Ui.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Vi(Ui.UNAVAILABLE,"Connection failed."));break;default:Si()}}finally{wi("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))},e.prototype.Qi=function(t,e){var n=[this.Oi,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new ei,r=ne(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Bi(s.initMessageHeaders,e),(0,o.uI)()||(0,o.b$)()||(0,o.d)()||(0,o.w1)()||(0,o.Mn)()||(0,o.ru)()||(s.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");wi("Connection","Creating WebChannel: "+a,s);var h=i.createWebChannel(a,s),u=!1,c=!1,l=new Tu({vi:function(t){c?wi("Connection","Not sending because WebChannel is closed:",t):(u||(wi("Connection","Opening WebChannel transport."),h.open(),u=!0),wi("Connection","WebChannel sending:",t),h.send(t))},Pi:function(){return h.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(h,li.EventType.OPEN,(function(){c||wi("Connection","WebChannel transport opened.")})),f(h,li.EventType.CLOSE,(function(){c||(c=!0,wi("Connection","WebChannel transport closed"),l.$i())})),f(h,li.EventType.ERROR,(function(t){c||(c=!0,Ti("Connection","WebChannel transport errored:",t),l.$i(new Vi(Ui.UNAVAILABLE,"The operation could not be completed")))})),f(h,li.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];Ci(!!n);var i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){wi("Connection","WebChannel received error:",r);var s=r.status,o=function(t){var e=Fs[t];if(void 0!==e)return Xs(e)}(s),a=r.message;void 0===o&&(o=Ui.INTERNAL,a="Unknown error status: "+s+" with message "+r.message),c=!0,l.$i(new Vi(o,a)),h.close()}else wi("Connection","WebChannel received:",n),l.Fi(n)}})),f(r,hi.STAT_EVENT,(function(t){t.stat===ui?wi("Connection","Detected buffering proxy"):t.stat===ci&&wi("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Ni()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Oi=e+"://"+t.host,this.ki="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Mi=function(t,e,n,i){var r=this.Li(t,e);wi("RestConnection","Sending: ",r,n);var s={};return this.Bi(s,i),this.qi(t,r,s,n).then((function(t){return wi("RestConnection","Received: ",t),t}),(function(e){throw Ti("RestConnection",t+" failed with error: ",e,"url: ",r,"request:",n),e}))},t.prototype.Ui=function(t,e,n,i){return this.Mi(t,e,n,i)},t.prototype.Bi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.1",t["Content-Type"]="text/plain",e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.Li=function(t,e){var n=_u[t];return this.Oi+"/v1/"+e+":"+n},t}());function Su(){return"undefined"!=typeof window?window:null}function Cu(){return"undefined"!=typeof document?document:null}function Au(t){return new yo(t,!0)}var Iu=function(){function t(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Fe=t,this.timerId=e,this.Ki=n,this.Wi=i,this.ji=r,this.Gi=0,this.zi=null,this.Hi=Date.now(),this.reset()}return t.prototype.reset=function(){this.Gi=0},t.prototype.Ji=function(){this.Gi=this.ji},t.prototype.Yi=function(t){var e=this;this.cancel();var n=Math.floor(this.Gi+this.Xi()),i=Math.max(0,Date.now()-this.Hi),r=Math.max(0,n-i);r>0&&wi("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.Gi+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.zi=this.Fe.enqueueAfterDelay(this.timerId,r,(function(){return e.Hi=Date.now(),t()})),this.Gi*=this.Wi,this.Gi<this.Ki&&(this.Gi=this.Ki),this.Gi>this.ji&&(this.Gi=this.ji)},t.prototype.Zi=function(){null!==this.zi&&(this.zi.skipDelay(),this.zi=null)},t.prototype.cancel=function(){null!==this.zi&&(this.zi.cancel(),this.zi=null)},t.prototype.Xi=function(){return(Math.random()-.5)*this.Gi},t}(),Pu=function(){function t(t,e,n,i,r,s){this.Fe=t,this.tr=n,this.er=i,this.nr=r,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Iu(t,e)}return t.prototype.cr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.ar=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.ur()},t.prototype.stop=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return this.cr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.hr=function(){this.state=0,this.rr.reset()},t.prototype.lr=function(){var t=this;this.ar()&&null===this.ir&&(this.ir=this.Fe.enqueueAfterDelay(this.tr,6e4,(function(){return t.dr()})))},t.prototype.wr=function(t){this._r(),this.stream.send(t)},t.prototype.dr=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){return this.ar()?[2,this.close(0)]:[2]}))}))},t.prototype._r=function(){this.ir&&(this.ir.cancel(),this.ir=null)},t.prototype.close=function(t,e){return vi(this,void 0,void 0,(function(){return gi(this,(function(n){switch(n.label){case 0:return this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===Ui.RESOURCE_EXHAUSTED?(_i(e.toString()),_i("Using maximum backoff delay to prevent overloading the backend."),this.rr.Ji()):e&&e.code===Ui.UNAUTHENTICATED&&this.nr.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Di(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.mr=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.yr(this.sr),n=this.sr;this.nr.getToken().then((function(e){t.sr===n&&t.gr(e)}),(function(n){e((function(){var e=new Vi(Ui.UNKNOWN,"Fetching auth token failed: "+n.message);return t.pr(e)}))}))},t.prototype.gr=function(t){var e=this,n=this.yr(this.sr);this.stream=this.Er(t),this.stream.Vi((function(){n((function(){return e.state=2,e.listener.Vi()}))})),this.stream.Di((function(t){n((function(){return e.pr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.ur=function(){var t=this;this.state=4,this.rr.Yi((function(){return vi(t,void 0,void 0,(function(){return gi(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.pr=function(t){return wi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.yr=function(t){var e=this;return function(n){e.Fe.enqueueAndForget((function(){return e.sr===t?n():(wi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Ru=function(t){function e(e,n,i,r,s){var o=this;return(o=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,i,s)||this).D=r,o}return pi(e,t),e.prototype.Er=function(t){return this.er.Qi("Listen",t)},e.prototype.onMessage=function(t){this.rr.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Si()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.V?(Ci(void 0===e||"string"==typeof e),Wi.fromBase64String(e||"")):(Ci(void 0===e||e instanceof Uint8Array),Wi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Ui.UNKNOWN:Xs(t.code);return new Vi(e,t.message||"")}(a);n=new co(i,r,s,o||null)}else if("documentChange"in e){e.documentChange,(i=e.documentChange).document,i.document.name,i.document.updateTime,r=Co(t,i.document.name),s=_o(i.document.updateTime);var a=new is({mapValue:{fields:i.document.fields}}),h=(o=new vr(r,s,a,{}),i.targetIds||[]),u=i.removedTargetIds||[];n=new ho(h,u,o.key,o)}else if("documentDelete"in e)e.documentDelete,(i=e.documentDelete).document,r=Co(t,i.document),s=i.readTime?_o(i.readTime):es.min(),a=new gr(r,s),o=i.removedTargetIds||[],n=new ho([],o,a.key,a);else if("documentRemove"in e)e.documentRemove,(i=e.documentRemove).document,r=Co(t,i.document),s=i.removedTargetIds||[],n=new ho([],s,r,null);else{if(!("filter"in e))return Si();e.filter;var c=e.filter;c.targetId,i=c.count||0,r=new Ys(i),s=c.targetId,n=new uo(s,r)}return n}(this.D,t),n=function(t){if(!("targetChange"in t))return es.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?es.min():e.readTime?_o(e.readTime):es.min()}(t);return this.listener.Tr(e,n)},e.prototype.Ir=function(t){var e={};e.database=Po(this.D),e.addTarget=function(t,e){var n,i=e.target;return(n=_r(i)?{documents:Lo(t,i)}:{query:No(t,i)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=bo(t,e.resumeToken):e.snapshotVersion.compareTo(es.min())>0&&(n.readTime=xo(t,e.snapshotVersion.toTimestamp())),n}(this.D,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Si()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.D,t);n&&(e.labels=n),this.wr(e)},e.prototype.Ar=function(t){var e={};e.database=Po(this.D),e.removeTarget=t,this.wr(e)},e}(Pu),Ou=function(t){function e(e,n,i,r,s){var o=this;return(o=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,i,s)||this).D=r,o.Rr=!1,o}return pi(e,t),Object.defineProperty(e.prototype,"br",{get:function(){return this.Rr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Rr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.mr=function(){this.Rr&&this.vr([])},e.prototype.Er=function(t){return this.er.Qi("Write",t)},e.prototype.onMessage=function(t){if(Ci(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();var e=function(t,e){return t&&t.length>0?(Ci(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?_o(t.updateTime):_o(e);return n.isEqual(es.min())&&(n=_o(e)),new _s(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=_o(t.commitTime);return this.listener.Pr(n,e)}return Ci(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()},e.prototype.Sr=function(){var t={};t.database=Po(this.D),this.wr(t)},e.prototype.vr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Mo(e.D,t)}))};this.wr(n)},e}(Pu),ku=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).credentials=e,r.er=n,r.D=i,r.Dr=!1,r}return pi(e,t),e.prototype.Cr=function(){if(this.Dr)throw new Vi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mi=function(t,e,n){var i=this;return this.Cr(),this.credentials.getToken().then((function(r){return i.er.Mi(t,e,n,r)})).catch((function(t){throw t.code===Ui.UNAUTHENTICATED&&i.credentials.invalidateToken(),t}))},e.prototype.Ui=function(t,e,n){var i=this;return this.Cr(),this.credentials.getToken().then((function(r){return i.er.Ui(t,e,n,r)})).catch((function(t){throw t.code===Ui.UNAUTHENTICATED&&i.credentials.invalidateToken(),t}))},e.prototype.terminate=function(){this.Dr=!1},e}((function(){})),Mu=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.$r=null,this.Fr=!0}return t.prototype.Or=function(){var t=this;0===this.Nr&&(this.kr("Unknown"),this.$r=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.$r=null,t.Mr("Backend didn't respond within 10 seconds."),t.kr("Offline"),Promise.resolve()})))},t.prototype.Lr=function(t){"Online"===this.state?this.kr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr("Connection failed 1 times. Most recent error: "+t.toString()),this.kr("Offline")))},t.prototype.set=function(t){this.Br(),this.Nr=0,"Online"===t&&(this.Fr=!1),this.kr(t)},t.prototype.kr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Mr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fr?(_i(e),this.Fr=!1):wi("OnlineStateTracker",e)},t.prototype.Br=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},t}(),Du=function(t,e,n,i,r){var s=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.qr=[],this.Ur=new Map,this.Qr=new Set,this.Kr=[],this.Wr=r,this.Wr.pi((function(t){n.enqueueAndForget((function(){return vi(s,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return Xu(this)?(wi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return(e=Ai(t)).Qr.add(4),[4,Nu(e)];case 1:return n.sent(),e.jr.set("Unknown"),e.Qr.delete(4),[4,Lu(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.jr=new Mu(n,i)};function Lu(t){return vi(this,void 0,void 0,(function(){var e,n;return gi(this,(function(i){switch(i.label){case 0:if(!Xu(t))return[3,4];e=0,n=t.Kr,i.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Nu(t){return vi(this,void 0,void 0,(function(){var e,n;return gi(this,(function(i){switch(i.label){case 0:e=0,n=t.Kr,i.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Fu(t,e){var n=Ai(t);n.Ur.has(e.targetId)||(n.Ur.set(e.targetId,e),zu(n)?Yu(n):rc(n).ar()&&Uu(n,e))}function Bu(t,e){var n=Ai(t),i=rc(n);n.Ur.delete(e),i.ar()&&Vu(n,e),0===n.Ur.size&&(i.ar()?i.lr():Xu(n)&&n.jr.set("Unknown"))}function Uu(t,e){t.Gr.H(e.targetId),rc(t).Ir(e)}function Vu(t,e){t.Gr.H(e),rc(t).Ar(e)}function Yu(t){t.Gr=new fo({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},yt:function(e){return t.Ur.get(e)||null}}),rc(t).start(),t.jr.Or()}function zu(t){return Xu(t)&&!rc(t).cr()&&t.Ur.size>0}function Xu(t){return 0===Ai(t).Qr.size}function Gu(t){t.Gr=void 0}function ju(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){return t.Ur.forEach((function(e,n){Uu(t,e)})),[2]}))}))}function Wu(t,e){return vi(this,void 0,void 0,(function(){return gi(this,(function(n){return Gu(t),zu(t)?(t.jr.Lr(e),Yu(t)):t.jr.set("Unknown"),[2]}))}))}function Hu(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s;return gi(this,(function(o){switch(o.label){case 0:if(t.jr.set("Online"),!(e instanceof co&&2===e.state&&e.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,function(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s;return gi(this,(function(o){switch(o.label){case 0:n=e.cause,i=0,r=e.targetIds,o.label=1;case 1:return i<r.length?(s=r[i],t.Ur.has(s)?[4,t.remoteSyncer.rejectListen(s,n)]:[3,3]):[3,5];case 2:o.sent(),t.Ur.delete(s),t.Gr.removeTarget(s),o.label=3;case 3:o.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return o.sent(),[3,5];case 3:return i=o.sent(),wi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),[4,qu(t,i)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ho?t.Gr.st(e):e instanceof uo?t.Gr.ht(e):t.Gr.ot(e),n.isEqual(es.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,Yh(t.localStore)];case 8:return r=o.sent(),n.compareTo(r)>=0?[4,function(t,e){var n=t.Gr.dt(e);return n.targetChanges.forEach((function(n,i){if(n.resumeToken.approximateByteSize()>0){var r=t.Ur.get(i);r&&t.Ur.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Ur.get(e);if(n){t.Ur.set(e,n.withResumeToken(Wi.EMPTY_BYTE_STRING,n.snapshotVersion)),Vu(t,e);var i=new Ma(n.target,e,1,n.sequenceNumber);Uu(t,i)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return wi("RemoteStore","Failed to raise snapshot:",s=o.sent()),[4,qu(t,s)];case 12:return o.sent(),[3,13];case 13:return[2]}}))}))}function qu(t,e,n){return vi(this,void 0,void 0,(function(){var i=this;return gi(this,(function(r){switch(r.label){case 0:if(!Ea(e))throw e;return t.Qr.add(1),[4,Nu(t)];case 1:return r.sent(),t.jr.set("Offline"),n||(n=function(){return Yh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return vi(i,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return wi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Qr.delete(1),[4,Lu(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Ku(t,e){return e().catch((function(n){return qu(t,n,e)}))}function Qu(t){return vi(this,void 0,void 0,(function(){var e,n,i,r,s;return gi(this,(function(o){switch(o.label){case 0:e=Ai(t),n=sc(e),i=e.qr.length>0?e.qr[e.qr.length-1].batchId:-1,o.label=1;case 1:if(!function(t){return Xu(t)&&t.qr.length<10}(e))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,Gh(e.localStore,i)];case 3:return null===(r=o.sent())?(0===e.qr.length&&n.lr(),[3,7]):(i=r.batchId,function(t,e){t.qr.push(e);var n=sc(t);n.ar()&&n.br&&n.vr(e.mutations)}(e,r),[3,6]);case 4:return s=o.sent(),[4,qu(e,s)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return Zu(e)&&Ju(e),[2]}}))}))}function Zu(t){return Xu(t)&&!sc(t).cr()&&t.qr.length>0}function Ju(t){sc(t).start()}function $u(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){return sc(t).Sr(),[2]}))}))}function tc(t){return vi(this,void 0,void 0,(function(){var e,n,i,r;return gi(this,(function(s){for(e=sc(t),n=0,i=t.qr;n<i.length;n++)r=i[n],e.vr(r.mutations);return[2]}))}))}function ec(t,e,n){return vi(this,void 0,void 0,(function(){var i,r;return gi(this,(function(s){switch(s.label){case 0:return i=t.qr.shift(),r=ka.from(i,e,n),[4,Ku(t,(function(){return t.remoteSyncer.applySuccessfulWrite(r)}))];case 1:return s.sent(),[4,Qu(t)];case 2:return s.sent(),[2]}}))}))}function nc(t,e){return vi(this,void 0,void 0,(function(){return gi(this,(function(n){switch(n.label){case 0:return e&&sc(t).br?[4,function(t,e){return vi(this,void 0,void 0,(function(){var n,i;return gi(this,(function(r){switch(r.label){case 0:return zs(i=e.code)&&i!==Ui.ABORTED?(n=t.qr.shift(),sc(t).hr(),[4,Ku(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return r.sent(),[4,Qu(t)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Zu(t)&&Ju(t),[2]}}))}))}function ic(t,e){return vi(this,void 0,void 0,(function(){var n;return gi(this,(function(i){switch(i.label){case 0:return n=Ai(t),e?(n.Qr.delete(2),[4,Lu(n)]):[3,2];case 1:return i.sent(),[3,5];case 2:return e?[3,4]:(n.Qr.add(2),[4,Nu(n)]);case 3:i.sent(),n.jr.set("Unknown"),i.label=4;case 4:i.label=5;case 5:return[2]}}))}))}function rc(t){var e=this;return t.zr||(t.zr=function(t,e,n){var i=Ai(t);return i.Cr(),new Ru(e,i.er,i.credentials,i.D,n)}(t.datastore,t.asyncQueue,{Vi:ju.bind(null,t),Di:Wu.bind(null,t),Tr:Hu.bind(null,t)}),t.Kr.push((function(n){return vi(e,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return n?(t.zr.hr(),zu(t)?Yu(t):t.jr.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.zr.stop()];case 2:e.sent(),Gu(t),e.label=3;case 3:return[2]}}))}))}))),t.zr}function sc(t){var e=this;return t.Hr||(t.Hr=function(t,e,n){var i=Ai(t);return i.Cr(),new Ou(e,i.er,i.credentials,i.D,n)}(t.datastore,t.asyncQueue,{Vi:$u.bind(null,t),Di:nc.bind(null,t),Vr:tc.bind(null,t),Pr:ec.bind(null,t)}),t.Kr.push((function(n){return vi(e,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return n?(t.Hr.hr(),[4,Qu(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Hr.stop()];case 3:e.sent(),t.qr.length>0&&(wi("RemoteStore","Stopping write stream with "+t.qr.length+" pending writes"),t.qr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Hr}var oc=function(){function t(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,i,r,s){var o=new t(e,n,Date.now()+i,r,s);return o.start(i),o},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vi(Ui.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function ac(t,e){if(_i("AsyncQueue",e+": "+t),Ea(t))return new Vi(Ui.UNAVAILABLE,e+": "+t);throw t}var hc=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ji.comparator(e.key,n.key)}:function(t,e){return ji.comparator(t.key,e.key)},this.keyedMap=$s(),this.sortedSet=new Gs(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();n.hasNext();){var r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var i=new t;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i},t}(),uc=function(){function t(){this.Jr=new Gs(ji.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Jr.get(e);n?0!==t.type&&3===n.type?this.Jr=this.Jr.insert(e,t):3===t.type&&1!==n.type?this.Jr=this.Jr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Jr=this.Jr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Jr=this.Jr.remove(e):1===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):Si():this.Jr=this.Jr.insert(e,t)},t.prototype.Yr=function(){var t=[];return this.Jr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),cc=function(){function t(t,e,n,i,r,s,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,i,r){var s=[];return n.forEach((function(t){s.push({type:0,doc:t})})),new t(e,n,hc.emptySet(n),s,i,r,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Kr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},t}(),lc=function(){this.Xr=void 0,this.listeners=[]},fc=function(){this.queries=new xh((function(t){return Qr(t)}),Kr),this.onlineState="Unknown",this.Zr=new Set};function dc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a,h;return gi(this,(function(u){switch(u.label){case 0:if(n=Ai(t),i=e.query,r=!1,(s=n.queries.get(i))||(r=!0,s=new lc),!r)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),o=s,[4,n.onListen(i)];case 2:return o.Xr=u.sent(),[3,4];case 3:return a=u.sent(),h=ac(a,"Initialization of query '"+Zr(e.query)+"' failed"),[2,void e.onError(h)];case 4:return n.queries.set(i,s),s.listeners.push(e),e.eo(n.onlineState),s.Xr&&e.no(s.Xr)&&mc(n),[2]}}))}))}function pc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o;return gi(this,(function(a){return n=Ai(t),i=e.query,r=!1,(s=n.queries.get(i))&&(o=s.listeners.indexOf(e))>=0&&(s.listeners.splice(o,1),r=0===s.listeners.length),r?[2,(n.queries.delete(i),n.onUnlisten(i))]:[2]}))}))}function vc(t,e){for(var n=Ai(t),i=!1,r=0,s=e;r<s.length;r++){var o=s[r],a=o.query,h=n.queries.get(a);if(h){for(var u=0,c=h.listeners;u<c.length;u++)c[u].no(o)&&(i=!0);h.Xr=o}}i&&mc(n)}function gc(t,e,n){var i=Ai(t),r=i.queries.get(e);if(r)for(var s=0,o=r.listeners;s<o.length;s++)o[s].onError(n);i.queries.delete(e)}function mc(t){t.Zr.forEach((function(t){t.next()}))}var yc=function(){function t(t,e,n){this.query=t,this.so=e,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.no=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new cc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var s=!1;return this.io?this.oo(t)&&(this.so.next(t),s=!0):this.co(t,this.onlineState)&&(this.ao(t),s=!0),this.ro=t,s},t.prototype.onError=function(t){this.so.error(t)},t.prototype.eo=function(t){this.onlineState=t;var e=!1;return this.ro&&!this.io&&this.co(this.ro,t)&&(this.ao(this.ro),e=!0),e},t.prototype.co=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.uo&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.oo=function(t){if(t.docChanges.length>0)return!0;var e=this.ro&&this.ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.ao=function(t){t=cc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.io=!0,this.so.next(t)},t}(),xc=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.ho=function(){return"metadata"in this.payload},t}(),bc=function(){function t(t){this.D=t}return t.prototype.Gn=function(t){return Co(this.D,t)},t.prototype.zn=function(t){return t.metadata.exists?ko(this.D,t.document,!1):new gr(this.Gn(t.metadata.name),this.Hn(t.metadata.readTime))},t.prototype.Hn=function(t){return _o(t)},t}(),wc=function(){function t(t,e,n){this.lo=t,this.localStore=e,this.D=n,this.queries=[],this.documents=[],this.progress=_c(t)}return t.prototype.fo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.wo=function(t){for(var e=new Map,n=new bc(this.D),i=0,r=t;i<r.length;i++){var s=r[i];if(s.metadata.queries)for(var o=n.Gn(s.metadata.name),a=0,h=s.metadata.queries;a<h.length;a++){var u=h[a],c=(e.get(u)||io()).add(o);e.set(u,c)}}return e},t.prototype.complete=function(){return vi(this,void 0,void 0,(function(){var t,e,n,i,r;return gi(this,(function(s){switch(s.label){case 0:return[4,Zh(this.localStore,new bc(this.D),this.documents,this.lo.id)];case 1:t=s.sent(),e=this.wo(this.documents),n=0,i=this.queries,s.label=2;case 2:return n<i.length?(r=i[n],[4,Jh(this.localStore,r,e.get(r.name))]):[3,5];case 3:s.sent(),s.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Mh(Object.assign({},this.progress),t))]}}))}))},t}();function _c(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Tc=function(t){this.key=t},Ec=function(t){this.key=t},Sc=function(){function t(t,e){this.query=t,this._o=e,this.mo=null,this.current=!1,this.yo=io(),this.mutatedKeys=io(),this.po=$r(t),this.Eo=new hc(this.po)}return Object.defineProperty(t.prototype,"To",{get:function(){return this._o},enumerable:!1,configurable:!0}),t.prototype.Io=function(t,e){var n=this,i=e?e.Ao:new uc,r=e?e.Eo:this.Eo,s=e?e.mutatedKeys:this.mutatedKeys,o=r,a=!1,h=Yr(this.query)&&r.size===this.query.limit?r.last():null,u=zr(this.query)&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((function(t,e){var c=r.get(t),l=e instanceof vr?e:null;l&&(l=Jr(n.query,l)?l:null);var f=!!c&&n.mutatedKeys.has(c.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;c&&l?c.data().isEqual(l.data())?f!==d&&(i.track({type:3,doc:l}),p=!0):n.Ro(c,l)||(i.track({type:2,doc:l}),p=!0,(h&&n.po(l,h)>0||u&&n.po(l,u)<0)&&(a=!0)):!c&&l?(i.track({type:0,doc:l}),p=!0):c&&!l&&(i.track({type:1,doc:c}),p=!0,(h||u)&&(a=!0)),p&&(l?(o=o.add(l),s=d?s.add(t):s.delete(t)):(o=o.delete(t),s=s.delete(t)))})),Yr(this.query)||zr(this.query))for(;o.size>this.query.limit;){var c=Yr(this.query)?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),i.track({type:1,doc:c})}return{Eo:o,Ao:i,Mn:a,mutatedKeys:s}},t.prototype.Ro=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var i=this,r=this.Eo;this.Eo=t.Eo,this.mutatedKeys=t.mutatedKeys;var s=t.Ao.Yr();s.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Si()}};return n(t)-n(e)}(t.type,e.type)||i.po(t.doc,e.doc)})),this.bo(n);var o=e?this.vo():[],a=0===this.yo.size&&this.current?1:0,h=a!==this.mo;return this.mo=a,0!==s.length||h?{snapshot:new cc(this.query,t.Eo,r,s,t.mutatedKeys,0===a,h,!1),Po:o}:{Po:o}},t.prototype.eo=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new uc,mutatedKeys:this.mutatedKeys,Mn:!1},!1)):{Po:[]}},t.prototype.Vo=function(t){return!this._o.has(t)&&!!this.Eo.has(t)&&!this.Eo.get(t).hasLocalMutations},t.prototype.bo=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._o=e._o.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e._o=e._o.delete(t)})),this.current=t.current)},t.prototype.vo=function(){var t=this;if(!this.current)return[];var e=this.yo;this.yo=io(),this.Eo.forEach((function(e){t.Vo(e.key)&&(t.yo=t.yo.add(e.key))}));var n=[];return e.forEach((function(e){t.yo.has(e)||n.push(new Ec(e))})),this.yo.forEach((function(t){e.has(t)||n.push(new Tc(t))})),n},t.prototype.So=function(t){this._o=t.jn,this.yo=io();var e=this.Io(t.documents);return this.applyChanges(e,!0)},t.prototype.Do=function(){return cc.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)},t}(),Cc=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ac=function(t){this.key=t,this.Co=!1},Ic=function(){function t(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.xo={},this.No=new xh((function(t){return Qr(t)}),Kr),this.$o=new Map,this.Fo=new Set,this.Oo=new Gs(ji.comparator),this.ko=new Map,this.Mo=new tu,this.Lo={},this.Bo=new Map,this.qo=ah.ne(),this.onlineState="Unknown",this.Uo=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.Uo},enumerable:!1,configurable:!0}),t}();function Pc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a;return gi(this,(function(h){switch(h.label){case 0:return n=rl(t),(s=n.No.get(e))?(i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Do(),[3,4]):[3,1];case 1:return[4,jh(n.localStore,Hr(e))];case 2:return o=h.sent(),a=n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.targetId,[4,Rc(n,e,i,"current"===a)];case 3:r=h.sent(),n.isPrimaryClient&&Fu(n.remoteStore,o),h.label=4;case 4:return[2,r]}}))}))}function Rc(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s,o,a,h,u;return gi(this,(function(c){switch(c.label){case 0:return t.Qo=function(e,n,i){return function(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s,o;return gi(this,(function(a){switch(a.label){case 0:return(r=e.view.Io(n)).Mn?[4,Hh(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view.Io(n,r)}))]:[3,2];case 1:r=a.sent(),a.label=2;case 2:return s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s),[2,(Xc(t,e.targetId,o.Po),o.snapshot)]}}))}))}(t,e,n,i)},[4,Hh(t.localStore,e,!0)];case 1:return r=c.sent(),s=new Sc(e,r.jn),o=s.Io(r.documents),a=ao.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState),h=s.applyChanges(o,t.isPrimaryClient,a),Xc(t,n,h.Po),u=new Cc(e,n,s),[2,(t.No.set(e,u),t.$o.has(n)?t.$o.get(n).push(e):t.$o.set(n,[e]),h.snapshot)]}}))}))}function Oc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r;return gi(this,(function(s){switch(s.label){case 0:return n=Ai(t),i=n.No.get(e),(r=n.$o.get(i.targetId)).length>1?[2,(n.$o.set(i.targetId,r.filter((function(t){return!Kr(t,e)}))),void n.No.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)?[3,2]:[4,Wh(n.localStore,i.targetId,!1).then((function(){n.sharedClientState.clearQueryState(i.targetId),Bu(n.remoteStore,i.targetId),Yc(n,i.targetId)})).catch(fh)]):[3,3];case 1:s.sent(),s.label=2;case 2:return[3,5];case 3:return Yc(n,i.targetId),[4,Wh(n.localStore,i.targetId,!0)];case 4:s.sent(),s.label=5;case 5:return[2]}}))}))}function kc(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o;return gi(this,(function(a){switch(a.label){case 0:i=sl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,i=Ai(t),r=Zi.now(),s=e.reduce((function(t,e){return t.add(e.key)}),io());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return i.Kn.bn(t,s).next((function(s){n=s;for(var o=[],a=0,h=e;a<h.length;a++){var u=h[a],c=Is(u,n.get(u.key));null!=c&&o.push(new ks(u.key,c,ss(c.proto.mapValue),Ts.exists(!0)))}return i.Tn.addMutationBatch(t,r,o,e)}))})).then((function(t){var e=t.applyToLocalDocumentSet(n);return{batchId:t.batchId,changes:e}}))}(i.localStore,e)];case 2:return r=a.sent(),i.sharedClientState.addPendingMutation(r.batchId),function(t,e,n){var i=t.Lo[t.currentUser.toKey()];i||(i=new Gs(Ri)),i=i.insert(e,n),t.Lo[t.currentUser.toKey()]=i}(i,r.batchId,n),[4,Wc(i,r.changes)];case 3:return a.sent(),[4,Qu(i.remoteStore)];case 4:return a.sent(),[3,6];case 5:return s=a.sent(),o=ac(s,"Failed to persist write"),n.reject(o),[3,6];case 6:return[2]}}))}))}function Mc(t,e){return vi(this,void 0,void 0,(function(){var n,i;return gi(this,(function(r){switch(r.label){case 0:n=Ai(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,zh(n.localStore,e)];case 2:return i=r.sent(),e.targetChanges.forEach((function(t,e){var i=n.ko.get(e);i&&(Ci(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.Co=!0:t.modifiedDocuments.size>0?Ci(i.Co):t.removedDocuments.size>0&&(Ci(i.Co),i.Co=!1))})),[4,Wc(n,i,e)];case 3:return r.sent(),[3,6];case 4:return[4,fh(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Dc(t,e,n){var i=Ai(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){var r=[];i.No.forEach((function(t,n){var i=n.view.eo(e);i.snapshot&&r.push(i.snapshot)})),function(t,e){var n=Ai(t);n.onlineState=e;var i=!1;n.queries.forEach((function(t,n){for(var r=0,s=n.listeners;r<s.length;r++)s[r].eo(e)&&(i=!0)})),i&&mc(n)}(i.eventManager,e),r.length&&i.xo.Tr(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Lc(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o,a,h;return gi(this,(function(u){switch(u.label){case 0:return(i=Ai(t)).sharedClientState.updateQueryState(e,"rejected",n),r=i.ko.get(e),(s=r&&r.key)?(o=(o=new Gs(ji.comparator)).insert(s,new gr(s,es.min())),a=io().add(s),h=new oo(es.min(),new Map,new Hs(Ri),o,a),[4,Mc(i,h)]):[3,2];case 1:return u.sent(),i.Oo=i.Oo.remove(s),i.ko.delete(e),jc(i),[3,4];case 2:return[4,Wh(i.localStore,e,!1).then((function(){return Yc(i,e,n)})).catch(fh)];case 3:u.sent(),u.label=4;case 4:return[2]}}))}))}function Nc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r;return gi(this,(function(s){switch(s.label){case 0:n=Ai(t),i=e.batch.batchId,s.label=1;case 1:return s.trys.push([1,4,,6]),[4,Vh(n.localStore,e)];case 2:return r=s.sent(),Vc(n,i,null),Uc(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),[4,Wc(n,r)];case 3:return s.sent(),[3,6];case 4:return[4,fh(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}}))}))}function Fc(t,e,n){return vi(this,void 0,void 0,(function(){var i,r;return gi(this,(function(s){switch(s.label){case 0:i=Ai(t),s.label=1;case 1:return s.trys.push([1,4,,6]),[4,function(t,e){var n=Ai(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var i;return n.Tn.lookupMutationBatch(t,e).next((function(e){return Ci(null!==e),i=e.keys(),n.Tn.removeMutationBatch(t,e)})).next((function(){return n.Tn.performConsistencyCheck(t)})).next((function(){return n.Kn.bn(t,i)}))}))}(i.localStore,e)];case 2:return r=s.sent(),Vc(i,e,n),Uc(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),[4,Wc(i,r)];case 3:return s.sent(),[3,6];case 4:return[4,fh(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}}))}))}function Bc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o;return gi(this,(function(a){switch(a.label){case 0:Xu((n=Ai(t)).remoteStore)||wi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Ai(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Tn.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(i=a.sent())?[2,void e.resolve()]:((r=n.Bo.get(i)||[]).push(e),n.Bo.set(i,r),[3,4]);case 3:return s=a.sent(),o=ac(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(o),[3,4];case 4:return[2]}}))}))}function Uc(t,e){(t.Bo.get(e)||[]).forEach((function(t){t.resolve()})),t.Bo.delete(e)}function Vc(t,e,n){var i=Ai(t),r=i.Lo[i.currentUser.toKey()];if(r){var s=r.get(e);s&&(n?s.reject(n):s.resolve(),r=r.remove(e)),i.Lo[i.currentUser.toKey()]=r}}function Yc(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var i=0,r=t.$o.get(e);i<r.length;i++){var s=r[i];t.No.delete(s),n&&t.xo.Ko(s,n)}t.$o.delete(e),t.isPrimaryClient&&t.Mo.os(e).forEach((function(e){t.Mo.containsKey(e)||zc(t,e)}))}function zc(t,e){t.Fo.delete(e.path.canonicalString());var n=t.Oo.get(e);null!==n&&(Bu(t.remoteStore,n),t.Oo=t.Oo.remove(e),t.ko.delete(n),jc(t))}function Xc(t,e,n){for(var i=0,r=n;i<r.length;i++){var s=r[i];s instanceof Tc?(t.Mo.addReference(s.key,e),Gc(t,s)):s instanceof Ec?(wi("SyncEngine","Document no longer in limbo: "+s.key),t.Mo.removeReference(s.key,e),t.Mo.containsKey(s.key)||zc(t,s.key)):Si()}}function Gc(t,e){var n=e.key,i=n.path.canonicalString();t.Oo.get(n)||t.Fo.has(i)||(wi("SyncEngine","New document in limbo: "+n),t.Fo.add(i),jc(t))}function jc(t){for(;t.Fo.size>0&&t.Oo.size<t.maxConcurrentLimboResolutions;){var e=t.Fo.values().next().value;t.Fo.delete(e);var n=new ji(zi.fromString(e)),i=t.qo.next();t.ko.set(i,new Ac(n)),t.Oo=t.Oo.insert(n,i),Fu(t.remoteStore,new Ma(Hr(Vr(n.path)),i,2,yi.o))}}function Wc(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o;return gi(this,(function(a){switch(a.label){case 0:return i=Ai(t),r=[],s=[],o=[],i.No.isEmpty()?[3,3]:(i.No.forEach((function(t,a){o.push(i.Qo(a,e,n).then((function(t){if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);var e=Lh.Nn(a.targetId,t);s.push(e)}})))})),[4,Promise.all(o)]);case 1:return a.sent(),i.xo.Tr(r),[4,function(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a,h,u,c;return gi(this,(function(l){switch(l.label){case 0:n=Ai(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return xa.forEach(e,(function(e){return xa.forEach(e.Cn,(function(i){return n.persistence.referenceDelegate.addReference(t,e.targetId,i)})).next((function(){return xa.forEach(e.xn,(function(i){return n.persistence.referenceDelegate.removeReference(t,e.targetId,i)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Ea(i=l.sent()))throw i;return wi("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(r=0,s=e;r<s.length;r++)o=s[r],a=o.targetId,o.fromCache||(h=n.Bn.get(a),u=h.snapshotVersion,c=h.withLastLimboFreeSnapshotVersion(u),n.Bn=n.Bn.insert(a,c));return[2]}}))}))}(i.localStore,s)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Hc(t,e){return vi(this,void 0,void 0,(function(){var n,i;return gi(this,(function(r){switch(r.label){case 0:return(n=Ai(t)).currentUser.isEqual(e)?[3,3]:(wi("SyncEngine","User change. New user:",e.toKey()),[4,Uh(n.localStore,e)]);case 1:return i=r.sent(),n.currentUser=e,function(t,e){t.Bo.forEach((function(t){t.forEach((function(t){t.reject(new Vi(Ui.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(n),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),[4,Wc(n,i.Wn)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}function qc(t,e){var n=Ai(t),i=n.ko.get(e);if(i&&i.Co)return io().add(i.key);var r=io(),s=n.$o.get(e);if(!s)return r;for(var o=0,a=s;o<a.length;o++){var h=a[o],u=n.No.get(h);r=r.unionWith(u.view.To)}return r}function Kc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r;return gi(this,(function(s){switch(s.label){case 0:return[4,Hh((n=Ai(t)).localStore,e.query,!0)];case 1:return i=s.sent(),r=e.view.So(i),[2,(n.isPrimaryClient&&Xc(n,e.targetId,r.Po),r)]}}))}))}function Qc(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){return[2,Kh((e=Ai(t)).localStore).then((function(t){return Wc(e,t)}))]}))}))}function Zc(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s;return gi(this,(function(o){switch(o.label){case 0:return[4,function(t,e){var n=Ai(t),i=Ai(n.Tn);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return i.Jt(t,e).next((function(e){return e?n.Kn.bn(t,e):xa.resolve(null)}))}))}((r=Ai(t)).localStore,e)];case 1:return null===(s=o.sent())?[3,6]:"pending"!==n?[3,3]:[4,Qu(r.remoteStore)];case 2:return o.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Vc(r,e,i||null),Uc(r,e),function(t,e){Ai(Ai(t).Tn).Xt(e)}(r.localStore,e)):Si(),o.label=4;case 4:return[4,Wc(r,s)];case 5:return o.sent(),[3,7];case 6:wi("SyncEngine","Cannot apply mutation batch with id: "+e),o.label=7;case 7:return[2]}}))}))}function Jc(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a,h,u;return gi(this,(function(c){switch(c.label){case 0:return rl(n=Ai(t)),sl(n),!0!==e||!0===n.Uo?[3,3]:(i=n.sharedClientState.getAllActiveQueryTargets(),[4,$c(n,i.toArray())]);case 1:return r=c.sent(),n.Uo=!0,[4,ic(n.remoteStore,!0)];case 2:for(c.sent(),s=0,o=r;s<o.length;s++)a=o[s],Fu(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.Uo?[3,7]:(h=[],u=Promise.resolve(),n.$o.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?h.push(e):u=u.then((function(){return Yc(n,e),Wh(n.localStore,e,!0)})),Bu(n.remoteStore,e)})),[4,u]);case 4:return c.sent(),[4,$c(n,h)];case 5:return c.sent(),function(t){var e=Ai(t);e.ko.forEach((function(t,n){Bu(e.remoteStore,n)})),e.Mo.cs(),e.ko=new Map,e.Oo=new Gs(ji.comparator)}(n),n.Uo=!1,[4,ic(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function $c(t,e,n){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a,h,u,c,l,f,d,p,v;return gi(this,(function(g){switch(g.label){case 0:n=Ai(t),i=[],r=[],s=0,o=e,g.label=1;case 1:return s<o.length?(a=o[s],h=void 0,(u=n.$o.get(a))&&0!==u.length?[4,jh(n.localStore,Hr(u[0]))]:[3,7]):[3,13];case 2:h=g.sent(),c=0,l=u,g.label=3;case 3:return c<l.length?(f=l[c],d=n.No.get(f),[4,Kc(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&r.push(p.snapshot),g.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,qh(n.localStore,a)];case 8:return v=g.sent(),[4,jh(n.localStore,v)];case 9:return h=g.sent(),[4,Rc(n,tl(v),a,!1)];case 10:g.sent(),g.label=11;case 11:i.push(h),g.label=12;case 12:return s++,[3,1];case 13:return[2,(n.xo.Tr(r),i)]}}))}))}function tl(t){return Ur(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function el(t){var e=Ai(t);return Ai(Ai(e.localStore).persistence).gn()}function nl(t,e,n,i){return vi(this,void 0,void 0,(function(){var r,s,o;return gi(this,(function(a){switch(a.label){case 0:return(r=Ai(t)).Uo?(wi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!r.$o.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Kh(r.localStore)];case 3:return s=a.sent(),o=oo.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Wc(r,s,o)];case 4:return a.sent(),[3,8];case 5:return[4,Wh(r.localStore,e,!0)];case 6:return a.sent(),Yc(r,e,i),[3,8];case 7:Si(),a.label=8;case 8:return[2]}}))}))}function il(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o,a,h,u,c,l,f;return gi(this,(function(d){switch(d.label){case 0:if(!(i=rl(t)).Uo)return[3,10];r=0,s=e,d.label=1;case 1:return r<s.length?(o=s[r],i.$o.has(o)?(wi("SyncEngine","Adding an already active target "+o),[3,5]):[4,qh(i.localStore,o)]):[3,6];case 2:return a=d.sent(),[4,jh(i.localStore,a)];case 3:return h=d.sent(),[4,Rc(i,tl(a),h.targetId,!1)];case 4:d.sent(),Fu(i.remoteStore,h),d.label=5;case 5:return r++,[3,1];case 6:u=function(t){return gi(this,(function(e){switch(e.label){case 0:return i.$o.has(t)?[4,Wh(i.localStore,t,!1).then((function(){Bu(i.remoteStore,t),Yc(i,t)})).catch(fh)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},c=0,l=n,d.label=7;case 7:return c<l.length?(f=l[c],[5,u(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))}function rl(t){var e=Ai(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Mc.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qc.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Lc.bind(null,e),e.xo.Tr=vc.bind(null,e.eventManager),e.xo.Ko=gc.bind(null,e.eventManager),e}function sl(t){var e=Ai(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Nc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fc.bind(null,e),e}function ol(t,e,n){var i=Ai(t);(function(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o,a,h;return gi(this,(function(u){switch(u.label){case 0:return u.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return i=u.sent(),[4,function(t,e){var n=Ai(t),i=_o(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.He.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(i)>=0}))}(t.localStore,i)];case 2:return u.sent()?[4,e.close()]:[3,4];case 3:return[2,(u.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(i)))];case 4:return n._updateProgress(_c(i)),r=new wc(i,t.localStore,e.D),[4,e.Wo()];case 5:s=u.sent(),u.label=6;case 6:return s?[4,r.fo(s)]:[3,10];case 7:return(o=u.sent())&&n._updateProgress(o),[4,e.Wo()];case 8:s=u.sent(),u.label=9;case 9:return[3,6];case 10:return[4,r.complete()];case 11:return a=u.sent(),[4,Wc(t,a.En,void 0)];case 12:return u.sent(),[4,function(t,e){var n=Ai(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.He.saveBundleMetadata(t,e)}))}(t.localStore,i)];case 13:return u.sent(),n._completeWith(a.progress),[3,15];case 14:return Ti("SyncEngine","Loading bundle failed with "+(h=u.sent())),n._failWith(h),[3,15];case 15:return[2]}}))}))})(i,e,n).then((function(){i.sharedClientState.notifyBundleLoaded()}))}var al=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return this.D=Au(t.databaseInfo.databaseId),this.sharedClientState=this.jo(t),this.persistence=this.Go(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t),[2]}}))}))},t.prototype.zo=function(t){return null},t.prototype.Ho=function(t){return Bh(this.persistence,new Nh,t.initialUser,this.D)},t.prototype.Go=function(t){return new ou(hu.Cs,this.D)},t.prototype.jo=function(t){return new xu},t.prototype.terminate=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),hl=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).Jo=e,r.cacheSizeBytes=n,r.forceOwnership=i,r.synchronizeTabs=!1,r}return pi(e,t),e.prototype.initialize=function(e){return vi(this,void 0,void 0,(function(){return gi(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Qh(this.localStore)];case 2:return n.sent(),[4,this.Jo.initialize(this,e)];case 3:return n.sent(),[4,sl(this.Jo.syncEngine)];case 4:return n.sent(),[4,Qu(this.Jo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ho=function(t){return Bh(this.persistence,new Nh,t.initialUser,this.D)},e.prototype.zo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new vh(e,t.asyncQueue)},e.prototype.Go=function(t){var e=kh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?$a.withCacheSize(this.cacheSizeBytes):$a.DEFAULT;return new Ph(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Su(),Cu(),this.D,this.sharedClientState,!!this.forceOwnership)},e.prototype.jo=function(t){return new xu},e}(al),ul=function(t){function e(e,n){var i=this;return(i=t.call(this,e,n,!1)||this).Jo=e,i.cacheSizeBytes=n,i.synchronizeTabs=!0,i}return pi(e,t),e.prototype.initialize=function(e){return vi(this,void 0,void 0,(function(){var n,i=this;return gi(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),n=this.Jo.syncEngine,this.sharedClientState instanceof yu?(this.sharedClientState.syncEngine={wi:Zc.bind(null,n),_i:nl.bind(null,n),mi:il.bind(null,n),gn:el.bind(null,n),di:Qc.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[4,this.persistence.en((function(t){return vi(i,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return[4,Jc(this.Jo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return r.sent(),[2]}}))}))},e.prototype.jo=function(t){var e=Su();if(!yu.At(e))throw new Vi(Ui.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new yu(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(hl),cl=function(){function t(){}return t.prototype.initialize=function(t,e){return vi(this,void 0,void 0,(function(){var n=this;return gi(this,(function(i){switch(i.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Dc(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Hc.bind(null,this.syncEngine),[4,ic(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new fc},t.prototype.createDatastore=function(t){var e,n=Au(t.databaseInfo.databaseId),i=(e=t.databaseInfo,new Eu(e));return function(t,e,n){return new ku(t,e,n)}(t.credentials,i,n)},t.prototype.createRemoteStore=function(t){var e,n,i,r,s,o=this;return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=function(t){return Dc(o.syncEngine,t,0)},s=wu.At()?new wu:new bu,new Du(e,n,i,r,s)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,i,r,s,o){var a=new Ic(t,e,n,i,r,s);return o&&(a.Uo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=Ai(t),wi("RemoteStore","RemoteStore shutting down."),e.Qr.add(5),[4,Nu(e)];case 1:return n.sent(),e.Wr.shutdown(),e.jr.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function ll(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return vi(this,void 0,void 0,(function(){var i;return gi(this,(function(r){return n<t.byteLength?(i={value:t.slice(n,n+e),done:!1},[2,(n+=e,i)]):[2,{done:!0}]}))}))},cancel:function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var fl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Yo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Yo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Xo=function(){this.muted=!0},t.prototype.Yo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),dl=function(){function t(t,e){var n=this;this.Zo=t,this.D=e,this.metadata=new ya,this.buffer=new Uint8Array,this.tc=new TextDecoder("utf-8"),this.ec().then((function(t){t&&t.ho()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Zo.cancel()},t.prototype.getMetadata=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Wo=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.ec())]}}))}))},t.prototype.ec=function(){return vi(this,void 0,void 0,(function(){var t,e,n,i;return gi(this,(function(r){switch(r.label){case 0:return[4,this.nc()];case 1:return null===(t=r.sent())?[2,null]:(e=this.tc.decode(t),n=Number(e),isNaN(n)&&this.sc("length string ("+e+") is not valid number"),[4,this.ic(n)]);case 2:return i=r.sent(),[2,new xc(JSON.parse(i),t.length+n)]}}))}))},t.prototype.rc=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.nc=function(){return vi(this,void 0,void 0,(function(){var t,e;return gi(this,(function(n){switch(n.label){case 0:return this.rc()<0?[4,this.oc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.rc())<0&&this.sc("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.ic=function(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.oc()]:[3,3];case 1:n.sent()&&this.sc("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.tc.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.sc=function(t){throw this.Zo.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.oc=function(){return vi(this,void 0,void 0,(function(){var t,e;return gi(this,(function(n){switch(n.label){case 0:return[4,this.Zo.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),pl=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return vi(this,void 0,void 0,(function(){var e,n=this;return gi(this,(function(i){switch(i.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Vi(Ui.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return vi(this,void 0,void 0,(function(){var n,i,r,s,o,a;return gi(this,(function(h){switch(h.label){case 0:return n=Ai(t),i=Po(n.D)+"/documents",r={documents:e.map((function(t){return So(n.D,t)}))},[4,n.Ui("BatchGetDocuments",i,r)];case 1:return s=h.sent(),o=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Ci(!!e.found),e.found.name,e.found.updateTime;var n=Co(t,e.found.name),i=_o(e.found.updateTime),r=new is({mapValue:{fields:e.found.fields}});return new vr(n,i,r,{})}(t,e):"missing"in e?function(t,e){Ci(!!e.missing),Ci(!!e.readTime);var n=Co(t,e.missing),i=_o(e.readTime);return new gr(n,i)}(t,e):Si()}(n.D,t);o.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=o.get(t.toString());Ci(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=i.sent()).forEach((function(t){t instanceof gr||t instanceof vr?n.recordVersion(t):Si()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Us(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return vi(this,void 0,void 0,(function(){var t,e=this;return gi(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var i=ji.fromPath(n);e.mutations.push(new Vs(i,e.precondition(i)))})),[4,function(t,e){return vi(this,void 0,void 0,(function(){var n,i,r;return gi(this,(function(s){switch(s.label){case 0:return n=Ai(t),i=Po(n.D)+"/documents",r={writes:e.map((function(t){return Mo(n.D,t)}))},[4,n.Mi("Commit",i,r)];case 1:return s.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t instanceof vr)e=t.version;else{if(!(t instanceof gr))throw Si();e=es.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Vi(Ui.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ts.updateTime(e):Ts.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(es.min()))throw new Vi(Ui.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ts.updateTime(e)}return Ts.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),vl=function(){function t(t,e,n,i){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=i,this.cc=5,this.rr=new Iu(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ac()},t.prototype.ac=function(){var t=this;this.rr.Yi((function(){return vi(t,void 0,void 0,(function(){var t,e,n=this;return gi(this,(function(i){return t=new pl(this.datastore),(e=this.uc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.hc(t)}))}))})).catch((function(t){n.hc(t)})),[2]}))}))}))},t.prototype.uc=function(t){try{var e=this.updateFunction(t);return!Ni(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.hc=function(t){var e=this;this.cc>0&&this.lc(t)?(this.cc-=1,this.asyncQueue.enqueueAndForget((function(){return e.ac(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.lc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!zs(e)}return!1},t}(),gl=function(){function t(t,e,n){var i=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=uu.UNAUTHENTICATED,this.clientId=Pi.u(),this.credentialListener=function(){},this.receivedInitialUser=new ya,this.credentials.setChangeListener((function(t){wi("FirestoreClient","Received user=",t.uid),i.user=t,i.credentialListener(t),i.receivedInitialUser.resolve()}))}return t.prototype.getConfiguration=function(){return vi(this,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}}))}))},t.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then((function(){return e.credentialListener(e.user)}))},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Vi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return vi(t,void 0,void 0,(function(){var t,n;return gi(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:i.sent(),i.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:i.sent(),i.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=i.sent(),n=ac(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function ml(t,e){return vi(this,void 0,void 0,(function(){var n,i,r=this;return gi(this,(function(s){switch(s.label){case 0:return t.asyncQueue.verifyOperationInProgress(),wi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=s.sent(),[4,e.initialize(n)];case 2:return s.sent(),i=n.initialUser,t.setCredentialChangeListener((function(n){i.isEqual(n)||(i=n,t.asyncQueue.enqueueRetryable((function(){return vi(r,void 0,void 0,(function(){return gi(this,(function(t){switch(t.label){case 0:return[4,Uh(e.localStore,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function yl(t,e){return vi(this,void 0,void 0,(function(){var n,i;return gi(this,(function(r){switch(r.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,xl(t)];case 1:return n=r.sent(),wi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return i=r.sent(),[4,e.initialize(n,i)];case 3:return r.sent(),t.setCredentialChangeListener((function(n){return t.asyncQueue.enqueueRetryable((function(){return function(t,e){return vi(this,void 0,void 0,(function(){var n,i;return gi(this,(function(r){switch(r.label){case 0:return(n=Ai(t)).asyncQueue.verifyOperationInProgress(),wi("RemoteStore","RemoteStore received new credentials"),i=Xu(n),n.Qr.add(3),[4,Nu(n)];case 1:return r.sent(),i&&n.jr.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return r.sent(),n.Qr.delete(3),[4,Lu(n)];case 3:return r.sent(),[2]}}))}))}(e.remoteStore,n)}))})),t.onlineComponents=e,[2]}}))}))}function xl(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(wi("FirestoreClient","Using default OfflineComponentProvider"),[4,ml(t,new al)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function bl(t){return vi(this,void 0,void 0,(function(){return gi(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(wi("FirestoreClient","Using default OnlineComponentProvider"),[4,yl(t,new cl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function wl(t){return xl(t).then((function(t){return t.persistence}))}function _l(t){return xl(t).then((function(t){return t.localStore}))}function Tl(t){return bl(t).then((function(t){return t.remoteStore}))}function El(t){return bl(t).then((function(t){return t.syncEngine}))}function Sl(t){return vi(this,void 0,void 0,(function(){var e,n;return gi(this,(function(i){switch(i.label){case 0:return[4,bl(t)];case 1:return e=i.sent(),[2,((n=e.eventManager).onListen=Pc.bind(null,e.syncEngine),n.onUnlisten=Oc.bind(null,e.syncEngine),n)]}}))}))}function Cl(t,e,n){var i=this;void 0===n&&(n={});var r=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(i,void 0,void 0,(function(){var i;return gi(this,(function(s){switch(s.label){case 0:return i=function(t,e,n,i,r){var s=new fl({next:function(s){e.enqueueAndForget((function(){return pc(t,o)}));var a=s.docs.has(n);!a&&s.fromCache?r.reject(new Vi(Ui.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new Vi(Ui.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:function(t){return r.reject(t)}}),o=new yc(Vr(n.path),s,{includeMetadataChanges:!0,uo:!0});return dc(t,o)},[4,Sl(t)];case 1:return[2,i.apply(void 0,[s.sent(),t.asyncQueue,e,n,r])]}}))}))})),r.promise}function Al(t,e,n){var i=this;void 0===n&&(n={});var r=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(i,void 0,void 0,(function(){var i;return gi(this,(function(s){switch(s.label){case 0:return i=function(t,e,n,i,r){var s=new fl({next:function(n){e.enqueueAndForget((function(){return pc(t,o)})),n.fromCache&&"server"===i.source?r.reject(new Vi(Ui.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:function(t){return r.reject(t)}}),o=new yc(n,s,{includeMetadataChanges:!0,uo:!0});return dc(t,o)},[4,Sl(t)];case 1:return[2,i.apply(void 0,[s.sent(),t.asyncQueue,e,n,r])]}}))}))})),r.promise}var Il=function(t,e,n,i,r,s){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=s},Pl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Rl=new Map,Ol=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},kl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){this.changeListener=t,t(uu.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ml=function(){function t(t){var e=this;this.fc=null,this.currentUser=uu.UNAUTHENTICATED,this.receivedInitialUser=!1,this.dc=0,this.changeListener=null,this.forceRefresh=!1,this.fc=function(){e.dc++,e.currentUser=e.wc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.dc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.fc):(this.fc(null),t.get().then((function(t){e.auth=t,e.fc&&e.auth.addAuthTokenListener(e.fc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.dc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.dc!==e?(wi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ci("string"==typeof n.accessToken),new Ol(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.fc),this.fc=null,this.changeListener=null},t.prototype.wc=function(){var t=this.auth&&this.auth.getUid();return Ci(null===t||"string"==typeof t),new uu(t)},t}(),Dl=function(){function t(t,e){this._c=t,this.mc=e,this.type="FirstParty",this.user=uu.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.mc},e=this._c.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ll=function(){function t(t,e){this._c=t,this.mc=e}return t.prototype.getToken=function(){return Promise.resolve(new Dl(this._c,this.mc))},t.prototype.setChangeListener=function(t){t(uu.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Nl(t,e,n){if(!n)throw new Vi(Ui.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Fl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bl(t,e,n,i){if(!0===e&&!0===i)throw new Vi(Ui.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ul(t){if(!ji.isDocumentKey(t))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Vl(t){if(ji.isDocumentKey(t))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Yl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Si()}function zl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Vi(Ui.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Yl(t);throw new Vi(Ui.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Xl(t,e){if(e<=0)throw new Vi(Ui.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Gl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Vi(Ui.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Vi(Ui.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Bl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),jl=function(){function t(t,e){this._persistenceKey="(lite)",this._settings=new Gl({}),this._settingsFrozen=!1,t instanceof Pl?(this._databaseId=t,this._credentials=new kl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Vi(Ui.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pl(t.options.projectId)}(t),this._credentials=new Ml(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Vi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Vi(Ui.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new kl;switch(t.type){case"gapi":var e=t.client;return Ci(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ll(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Vi(Ui.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Rl.get(this))&&(wi("ComponentProvider","Removing Datastore"),Rl.delete(this),t.terminate()),Promise.resolve();var t},t}(),Wl=function(t){this._delegate=t},Hl=function(){function t(t,e,n){this._converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Kl(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),ql=function(){function t(t,e,n){this._converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Kl=function(t){function e(e,n,i){var r=this;return(r=t.call(this,e,n,Vr(i))||this).firestore=e,r._path=i,r.type="collection",r}return pi(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Hl(this.firestore,null,new ji(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(ql);function Ql(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(t instanceof Wl&&(t=t._delegate),Nl("collection","path",e),t instanceof jl)return Vl(n=zi.fromString.apply(zi,mi([e],i))),new Kl(t,null,n);if(!(t instanceof Hl||t instanceof Kl))throw new Vi(Ui.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Vl(n=zi.fromString.apply(zi,mi([t.path],i)).child(zi.fromString(e))),new Kl(t.firestore,null,n)}function Zl(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(t instanceof Wl&&(t=t._delegate),1===arguments.length&&(e=Pi.u()),Nl("doc","path",e),t instanceof jl)return Ul(n=zi.fromString.apply(zi,mi([e],i))),new Hl(t,null,new ji(n));if(!(t instanceof Hl||t instanceof Kl))throw new Vi(Ui.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ul(n=t._path.child(zi.fromString.apply(zi,mi([e],i)))),new Hl(t.firestore,t instanceof Kl?t._converter:null,new ji(n))}function Jl(t,e){return t instanceof Wl&&(t=t._delegate),e instanceof Wl&&(e=e._delegate),(t instanceof Hl||t instanceof Kl)&&(e instanceof Hl||e instanceof Kl)&&t.firestore===e.firestore&&t.path===e.path&&t._converter===e._converter}function $l(t,e){return t instanceof Wl&&(t=t._delegate),e instanceof Wl&&(e=e._delegate),t instanceof ql&&e instanceof ql&&t.firestore===e.firestore&&Kr(t._query,e._query)&&t._converter===e._converter}var tf=function(){function t(){var t=this;this.yc=Promise.resolve(),this.gc=[],this.Ec=!1,this.Tc=[],this.Ic=null,this.Ac=!1,this.Rc=[],this.rr=new Iu(this,"async_queue_retry"),this.bc=function(){var e=Cu();e&&wi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.rr.Zi()};var e=Cu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.Ec},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.vc(),this.Pc(t)},t.prototype.enterRestrictedMode=function(){if(!this.Ec){this.Ec=!0;var t=Cu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}},t.prototype.enqueue=function(t){return this.vc(),this.Ec?new Promise((function(t){})):this.Pc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.gc.push(t),e.Vc()}))},t.prototype.Vc=function(){return vi(this,void 0,void 0,(function(){var t,e=this;return gi(this,(function(n){switch(n.label){case 0:if(0===this.gc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gc[0]()];case 2:return n.sent(),this.gc.shift(),this.rr.reset(),[3,4];case 3:if(!Ea(t=n.sent()))throw t;return wi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gc.length>0&&this.rr.Yi((function(){return e.Vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Pc=function(t){var e=this,n=this.yc.then((function(){return e.Ac=!0,t().catch((function(t){throw e.Ic=t,e.Ac=!1,_i("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ac=!1,t}))}));return this.yc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var i=this;this.vc(),this.Rc.indexOf(t)>-1&&(e=0);var r=oc.createAndSchedule(this,t,e,n,(function(t){return i.Sc(t)}));return this.Tc.push(r),r},t.prototype.vc=function(){this.Ic&&Si()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Dc=function(){return vi(this,void 0,void 0,(function(){var t;return gi(this,(function(e){switch(e.label){case 0:return[4,t=this.yc];case 1:e.sent(),e.label=2;case 2:if(t!==this.yc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Cc=function(t){for(var e=0,n=this.Tc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.xc=function(t){var e=this;return this.Dc().then((function(){e.Tc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,i=e.Tc;n<i.length;n++){var r=i[n];if(r.skipDelay(),"all"!==t&&r.timerId===t)break}return e.Dc()}))},t.prototype.Nc=function(t){this.Rc.push(t)},t.prototype.Sc=function(t){var e=this.Tc.indexOf(t);this.Tc.splice(e,1)},t}();function ef(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,i=0,r=["next","error","complete"];i<r.length;i++){var s=r[i];if(s in n&&"function"==typeof n[s])return!0}return!1}(t)}var nf=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new ya,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),rf=function(t){function e(e,n){var i=this;return(i=t.call(this,e,n)||this)._queue=new tf,i._persistenceKey="name"in e?e.name:"[DEFAULT]",i}return pi(e,t),e.prototype._terminate=function(){return this._firestoreClient||of(this),this._firestoreClient.terminate()},e}(jl);function sf(t){return t._firestoreClient||of(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function of(t){var e=t._freezeSettings(),n=function(t,e,n){return new Il(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t._databaseId,t._persistenceKey,e);t._firestoreClient=new gl(t._credentials,t._queue,n)}function af(t,e,n){var i=this,r=new ya;return t.asyncQueue.enqueue((function(){return vi(i,void 0,void 0,(function(){var i;return gi(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,ml(t,n)];case 1:return s.sent(),[4,yl(t,e)];case 2:return s.sent(),r.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Ui.FAILED_PRECONDITION||t.code===Ui.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(i=s.sent()))throw i;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i),[3,4];case 4:return[2]}}))}))})).then((function(){return r.promise}))}function hf(t){if(t._initialized||t._terminated)throw new Vi(Ui.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var uf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),cf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Wi.fromBase64String(e))}catch(e){throw new Vi(Ui.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Wi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),lf=function(t){this._methodName=t},ff=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Vi(Ui.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Vi(Ui.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Ri(this._lat,t._lat)||Ri(this._long,t._long)},t}(),df=/^__.*__$/,pf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new ks(t,this.data,this.fieldMask,e,this.fieldTransforms):new Os(t,this.data,e,this.fieldTransforms)},t}(),vf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new ks(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function gf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Si()}}var mf=function(){function t(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.D=n,this.ignoreUndefinedProperties=i,void 0===r&&this.$c(),this.fieldTransforms=r||[],this.fieldMask=s||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Fc",{get:function(){return this.settings.Fc},enumerable:!1,configurable:!0}),t.prototype.Oc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.D,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Oc({path:n,Mc:!1});return i.Lc(t),i},t.prototype.Bc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Oc({path:n,Mc:!1});return i.$c(),i},t.prototype.qc=function(t){return this.Oc({path:void 0,Mc:!0})},t.prototype.Uc=function(t){return Ff(t,this.settings.methodName,this.settings.Qc||!1,this.path,this.settings.Kc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.$c=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lc(this.path.get(t))},t.prototype.Lc=function(t){if(0===t.length)throw this.Uc("Document fields must not be empty");if(gf(this.Fc)&&df.test(t))throw this.Uc('Document fields cannot begin and end with "__"')},t}(),yf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.D=n||Au(t)}return t.prototype.Wc=function(t,e,n,i){return void 0===i&&(i=!1),new mf({Fc:t,methodName:e,Kc:n,path:Gi.emptyPath(),Mc:!1,Qc:i},this.databaseId,this.D,this.ignoreUndefinedProperties)},t}();function xf(t){var e=t._freezeSettings(),n=Au(t._databaseId);return new yf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bf(t,e,n,i,r,s){void 0===s&&(s={});var o=t.Wc(s.merge||s.mergeFields?2:0,e,n,r);Mf("Data must be an object, but it was:",o,i);var a,h,u=Of(i,o);if(s.merge)a=new ns(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){for(var c=[],l=0,f=s.mergeFields;l<f.length;l++){var d=Df(e,f[l],n);if(!o.contains(d))throw new Vi(Ui.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Bf(c,d)||c.push(d)}a=new ns(c),h=o.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,h=o.fieldTransforms;return new pf(new is(u),a,h)}var wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Fc)throw 1===t.Fc?t.Uc(this._methodName+"() can only appear at the top level of your update data"):t.Uc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(lf);function _f(t,e,n){return new mf({Fc:3,Kc:e.settings.Kc,methodName:t._methodName,Mc:n},e.databaseId,e.D,e.ignoreUndefinedProperties)}var Tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype._toFieldTransform=function(t){return new ws(t.path,new ds)},e.prototype.isEqual=function(t){return t instanceof e},e}(lf),Ef=function(t){function e(e,n){var i=this;return(i=t.call(this,e)||this).jc=n,i}return pi(e,t),e.prototype._toFieldTransform=function(t){var e=_f(this,t,!0),n=this.jc.map((function(t){return Rf(t,e)})),i=new ps(n);return new ws(t.path,i)},e.prototype.isEqual=function(t){return this===t},e}(lf),Sf=function(t){function e(e,n){var i=this;return(i=t.call(this,e)||this).jc=n,i}return pi(e,t),e.prototype._toFieldTransform=function(t){var e=_f(this,t,!0),n=this.jc.map((function(t){return Rf(t,e)})),i=new gs(n);return new ws(t.path,i)},e.prototype.isEqual=function(t){return this===t},e}(lf),Cf=function(t){function e(e,n){var i=this;return(i=t.call(this,e)||this).Gc=n,i}return pi(e,t),e.prototype._toFieldTransform=function(t){var e=new ys(t.D,hs(t.D,this.Gc));return new ws(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(lf);function Af(t,e,n,i){var r=t.Wc(1,e,n);Mf("Data must be an object, but it was:",r,i);var s=[],o=new rs;Di(i,(function(t,i){var a=Nf(e,t,n);i instanceof Wl&&(i=i._delegate);var h=r.Bc(a);if(i instanceof wf)s.push(a);else{var u=Rf(i,h);null!=u&&(s.push(a),o.set(a,u))}}));var a=new ns(s);return new vf(o.v(),a,r.fieldTransforms)}function If(t,e,n,i,r,s){var o=t.Wc(1,e,n),a=[Df(e,i,n)],h=[r];if(s.length%2!=0)throw new Vi(Ui.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<s.length;u+=2)a.push(Df(e,s[u])),h.push(s[u+1]);for(var c=[],l=new rs,f=a.length-1;f>=0;--f)if(!Bf(c,a[f])){var d=a[f],p=h[f];p instanceof Wl&&(p=p._delegate);var v=o.Bc(d);if(p instanceof wf)c.push(d);else{var g=Rf(p,v);null!=g&&(c.push(d),l.set(d,g))}}var m=new ns(c);return new vf(l.v(),m,o.fieldTransforms)}function Pf(t,e,n,i){return void 0===i&&(i=!1),Rf(n,t.Wc(i?4:3,e))}function Rf(t,e){if(t instanceof Wl&&(t=t._delegate),kf(t))return Mf("Unsupported field value:",e,t),Of(t,e);if(t instanceof lf)return function(t,e){if(!gf(e.Fc))throw e.Uc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Uc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Mc&&4!==e.Fc)throw e.Uc("Nested arrays are not supported");return function(t,e){for(var n=[],i=0,r=0,s=t;r<s.length;r++){var o=Rf(s[r],e.qc(i));null==o&&(o={nullValue:"NULL_VALUE"}),n.push(o),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Wl&&(t=t._delegate),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return hs(e.D,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zi.fromDate(t);return{timestampValue:xo(e.D,n)}}if(t instanceof Zi)return n=new Zi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:xo(e.D,n)};if(t instanceof ff)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof cf)return{bytesValue:bo(e.D,t._byteString)};if(t instanceof Hl){n=e.databaseId;var i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Uc("Document reference is for database "+i.projectId+"/"+i.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:To(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Uc("Unsupported field value: "+Yl(t))}(t,e)}function Of(t,e){var n={};return Li(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Di(t,(function(t,i){var r=Rf(i,e.kc(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function kf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zi||t instanceof ff||t instanceof cf||t instanceof Hl||t instanceof lf)}function Mf(t,e,n){if(!kf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var i=Yl(n);throw"an object"===i?e.Uc(t+" a custom object"):e.Uc(t+" "+i)}}function Df(t,e,n){if(e instanceof Wl&&(e=e._delegate),e instanceof uf)return e._internalPath;if("string"==typeof e)return Nf(t,e);throw Ff("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Lf=new RegExp("[~\\*/\\[\\]]");function Nf(t,e,n){if(e.search(Lf)>=0)throw Ff("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(uf.bind.apply(uf,mi([void 0],e.split(".")))))._internalPath}catch(i){throw Ff("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ff(t,e,n,i,r){var s=i&&!i.isEmpty(),o=void 0!==r,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var h="";return(s||o)&&(h+=" (found",s&&(h+=" in field "+i),o&&(h+=" in document "+r),h+=")"),new Vi(Ui.INVALID_ARGUMENT,(a+=". ")+t+h)}function Bf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Uf=function(){function t(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Hl(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Vf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data().field(Yf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Vf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Uf);function Yf(t,e){return"string"==typeof e?Nf(t,e):e instanceof Wl?e._delegate._internalPath:e._internalPath}var zf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Xf=function(t){function e(e,n,i,r,s,o){var a=this;return(a=t.call(this,e,n,i,r,o)||this)._firestore=e,a._firestoreImpl=e,a.metadata=s,a}return pi(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Gf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data().field(Yf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Uf),Gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Xf),jf=function(){function t(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new zf(i.hasPendingWrites,i.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(i){t.call(e,new Gf(n._firestore,n._userDataWriter,i.key,i,new zf(n._snapshot.mutatedKeys.has(i.key),n._snapshot.fromCache),n.query._converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Vi(Ui.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var i=new Gf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new zf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter);return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:n++}}))}var i=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Gf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new zf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter),r=-1,s=-1;return 0!==e.type&&(r=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:Wf(e.type),doc:n,oldIndex:r,newIndex:s}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Wf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Si()}}function Hf(t,e){return t instanceof Xf&&e instanceof Xf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof jf&&e instanceof jf&&t._firestore===e._firestore&&$l(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function qf(t){if(zr(t)&&0===t.explicitOrderBy.length)throw new Vi(Ui.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kf=function(){};function Qf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,r=e;i<r.length;i++){var s=r[i];t=s._apply(t)}return t}var Zf=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).zc=e,r.Hc=n,r.Jc=i,r.type="where",r}return pi(e,t),e.prototype._apply=function(t){var e=xf(t.firestore),n=function(t,e,n,i,r,s,o){var a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s+"' queries on FieldPath.documentId().");if("in"===s||"not-in"===s){rd(o,s);for(var h=[],u=0,c=o;u<c.length;u++){var l=c[u];h.push(id(i,t,l))}a={arrayValue:{values:h}}}else a=id(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||rd(o,s),a=Pf(n,"where",o,"in"===s||"not-in"===s);var f=Tr.create(r,s,a);return function(t,e){if(e.g()){var n=Gr(t);if(null!==n&&!n.isEqual(e.field))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=Xr(t);null!==i&&sd(0,e.field,i)}var r=function(t,e){for(var n=0,i=t.filters;n<i.length;n++){var r=i[n];if(e.indexOf(r.op)>=0)return r.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==r)throw r===e.op?new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.zc,this.Hc,this.Jc);return new ql(t.firestore,t._converter,function(t,e){var n=t.filters.concat([e]);return new Br(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Kf),Jf=function(t){function e(e,n){var i=this;return(i=t.call(this)||this).zc=e,i.Yc=n,i.type="orderBy",i}return pi(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i=new Dr(e,n);return function(t,e){if(null===Xr(t)){var n=Gr(t);null!==n&&sd(0,n,e.field)}}(t,i),i}(t._query,this.zc,this.Yc);return new ql(t.firestore,t._converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Br(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Kf),$f=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).type=e,r.Xc=n,r.Zc=i,r}return pi(e,t),e.prototype._apply=function(t){return new ql(t.firestore,t._converter,qr(t._query,this.Xc,this.Zc))},e}(Kf),td=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).type=e,r.ta=n,r.ea=i,r}return pi(e,t),e.prototype._apply=function(t){var e=nd(t,this.type,this.ta,this.ea);return new ql(t.firestore,t._converter,function(t,e){return new Br(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Kf),ed=function(t){function e(e,n,i){var r=this;return(r=t.call(this)||this).type=e,r.ta=n,r.ea=i,r}return pi(e,t),e.prototype._apply=function(t){var e=nd(t,this.type,this.ta,this.ea);return new ql(t.firestore,t._converter,function(t,e){return new Br(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Kf);function nd(t,e,n,i){if(n[0]instanceof Wl&&(n[0]=n[0]._delegate),n[0]instanceof Uf)return function(t,e,n,i,r){if(!i)throw new Vi(Ui.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var s=[],o=0,a=Wr(t);o<a.length;o++){var h=a[o];if(h.field.isKeyField())s.push(hr(e,i.key));else{var u=i.field(h.field);if(Ji(u))throw new Vi(Ui.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var c=h.field.canonicalString();throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}s.push(u)}}return new kr(s,r)}(t._query,t.firestore._databaseId,e,n[0]._document,i);var r=xf(t.firestore);return function(t,e,n,i,r,s){var o=t.explicitOrderBy;if(r.length>o.length)throw new Vi(Ui.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],h=0;h<r.length;h++){var u=r[h];if(o[h].field.isKeyField()){if("string"!=typeof u)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof u);if(!jr(t)&&-1!==u.indexOf("/"))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+u+"' contains a slash.");var c=t.path.child(zi.fromString(u));if(!ji.isDocumentKey(c))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ji(c);a.push(hr(e,l))}else{var f=Pf(n,i,u);a.push(f)}}return new kr(a,s)}(t._query,t.firestore._databaseId,r,e,n,i)}function id(t,e,n){if(n instanceof Wl&&(n=n._delegate),"string"==typeof n){if(""===n)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!jr(e)&&-1!==n.indexOf("/"))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(zi.fromString(n));if(!ji.isDocumentKey(i))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return hr(t,new ji(i))}if(n instanceof Hl)return hr(t,n._key);throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Yl(n)+".")}function rd(t,e){if(!Array.isArray(t)||0===t.length)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function sd(t,e,n){if(!n.isEqual(e))throw new Vi(Ui.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var od=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),er(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ki(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Qi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Si()}},t.prototype.convertObject=function(t,e){var n=this,i={};return Di(t.fields||{},(function(t,r){i[t]=n.convertValue(r,e)})),i},t.prototype.convertGeoPoint=function(t){return new ff(Ki(t.latitude),Ki(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=$i(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(tr(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=qi(t);return new Zi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=zi.fromString(t);Ci(qo(n));var i=new Pl(n.get(1),n.get(3)),r=new ji(n.popFirst(5));return i.isEqual(e)||_i("Document "+r+" contains a document reference within a different database ("+i.projectId+"/"+i.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),r},t}();function ad(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pi(e,t),e.prototype.convertBytes=function(t){return new cf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Hl(this.firestore,null,e)},e}(od),ud=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=xf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var i=cd(t,this._firestore),r=ad(i._converter,e,n),s=bf(this._dataReader,"WriteBatch.set",i._key,r,null!==i._converter,n);return this._mutations.push(s.toMutation(i._key,Ts.none())),this},t.prototype.update=function(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];this._verifyNotCommitted();var s,o=cd(t,this._firestore);return e instanceof Wl&&(e=e._delegate),s="string"==typeof e||e instanceof uf?If(this._dataReader,"WriteBatch.update",o._key,e,n,i):Af(this._dataReader,"WriteBatch.update",o._key,e),this._mutations.push(s.toMutation(o._key,Ts.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=cd(t,this._firestore);return this._mutations=this._mutations.concat(new Us(e._key,Ts.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Vi(Ui.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function cd(t,e){if(t instanceof Wl&&(t=t._delegate),t.firestore!==e)throw new Vi(Ui.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ld=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pi(e,t),e.prototype.convertBytes=function(t){return new cf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Hl(this.firestore,null,e)},e}(od);function fd(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];t=zl(t,Hl);var s=zl(t.firestore,rf),o=xf(s);return e instanceof Wl&&(e=e._delegate),pd(s,[("string"==typeof e||e instanceof uf?If(o,"updateDoc",t._key,e,n,i):Af(o,"updateDoc",t._key,e)).toMutation(t._key,Ts.exists(!0))])}function dd(t){for(var e,n,i,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];t instanceof Wl&&(t=t._delegate);var o={includeMetadataChanges:!1},a=0;"object"!=typeof r[a]||ef(r[a])||(o=r[a],a++);var h,u,c,l={includeMetadataChanges:o.includeMetadataChanges};if(ef(r[a])){var f=r[a];r[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),r[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),r[a+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}if(t instanceof Hl)u=zl(t.firestore,rf),c=Vr(t._key.path),h={next:function(e){r[a]&&r[a](vd(u,t,e))},error:r[a+1],complete:r[a+2]};else{var d=zl(t,ql);u=zl(d.firestore,rf),c=d._query;var p=new ld(u);h={next:function(t){r[a]&&r[a](new jf(u,p,d,t))},error:r[a+1],complete:r[a+2]},qf(t._query)}return function(t,e,n,i){var r=this,s=new fl(i),o=new yc(e,s,n);return t.asyncQueue.enqueueAndForget((function(){return vi(r,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=dc,[4,Sl(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){s.Xo(),t.asyncQueue.enqueueAndForget((function(){return vi(r,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=pc,[4,Sl(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(sf(u),c,l,h)}function pd(t,e){return function(t,e){var n=this,i=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var n;return gi(this,(function(r){switch(r.label){case 0:return n=kc,[4,El(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,i])]}}))}))})),i.promise}(sf(t),e)}function vd(t,e,n){var i=n.docs.get(e._key),r=new ld(t);return new Xf(t,r,e._key,i,new zf(n.hasPendingWrites,n.fromCache),e._converter)}var gd=function(t){function e(e,n){var i=this;return(i=t.call(this,e,n)||this)._firestore=e,i}return pi(e,t),e.prototype.get=function(e){var n=this,i=cd(e,this._firestore),r=new ld(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Xf(n._firestore,r,i._key,t._document,new zf(!1,!1),i._converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=xf(t)}return t.prototype.get=function(t){var e=this,n=cd(t,this._firestore),i=new hd(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Si();var r=t[0];if(r instanceof gr)return new Uf(e._firestore,i,n._key,null,n._converter);if(r instanceof vr)return new Uf(e._firestore,i,r.key,r,n._converter);throw Si()}))},t.prototype.set=function(t,e,n){var i=cd(t,this._firestore),r=ad(i._converter,e,n),s=bf(this._dataReader,"Transaction.set",i._key,r,null!==i._converter,n);return this._transaction.set(i._key,s),this},t.prototype.update=function(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];var s,o=cd(t,this._firestore);return e instanceof Wl&&(e=e._delegate),s="string"==typeof e||e instanceof uf?If(this._dataReader,"Transaction.update",o._key,e,n,i):Af(this._dataReader,"Transaction.update",o._key,e),this._transaction.update(o._key,s),this},t.prototype.delete=function(t){var e=cd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function md(){if("undefined"==typeof Uint8Array)throw new Vi(Ui.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function yd(){if("undefined"==typeof atob)throw new Vi(Ui.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var xd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.fromBase64String=function(t){return yd(),new e(cf.fromBase64String(t))},e.fromUint8Array=function(t){return md(),new e(cf.fromUint8Array(t))},e.prototype.toBase64=function(){return yd(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return md(),this._delegate.toUint8Array()},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Wl),bd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){hf(t=zl(t,rf));var n=sf(t),i=t._freezeSettings(),r=new cl;return af(n,r,new hl(r,i.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){hf(t=zl(t,rf));var e=sf(t),n=t._freezeSettings(),i=new cl;return af(e,i,new ul(i,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Vi(Ui.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ya;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return vi(e,void 0,void 0,(function(){var e;return gi(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return wa.At()?(e=t+"main",[4,wa.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(kh(t._databaseId,t._persistenceKey))];case 1:return i.sent(),n.resolve(),[3,3];case 2:return e=i.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),wd=function(t){function e(e,n,i){var r=this;return(r=t.call(this,n)||this).na=i,r.INTERNAL={delete:function(){return r.terminate()}},e instanceof Pl||(r.sa=e),r}return pi(e,t),Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var i=(t=zl(t,jl))._getSettings();"firestore.googleapis.com"!==i.host&&i.host!==e&&Ti("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1}))}(this._delegate,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return vi(e,void 0,void 0,(function(){var e,n;return gi(this,(function(i){switch(i.label){case 0:return[4,wl(t)];case 1:return e=i.sent(),[4,Tl(t)];case 2:return n=i.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Ai(t);return e.Qr.delete(0),Lu(e)}(n))]}}))}))}))}(sf(zl(this._delegate,rf)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return vi(e,void 0,void 0,(function(){var e,n;return gi(this,(function(i){switch(i.label){case 0:return[4,wl(t)];case 1:return e=i.sent(),[4,Tl(t)];case 2:return n=i.sent(),[2,(e.setNetworkEnabled(!1),function(t){return vi(this,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return(e=Ai(t)).Qr.add(0),[4,Nu(e)];case 1:return n.sent(),e.jr.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(sf(zl(this._delegate,rf)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.na.enableMultiTabIndexedDbPersistence(this):this.na.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.na.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.sa&&(this.sa._removeServiceInstance("firestore"),this.sa._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(e,void 0,void 0,(function(){var e;return gi(this,(function(i){switch(i.label){case 0:return e=Bc,[4,El(t)];case 1:return[2,e.apply(void 0,[i.sent(),n])]}}))}))})),n.promise}(sf(zl(this._delegate,rf)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,i=new fl(e);return t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ai(t).Zr.add(e),e.next()},[4,Sl(t)];case 1:return[2,e.apply(void 0,[n.sent(),i])]}}))}))})),function(){i.Xo(),t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ai(t).Zr.delete(e)},[4,Sl(t)];case 1:return[2,e.apply(void 0,[n.sent(),i])]}}))}))}))}}(sf(t=zl(t,rf)),ef(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.sa)throw new Vi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.sa},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ld(this,Ql(this._delegate,t))}catch(t){throw Ad(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Cd(this,Zl(this._delegate,t))}catch(t){throw Ad(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new kd(this,function(t,e){if(t=zl(t,jl),Nl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ql(t,null,function(t){return new Br(zi.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Ad(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,i=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var n;return gi(this,(function(r){switch(r.label){case 0:return[4,function(t){return bl(t).then((function(t){return t.datastore}))}(t)];case 1:return n=r.sent(),new vl(t.asyncQueue,n,e,i).run(),[2]}}))}))})),i.promise}(sf(t),(function(n){return e(new gd(t,n))}))}(this._delegate,(function(n){return t(new Td(e,n))}))},e.prototype.batch=function(){var t=this;return sf(this._delegate),new Ed(new ud(this._delegate,(function(e){return pd(t._delegate,e)})))},e.prototype.loadBundle=function(t){throw new Vi(Ui.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Vi(Ui.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Wl),_d=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pi(e,t),e.prototype.convertBytes=function(t){return new xd(new cf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Cd.ia(e,this.firestore,null)},e}(od),Td=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this)._firestore=e,i._userDataWriter=new _d(e),i}return pi(e,t),e.prototype.get=function(t){var e=this,n=Nd(t);return this._delegate.get(n).then((function(t){return new Rd(e._firestore,new Xf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n._converter))}))},e.prototype.set=function(t,e,n){var i=Nd(t);return n?(Fl("Transaction.set",n),this._delegate.set(i,e,n)):this._delegate.set(i,e),this},e.prototype.update=function(t,e,n){for(var i,r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];var o=Nd(t);return 2===arguments.length?this._delegate.update(o,e):(i=this._delegate).update.apply(i,mi([o,e,n],r)),this},e.prototype.delete=function(t){var e=Nd(t);return this._delegate.delete(e),this},e}(Wl),Ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.set=function(t,e,n){var i=Nd(t);return n?(Fl("WriteBatch.set",n),this._delegate.set(i,e,n)):this._delegate.set(i,e),this},e.prototype.update=function(t,e,n){for(var i,r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];var o=Nd(t);return 2===arguments.length?this._delegate.update(o,e):(i=this._delegate).update.apply(i,mi([o,e,n],r)),this},e.prototype.delete=function(t){var e=Nd(t);return this._delegate.delete(e),this},e.prototype.commit=function(){return this._delegate.commit()},e}(Wl),Sd=function(t){function e(e,n,i){var r=this;return(r=t.call(this,i)||this)._firestore=e,r._userDataWriter=n,r}return pi(e,t),e.prototype.fromFirestore=function(t,e){var n=new Gf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Od(this._firestore,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},e.ra=function(t,n){var i=e.oa,r=i.get(t);r||(r=new WeakMap,i.set(t,r));var s=r.get(n);return s||(s=new e(t,new _d(t),n),r.set(n,s)),s},e}(Wl);Sd.oa=new WeakMap;var Cd=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this).firestore=e,i._userDataWriter=new _d(e),i}return pi(e,t),e.ca=function(t,n,i){if(t.length%2!=0)throw new Vi(Ui.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new Hl(n._delegate,i,new ji(t)))},e.ia=function(t,n,i){return new e(n,new Hl(n._delegate,i,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ld(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ld(this.firestore,Ql(this._delegate,t))}catch(t){throw Ad(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Wl&&(t=t._delegate),t instanceof Hl&&Jl(this._delegate,t)},e.prototype.set=function(t,e){e=Fl("DocumentReference.set",e);try{return function(t,e,n){t=zl(t,Hl);var i=zl(t.firestore,rf),r=ad(t._converter,e,n);return pd(i,[bf(xf(i),"setDoc",t._key,r,null!==t._converter,n).toMutation(t._key,Ts.none())])}(this._delegate,t,e)}catch(t){throw Ad(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];try{return 1===arguments.length?fd(this._delegate,t):fd.apply(void 0,mi([this._delegate,t,e],n))}catch(t){throw Ad(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return pd(zl((t=this._delegate).firestore,rf),[new Us(t._key,Ts.none())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=Id(e),r=Pd(e,(function(e){return new Rd(t.firestore,new Xf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))}));return dd(this._delegate,i,r)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zl(t,Hl);var e=zl(t.firestore,rf),n=sf(e),i=new ld(e);return function(t,e){var n=this,i=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var n;return gi(this,(function(r){switch(r.label){case 0:return n=function(t,e,n){return vi(this,void 0,void 0,(function(){var i,r;return gi(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Ai(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Kn.In(t,e)}))}(t,e)];case 1:return(r=s.sent())instanceof vr?n.resolve(r):r instanceof gr?n.resolve(null):n.reject(new Vi(Ui.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),r=ac(i,"Failed to get document '"+e+" from cache"),n.reject(r),[3,3];case 3:return[2]}}))}))},[4,_l(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,i])]}}))}))})),i.promise}(n,t._key).then((function(n){return new Xf(e,i,t._key,n,new zf(n instanceof vr&&n.hasLocalMutations,!0),t._converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zl(t,Hl);var e=zl(t.firestore,rf);return Cl(sf(e),t._key,{source:"server"}).then((function(n){return vd(e,t,n)}))}(this._delegate):function(t){t=zl(t,Hl);var e=zl(t.firestore,rf);return Cl(sf(e),t._key).then((function(n){return vd(e,t,n)}))}(this._delegate)).then((function(t){return new Rd(e.firestore,new Xf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate._converter))}))},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Sd.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(Wl);function Ad(t,e,n){return t.message=t.message.replace(e,n),t}function Id(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];if("object"==typeof i&&!ef(i))return i}return{}}function Pd(t,e){var n,i,r;return{next:function(t){r.next&&r.next(e(t))},error:null===(n=(r=ef(t[0])?t[0]:ef(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}var Rd=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this)._firestore=e,i}return pi(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Cd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._delegate.data(t)},e.prototype.get=function(t,e){return this._delegate.get(t,e)},e.prototype.isEqual=function(t){return Hf(this._delegate,t._delegate)},e}(Wl),Od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Rd),kd=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this).firestore=e,i._userDataWriter=new _d(e),i}return pi(e,t),e.prototype.where=function(t,n,i){try{return new e(this.firestore,Qf(this._delegate,function(t,e,n){var i=e,r=Yf("where",t);return new Zf(r,i,n)}(t,n,i)))}catch(t){throw Ad(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Qf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,i=Yf("orderBy",t);return new Jf(i,n)}(t,n)))}catch(t){throw Ad(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Qf(this._delegate,function(t){return Xl("limit",t),new $f("limit",t,"F")}(t)))}catch(t){throw Ad(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Qf(this._delegate,function(t){return Xl("limitToLast",t),new $f("limitToLast",t,"L")}(t)))}catch(t){throw Ad(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Qf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new td("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Ad(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Qf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new td("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Ad(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Qf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ed("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Ad(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Qf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ed("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Ad(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return $l(this._delegate,t._delegate)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zl(t,ql);var e=zl(t.firestore,rf),n=sf(e),i=new ld(e);return function(t,e){var n=this,i=new ya;return t.asyncQueue.enqueueAndForget((function(){return vi(n,void 0,void 0,(function(){var n;return gi(this,(function(r){switch(r.label){case 0:return n=function(t,e,n){return vi(this,void 0,void 0,(function(){var i,r,s,o,a;return gi(this,(function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),[4,Hh(t,e,!0)];case 1:return a=h.sent(),i=new Sc(e,a.jn),r=i.Io(a.documents),s=i.applyChanges(r,!1),n.resolve(s.snapshot),[3,3];case 2:return o=h.sent(),a=ac(o,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,_l(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,i])]}}))}))})),i.promise}(n,t._query).then((function(n){return new jf(e,i,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zl(t,ql);var e=zl(t.firestore,rf),n=sf(e),i=new ld(e);return Al(n,t._query,{source:"server"}).then((function(n){return new jf(e,i,t,n)}))}(this._delegate):function(t){t=zl(t,ql);var e=zl(t.firestore,rf),n=sf(e),i=new ld(e);return qf(t._query),Al(n,t._query).then((function(n){return new jf(e,i,t,n)}))}(this._delegate)).then((function(t){return new Dd(e.firestore,new jf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=Id(e),r=Pd(e,(function(e){return new Dd(t.firestore,new jf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return dd(this._delegate,i,r)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Sd.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(Wl),Md=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this)._firestore=e,i}return pi(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Od(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(Wl),Dd=function(t){function e(e,n){var i=this;return(i=t.call(this,n)||this)._firestore=e,i}return pi(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new kd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Od(t._firestore,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Md(e._firestore,t)}))},e.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(i){t.call(e,new Od(n._firestore,i))}))},e.prototype.isEqual=function(t){return Hf(this._delegate,t._delegate)},e}(Wl),Ld=function(t){function e(e,n){var i=this;return(i=t.call(this,e,n)||this).firestore=e,i._delegate=n,i}return pi(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Cd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Cd(this.firestore,void 0===t?Zl(this._delegate):Zl(this._delegate,t))}catch(t){throw Ad(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=zl(t.firestore,rf),i=Zl(t),r=ad(t._converter,e);return pd(n,[bf(xf(t.firestore),"addDoc",i._key,r,null!==t._converter,{}).toMutation(i._key,Ts.exists(!1))]).then((function(){return i}))}(this._delegate,t).then((function(t){return new Cd(e.firestore,t)}))},e.prototype.isEqual=function(t){return Jl(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Sd.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(kd);function Nd(t){return t instanceof Wl&&(t=t._delegate),zl(t,Hl)}var Fd=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(uf.bind.apply(uf,mi([void 0],e))))||this}return pi(e,t),e.documentId=function(){return new e(Gi.keyField().canonicalString())},e.prototype.isEqual=function(t){return t instanceof Wl&&(t=t._delegate),t instanceof uf&&this._delegate._internalPath.isEqual(t._internalPath)},e}(Wl),Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pi(e,t),e.serverTimestamp=function(){var t=new Tf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new wf("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ef("arrayUnion",t)}.apply(void 0,t);return i._methodName="FieldValue.arrayUnion",new e(i)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sf("arrayRemove",t)}.apply(void 0,t);return i._methodName="FieldValue.arrayRemove",new e(i)},e.increment=function(t){var n=function(t){return new Cf("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e}(Wl);var Ud,Vd,Yd=n(886),zd={Firestore:wd,GeoPoint:ff,Timestamp:Zi,Blob:xd,Transaction:Td,WriteBatch:Ed,DocumentReference:Cd,DocumentSnapshot:Rd,Query:kd,QueryDocumentSnapshot:Od,QuerySnapshot:Dd,CollectionReference:Ld,FieldPath:Fd,FieldValue:Bd,setLogLevel:function(t){var e;e=t,xi.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Yd.wA("firestore",(function(t){return function(t,e){return new wd(t,new rf(t,e),new bd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},zd)))})(Ud=r.Z),Ud.registerVersion("@firebase/firestore","2.2.1"),(Vd=wd).prototype.loadBundle=function(t){return function(t,e){var n=sf(t=zl(t,rf)),i=new nf;return function(t,e,n,i){var r=this,s=function(t,e){return function(t,e){return new dl(t,e)}(function(t,e){if(t instanceof Uint8Array)return ll(t,e);if(t instanceof ArrayBuffer)return ll(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Au(e));t.asyncQueue.enqueueAndForget((function(){return vi(r,void 0,void 0,(function(){var e;return gi(this,(function(n){switch(n.label){case 0:return e=ol,[4,El(t)];case 1:return e.apply(void 0,[n.sent(),s,i]),[2]}}))}))}))}(n,t._databaseId,e,i),i}(this._delegate,t)},Vd.prototype.namedQuery=function(t){var e,n,i=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return vi(n,void 0,void 0,(function(){var n;return gi(this,(function(i){switch(i.label){case 0:return n=function(t,e){var n=Ai(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.He.getNamedQuery(t,e)}))},[4,_l(t)];case 1:return[2,n.apply(void 0,[i.sent(),e])]}}))}))}))}(sf(e=zl(e,rf)),n).then((function(t){return t?new ql(e,null,t.query):null}))).then((function(t){return t?new kd(i,t):null}))};var Xd=function(t,e){return(Xd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Gd(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function jd(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}Object.create,Object.create;var Wd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hd=function(t){function e(n,i,r){var s=t.call(this,i)||this;return Object.setPrototypeOf(s,e.prototype),s.code=n,s.details=r,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Xd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),qd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Gd(this,void 0,void 0,(function(){var t;return jd(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Gd(this,void 0,void 0,(function(){return jd(this,(function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return Gd(this,void 0,void 0,(function(){var t,e;return jd(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Kd(t,e){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=e(t[i]));return n}var Qd,Zd,Jd,$d=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Kd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Kd(t,(function(t){return e.decode(t)})):t},t}(),tp=function(){function t(t,e,n,i,r){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.fetchImpl=r,this.serializer=new $d,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new qd(e,n),this.cancelAllRequests=new Promise((function(t){s.deleteService=function(){return t()}}));try{var o=new URL(i);this.customDomain=o.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(i){return n.call(t,i,e||{})}},t.prototype.postJSON=function(t,e,n){return Gd(this,void 0,void 0,(function(){var i,r;return jd(this,(function(s){switch(s.label){case 0:n["Content-Type"]="application/json",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return i=s.sent(),[3,4];case 3:return s.sent(),[2,{status:0,json:null}];case 4:r=null,s.label=5;case 5:return s.trys.push([5,7,,8]),[4,i.json()];case 6:return r=s.sent(),[3,8];case 7:return s.sent(),[3,8];case 8:return[2,{status:i.status,json:r}]}}))}))},t.prototype.call=function(t,e,n){return Gd(this,void 0,void 0,(function(){var i,r,s,o,a,h,u,c,l,f,d;return jd(this,(function(p){switch(p.label){case 0:return i=this._url(t),e=this.serializer.encode(e),r={data:e},s={},[4,this.contextProvider.getContext()];case 1:return(o=p.sent()).authToken&&(s.Authorization="Bearer "+o.authToken),o.instanceIdToken&&(s["Firebase-Instance-ID-Token"]=o.instanceIdToken),a=n.timeout||7e4,h=function(t){var e,n=new Promise((function(n,i){e=setTimeout((function(){i(new Hd("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),u=h.timer,c=h.promise,[4,Promise.race([ep(u,this.postJSON(i,r,s)),c,ep(u,this.cancelAllRequests)])];case 2:if(!(l=p.sent()))throw new Hd("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var i=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=i,s=void 0;try{var o=e&&e.error;if(o){var a=o.status;if("string"==typeof a){if(!Wd[a])return new Hd("internal","internal");i=Wd[a],r=a}var h=o.message;"string"==typeof h&&(r=h),void 0!==(s=o.details)&&(s=n.decode(s))}}catch(t){}return"ok"===i?null:new Hd(i,r,s)}(l.status,l.json,this.serializer))throw f;if(!l.json)throw new Hd("internal","Response is not valid JSON object.");if(void 0===(d=l.json.data)&&(d=l.json.result),void 0===d)throw new Hd("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function ep(t,e){return Gd(this,void 0,void 0,(function(){var n;return jd(this,(function(i){switch(i.label){case 0:return[4,e];case 1:return n=i.sent(),clearTimeout(t),[2,n]}}))}))}Qd=r.Z,Zd=fetch.bind(self),Jd={Functions:tp},Qd.INTERNAL.registerComponent(new Yd.wA("functions",(function(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("messaging");return new tp(i,r,s,n,Zd)}),"PUBLIC").setServiceProps(Jd).setMultipleInstances(!0)),r.Z.registerVersion("@firebase/functions","0.6.4");var np=function(){return(np=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function ip(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function rp(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function sp(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create;var op,ap=n(676),hp="w:0.4.22",up=((op={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',op["not-registered"]="Firebase Installation is not registered.",op["installation-not-found"]="Firebase Installation not found.",op["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',op["app-offline"]="Could not process request. Application offline.",op["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",op),cp=new o.LL("installations","Installations",up);function lp(t){return t instanceof o.ZR&&t.code.includes("request-failed")}function fp(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function dp(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function pp(t,e){return ip(this,void 0,void 0,(function(){var n,i;return rp(this,(function(r){switch(r.label){case 0:return[4,e.json()];case 1:return n=r.sent(),i=n.error,[2,cp.create("request-failed",{requestName:t,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})]}}))}))}function vp(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function gp(t,e){var n=e.refreshToken,i=vp(t);return i.append("Authorization",function(t){return"FIS_v2 "+t}(n)),i}function mp(t){return ip(this,void 0,void 0,(function(){var e;return rp(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function yp(t,e){var n=e.fid;return ip(this,void 0,void 0,(function(){var e,i,r,s,o,a;return rp(this,(function(h){switch(h.label){case 0:return e=fp(t),i=vp(t),r={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:hp},s={method:"POST",headers:i,body:JSON.stringify(r)},[4,mp((function(){return fetch(e,s)}))];case 1:return(o=h.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,{fid:(a=h.sent()).fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:dp(a.authToken)}];case 3:return[4,pp("Create Installation",o)];case 4:throw h.sent()}}))}))}function xp(t){return new Promise((function(e){setTimeout(e,t)}))}var bp=/^[cdef][\w-]{21}$/;function wp(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return bp.test(e)?e:""}catch(t){return""}}function _p(t){return t.appName+"!"+t.appId}var Tp=new Map;function Ep(t,e){var n=_p(t);Sp(n,e),function(t,e){var n=Ap();n&&n.postMessage({key:t,fid:e}),Ip()}(n,e)}function Sp(t,e){var n,i,r=Tp.get(t);if(r)try{for(var s=sp(r),o=s.next();!o.done;o=s.next())(0,o.value)(e)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}var Cp=null;function Ap(){return!Cp&&"BroadcastChannel"in self&&((Cp=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Sp(t.data.key,t.data.fid)}),Cp}function Ip(){0===Tp.size&&Cp&&(Cp.close(),Cp=null)}var Pp="firebase-installations-store",Rp=null;function Op(){return Rp||(Rp=(0,ap.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Pp)}}))),Rp}function kp(t,e){return ip(this,void 0,void 0,(function(){var n,i,r,s,o;return rp(this,(function(a){switch(a.label){case 0:return n=_p(t),[4,Op()];case 1:return i=a.sent(),r=i.transaction(Pp,"readwrite"),[4,(s=r.objectStore(Pp)).get(n)];case 2:return o=a.sent(),[4,s.put(e,n)];case 3:return a.sent(),[4,r.complete];case 4:return a.sent(),o&&o.fid===e.fid||Ep(t,e.fid),[2,e]}}))}))}function Mp(t){return ip(this,void 0,void 0,(function(){var e,n,i;return rp(this,(function(r){switch(r.label){case 0:return e=_p(t),[4,Op()];case 1:return n=r.sent(),[4,(i=n.transaction(Pp,"readwrite")).objectStore(Pp).delete(e)];case 2:return r.sent(),[4,i.complete];case 3:return r.sent(),[2]}}))}))}function Dp(t,e){return ip(this,void 0,void 0,(function(){var n,i,r,s,o,a;return rp(this,(function(h){switch(h.label){case 0:return n=_p(t),[4,Op()];case 1:return i=h.sent(),r=i.transaction(Pp,"readwrite"),[4,(s=r.objectStore(Pp)).get(n)];case 2:return o=h.sent(),void 0!==(a=e(o))?[3,4]:[4,s.delete(n)];case 3:return h.sent(),[3,6];case 4:return[4,s.put(a,n)];case 5:h.sent(),h.label=6;case 6:return[4,r.complete];case 7:return h.sent(),!a||o&&o.fid===a.fid||Ep(t,a.fid),[2,a]}}))}))}function Lp(t){return ip(this,void 0,void 0,(function(){var e,n,i;return rp(this,(function(r){switch(r.label){case 0:return[4,Dp(t,(function(n){var i=function(t){return Bp(t||{fid:wp(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(cp.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return ip(this,void 0,void 0,(function(){var n,i;return rp(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,7]),[4,yp(t,e)];case 1:return n=r.sent(),[2,kp(t,n)];case 2:return lp(i=r.sent())&&409===i.customData.serverCode?[4,Mp(t)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,kp(t,{fid:e.fid,registrationStatus:0})];case 5:r.sent(),r.label=6;case 6:throw i;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Np(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}))];case 1:return""!==(n=r.sent()).fid?[3,3]:(i={},[4,e]);case 2:return[2,(i.installationEntry=r.sent(),i)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Np(t){return ip(this,void 0,void 0,(function(){var e,n,i,r;return rp(this,(function(s){switch(s.label){case 0:return[4,Fp(t)];case 1:e=s.sent(),s.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,xp(100)];case 3:return s.sent(),[4,Fp(t)];case 4:return e=s.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Lp(t)];case 6:return n=s.sent(),i=n.installationEntry,(r=n.registrationPromise)?[2,r]:[2,i];case 7:return[2,e]}}))}))}function Fp(t){return Dp(t,(function(t){if(!t)throw cp.create("installation-not-found");return Bp(t)}))}function Bp(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Up(t,e){var n=t.appConfig,i=t.platformLoggerProvider;return ip(this,void 0,void 0,(function(){var t,r,s,o,a,h;return rp(this,(function(u){switch(u.label){case 0:return t=function(t,e){var n=e.fid;return fp(t)+"/"+n+"/authTokens:generate"}(n,e),r=gp(n,e),(s=i.getImmediate({optional:!0}))&&r.append("x-firebase-client",s.getPlatformInfoString()),o={installation:{sdkVersion:hp}},a={method:"POST",headers:r,body:JSON.stringify(o)},[4,mp((function(){return fetch(t,a)}))];case 1:return(h=u.sent()).ok?[4,h.json()]:[3,3];case 2:return[2,dp(u.sent())];case 3:return[4,pp("Generate Auth Token",h)];case 4:throw u.sent()}}))}))}function Vp(t,e){return void 0===e&&(e=!1),ip(this,void 0,void 0,(function(){var n,i,r;return rp(this,(function(s){switch(s.label){case 0:return[4,Dp(t.appConfig,(function(i){if(!zp(i))throw cp.create("not-registered");var r,s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(r)))return i;if(1===s.requestStatus)return n=function(t,e){return ip(this,void 0,void 0,(function(){var n,i;return rp(this,(function(r){switch(r.label){case 0:return[4,Yp(t.appConfig)];case 1:n=r.sent(),r.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,xp(100)];case 3:return r.sent(),[4,Yp(t.appConfig)];case 4:return n=r.sent(),[3,2];case 5:return 0===(i=n.authToken).requestStatus?[2,Vp(t,e)]:[2,i]}}))}))}(t,e),i;if(!navigator.onLine)throw cp.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return np(np({},t),{authToken:e})}(i);return n=function(t,e){return ip(this,void 0,void 0,(function(){var n,i,r;return rp(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,8]),[4,Up(t,e)];case 1:return n=s.sent(),r=np(np({},e),{authToken:n}),[4,kp(t.appConfig,r)];case 2:return s.sent(),[2,n];case 3:return!lp(i=s.sent())||401!==i.customData.serverCode&&404!==i.customData.serverCode?[3,5]:[4,Mp(t.appConfig)];case 4:return s.sent(),[3,7];case 5:return r=np(np({},e),{authToken:{requestStatus:0}}),[4,kp(t.appConfig,r)];case 6:s.sent(),s.label=7;case 7:throw i;case 8:return[2]}}))}))}(t,o),o}))];case 1:return i=s.sent(),n?[4,n]:[3,3];case 2:return r=s.sent(),[3,4];case 3:r=i.authToken,s.label=4;case 4:return[2,r]}}))}))}function Yp(t){return Dp(t,(function(t){if(!zp(t))throw cp.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?np(np({},t),{authToken:{requestStatus:0}}):t}))}function zp(t){return void 0!==t&&2===t.registrationStatus}function Xp(t){return ip(this,void 0,void 0,(function(){var e;return rp(this,(function(n){switch(n.label){case 0:return[4,Lp(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Gp(t,e){return ip(this,void 0,void 0,(function(){var n,i,r,s;return rp(this,(function(o){switch(o.label){case 0:return n=function(t,e){var n=e.fid;return fp(t)+"/"+n}(t,e),i=gp(t,e),r={method:"DELETE",headers:i},[4,mp((function(){return fetch(n,r)}))];case 1:return(s=o.sent()).ok?[3,3]:[4,pp("Delete Installation",s)];case 2:throw o.sent();case 3:return[2]}}))}))}function jp(t){return cp.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new Yd.wA("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw jp("App Configuration");if(!t.name)throw jp("App Name");try{for(var i=sp(["projectId","apiKey","appId"]),r=i.next();!r.done;r=i.next()){var s=r.value;if(!t.options[s])throw jp(s)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return ip(this,void 0,void 0,(function(){var e,n,i;return rp(this,(function(r){switch(r.label){case 0:return[4,Lp(t.appConfig)];case 1:return e=r.sent(),n=e.installationEntry,(i=e.registrationPromise)?i.catch(console.error):Vp(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),ip(this,void 0,void 0,(function(){return rp(this,(function(n){switch(n.label){case 0:return[4,Xp(t.appConfig)];case 1:return n.sent(),[4,Vp(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return ip(this,void 0,void 0,(function(){var e,n;return rp(this,(function(i){switch(i.label){case 0:return[4,Dp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=i.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw cp.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw cp.create("app-offline");case 3:return[4,Gp(e,n)];case 4:return i.sent(),[4,Mp(e)];case 5:i.sent(),i.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){Ap();var n=_p(t),i=Tp.get(n);i||(i=new Set,Tp.set(n,i)),i.add(e)}(n,e),function(){!function(t,e){var n=_p(t),i=Tp.get(n);i&&(i.delete(e),0===i.size&&Tp.delete(n),Ip())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.22")}(r.Z);var Wp,Hp=function(){return(Hp=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function qp(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function Kp(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Qp(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create;var Zp,Jp=((Wp={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Wp["only-available-in-window"]="This method is available in a Window context.",Wp["only-available-in-sw"]="This method is available in a service worker context.",Wp["permission-default"]="The notification permission was not granted and dismissed instead.",Wp["permission-blocked"]="The notification permission was not granted and blocked instead.",Wp["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Wp["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Wp["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Wp["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Wp["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Wp["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Wp["token-update-no-token"]="FCM returned no token when updating the user to push.",Wp["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Wp["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Wp["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Wp["invalid-vapid-key"]="The public VAPID key must be a string.",Wp["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Wp),$p=new o.LL("messaging","Messaging",Jp),tv="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function ev(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nv(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Zp||(Zp={}));var iv="fcm_token_details_db",rv="fcm_token_object_Store";function sv(t){return qp(this,void 0,void 0,(function(){var e,n=this;return Kp(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!i.sent().map((function(t){return t.name})).includes(iv))return[2,null];i.label=2;case 2:return e=null,[4,(0,ap.openDb)(iv,5,(function(i){return qp(n,void 0,void 0,(function(){var n,r,s,o;return Kp(this,(function(a){switch(a.label){case 0:return i.oldVersion<2?[2]:i.objectStoreNames.contains(rv)?[4,(n=i.transaction.objectStore(rv)).index("fcmSenderId").get(t)]:[2];case 1:return r=a.sent(),[4,n.clear()];case 2:if(a.sent(),!r)return[2];if(2===i.oldVersion){if(!(s=r).auth||!s.p256dh||!s.endpoint)return[2];e={token:s.fcmToken,createTime:null!==(o=s.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:s.auth,p256dh:s.p256dh,endpoint:s.endpoint,swScope:s.swScope,vapidKey:"string"==typeof s.vapidKey?s.vapidKey:ev(s.vapidKey)}}}else(3===i.oldVersion||4===i.oldVersion)&&(e={token:(s=r).fcmToken,createTime:s.createTime,subscriptionOptions:{auth:ev(s.auth),p256dh:ev(s.p256dh),endpoint:s.endpoint,swScope:s.swScope,vapidKey:ev(s.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,(0,ap.deleteDb)(iv)];case 4:return i.sent(),[4,(0,ap.deleteDb)("fcm_vapid_details_db")];case 5:return i.sent(),[4,(0,ap.deleteDb)("undefined")];case 6:return i.sent(),[2,ov(e)?e:null]}}))}))}function ov(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var av="firebase-messaging-store",hv=null;function uv(){return hv||(hv=(0,ap.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(av)}}))),hv}function cv(t){return qp(this,void 0,void 0,(function(){var e,n,i;return Kp(this,(function(r){switch(r.label){case 0:return e=dv(t),[4,uv()];case 1:return[4,r.sent().transaction(av).objectStore(av).get(e)];case 2:return(n=r.sent())?[2,n]:[3,3];case 3:return[4,sv(t.appConfig.senderId)];case 4:return(i=r.sent())?[4,lv(t,i)]:[3,6];case 5:return r.sent(),[2,i];case 6:return[2]}}))}))}function lv(t,e){return qp(this,void 0,void 0,(function(){var n,i,r;return Kp(this,(function(s){switch(s.label){case 0:return n=dv(t),[4,uv()];case 1:return i=s.sent(),[4,(r=i.transaction(av,"readwrite")).objectStore(av).put(e,n)];case 2:return s.sent(),[4,r.complete];case 3:return s.sent(),[2,e]}}))}))}function fv(t){return qp(this,void 0,void 0,(function(){var e,n,i;return Kp(this,(function(r){switch(r.label){case 0:return e=dv(t),[4,uv()];case 1:return n=r.sent(),[4,(i=n.transaction(av,"readwrite")).objectStore(av).delete(e)];case 2:return r.sent(),[4,i.complete];case 3:return r.sent(),[2]}}))}))}function dv(t){return t.appConfig.appId}function pv(t,e){return qp(this,void 0,void 0,(function(){var n,i,r,s,o,a;return Kp(this,(function(h){switch(h.label){case 0:return[4,yv(t)];case 1:n=h.sent(),i=xv(e),r={method:"POST",headers:n,body:JSON.stringify(i)},h.label=2;case 2:return h.trys.push([2,5,,6]),[4,fetch(mv(t.appConfig),r)];case 3:return[4,h.sent().json()];case 4:return s=h.sent(),[3,6];case 5:throw o=h.sent(),$p.create("token-subscribe-failed",{errorInfo:o});case 6:if(s.error)throw a=s.error.message,$p.create("token-subscribe-failed",{errorInfo:a});if(!s.token)throw $p.create("token-subscribe-no-token");return[2,s.token]}}))}))}function vv(t,e){return qp(this,void 0,void 0,(function(){var n,i,r,s,o,a;return Kp(this,(function(h){switch(h.label){case 0:return[4,yv(t)];case 1:n=h.sent(),i=xv(e.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(i)},h.label=2;case 2:return h.trys.push([2,5,,6]),[4,fetch(mv(t.appConfig)+"/"+e.token,r)];case 3:return[4,h.sent().json()];case 4:return s=h.sent(),[3,6];case 5:throw o=h.sent(),$p.create("token-update-failed",{errorInfo:o});case 6:if(s.error)throw a=s.error.message,$p.create("token-update-failed",{errorInfo:a});if(!s.token)throw $p.create("token-update-no-token");return[2,s.token]}}))}))}function gv(t,e){return qp(this,void 0,void 0,(function(){var n,i,r,s,o;return Kp(this,(function(a){switch(a.label){case 0:return[4,yv(t)];case 1:n=a.sent(),i={method:"DELETE",headers:n},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(mv(t.appConfig)+"/"+e,i)];case 3:return[4,a.sent().json()];case 4:if((r=a.sent()).error)throw s=r.error.message,$p.create("token-unsubscribe-failed",{errorInfo:s});return[3,6];case 5:throw o=a.sent(),$p.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}}))}))}function mv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function yv(t){var e=t.appConfig,n=t.installations;return qp(this,void 0,void 0,(function(){var t;return Kp(this,(function(i){switch(i.label){case 0:return[4,n.getToken()];case 1:return t=i.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function xv(t){var e=t.p256dh,n=t.auth,i=t.endpoint,r=t.vapidKey,s={web:{endpoint:i,auth:n,p256dh:e}};return r!==tv&&(s.web.applicationPubKey=r),s}function bv(t,e,n){return qp(this,void 0,void 0,(function(){var i,r,s,o;return Kp(this,(function(a){switch(a.label){case 0:if("granted"!==Notification.permission)throw $p.create("permission-blocked");return[4,Ev(e,n)];case 1:return i=a.sent(),[4,cv(t)];case 2:return r=a.sent(),s={vapidKey:n,swScope:e.scope,endpoint:i.endpoint,auth:ev(i.getKey("auth")),p256dh:ev(i.getKey("p256dh"))},r?[3,3]:[2,Tv(t,s)];case 3:if(h=r.subscriptionOptions,c=(u=s).vapidKey===h.vapidKey,l=u.endpoint===h.endpoint,f=u.auth===h.auth,d=u.p256dh===h.p256dh,c&&l&&f&&d)return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,gv(t,r.token)];case 5:return a.sent(),[3,7];case 6:return o=a.sent(),console.warn(o),[3,7];case 7:return[2,Tv(t,s)];case 8:return Date.now()>=r.createTime+6048e5?[2,_v({token:r.token,createTime:Date.now(),subscriptionOptions:s},t,e)]:[2,r.token];case 9:return[2]}var h,u,c,l,f,d}))}))}function wv(t,e){return qp(this,void 0,void 0,(function(){var n,i;return Kp(this,(function(r){switch(r.label){case 0:return[4,cv(t)];case 1:return(n=r.sent())?[4,gv(t,n.token)]:[3,4];case 2:return r.sent(),[4,fv(t)];case 3:r.sent(),r.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(i=r.sent())?[2,i.unsubscribe()]:[2,!0]}}))}))}function _v(t,e,n){return qp(this,void 0,void 0,(function(){var i,r,s;return Kp(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,5]),[4,vv(e,t)];case 1:return i=o.sent(),r=Hp(Hp({},t),{token:i,createTime:Date.now()}),[4,lv(e,r)];case 2:return o.sent(),[2,i];case 3:return s=o.sent(),[4,wv(e,n)];case 4:throw o.sent(),s;case 5:return[2]}}))}))}function Tv(t,e){return qp(this,void 0,void 0,(function(){var n,i;return Kp(this,(function(r){switch(r.label){case 0:return[4,pv(t,e)];case 1:return n=r.sent(),i={token:n,createTime:Date.now(),subscriptionOptions:e},[4,lv(t,i)];case 2:return r.sent(),[2,i.token]}}))}))}function Ev(t,e){return qp(this,void 0,void 0,(function(){var n;return Kp(this,(function(i){switch(i.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=i.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nv(e)})]}}))}))}function Sv(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Cv(t){return new Promise((function(e){setTimeout(e,t)}))}var Av=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw $p.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return qp(this,void 0,void 0,(function(){var n;return Kp(this,(function(i){switch(i.label){case 0:return this.vapidKey?[3,2]:[4,cv(this.firebaseDependencies)];case 1:n=i.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:tv,i.label=2;case 2:return[2,bv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return wv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw $p.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw $p.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw $p.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw $p.create("only-available-in-window")},t.prototype.onMessage=function(){throw $p.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw $p.create("only-available-in-window")},t.prototype.onPush=function(t){return qp(this,void 0,void 0,(function(){var e,n,i,r;return Kp(this,(function(s){switch(s.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,Ov()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=s.sent())?[2,Rv(n,e)]:(i=!1,e.notification?[4,kv(Iv(e))]:[3,3]);case 2:s.sent(),i=!0,s.label=3;case 3:return!0===i&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(r=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var i=e.notification.body;i&&(t.notification.body=i);var r=e.notification.image;r&&(t.notification.image=r)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var i=e.fcmOptions.analytics_label;i&&(t.fcmOptions.analyticsLabel=i)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(r):this.bgMessageHandler.next(r)),[4,Cv(1e3)]);case 4:return s.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return qp(this,void 0,void 0,(function(){var i;return Kp(this,(function(r){switch(r.label){case 0:return t.newSubscription?[3,2]:[4,wv(this.firebaseDependencies,self.registration)];case 1:return r.sent(),[2];case 2:return[4,cv(this.firebaseDependencies)];case 3:return i=r.sent(),[4,wv(this.firebaseDependencies,self.registration)];case 4:return r.sent(),[4,bv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==i?void 0:i.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:tv)];case 5:return r.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return qp(this,void 0,void 0,(function(){var i,r,s,o,a;return Kp(this,(function(h){switch(h.label){case 0:return(i=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(r=function(t){var e,n,i,r=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(i=t.notification)||void 0===i?void 0:i.click_action;return r||(Sv(t.data)?self.location.origin:null)}(i))?(s=new URL(r,self.location.href),o=new URL(self.location.origin),s.host!==o.host?[2]:[4,Pv(s)]):[2]):[2];case 1:return(a=h.sent())?[3,4]:[4,self.clients.openWindow(r)];case 2:return a=h.sent(),[4,Cv(3e3)];case 3:return h.sent(),[3,6];case 4:return[4,a.focus()];case 5:a=h.sent(),h.label=6;case 6:return a?(i.messageType=Zp.NOTIFICATION_CLICKED,i.isFirebaseMessaging=!0,[2,a.postMessage(i)]):[2]}}))}))},t}();function Iv(t){var e,n=Hp({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function Pv(t){return qp(this,void 0,void 0,(function(){var e,n,i,r,s,o,a;return Kp(this,(function(h){switch(h.label){case 0:return[4,Ov()];case 1:e=h.sent();try{for(n=Qp(e),i=n.next();!i.done;i=n.next())if(r=i.value,s=new URL(r.url,self.location.href),t.host===s.host)return[2,r]}catch(t){o={error:t}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return[2,null]}}))}))}function Rv(t,e){var n,i;e.isFirebaseMessaging=!0,e.messageType=Zp.PUSH_RECEIVED;try{for(var r=Qp(t),s=r.next();!s.done;s=r.next())s.value.postMessage(e)}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}function Ov(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function kv(t){var e,n=t.actions,i=Notification.maxActions;return n&&i&&n.length>i&&console.warn("This browser only supports "+i+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Mv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return qp(this,void 0,void 0,(function(){var e,n;return Kp(this,(function(i){switch(i.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Zp.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),Sv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return qp(this,void 0,void 0,(function(){return Kp(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw $p.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,bv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return qp(this,void 0,void 0,(function(){return Kp(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=tv),[2]}))}))},t.prototype.updateSwReg=function(t){return qp(this,void 0,void 0,(function(){return Kp(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw $p.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return qp(this,void 0,void 0,(function(){var t,e;return Kp(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),$p.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return qp(this,void 0,void 0,(function(){return Kp(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,wv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return qp(this,void 0,void 0,(function(){var t;return Kp(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?$p.create("permission-blocked"):$p.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw $p.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw $p.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw $p.create("invalid-sw-registration");if(this.swRegistration)throw $p.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw $p.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw $p.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return qp(this,void 0,void 0,(function(){var n;return Kp(this,(function(i){switch(i.label){case 0:return n=function(t){switch(t){case Zp.NOTIFICATION_CLICKED:return"notification_open";case Zp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return i.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Dv(t){return $p.create("missing-app-config-values",{valueName:t})}var Lv={isSupported:Nv};function Nv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.Z.INTERNAL.registerComponent(new Yd.wA("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Dv("App Configuration Object");if(!t.name)throw Dv("App Name");var i=t.options;try{for(var r=Qp(["projectId","apiKey","appId","messagingSenderId"]),s=r.next();!s.done;s=r.next()){var o=s.value;if(!i[o])throw Dv(o)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:i.projectId,apiKey:i.apiKey,appId:i.appId,senderId:i.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Nv())throw $p.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Av(n):new Mv(n)}),"PUBLIC").setServiceProps(Lv));var Fv=function(t,e){return(Fv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},Bv=function(){return(Bv=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function Uv(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function Vv(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Yv(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}Object.create,Object.create;var zv="firebasestorage.googleapis.com",Xv=function(t){function e(n,i){var r=t.call(this,Gv(n),"Firebase Storage: "+i+" ("+Gv(n)+")")||this;return r.customData={serverResponse:null},Object.setPrototypeOf(r,e.prototype),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Fv(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._codeEquals=function(t){return Gv(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(o.ZR);function Gv(t){return"storage/"+t}function jv(){return new Xv("unknown","An unknown error occurred, please check the error payload for server response.")}function Wv(){return new Xv("canceled","User canceled the upload/download.")}function Hv(){return new Xv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function qv(t){return new Xv("invalid-argument",t)}function Kv(){return new Xv("app-deleted","The Firebase app was deleted.")}function Qv(t){return new Xv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zv(t,e){return new Xv("invalid-format","String does not match format '"+t+"': "+e)}function Jv(t){throw new Xv("internal-error","Internal error: "+t)}var $v={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},tg=function(t,e){this.data=t,this.contentType=e||null};function eg(t,e){switch(t){case $v.RAW:return new tg(ng(e));case $v.BASE64:case $v.BASE64URL:return new tg(ig(t,e));case $v.DATA_URL:return new tg((n=new sg(e)).base64?ig($v.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw Zv($v.DATA_URL,"Malformed data URL.")}return ng(e)}(n.rest),new sg(e).contentType)}var n;throw jv()}function ng(t){for(var e=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(i=65536|(1023&i)<<10|1023&t.charCodeAt(++n),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function ig(t,e){switch(t){case $v.BASE64:var n=-1!==e.indexOf("-"),i=-1!==e.indexOf("_");if(n||i)throw Zv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case $v.BASE64URL:var r=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(r||s)throw Zv(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=atob(e)}catch(e){throw Zv(t,"Invalid character found")}for(var a=new Uint8Array(o.length),h=0;h<o.length;h++)a[h]=o.charCodeAt(h);return a}var rg,sg=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Zv($v.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,i,r=e[1]||null;null!=r&&(this.base64=(i=";base64",(n=r).length>=i.length&&n.substring(n.length-i.length)===i),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)},og={STATE_CHANGED:"state_changed"},ag={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function hg(t){switch(t){case"running":case"pausing":case"canceling":return ag.RUNNING;case"paused":return ag.PAUSED;case"success":return ag.SUCCESS;case"canceled":return ag.CANCELED;case"error":default:return ag.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(rg||(rg={}));var ug=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=rg.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=rg.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=rg.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,i){if(this.sent_)throw Jv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(var r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Jv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Jv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Jv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),cg=function(){function t(){}return t.prototype.createXhrIo=function(){return new ug},t}(),lg=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw new Xv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}for(var o=zv.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:s}],h=0;h<a.length;h++){var u=a[h],c=u.regex.exec(e);if(c){var l=c[u.indices.bucket],f=c[u.indices.path];f||(f=""),n=new t(l,f),u.postModify(n);break}}if(null==n)throw function(t){return new Xv("invalid-url","Invalid URL '"+t+"'.")}(e);return n},t}(),fg=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function dg(t){return"string"==typeof t||t instanceof String}function pg(t){return vg()&&t instanceof Blob}function vg(){return"undefined"!=typeof Blob}function gg(t,e,n,i){if(i<e)throw qv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(i>n)throw qv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function mg(t){return"https://"+zv+"/v0"+t}function yg(t){var e=encodeURIComponent,n="?";for(var i in t)t.hasOwnProperty(i)&&(n=n+(e(i)+"=")+e(t[i])+"&");return n.slice(0,-1)}var xg=function(){function t(t,e,n,i,r,s,o,a,h,u,c){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=h,this.pool_=c,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var i,r=t.resolve_,s=t.reject_,o=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(o,o.getResponseText());!function(t){return void 0!==t}(a)?r():r(a)}catch(t){s(t)}else null!==o?((i=jv()).serverResponse=o.getResponseText(),t.errorCallback_?s(t.errorCallback_(o,i)):s(i)):n.canceled?s(i=t.appDelete_?Kv():Wv()):s(i=new Xv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new bg(!1,null,!0)):this.backoffId_=function(e,n,i){var r=1,s=null,o=!1,a=0;function h(){return 2===a}var u=!1;function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u||(u=!0,n.apply(null,t))}function l(e){s=setTimeout((function(){s=null,function(e,n){if(n)e(!1,new bg(!1,null,!0));else{var i=t.pool_.createXhrIo();t.pendingXhr_=i,null!==t.progressCallback_&&i.addUploadProgressListener(r),i.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(r),t.pendingXhr_=null;var i=(n=n).getErrorCode()===rg.NO_ERROR,s=n.getStatus();if(i&&!t.isRetryStatusCode_(s)){var o=-1!==t.successCodes_.indexOf(s);e(!0,new bg(o,n))}else{var a=n.getErrorCode()===rg.ABORT;e(!1,new bg(!1,null,a))}}))}function r(e){var n=e.loaded,i=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,i)}}(f,h())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.call.apply(c,Yv([null,t],e));else{var i;h()||o?c.call.apply(c,Yv([null,t],e)):(r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),l(i))}}var d=!1;function p(t){d||(d=!0,u||(null!==s?(t||(a=2),clearTimeout(s),l(0)):t||(a=1)))}return l(0),setTimeout((function(){o=!0,p(!0)}),i),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),i=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||i},t}(),bg=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function wg(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function _g(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wg();if(void 0!==n){for(var i=new n,r=0;r<t.length;r++)i.append(t[r]);return i.getBlob()}if(vg())return new Blob(t);throw new Xv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var Tg=function(){function t(t,e){var n=0,i="";pg(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(pg(this.data_)){var i=(r=this.data_,s=e,o=n,r.webkitSlice?r.webkitSlice(s,o):r.mozSlice?r.mozSlice(s,o):r.slice?r.slice(s,o):null);return null===i?null:new t(i)}var r,s,o;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(vg()){var i=e.map((function(e){return e instanceof t?e.data_:e}));return new t(_g.apply(null,i))}var r=e.map((function(t){return dg(t)?eg($v.RAW,t).data:t.data_})),s=0;r.forEach((function(t){s+=t.byteLength}));var o=new Uint8Array(s),a=0;return r.forEach((function(t){for(var e=0;e<t.length;e++)o[a++]=t[e]})),new t(o,!0)},t.prototype.uploadData=function(){return this.data_},t}();function Eg(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function Sg(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Cg(t,e){return e}var Ag=function(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||Cg},Ig=null;function Pg(){if(Ig)return Ig;var t=[];t.push(new Ag("bucket")),t.push(new Ag("generation")),t.push(new Ag("metageneration")),t.push(new Ag("name","fullPath",!0));var e=new Ag("name");e.xform=function(t,e){return function(t){return!dg(t)||t.length<2?t:Sg(t)}(e)},t.push(e);var n=new Ag("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Ag("timeCreated")),t.push(new Ag("updated")),t.push(new Ag("md5Hash",null,!0)),t.push(new Ag("cacheControl",null,!0)),t.push(new Ag("contentDisposition",null,!0)),t.push(new Ag("contentEncoding",null,!0)),t.push(new Ag("contentLanguage",null,!0)),t.push(new Ag("contentType",null,!0)),t.push(new Ag("metadata","customMetadata",!0)),Ig=t}function Rg(t,e,n){var i=Eg(e);return null===i?null:function(t,e,n){for(var i={type:"file"},r=n.length,s=0;s<r;s++){var o=n[s];i[o.local]=o.xform(i,e[o.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,i=t.fullPath,r=new lg(n,i);return e._makeStorageReference(r)}})}(i,t),i}(t,i,n)}function Og(t,e){for(var n={},i=e.length,r=0;r<i;r++){var s=e[r];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var kg=function(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Mg(t){if(!t)throw jv()}function Dg(t,e){return function(n,i){var r=Rg(t,i,e);return Mg(null!==r),r}}function Lg(t){return function(e,n){var i,r,s;return 401===e.getStatus()?i=new Xv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,i=new Xv("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=t.path,i=new Xv("unauthorized","User does not have permission to access '"+r+"'.")):i=n,i.serverResponse=n.serverResponse,i}}function Ng(t){var e=Lg(t);return function(n,i){var r,s=e(n,i);return 404===n.getStatus()&&(r=t.path,s=new Xv("object-not-found","Object '"+r+"' does not exist.")),s.serverResponse=i.serverResponse,s}}function Fg(t,e,n){var i=mg(e.fullServerUrl()),r=t.maxOperationRetryTime,s=new kg(i,"GET",Dg(t,n),r);return s.errorHandler=Ng(e),s}function Bg(t,e,n,i,r){var s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),i&&(s.pageToken=i),r&&(s.maxResults=r);var o=mg(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,h=new kg(o,"GET",function(t,e){return function(n,i){var r=function(t,e,n){var i=Eg(n);return null===i?null:function(t,e,n){var i={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var r=0,s=n.prefixes;r<s.length;r++){var o=s[r].replace(/\/$/,""),a=t._makeStorageReference(new lg(e,o));i.prefixes.push(a)}if(n.items)for(var h=0,u=n.items;h<u.length;h++){var c=u[h];a=t._makeStorageReference(new lg(e,c.name)),i.items.push(a)}return i}(t,e,i)}(t,e,i);return Mg(null!==r),r}}(t,e.bucket),a);return h.urlParams=s,h.errorHandler=Lg(e),h}function Ug(t,e,n){var i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),i}var Vg=function(t,e,n,i){this.current=t,this.total=e,this.finalized=!!n,this.metadata=i||null};function Yg(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Mg(!1)}return Mg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var zg=262144;var Xg=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var i=t;this.next=i.next,this.error=i.error,this.complete=i.complete}};function Gg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var jg=function(){function t(t,e,n){var i=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Pg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){i._request=void 0,i._chunkMultiplier=1,t._codeEquals("canceled")?(i._needToFetchStatus=!0,i.completeTransitions_()):(i._error=t,i._transition("error"))},this._metadataErrorHandler=function(t){i._request=void 0,t._codeEquals("canceled")?i.completeTransitions_():(i._error=t,i._transition("error"))},this._promise=new Promise((function(t,e){i._resolve=t,i._reject=e,i._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage._getAuthToken().then((function(n){switch(e._state){case"running":t(n);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,i,r){var s=e.bucketOnlyServerUrl(),o=Ug(e,i,r),a={name:o.fullPath},h=mg(s),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":i.size(),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},c=Og(o,n),l=t.maxUploadRetryTime,f=new kg(h,"POST",(function(t){var e;Yg(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Mg(!1)}return Mg(dg(e)),e}),l);return f.urlParams=a,f.headers=u,f.body=c,f.errorHandler=Lg(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(n,e);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var i=function(t,e,n,i){var r=t.maxUploadRetryTime,s=new kg(n,"POST",(function(t){var e=Yg(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Mg(!1)}n||Mg(!1);var r=Number(n);return Mg(!isNaN(r)),new Vg(r,i.size(),"final"===e)}),r);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=Lg(e),s}(t._ref.storage,t._ref._location,e,t._blob),r=t._ref.storage._makeRequest(i,n);t._request=r,r.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=zg*this._chunkMultiplier,n=new Vg(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((function(r){var s;try{s=function(t,e,n,i,r,s,o,a){var h=new Vg(0,0);if(o?(h.current=o.current,h.total=o.total):(h.current=0,h.total=i.size()),i.size()!==h.total)throw new Xv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var u=h.total-h.current,c=u;r>0&&(c=Math.min(c,r));var l=h.current,f=l+c,d={"X-Goog-Upload-Command":c===u?"upload, finalize":"upload","X-Goog-Upload-Offset":h.current},p=i.slice(l,f);if(null===p)throw Hv();var v=e.maxUploadRetryTime,g=new kg(n,"POST",(function(t,n){var r,o=Yg(t,["active","final"]),a=h.current+c,u=i.size();return r="final"===o?Dg(e,s)(t,n):null,new Vg(a,u,"final"===o,r)}),v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=a||null,g.errorHandler=Lg(t),g}(t._ref._location,t._ref.storage,i,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var o=t._ref.storage._makeRequest(s,r);t._request=o,o.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){zg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=Fg(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(n,e);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,i,r){var s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;var h=Ug(e,i,r),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Og(h,n)+"\r\n--"+a+"\r\nContent-Type: "+h.contentType+"\r\n\r\n",c="\r\n--"+a+"--",l=Tg.getBlob(u,i,c);if(null===l)throw Hv();var f={name:h.fullPath},d=mg(s),p=t.maxUploadRetryTime,v=new kg(d,"POST",Dg(t,n),p);return v.urlParams=f,v.headers=o,v.body=l.uploadData(),v.errorHandler=Lg(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(n,e);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=Wv(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=hg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,i){var r=this,s=new Xg(e,n,i);return this._addObserver(s),function(){r._removeObserver(s)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(hg(this._state)){case ag.SUCCESS:Gg(this._resolve.bind(null,this.snapshot))();break;case ag.CANCELED:case ag.ERROR:Gg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(hg(this._state)){case ag.RUNNING:case ag.PAUSED:t.next&&Gg(t.next.bind(t,this.snapshot))();break;case ag.SUCCESS:t.complete&&Gg(t.complete.bind(t))();break;case ag.CANCELED:case ag.ERROR:t.error&&Gg(t.error.bind(t,this._error))();break;default:t.error&&Gg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),Wg=function(){function t(t,e){this._service=t,this._location=e instanceof lg?e:lg.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new lg(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Sg(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new lg(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Qv(t)},t}();function Hg(t){var e={prefixes:[],items:[]};return qg(t,e).then((function(){return e}))}function qg(t,e,n){return Uv(this,void 0,void 0,(function(){var i,r,s;return Vv(this,(function(o){switch(o.label){case 0:return[4,Kg(t,{pageToken:n})];case 1:return i=o.sent(),(r=e.prefixes).push.apply(r,i.prefixes),(s=e.items).push.apply(s,i.items),null==i.nextPageToken?[3,3]:[4,qg(t,e,i.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function Kg(t,e){return Uv(this,void 0,void 0,(function(){var n,i,r;return Vv(this,(function(s){switch(s.label){case 0:return null!=e&&"number"==typeof e.maxResults&&gg("options.maxResults",1,1e3,e.maxResults),[4,t.storage._getAuthToken()];case 1:return n=s.sent(),i=e||{},r=Bg(t.storage,t._location,"/",i.pageToken,i.maxResults),[2,t.storage._makeRequest(r,n).getPromise()]}}))}))}function Qg(t){return Uv(this,void 0,void 0,(function(){var e,n;return Vv(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage._getAuthToken()];case 1:return e=i.sent(),n=function(t,e,n){var i=mg(e.fullServerUrl()),r=t.maxOperationRetryTime,s=new kg(i,"GET",function(t,e){return function(n,i){var r=Rg(t,i,e);return Mg(null!==r),function(t,e){var n=Eg(e);if(null===n)return null;if(!dg(n.downloadTokens))return null;var i=n.downloadTokens;if(0===i.length)return null;var r=encodeURIComponent;return i.split(",").map((function(e){var n=t.bucket,i=t.fullPath;return mg("/b/"+r(n)+"/o/"+r(i))+yg({alt:"media",token:e})}))[0]}(r,i)}}(t,n),r);return s.errorHandler=Ng(e),s}(t.storage,t._location,Pg()),[2,t.storage._makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new Xv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function Zg(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),i=new lg(t._location.bucket,n);return new Wg(t.storage,i)}function Jg(t){return/^[A-Za-z]+:\/\//.test(t)}function $g(t,e){if(t instanceof em){var n=t;if(null==n._bucket)throw new Xv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var i=new Wg(n,n._bucket);return null!=e?$g(i,e):i}if(void 0!==e){if(e.includes(".."))throw qv('`path` param cannot contain ".."');return Zg(t,e)}return t}function tm(t,e){if(e&&Jg(e)){if(t instanceof em)return new Wg(t,e);throw qv("To use ref(service, url), the first argument must be a Storage instance.")}return $g(t,e)}var em=function(){function t(t,e,n,i,r){var s,o;this.app=t,this._authProvider=e,this._pool=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?lg.makeFromBucketSpec(i):null==(o=null==(s=this.app.options)?void 0:s.storageBucket)?null:lg.makeFromBucketSpec(o)}return Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){gg("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){gg("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return Uv(this,void 0,void 0,(function(){var t,e;return Vv(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new Wg(this,t)},t.prototype._makeRequest=function(t,e){var n=this;if(this._deleted)return new fg(Kv());var i=function(t,e,n,i,r){var s=yg(t.urlParams),o=t.url+s,a=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(a,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(a,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(a,r),new xg(o,t.method,a,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return n._requests.delete(i)}),(function(){return n._requests.delete(i)})),i},t}();function nm(t,e){return tm(t,e)}var im=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),rm=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new im(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new im(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,i){var r=this,s=void 0;return e&&(s="function"==typeof e?function(t){return e(new im(t,r,r._ref))}:{next:e.next?function(t){return e.next(new im(t,r,r._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,s,n||void 0,i||void 0)},t}(),sm=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new om(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new om(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),om=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return Zg(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new rm(function(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new jg(t,new Tg(e),n)}(t,e,n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=$v.RAW),this._throwIfRoot("putString");var i=eg(e,t),r=Bv({},n);return null==r.contentType&&null!=i.contentType&&(r.contentType=i.contentType),new rm(new jg(this._delegate,new Tg(i.data,!0),r),this)},t.prototype.listAll=function(){var t=this;return function(t){return Hg(t)}(this._delegate).then((function(e){return new sm(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return Kg(t,e)}(this._delegate,t||void 0).then((function(t){return new sm(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return function(t){return Uv(this,void 0,void 0,(function(){var e,n;return Vv(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage._getAuthToken()];case 1:return e=i.sent(),n=Fg(t.storage,t._location,Pg()),[2,t.storage._makeRequest(n,e).getPromise()]}}))}))}(t)}(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return function(t,e){return Uv(this,void 0,void 0,(function(){var n,i;return Vv(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage._getAuthToken()];case 1:return n=r.sent(),i=function(t,e,n,i){var r=mg(e.fullServerUrl()),s=Og(n,i),o=t.maxOperationRetryTime,a=new kg(r,"PATCH",Dg(t,i),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=Ng(e),a}(t.storage,t._location,e,Pg()),[2,t.storage._makeRequest(i,n).getPromise()]}}))}))}(t,e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return Qg(t)}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return function(t){return Uv(this,void 0,void 0,(function(){var e,n;return Vv(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage._getAuthToken()];case 1:return e=i.sent(),n=function(t,e){var n=mg(e.fullServerUrl()),i=t.maxOperationRetryTime,r=new kg(n,"DELETE",(function(t,e){}),i);return r.successCodes=[200,204],r.errorHandler=Ng(e),r}(t.storage,t._location),[2,t.storage._makeRequest(n,e).getPromise()]}}))}))}(t)}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Qv(t)},t}(),am=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Jg(t))throw qv("ref() expected a child path but got a URL, use refFromURL instead.");return new om(nm(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Jg(t))throw qv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{lg.makeFromUrl(t)}catch(t){throw qv("refFromUrl() expected a valid full URL but got an invalid one.")}return new om(nm(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t}();function hm(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal");return new am(i,new em(i,s,new cg,n,r.Z.SDK_VERSION))}!function(t){var e={TaskState:ag,TaskEvent:og,StringFormat:$v,Storage:em,Reference:om};t.INTERNAL.registerComponent(new Yd.wA("storage",hm,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.4.5")}(r.Z);var um=function(){return(um=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function cm(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}Object.create,Object.create;var lm,fm,dm,pm="0.4.8",vm=pm,gm="FB-PERF-TRACE-MEASURE",mm="_wt_",ym="_fcp",xm="_fid",bm="@firebase/performance/config",wm="@firebase/performance/configexpire",_m="Performance",Tm=((lm={})["trace started"]="Trace {$traceName} was started before.",lm["trace stopped"]="Trace {$traceName} is not running.",lm["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",lm["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",lm["no window"]="Window is not available.",lm["no app id"]="App id is not available.",lm["no project id"]="Project id is not available.",lm["no api key"]="Api key is not available.",lm["invalid cc log"]="Attempted to queue invalid cc event",lm["FB not default"]="Performance can only start when Firebase app instance is the default one.",lm["RC response not ok"]="RC response is not ok",lm["invalid attribute name"]="Attribute name {$attributeName} is invalid.",lm["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",lm["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",lm["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",lm),Em=new o.LL("performance",_m,Tm),Sm=new s.Yd(_m);Sm.logLevel=s.in.INFO;var Cm,Am=function(){function t(t){if(this.window=t,!t)throw Em.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,o.hl)()||(Sm.info("IndexedDB is not supported by current browswer"),!1):(Sm.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,i=t.getEntries();n<i.length;n++){var r=i[n];e(r)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===fm&&(fm=new t(dm)),fm},t}();function Im(t,e){var n=t.length-e.length;if(n<0||n>1)throw Em.create("invalid String merger input");for(var i=[],r=0;r<t.length;r++)i.push(t.charAt(r)),e.length>r&&i.push(e.charAt(r));return i.join("")}var Pm,Rm,Om=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Im("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Im("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw Em.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw Em.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw Em.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Cm&&(Cm=new t),Cm},t}();function km(){return Pm}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Rm||(Rm={}));var Mm=["firebase_","google_","ga_"],Dm=new RegExp("^[a-zA-Z]\\w*$");function Lm(){var t=Am.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function Nm(){switch(Am.getInstance().document.visibilityState){case"visible":return Rm.VISIBLE;case"hidden":return Rm.HIDDEN;default:return Rm.UNKNOWN}}function Fm(){var t=Am.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var Bm="Could not fetch config, will use default configs";function Um(t){if(!t)return t;var e=Om.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Vm(e.tracesSamplingRate),e.logNetworkAfterSampling=Vm(e.networkRequestsSamplingRate),t}function Vm(t){return Math.random()<=t}var Ym,zm=1;function Xm(){return zm=2,Ym=Ym||function(){var t=Am.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=Om.getInstance().installationsService.getId()).then((function(t){Pm=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=Am.getInstance().localStorage;if(t){var e=t.getItem(wm);if(e&&Number(e)>Date.now()){var n=t.getItem(bm);if(n)try{return JSON.parse(n)}catch(t){return}}}}();return e?(Um(e),Promise.resolve()):function(t){return(e=Om.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Om.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Om.getInstance().getApiKey(),i=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Om.getInstance().getAppId(),app_version:vm,sdk_version:"0.0.1"})});return fetch(i).then((function(t){if(t.ok)return t.json();throw Em.create("RC response not ok")}))})).catch((function(){Sm.info(Bm)}));var e}(t).then(Um).then((function(t){return function(t){var e=Am.getInstance().localStorage;t&&e&&(e.setItem(bm,JSON.stringify(t)),e.setItem(wm,String(Date.now()+60*Om.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return Gm()}),(function(){return Gm()}))}function Gm(){zm=3}var jm,Wm=1e4,Hm=3,qm=[],Km=!1;function Qm(t){setTimeout((function(){var t,e;if(0!==Hm)return qm.length?(e=(t=qm.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=Om.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||Sm.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),i=Wm;isNaN(n)||(i=Math.max(n,i));var r=t.logResponseDetails;Array.isArray(r)&&r.length>0&&"RETRY_REQUEST_LATER"===r[0].responseAction&&(qm=cm(cm([],e),qm),Sm.info("Retry transport request later.")),Hm=3,Qm(i)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Om.getInstance().logSource,log_event:e},t).catch((function(){qm=cm(cm([],t),qm),Hm--,Sm.info("Tries left: "+Hm+"."),Qm(Wm)}))):Qm(Wm)}),t)}function Zm(t){if(!t.eventTime||!t.message)throw Em.create("invalid cc log");qm=cm(cm([],qm),[t])}function Jm(t,e){jm||(jm=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Zm({message:t.apply(void 0,e),eventTime:Date.now()})}}(ey)),jm(t,e)}function $m(t){var e=Om.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Am.getInstance().requiredApisAvailable()&&(t.isAuto&&Nm()!==Rm.VISIBLE||(3===zm?ty(t):Xm().then((function(){return ty(t)}),(function(){return ty(t)}))))}function ty(t){if(km()){var e=Om.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return Jm(t,1)}),0)}}function ey(t,e){return 0===e?(i={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},r={application_info:ny(),network_request_metric:i},JSON.stringify(r)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var i={application_info:ny(),trace_metric:e};return JSON.stringify(i)}(t);var n,i,r}function ny(){return{google_app_id:Om.getInstance().getAppId(),app_instance_id:km(),web_app_info:{sdk_version:vm,page_url:Am.getInstance().getUrl(),service_worker_status:Lm(),visibility_state:Nm(),effective_connection_type:Fm()},application_process_state:0}}var iy=["_fp",ym,xm],ry=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Am.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw Em.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw Em.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),$m(this)},t.prototype.record=function(t,e,n){if(t<=0)throw Em.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Em.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=um({},n.attributes)),n&&n.metrics)for(var i=0,r=Object.keys(n.metrics);i<r.length;i++){var s=r[i];isNaN(Number(n.metrics[s]))||(this.counters[s]=Number(Math.floor(n.metrics[s])))}$m(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(r=t,s=this.name,0===r.length||r.length>100||!(s&&s.startsWith(mm)&&iy.indexOf(r)>-1)&&r.startsWith("_"))throw Em.create("invalid custom metric name",{customMetricName:t});var n,i,r,s;this.counters[t]=(n=e,(i=Math.floor(n))<n&&Sm.info("Metric value should be an Integer, setting the value as : "+i+"."),i)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,i=!(0===(n=t).length||n.length>40||Mm.some((function(t){return n.startsWith(t)}))||!n.match(Dm)),r=function(t){return 0!==t.length&&t.length<=100}(e);if(i&&r)this.customAttributes[t]=e;else{if(!i)throw Em.create("invalid attribute name",{attributeName:t});if(!r)throw Em.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return um({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,i){var r=Am.getInstance().getUrl();if(r){var s=new t(mm+r,!0),o=Math.floor(1e3*Am.getInstance().getTimeOrigin());if(s.setStartTime(o),e&&e[0]&&(s.setDuration(Math.floor(1e3*e[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var a=n.find((function(t){return"first-paint"===t.name}));a&&a.startTime&&s.putMetric("_fp",Math.floor(1e3*a.startTime));var h=n.find((function(t){return"first-contentful-paint"===t.name}));h&&h.startTime&&s.putMetric(ym,Math.floor(1e3*h.startTime)),i&&s.putMetric(xm,Math.floor(1e3*i))}$m(s)}},t.createUserTimingTrace=function(e){$m(new t(e,!1,e))},t}();function sy(t){var e=t;if(e&&void 0!==e.responseStart){var n=Am.getInstance().getTimeOrigin(),i=Math.floor(1e3*(e.startTime+n)),r=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,s=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Om.getInstance();if(e.instrumentationEnabled){var n=t.url,i=e.logEndPointUrl.split("?")[0],r=e.flTransportEndpointUrl.split("?")[0];n!==i&&n!==r&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return Jm(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:i,timeToResponseInitiatedUs:r,timeToResponseCompletedUs:s})}}function oy(){km()&&(setTimeout((function(){return function(){var t=Am.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var i=setTimeout((function(){ry.createOobTrace(e,n),i=void 0}),5e3);t.onFirstInputDelay((function(t){i&&(clearTimeout(i),ry.createOobTrace(e,n,t))}))}else ry.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Am.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)sy(n[e]);t.setupObserver("resource",sy)}()}),0),setTimeout((function(){return function(){for(var t=Am.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)ay(n[e]);t.setupObserver("measure",ay)}()}),0))}function ay(t){var e=t.name;e.substring(0,gm.length)!==gm&&ry.createUserTimingTrace(e)}var hy=function(){function t(t){this.app=t,Am.getInstance().requiredApisAvailable()&&(0,o.eu)().then((function(t){t&&(Km||(Qm(5500),Km=!0),Xm().then(oy,oy))})).catch((function(t){Sm.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new ry(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Om.getInstance().instrumentationEnabled},set:function(t){Om.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Om.getInstance().dataCollectionEnabled},set:function(t){Om.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new Yd.wA("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw Em.create("FB not default");if("undefined"==typeof window)throw Em.create("no window");return function(t){dm=t}(window),Om.getInstance().firebaseAppInstance=t,Om.getInstance().installationsService=e,new hy(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance",pm)}(r.Z);var uy=function(){return(uy=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function cy(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function ly(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}Object.create,Object.create;var fy,dy,py="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(fy||(fy={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(dy||(dy={}));var vy,gy=new s.Yd("@firebase/analytics");function my(t,e,n,i,r,s){return cy(this,void 0,void 0,(function(){var o,a,h,u;return ly(this,(function(c){switch(c.label){case 0:o=i[r],c.label=1;case 1:return c.trys.push([1,7,,8]),o?[4,e[o]]:[3,3];case 2:return c.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return a=c.sent(),(h=a.find((function(t){return t.measurementId===r})))?[4,e[h.appId]]:[3,6];case 5:c.sent(),c.label=6;case 6:return[3,8];case 7:return u=c.sent(),gy.error(u),[3,8];case 8:return t(fy.CONFIG,r,s),[2]}}))}))}function yy(t,e,n,i,r){return cy(this,void 0,void 0,(function(){var s,o,a,h,u,c,l,f;return ly(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),s=[],r&&r.send_to?(o=r.send_to,Array.isArray(o)||(o=[o]),[4,Promise.all(n)]):[3,2];case 1:for(a=d.sent(),h=function(t){var n=a.find((function(e){return e.measurementId===t})),i=n&&e[n.appId];if(!i)return s=[],"break";s.push(i)},u=0,c=o;u<c.length&&(l=c[u],"break"!==h(l));u++);d.label=2;case 2:return 0===s.length&&(s=Object.values(e)),[4,Promise.all(s)];case 3:return d.sent(),t(fy.EVENT,i,r||{}),[3,5];case 4:return f=d.sent(),gy.error(f),[3,5];case 5:return[2]}}))}))}var xy=((vy={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",vy["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",vy["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",vy["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",vy["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",vy["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",vy["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",vy["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',vy["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',vy),by=new o.LL("analytics","Analytics",xy),wy=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function _y(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function Ty(t){var e;return cy(this,void 0,void 0,(function(){var n,i,r,s,o,a,h;return ly(this,(function(u){switch(u.label){case 0:return n=t.appId,i=t.apiKey,r={method:"GET",headers:_y(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(s,r)];case 1:if(200===(o=u.sent()).status||304===o.status)return[3,6];a="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return h=u.sent(),(null===(e=h.error)||void 0===e?void 0:e.message)&&(a=h.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw by.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a});case 6:return[2,o.json()]}}))}))}function Ey(t,e,n,i){var r=e.throttleEndTimeMillis,s=e.backoffCount;return void 0===i&&(i=wy),cy(this,void 0,void 0,(function(){var e,a,h,u,c,l,f;return ly(this,(function(d){switch(d.label){case 0:e=t.appId,a=t.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Sy(n,r)];case 2:return d.sent(),[3,4];case 3:if(h=d.sent(),a)return gy.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]"),[2,{appId:e,measurementId:a}];throw h;case 4:return d.trys.push([4,6,,7]),[4,Ty(t)];case 5:return u=d.sent(),i.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof o.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=d.sent())){if(i.deleteThrottleMetadata(e),a)return gy.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:a}];throw c}return l=503===Number(c.customData.httpStatus)?(0,o.$s)(s,i.intervalMillis,30):(0,o.$s)(s,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+l,backoffCount:s+1},i.setThrottleMetadata(e,f),gy.debug("Calling attemptFetch again in "+l+" millis"),[2,Ey(t,f,n,i)];case 7:return[2]}}))}))}function Sy(t,e){return new Promise((function(n,i){var r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((function(){clearTimeout(s),i(by.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Cy=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();var Ay,Iy,Py={},Ry=[],Oy={},ky="dataLayer",My="gtag",Dy=!1;function Ly(t){if(Dy)throw by.create("already-initialized");t.dataLayerName&&(ky=t.dataLayerName),t.gtagName&&(My=t.gtagName)}function Ny(t,e){!function(){var t=[];if((0,o.ru)()&&t.push("This is a browser extension environment."),(0,o.zI)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=by.create("invalid-analytics-context",{errorInfo:e});gy.warn(n.message)}}();var n=t.options.appId;if(!n)throw by.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw by.create("no-api-key");gy.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Py[n])throw by.create("already-exists",{id:n});if(!Dy){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ky);var i=function(t,e,n,i,r){var s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(t,e,n,i){return function(r,s,o){return cy(this,void 0,void 0,(function(){var a;return ly(this,(function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),r!==fy.EVENT?[3,2]:[4,yy(t,e,n,s,o)];case 1:return h.sent(),[3,5];case 2:return r!==fy.CONFIG?[3,4]:[4,my(t,e,n,i,s,o)];case 3:return h.sent(),[3,5];case 4:t(fy.SET,s),h.label=5;case 5:return[3,7];case 6:return a=h.sent(),gy.error(a),[3,7];case 7:return[2]}}))}))}}(s,t,e,n),{gtagCore:s,wrappedGtag:window[r]}}(Py,Ry,Oy,ky,My),r=i.wrappedGtag,s=i.gtagCore;Iy=r,Ay=s,Dy=!0}return Py[n]=function(t,e,n,i,r,s){return cy(this,void 0,void 0,(function(){var a,h,u,c,l,f,d;return ly(this,(function(p){switch(p.label){case 0:return(a=function(t,e,n){return void 0===e&&(e=wy),cy(this,void 0,void 0,(function(){var n,i,r,s,o,a,h=this;return ly(this,(function(u){if(n=t.options,i=n.appId,r=n.apiKey,s=n.measurementId,!i)throw by.create("no-app-id");if(!r){if(s)return[2,{measurementId:s,appId:i}];throw by.create("no-api-key")}return o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Cy,setTimeout((function(){return cy(h,void 0,void 0,(function(){return ly(this,(function(t){return a.abort(),[2]}))}))}),6e4),[2,Ey({appId:i,apiKey:r,measurementId:s},o,a,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&gy.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return gy.error(t)})),e.push(a),h=function(){return cy(this,void 0,void 0,(function(){var t;return ly(this,(function(e){switch(e.label){case 0:return(0,o.hl)()?[3,1]:(gy.warn(by.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,o.eu)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),gy.warn(by.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?i.getId():void 0})),[4,Promise.all([a,h])];case 1:return u=p.sent(),c=u[0],l=u[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var i=n[e];if(i.src&&i.src.includes(py))return i}return null}()||function(t,e){var n=document.createElement("script");n.src=py+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(s,c.measurementId),r("js",new Date),(d={}).origin="firebase",d.update=!0,f=d,null!=l&&(f.firebase_id=l),r(fy.CONFIG,c.measurementId,f),[2,c.measurementId]}}))}))}(t,Ry,Oy,e,Ay,ky),{app:t,logEvent:function(t,e,i){(function(t,e,n,i,r){return cy(this,void 0,void 0,(function(){var s,o;return ly(this,(function(a){switch(a.label){case 0:return r&&r.global?(t(fy.EVENT,n,i),[2]):[3,1];case 1:return[4,e];case 2:s=a.sent(),o=uy(uy({},i),{send_to:s}),t(fy.EVENT,n,o),a.label=3;case 3:return[2]}}))}))})(Iy,Py[n],t,e,i).catch((function(t){return gy.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,i){return cy(this,void 0,void 0,(function(){var r;return ly(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(fy.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:r=s.sent(),t(fy.CONFIG,r,{update:!0,screen_name:n}),s.label=3;case 3:return[2]}}))}))})(Iy,Py[n],t,e).catch((function(t){return gy.error(t)}))},setUserId:function(t,e){(function(t,e,n,i){return cy(this,void 0,void 0,(function(){var r;return ly(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(fy.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:r=s.sent(),t(fy.CONFIG,r,{update:!0,user_id:n}),s.label=3;case 3:return[2]}}))}))})(Iy,Py[n],t,e).catch((function(t){return gy.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,i){return cy(this,void 0,void 0,(function(){var r,s,o,a,h;return ly(this,(function(u){switch(u.label){case 0:if(!i||!i.global)return[3,1];for(r={},s=0,o=Object.keys(n);s<o.length;s++)a=o[s],r["user_properties."+a]=n[a];return t(fy.SET,r),[2,Promise.resolve()];case 1:return[4,e];case 2:h=u.sent(),t(fy.CONFIG,h,{update:!0,user_properties:n}),u.label=3;case 3:return[2]}}))}))})(Iy,Py[n],t,e).catch((function(t){return gy.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return cy(this,void 0,void 0,(function(){var n;return ly(this,(function(i){switch(i.label){case 0:return[4,t];case 1:return n=i.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Py[n],t).catch((function(t){return gy.error(t)}))},INTERNAL:{delete:function(){return delete Py[n],Promise.resolve()}}}}var Fy="analytics";function By(){return cy(this,void 0,void 0,(function(){return ly(this,(function(t){switch(t.label){case 0:if((0,o.ru)())return[2,!1];if(!(0,o.zI)())return[2,!1];if(!(0,o.hl)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,o.eu)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Yd.wA(Fy,(function(t){return Ny(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Ly,EventName:dy,isSupported:By})),t.INTERNAL.registerComponent(new Yd.wA("analytics-internal",(function(t){try{return{logEvent:t.getProvider(Fy).getImmediate().logEvent}}catch(t){throw by.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.6")}(r.Z);var Uy=function(){return(Uy=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function Vy(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}function Yy(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}Object.create,Object.create;var zy,Xy=function(){function t(t,e,n,i){this.client=t,this.storage=e,this.storageCache=n,this.logger=i}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,i=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+i+"."),i},t.prototype.fetch=function(t){return Vy(this,void 0,void 0,(function(){var e,n,i,r,s;return Yy(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=o.sent(),n=e[0],(i=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,i]:(t.eTag=i&&i.eTag,[4,this.client.fetch(t)]);case 2:return r=o.sent(),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===r.status&&s.push(this.storage.setLastSuccessfulFetchResponse(r)),[4,Promise.all(s)];case 3:return o.sent(),[2,r]}}))}))},t}(),Gy=((zy={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",zy["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",zy["registration-api-key"]="Undefined API key. Check Firebase app initialization.",zy["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",zy["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",zy["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",zy["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",zy["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",zy["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",zy["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',zy["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',zy["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",zy["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",zy),jy=new o.LL("remoteconfig","Remote Config",Gy),Wy=function(){function t(t,e,n,i,r,s){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=i,this.apiKey=r,this.appId=s}return t.prototype.fetch=function(t){return Vy(this,void 0,void 0,(function(){var e,n,i,r,s,o,a,h,u,c,l,f,d,p,v,g,m,y,x;return Yy(this,(function(b){switch(b.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=b.sent(),n=e[0],i=e[1],r=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",s=r+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},h={method:"POST",headers:o,body:JSON.stringify(a)},u=fetch(s,h),c=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),b.label=2;case 2:return b.trys.push([2,5,,6]),[4,Promise.race([u,c])];case 3:return b.sent(),[4,u];case 4:return l=b.sent(),[3,6];case 5:throw f=b.sent(),d="fetch-client-network","AbortError"===f.name&&(d="fetch-timeout"),jy.create(d,{originalErrorMessage:f.message});case 6:if(p=l.status,v=l.headers.get("ETag")||void 0,200!==l.status)return[3,11];y=void 0,b.label=7;case 7:return b.trys.push([7,9,,10]),[4,l.json()];case 8:return y=b.sent(),[3,10];case 9:throw x=b.sent(),jy.create("fetch-client-parse",{originalErrorMessage:x.message});case 10:g=y.entries,m=y.state,b.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===m?p=500:"NO_CHANGE"===m?p=304:"NO_TEMPLATE"!==m&&"EMPTY_CONFIG"!==m||(g={}),304!==p&&200!==p)throw jy.create("fetch-status",{httpStatus:p});return[2,{status:p,eTag:v,config:g}]}var w}))}))},t}(),Hy=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),qy=["1","true","t","yes","y","on"],Ky=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&qy.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Qy=function(){function t(t,e,n,i,r){this.app=t,this._client=e,this._storageCache=n,this._storage=i,this._logger=r,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=s.in.DEBUG;break;case"silent":this._logger.logLevel=s.in.SILENT;break;default:this._logger.logLevel=s.in.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Vy(this,void 0,void 0,(function(){var t,e,n;return Yy(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=i.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return i.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Vy(this,void 0,void 0,(function(){var t,e,n,i=this;return Yy(this,(function(r){switch(r.label){case 0:t=new Hy,setTimeout((function(){return Vy(i,void 0,void 0,(function(){return Yy(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return r.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return r.sent(),[3,6];case 4:return e=r.sent(),n=function(t,e){return t instanceof o.ZR&&-1!==t.code.indexOf("fetch-throttle")}(e)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw r.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return Vy(this,void 0,void 0,(function(){return Yy(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(Uy(Uy({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Ky("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Ky("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Ky("static"))},t}();function Zy(t,e){var n=t.target.error||void 0;return jy.create(e,{originalErrorMessage:n&&n.message})}var Jy="app_namespace_store",$y=function(){function t(t,e,n,i){void 0===i&&(i=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Zy(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Jy,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=i}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Vy(this,void 0,void 0,(function(){var e,n=this;return Yy(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return e=i.sent(),[2,new Promise((function(i,r){var s=e.transaction([Jy],"readonly").objectStore(Jy),o=n.createCompositeKey(t);try{var a=s.get(o);a.onerror=function(t){r(Zy(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;i(e?e.value:void 0)}}catch(t){r(jy.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Vy(this,void 0,void 0,(function(){var n,i=this;return Yy(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return n=r.sent(),[2,new Promise((function(r,s){var o=n.transaction([Jy],"readwrite").objectStore(Jy),a=i.createCompositeKey(t);try{var h=o.put({compositeKey:a,value:e});h.onerror=function(t){s(Zy(t,"storage-set"))},h.onsuccess=function(){r()}}catch(t){s(jy.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return Vy(this,void 0,void 0,(function(){var e,n=this;return Yy(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return e=i.sent(),[2,new Promise((function(i,r){var s=e.transaction([Jy],"readwrite").objectStore(Jy),o=n.createCompositeKey(t);try{var a=s.delete(o);a.onerror=function(t){r(Zy(t,"storage-delete"))},a.onsuccess=function(){i()}}catch(t){r(jy.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),tx=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Vy(this,void 0,void 0,(function(){var t,e,n,i,r,s;return Yy(this,(function(o){switch(o.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(i=o.sent())&&(this.lastFetchStatus=i),[4,e];case 2:return(r=o.sent())&&(this.lastSuccessfulFetchTimestampMillis=r),[4,n];case 3:return(s=o.sent())&&(this.activeConfig=s),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function ex(t,e){return new Promise((function(n,i){var r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((function(){clearTimeout(s),i(jy.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var nx,ix=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Vy(this,void 0,void 0,(function(){var e;return Yy(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,i=e.backoffCount;return Vy(this,void 0,void 0,(function(){var e,r,s;return Yy(this,(function(a){switch(a.label){case 0:return[4,ex(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof o.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(r=a.sent()))throw r;return s={throttleEndTimeMillis:Date.now()+(0,o.$s)(i),backoffCount:i+1},[4,this.storage.setThrottleMetadata(s)];case 6:return a.sent(),[2,this.attemptFetch(t,s)];case 7:return[2]}}))}))},t}(),rx="@firebase/remote-config";(nx=r.Z).INTERNAL.registerComponent(new Yd.wA("remoteConfig",(function(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw jy.create("registration-window");var o=i.options,a=o.projectId,h=o.apiKey,u=o.appId;if(!a)throw jy.create("registration-project-id");if(!h)throw jy.create("registration-api-key");if(!u)throw jy.create("registration-app-id");n=n||"firebase";var c=new $y(u,i.name,n),l=new tx(c),f=new s.Yd(rx);f.logLevel=s.in.ERROR;var d=new Wy(r,nx.SDK_VERSION,n,a,h,u),p=new ix(d,c),v=new Xy(p,c,l,f),g=new Qy(i,v,l,c,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),nx.registerVersion(rx,"0.1.33"),r.Z.registerVersion("firebase","8.3.1","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.Z.registerVersion("firebase","8.3.1");class sx extends i().Physics.Arcade.Sprite{constructor(t,e,n){super(t,e,n,"bullet"),this.scene=t}fire(e,n){t.socket.emit("newBullet",{angle:this.scene.player.angle,initial:{x:e,y:n},end:{x:this.scene.game.input.activePointer.worldX,y:this.scene.game.input.activePointer.worldY}}),this.body.reset(e,n),this.angle=this.scene.player.angle,this.scene.physics.moveTo(this,this.scene.game.input.activePointer.worldX,this.scene.game.input.activePointer.worldY,300),this.setActive(!0),this.setVisible(!0)}preUpdate(e,n){super.preUpdate(e,n),(this.y<=0||this.y>=t.mapHeight||this.x<=0||this.x>=t.mapWidth)&&(this.setActive(!1),this.setVisible(!1))}}class ox extends i().Physics.Arcade.Group{constructor(t){super(t.physics.world,t),this.createMultiple({frameQuantity:40,key:"bullet",setScale:{x:.07,y:.07},active:!1,visible:!1,classType:sx})}fire(t,e){const n=this.getFirstDead(!1);n&&n.fire(t,e)}}const ax=ox;class hx extends i().Physics.Arcade.Sprite{constructor(e){super(e,Math.random()*t.mapWidth,Math.random()*t.mapHeight,"player"),this.nameText=e.add.text(this.x-40,this.y-100,e.name),e.add.existing(this),e.physics.add.existing(this),this.setScale(.5),e.cameras.main.startFollow(this,!0),this.setCollideWorldBounds(!0),t.socket.emit("newPlayer",{x:this.x,y:this.y,name:this.scene.name})}resetPos(){this.setPosition(Math.random()*t.mapWidth,Math.random()*t.mapHeight),this.resetNameText()}resetNameText(){this.nameText.setPosition(this.x-40,this.y-100)}}const ux=hx;class cx extends i().Scene{constructor(){super(),i().Scene.call(this,{key:"game"})}init(){this.speed=3,this.score=0,this.sprintAcceleration=3,this.name=prompt("What would you like to be called?")}preload(){this.load.image("player","assets/images/player.png"),this.load.image("bullet","assets/images/bullet.png"),this.load.image("enemy","assets/images/enemy.png"),this.load.audio("pew","assets/sounds/shoot.mp3"),this.load.audio("music","assets/sounds/music.mp3")}create(){this.start=this.getTime(),t.socket.emit("ready"),this.sound.add("music",1,!0).play(),this.scoreText=this.add.text(10,10,"Score: 0"),this.scoreText.setScrollFactor(0,0),this.leaderboardText=this.add.text(2*this.cameras.main.centerX-250,10,""),this.leaderboardText.setScrollFactor(0,0),t.socket.on("leaderboard",(t=>{let e="Leaderboard:";t.forEach((t=>{e+=`\n\t${t}`})),this.leaderboardText.text=e})),this.players=this.physics.add.group(),t.socket.on("newPlayer",(t=>{const e=this.add.sprite(t.player.x,t.player.y,"enemy");e.nameText=this.add.text(t.player.x-40,t.player.y-100,t.player.name),e.setScale(.5),e.id=t.id,this.players.add(e)})),t.socket.on("players",(e=>{Object.keys(e).forEach((n=>{const i=e[n];n!=t.socket.id?this.players.getChildren().forEach((t=>{t.id==n&&(t.nameText.setPosition(i.x-30,i.y-100),t.setPosition(i.x,i.y),t.setAngle(i.angle))})):this.score=i.score}))})),t.socket.on("playerLeft",(t=>{this.players.getChildren().forEach((e=>{e.id==t&&(e.destroy(),e.nameText.destroy())}))})),this.physics.world.setBounds(0,0,t.mapWidth,t.mapHeight),this.cameras.main.setBounds(0,0,t.mapWidth,t.mapHeight),this.player=new ux(this),this.myBullets=new ax(this),this.theirBullets=this.physics.add.group(),this.physics.add.overlap(this.theirBullets,this.player,((e,n)=>{this.player.resetPos(),t.socket.emit("shot",n.id)})),t.socket.on("newBullet",(t=>{const e=this.physics.add.sprite(t.pos.initial.x,t.pos.initial.y,"bullet");e.id=t.id,e.setScale(.07),e.setAngle(t.pos.angle),this.theirBullets.add(e),this.physics.moveTo(e,t.pos.end.x,t.pos.end.y,300)})),this.pew=this.sound.add("pew",{volume:.05}),this.keys=this.input.keyboard.addKeys("W,A,S,D"),this.shiftKey=this.input.keyboard.addKey(16),this.input.on("pointermove",(t=>{const e=i().Math.RAD_TO_DEG*i().Math.Angle.Between(this.player.x,this.player.y,this.game.input.activePointer.worldX,this.game.input.activePointer.worldY);this.player.setAngle(e)}))}update(){let e=this.speed;this.shiftKey.isDown&&(e+=this.sprintAcceleration),this.keys.W.isDown&&(this.player.y-=e,this.cameras.main.scrollY-=e,this.player.resetNameText()),this.keys.S.isDown&&(this.player.y+=e,this.cameras.main.scrollY+=e,this.player.resetNameText()),this.keys.A.isDown&&(this.player.x-=e,this.cameras.main.scrollX-=e,this.player.resetNameText()),this.keys.D.isDown&&(this.player.x+=e,this.cameras.main.scrollX+=e,this.player.resetNameText()),this.input.activePointer.isDown&&this.showDelta()>100&&(this.pew.play(),this.myBullets.fire(this.player.x,this.player.y-20),this.start=this.getTime()),this.scoreText.text="Score: "+this.score,t.socket.emit("player",{x:this.player.x,y:this.player.y,angle:this.player.angle})}getTime(){return(new Date).getTime()}showDelta(){return this.getTime()-this.start}}const lx=cx;class fx extends i().Scene{constructor(){super(),i().Scene.call(this,{key:"help"})}create(){this.backButton=this.add.text(0,0,"BACK",{fill:"#fc6b03"}),this.backButton.setInteractive(),this.backButton.on("pointerdown",(()=>{this.scene.switch("menu")})),this.add.text(this.cameras.main.centerX-300,this.cameras.main.centerY-100,"\n\t\t\tHow to play:\n                Use wasd keys to move\n                Hold down the cursor to shoot\n                Shoot the other players in order to earn points\n\t\t\tTip:\n\t\t\t\tHold shift to sprint\n            ")}}const dx=fx;class px extends i().Scene{constructor(){super(),i().Scene.call(this,{key:"menu"})}create(){const t={fill:"#fc6b03",fontSize:"150px",backgroundColor:"#a83232"};this.playButton=this.add.text(this.cameras.main.centerX-200,this.cameras.main.centerY-170,"PLAY",t),this.playButton.setInteractive(),this.playButton.on("pointerdown",(()=>{this.scene.switch("game")})),this.helpButton=this.add.text(this.cameras.main.centerX-200,this.cameras.main.centerY+5,"HELP",t),this.helpButton.setInteractive(),this.helpButton.on("pointerdown",(()=>{this.scene.switch("help")}))}}const vx=px;r.Z.initializeApp({apiKey:"AIzaSyDXU6Lw0B-Ma_LagtQ4OF-lmmwaAeZGBB8",authDomain:"grapple-ecd1c.firebaseapp.com",projectId:"grapple-ecd1c",storageBucket:"grapple-ecd1c.appspot.com",messagingSenderId:"874102344684",appId:"1:874102344684:web:5012c4dedb571774974ec9",measurementId:"G-7DFTRDPTLF",databaseURL:"https://grapple-ecd1c-default-rtdb.firebaseio.com/"}),r.Z.analytics(),new(i().Game)({width:window.innerWidth>t.mapWidth?t.mapWidth:window.innerWidth,height:window.innerHeight>t.mapHeight?t.mapHeight:window.innerHeight,physics:{default:"arcade",arcade:{debug:!1}},scene:[vx,dx,lx]})})()})();